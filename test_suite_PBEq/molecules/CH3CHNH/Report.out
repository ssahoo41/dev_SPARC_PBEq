---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:19
Job ID:    2266642
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:23
Job ID:    2266642
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.053 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.017 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 1.071 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 8.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 0.791 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 41.287 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.940 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.127 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.859631	    7.076335	   10.000000	
    6.715634	    9.086573	   11.666051	
    6.715634	    9.086573	    8.333949	
    9.138645	   12.923665	   10.000000	
   13.284366	   12.122571	   10.000000	
    7.941906	    8.926244	   10.000000	
    9.894898	   10.983105	   10.000000	
   12.248975	   10.483691	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.210 ms
Set up communicators.

--set up spincomm took 2.419 ms

--set up kptcomm took 0.337 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.107 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.306 ms

Calculate_SplineDerivRadFun took 0.201 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 5.411 ms.
time spent on vectorized spline interp: 3.900 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.736 ms.
time spent on vectorized spline interp: 1.781 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.510 ms.
time spent on vectorized spline interp: 1.736 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.928 ms.

Calculating rb for all atom types took 21.017 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.939 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000210243, sum_int_rho = 17.5000244691551
PosCharge = 18.000000021024, NegCharge = -17.500024469155, scal_fac = 1.028569991588
After scaling, int_rho = 18.0000000210243, PosCharge + NegCharge - NetCharge = -5.329e-14
--Calculate Vref took 0.412 ms
--Calculate rho_guess took 2.415 ms

 integral of b = -18.0000000210243,
 int{b} + Nelectron + NetCharge = -2.102e-08,
 Esc = -44.5396727134940,
 MPI_Reduce took 5.042 ms

Calculating b & b_ref took 13.421 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.076 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.088 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.013 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.119 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 30.112 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102430, int_b + int_rho = 4.366e-14, checking this took 0.661 ms
2-norm of RHS = 669.8250544589821, which took 0.106 ms

iter_count = 420, r_2norm = 5.650e-04, tol*||rhs|| = 6.698e-04

Anderson update took 284.051 ms, out of which F'*F took 131.552 ms; b-Ax took 857.298 ms, out of which Lap took 768.003 ms
Solving Poisson took 1845.530 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.356 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.816 ms
Total time for convolution: 	 convolve: 5.271232 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
Total time for convolution: 	 convolve: 5.265478 
Total time for convolution: 	 convolve: 5.392824 
Total time for convolution: 	 convolve: 5.262691 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.737 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.332 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.323 ms
rank = 0, XC calculation took 25183.167 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 1.609 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.215 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.921 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.141 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.908 ms
    Lanczos iter 53, eigmin  = -0.902736480, eigmax = 264.931120275, err_eigmin = 1.181e-03, err_eigmax = 9.662e-03
rank =   0, Lanczos took 156.227 ms, eigmin = -0.902736479971, eigmax = 267.580431477644

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.288847, lowerbound = -1.002736, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1397.681 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.875 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.544 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.374 ms
rank =  0, Distribute data + matrix mult took 20.814 ms
rank =  0, finding HY took 23.177 ms
rank =  0, distributing HY into block cyclic form took 16.163 ms
rank =  0, finding Y'*HY took 26.738 ms
Rank 0, Project_Hamiltonian used 86.937 ms
Total time for projection: 86.951 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.310 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.419 ms
rank = 0, Solve_Generalized_EigenProblem used 0.736 ms
    first calculated eigval = 2.803506321195830
    last  calculated eigval = 3.212168589838521
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.80350632119583
lambda[   2] =   2.83796739709274
lambda[   3] =   2.88528121812212
lambda[   4] =   2.92681085619464
lambda[   5] =   2.93671460203185
lambda[   6] =   2.94874693130888
lambda[   7] =   3.00009429378405
lambda[   8] =   3.01828409335961
lambda[   9] =   3.03863707273014
lambda[  10] =   3.06097483468074
lambda[  11] =   3.08702276428284
lambda[  12] =   3.11339706306944
lambda[  13] =   3.14089035215316
lambda[  14] =   3.16323978478847
lambda[  15] =   3.21216858983852
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.774 ms
rank =  0, subspace rotation using ScaLAPACK took 4.112 ms
rank =  0, Distributing orbital back into band + domain format took 14.876 ms
rank = 0, Subspace_Rotation used 19.017 ms

Total time for subspace rotation: 19.021 ms
rank = 0, Efermi =   3.049805954438 calculate fermi energy took 0.082 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.312169, lowerbound = -1.002736, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1413.849 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.134 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.543 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 17.709 ms
rank =  0, finding HY took 22.580 ms
rank =  0, distributing HY into block cyclic form took 16.189 ms
rank =  0, finding Y'*HY took 3.651 ms
Rank 0, Project_Hamiltonian used 60.177 ms
Total time for projection: 60.197 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.107 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.616405654578530
    last  calculated eigval = 0.461166138387457
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.61640565457853
lambda[   2] =  -0.46367871939100
lambda[   3] =  -0.20929157849563
lambda[   4] =  -0.05500992188960
lambda[   5] =   0.00914016054962
lambda[   6] =   0.05538498720136
lambda[   7] =   0.08630141776079
lambda[   8] =   0.21649024362934
lambda[   9] =   0.23748819535434
lambda[  10] =   0.32009727824326
lambda[  11] =   0.35866792857649
lambda[  12] =   0.39961013492693
lambda[  13] =   0.40309455368272
lambda[  14] =   0.42027089991809
lambda[  15] =   0.46116613838746
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 4.277 ms
rank =  0, Distributing orbital back into band + domain format took 15.140 ms
rank = 0, Subspace_Rotation used 19.441 ms

Total time for subspace rotation: 19.446 ms
rank = 0, Efermi =   0.290975868118 calculate fermi energy took 0.031 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.561166, lowerbound = -1.002736, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1400.945 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 16.061 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.600 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.215 ms
rank =  0, Distribute data + matrix mult took 20.900 ms
rank =  0, finding HY took 22.781 ms
rank =  0, distributing HY into block cyclic form took 14.472 ms
rank =  0, finding Y'*HY took 4.902 ms
Rank 0, Project_Hamiltonian used 63.119 ms
Total time for projection: 63.126 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.074 ms
rank = 0, Solve_Generalized_EigenProblem used 0.165 ms
    first calculated eigval = -0.922151345492302
    last  calculated eigval = 0.161986337194287
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.92215134549230
lambda[   2] =  -0.78287386562478
lambda[   3] =  -0.59788806665696
lambda[   4] =  -0.54006842397788
lambda[   5] =  -0.46940736475721
lambda[   6] =  -0.45266550456222
lambda[   7] =  -0.44703879415143
lambda[   8] =  -0.34139581744859
lambda[   9] =  -0.28805216795219
lambda[  10] =  -0.03108537117231
lambda[  11] =   0.06092238875789
lambda[  12] =   0.08862830669311
lambda[  13] =   0.13068505000112
lambda[  14] =   0.14901411375907
lambda[  15] =   0.16198633719429
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.179 ms
rank =  0, subspace rotation using ScaLAPACK took 4.128 ms
rank =  0, Distributing orbital back into band + domain format took 14.887 ms
rank = 0, Subspace_Rotation used 19.040 ms

Total time for subspace rotation: 19.045 ms
rank = 0, Efermi =  -0.060206781390 calculate fermi energy took 0.035 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.261986, lowerbound = -1.002736, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1403.322 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 15.207 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.407 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.646 ms
rank =  0, finding HY took 21.721 ms
rank =  0, distributing HY into block cyclic form took 14.587 ms
rank =  0, finding Y'*HY took 5.029 ms
Rank 0, Project_Hamiltonian used 60.021 ms
Total time for projection: 60.028 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.922962774872037
    last  calculated eigval = 0.095281708307699
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.92296277487204
lambda[   2] =  -0.78406194533247
lambda[   3] =  -0.60723192492916
lambda[   4] =  -0.55137437967490
lambda[   5] =  -0.48953160379238
lambda[   6] =  -0.46608336314745
lambda[   7] =  -0.45815183000170
lambda[   8] =  -0.35495552412197
lambda[   9] =  -0.31804660037620
lambda[  10] =  -0.10330915441546
lambda[  11] =   0.00847569469043
lambda[  12] =   0.04066031471930
lambda[  13] =   0.05473673946318
lambda[  14] =   0.06206573176437
lambda[  15] =   0.09528170830770
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 4.550 ms
rank =  0, Distributing orbital back into band + domain format took 14.946 ms
rank = 0, Subspace_Rotation used 19.528 ms

Total time for subspace rotation: 19.533 ms
rank = 0, Efermi =  -0.132430564616 calculate fermi energy took 0.036 ms
rank = 0, --- Calculate rho: sum over local bands took 3.422 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.085 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.188 ms
rank = 0, Calculating density took 6129.915 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.594 ms
rank = 0, D2D took 1.402 ms
rank = 0, Transfering density took 1.410 ms
Etot    =   -25.479088060403
Eband   =    -9.904799894669
E1      =    20.425166862821
E2      =    -7.442650449584
E3      =    -9.759388734409
Exc     =    -8.661821498422
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 3.185e+00, dEband = 1.238e+00
rank = 0, Calculating/Estimating energy took 1.030 ms, Etot = -25.479088060, dEtot = 3.185e+00, dEband = 1.238e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 43.5280850098036, which took 0.050 ms

iter_count = 96, r_2norm = 1.503e-03, tol*||rhs|| = 1.741e-03

Anderson update took 61.341 ms, out of which F'*F took 26.989 ms; b-Ax took 189.102 ms, out of which Lap took 168.827 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 413.772 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102434, int_b + int_rho = 9.095e-14, checking this took 0.122 ms
2-norm of RHS = 665.9136209921385, which took 0.186 ms

iter_count = 288, r_2norm = 5.323e-04, tol*||rhs|| = 6.659e-04

Anderson update took 179.722 ms, out of which F'*F took 82.213 ms; b-Ax took 570.115 ms, out of which Lap took 509.806 ms
Solving Poisson took 1224.473 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.720 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.229099 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 79.488 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.241011 
Total time for convolution: 	 convolve: 5.231210 
Total time for convolution: 	 convolve: 5.232894 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.322 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.262 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 0.987 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.845 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.853 ms

This SCF took 33006.343 ms, scf error = 1.950e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.195282, lowerbound = -0.922963, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1430.028 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.651 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.459 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.298 ms
rank =  0, Distribute data + matrix mult took 18.433 ms
rank =  0, finding HY took 22.415 ms
rank =  0, distributing HY into block cyclic form took 14.246 ms
rank =  0, finding Y'*HY took 5.217 ms
Rank 0, Project_Hamiltonian used 60.350 ms
Total time for projection: 60.364 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -0.891274588430695
    last  calculated eigval = 0.056054789418208
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89127458843070
lambda[   2] =  -0.74807961609342
lambda[   3] =  -0.58024639477153
lambda[   4] =  -0.52476582418934
lambda[   5] =  -0.45763374934827
lambda[   6] =  -0.43263013057166
lambda[   7] =  -0.42637795724138
lambda[   8] =  -0.33074379189292
lambda[   9] =  -0.28601698549329
lambda[  10] =  -0.09268391157709
lambda[  11] =  -0.02191545750007
lambda[  12] =   0.01869352727797
lambda[  13] =   0.02443735279334
lambda[  14] =   0.03708396688006
lambda[  15] =   0.05605478941821
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 4.297 ms
rank =  0, Distributing orbital back into band + domain format took 14.650 ms
rank = 0, Subspace_Rotation used 18.972 ms

Total time for subspace rotation: 18.995 ms
rank = 0, Efermi =  -0.121805321810 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 2.840 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.322 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.142 ms
rank = 0, Calculating density took 1518.010 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.465 ms
rank = 0, D2D took 0.580 ms
rank = 0, Transfering density took 0.587 ms
Etot    =   -25.430764138569
Eband   =    -9.355538078014
E1      =    19.940258328254
E2      =    -7.399116555480
E3      =    -9.905471768459
Exc     =    -8.780399998625
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 6.040e-03, dEband = 6.866e-02
rank = 0, Calculating/Estimating energy took 1.167 ms, Etot = -25.430764139, dEtot = 6.040e-03, dEband = 6.866e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 18.7532596246492, which took 0.050 ms

iter_count = 102, r_2norm = 5.756e-04, tol*||rhs|| = 7.501e-04

Anderson update took 61.276 ms, out of which F'*F took 32.231 ms; b-Ax took 210.652 ms, out of which Lap took 188.417 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 445.693 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102433, int_b + int_rho = 8.367e-14, checking this took 0.089 ms
2-norm of RHS = 661.0475109471838, which took 0.215 ms

iter_count = 300, r_2norm = 5.336e-04, tol*||rhs|| = 6.610e-04

Anderson update took 186.935 ms, out of which F'*F took 88.913 ms; b-Ax took 608.281 ms, out of which Lap took 543.290 ms
Solving Poisson took 1274.644 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.849 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.278758 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.574 ms
Total time for convolution: 	 convolve: 5.256481 
Total time for convolution: 	 convolve: 5.237867 
Total time for convolution: 	 convolve: 5.192094 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.330 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 0.972 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.813 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.805 ms

This SCF took 28369.958 ms, scf error = 1.330e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.156055, lowerbound = -0.891275, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1406.471 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.461 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.802 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.676 ms
rank =  0, Distribute data + matrix mult took 21.953 ms
rank =  0, finding HY took 23.016 ms
rank =  0, distributing HY into block cyclic form took 14.836 ms
rank =  0, finding Y'*HY took 4.658 ms
Rank 0, Project_Hamiltonian used 64.507 ms
Total time for projection: 64.523 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -0.847295281121991
    last  calculated eigval = 0.046754953154003
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84729528112199
lambda[   2] =  -0.69438629073977
lambda[   3] =  -0.53690900736741
lambda[   4] =  -0.48362376595215
lambda[   5] =  -0.40887555792289
lambda[   6] =  -0.38302925598440
lambda[   7] =  -0.37575024854002
lambda[   8] =  -0.29746923272800
lambda[   9] =  -0.24423548579532
lambda[  10] =  -0.06406130542167
lambda[  11] =  -0.03037656372446
lambda[  12] =   0.00636624010682
lambda[  13] =   0.01942736015644
lambda[  14] =   0.02272755254772
lambda[  15] =   0.04675495315400
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.163 ms
rank =  0, subspace rotation using ScaLAPACK took 4.134 ms
rank =  0, Distributing orbital back into band + domain format took 14.400 ms
rank = 0, Subspace_Rotation used 18.564 ms

Total time for subspace rotation: 18.569 ms
rank = 0, Efermi =  -0.093182715636 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 3.428 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.755 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.225 ms
rank = 0, Calculating density took 1497.305 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.662 ms
rank = 0, D2D took 0.826 ms
rank = 0, Transfering density took 0.834 ms
Etot    =   -25.395324750819
Eband   =    -8.543148253651
E1      =    19.245119122824
E2      =    -7.269841526702
E3      =   -10.154022579392
Exc     =    -8.981487011961
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 4.430e-03, dEband = 1.015e-01
rank = 0, Calculating/Estimating energy took 1.518 ms, Etot = -25.395324751, dEtot = 4.430e-03, dEband = 1.015e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.0859919591004, which took 5.070 ms

iter_count = 102, r_2norm = 2.292e-04, tol*||rhs|| = 2.434e-04

Anderson update took 64.471 ms, out of which F'*F took 29.894 ms; b-Ax took 202.974 ms, out of which Lap took 181.569 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 449.618 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102430, int_b + int_rho = 4.366e-14, checking this took 0.167 ms
2-norm of RHS = 660.2981831652099, which took 0.394 ms

iter_count = 276, r_2norm = 6.160e-04, tol*||rhs|| = 6.603e-04

Anderson update took 168.067 ms, out of which F'*F took 77.322 ms; b-Ax took 533.786 ms, out of which Lap took 472.090 ms
Solving Poisson took 1170.178 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.155919 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.211695 
Total time for convolution: 	 convolve: 5.193416 
Total time for convolution: 	 convolve: 5.170349 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.488 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.644 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.332 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.541 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.961 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.817 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.798 ms

This SCF took 28158.709 ms, scf error = 5.180e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.146755, lowerbound = -0.847295, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1383.769 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.725 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.284 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.329 ms
rank =  0, Distribute data + matrix mult took 18.363 ms
rank =  0, finding HY took 22.122 ms
rank =  0, distributing HY into block cyclic form took 14.241 ms
rank =  0, finding Y'*HY took 6.001 ms
Rank 0, Project_Hamiltonian used 60.775 ms
Total time for projection: 60.792 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -0.834718196590325
    last  calculated eigval = 0.039068201658282
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83471819659033
lambda[   2] =  -0.67726686637233
lambda[   3] =  -0.52070690282684
lambda[   4] =  -0.46892809228892
lambda[   5] =  -0.39211393354820
lambda[   6] =  -0.36709798217710
lambda[   7] =  -0.35748504431473
lambda[   8] =  -0.28769114975812
lambda[   9] =  -0.23328579110546
lambda[  10] =  -0.05415372235670
lambda[  11] =  -0.03264357325858
lambda[  12] =   0.00225651921458
lambda[  13] =   0.01672430659345
lambda[  14] =   0.01871869549373
lambda[  15] =   0.03906820165828
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 3.970 ms
rank =  0, Distributing orbital back into band + domain format took 14.753 ms
rank = 0, Subspace_Rotation used 18.748 ms

Total time for subspace rotation: 18.752 ms
rank = 0, Efermi =  -0.083275132514 calculate fermi energy took 0.073 ms
rank = 0, --- Calculate rho: sum over local bands took 3.700 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.593 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.218 ms
rank = 0, Calculating density took 1471.212 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.510 ms
rank = 0, D2D took 0.642 ms
rank = 0, Transfering density took 0.648 ms
Etot    =   -25.390066924709
Eband   =    -8.278587919103
E1      =    19.051214894474
E2      =    -7.183873223308
E3      =   -10.249395492746
Exc     =    -9.056289902009
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 6.572e-04, dEband = 3.307e-02
rank = 0, Calculating/Estimating energy took 2.712 ms, Etot = -25.390066925, dEtot = 6.572e-04, dEband = 3.307e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.7867527372508, which took 0.301 ms

iter_count = 108, r_2norm = 6.608e-05, tol*||rhs|| = 7.147e-05

Anderson update took 67.145 ms, out of which F'*F took 29.894 ms; b-Ax took 220.500 ms, out of which Lap took 197.686 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.980 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102437, int_b + int_rho = 1.164e-13, checking this took 0.097 ms
2-norm of RHS = 660.6666808655852, which took 0.174 ms

iter_count = 264, r_2norm = 5.779e-04, tol*||rhs|| = 6.607e-04

Anderson update took 167.409 ms, out of which F'*F took 79.458 ms; b-Ax took 530.309 ms, out of which Lap took 475.472 ms
Solving Poisson took 1131.561 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.661569 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.220110 
Total time for convolution: 	 convolve: 5.140641 
Total time for convolution: 	 convolve: 5.165251 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.775 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.588 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.965 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.836 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.824 ms

This SCF took 28466.187 ms, scf error = 1.953e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.139068, lowerbound = -0.834718, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1405.985 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 23.674 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.745 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 27.456 ms
rank =  0, finding HY took 22.163 ms
rank =  0, distributing HY into block cyclic form took 15.714 ms
rank =  0, finding Y'*HY took 4.404 ms
Rank 0, Project_Hamiltonian used 69.783 ms
Total time for projection: 69.796 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -0.829818220864184
    last  calculated eigval = 0.032266303524774
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82981822086418
lambda[   2] =  -0.67199391317883
lambda[   3] =  -0.51497825508049
lambda[   4] =  -0.46334894201854
lambda[   5] =  -0.38655045589849
lambda[   6] =  -0.36219552263508
lambda[   7] =  -0.35095375537017
lambda[   8] =  -0.28325363762515
lambda[   9] =  -0.22779382008458
lambda[  10] =  -0.05023489861285
lambda[  11] =  -0.03350172780855
lambda[  12] =   0.00092647223013
lambda[  13] =   0.01522816222353
lambda[  14] =   0.01738584882972
lambda[  15] =   0.03226630352477
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 4.114 ms
rank =  0, Distributing orbital back into band + domain format took 15.332 ms
rank = 0, Subspace_Rotation used 19.474 ms

Total time for subspace rotation: 19.479 ms
rank = 0, Efermi =  -0.079356308726 calculate fermi energy took 2.605 ms
rank = 0, --- Calculate rho: sum over local bands took 3.906 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.077 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.204 ms
rank = 0, Calculating density took 1504.310 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.759 ms
rank = 0, D2D took 0.991 ms
rank = 0, Transfering density took 1.000 ms
Etot    =   -25.388793404255
Eband   =    -8.181773046567
E1      =    19.006466254230
E2      =    -7.123515204151
E3      =   -10.283741027872
Exc     =    -9.081070129817
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 1.592e-04, dEband = 1.210e-02
rank = 0, Calculating/Estimating energy took 1.109 ms, Etot = -25.388793404, dEtot = 1.592e-04, dEband = 1.210e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8733310042949, which took 0.072 ms

iter_count = 114, r_2norm = 2.191e-05, tol*||rhs|| = 3.493e-05

Anderson update took 73.375 ms, out of which F'*F took 31.047 ms; b-Ax took 220.327 ms, out of which Lap took 195.979 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 491.206 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102433, int_b + int_rho = 8.367e-14, checking this took 0.104 ms
2-norm of RHS = 660.8773336399256, which took 0.143 ms

iter_count = 234, r_2norm = 5.482e-04, tol*||rhs|| = 6.609e-04

Anderson update took 144.480 ms, out of which F'*F took 71.932 ms; b-Ax took 459.590 ms, out of which Lap took 407.670 ms
Solving Poisson took 993.698 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.145 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.832 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.083 ms
Total time for convolution: 	 convolve: 5.244766 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.404 ms
Total time for convolution: 	 convolve: 5.434618 
Total time for convolution: 	 convolve: 5.528047 
Total time for convolution: 	 convolve: 5.167325 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.749 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.581 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 0.973 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.377 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.374 ms

This SCF took 28534.313 ms, scf error = 6.470e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.132266, lowerbound = -0.829818, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1408.203 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 15.553 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.096 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.240 ms
rank =  0, Distribute data + matrix mult took 19.914 ms
rank =  0, finding HY took 21.619 ms
rank =  0, distributing HY into block cyclic form took 14.359 ms
rank =  0, finding Y'*HY took 5.234 ms
Rank 0, Project_Hamiltonian used 61.185 ms
Total time for projection: 61.199 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.166 ms
    first calculated eigval = -0.828155562316936
    last  calculated eigval = 0.027302343478372
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82815556231694
lambda[   2] =  -0.67002557240172
lambda[   3] =  -0.51351208409780
lambda[   4] =  -0.46190816903990
lambda[   5] =  -0.38475124576870
lambda[   6] =  -0.36049490361010
lambda[   7] =  -0.34903274484104
lambda[   8] =  -0.28154660645958
lambda[   9] =  -0.22584339712284
lambda[  10] =  -0.04888702280703
lambda[  11] =  -0.03381937820919
lambda[  12] =   0.00045379220934
lambda[  13] =   0.01463458854201
lambda[  14] =   0.01667500173579
lambda[  15] =   0.02730234347837
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 4.672 ms
rank =  0, Distributing orbital back into band + domain format took 14.470 ms
rank = 0, Subspace_Rotation used 19.168 ms

Total time for subspace rotation: 19.174 ms
rank = 0, Efermi =  -0.078008433021 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 4.041 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.192 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.221 ms
rank = 0, Calculating density took 1496.362 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.762 ms
rank = 0, D2D took 0.938 ms
rank = 0, Transfering density took 0.942 ms
Etot    =   -25.388605836946
Eband   =    -8.150540572345
E1      =    18.994922111124
E2      =    -7.102254230677
E3      =   -10.288382226795
Exc     =    -9.083951119072
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 2.345e-05, dEband = 3.904e-03
rank = 0, Calculating/Estimating energy took 1.135 ms, Etot = -25.388605837, dEtot = 2.345e-05, dEband = 3.904e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3650537544095, which took 0.175 ms

iter_count = 114, r_2norm = 9.893e-06, tol*||rhs|| = 1.460e-05

Anderson update took 67.885 ms, out of which F'*F took 35.247 ms; b-Ax took 224.906 ms, out of which Lap took 200.796 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 490.151 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102428, int_b + int_rho = 2.547e-14, checking this took 0.138 ms
2-norm of RHS = 661.1716585012426, which took 0.239 ms

iter_count = 246, r_2norm = 6.556e-04, tol*||rhs|| = 6.612e-04

Anderson update took 153.379 ms, out of which F'*F took 71.396 ms; b-Ax took 486.180 ms, out of which Lap took 432.611 ms
Solving Poisson took 1046.392 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.174218 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.173566 
Total time for convolution: 	 convolve: 5.143351 
Total time for convolution: 	 convolve: 5.158137 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.772 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.231 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.968 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.369 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.362 ms

This SCF took 27789.972 ms, scf error = 4.469e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.127302, lowerbound = -0.828156, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1381.355 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 16.396 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.424 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.438 ms
rank =  0, Distribute data + matrix mult took 19.287 ms
rank =  0, finding HY took 22.156 ms
rank =  0, distributing HY into block cyclic form took 14.179 ms
rank =  0, finding Y'*HY took 5.265 ms
Rank 0, Project_Hamiltonian used 60.946 ms
Total time for projection: 60.975 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -0.824410229966384
    last  calculated eigval = 0.025813682581458
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82441022996638
lambda[   2] =  -0.66509676825186
lambda[   3] =  -0.50960673405577
lambda[   4] =  -0.45827637680889
lambda[   5] =  -0.38018583129668
lambda[   6] =  -0.35607426122533
lambda[   7] =  -0.34425623647527
lambda[   8] =  -0.27788650952041
lambda[   9] =  -0.22205398112568
lambda[  10] =  -0.04553389295854
lambda[  11] =  -0.03293469379070
lambda[  12] =   0.00156536567727
lambda[  13] =   0.01545159842447
lambda[  14] =   0.01684835377776
lambda[  15] =   0.02581368258146
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 4.194 ms
rank =  0, Distributing orbital back into band + domain format took 14.596 ms
rank = 0, Subspace_Rotation used 18.817 ms

Total time for subspace rotation: 18.821 ms
rank = 0, Efermi =  -0.074655303112 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 3.917 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.534 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.210 ms
rank = 0, Calculating density took 1469.119 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.808 ms
rank = 0, D2D took 0.979 ms
rank = 0, Transfering density took 0.986 ms
Etot    =   -25.388369117596
Eband   =    -8.075693858410
E1      =    18.960178874466
E2      =    -7.058467186429
E3      =   -10.301059937357
Exc     =    -9.092708543314
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 2.959e-05, dEband = 9.356e-03
rank = 0, Calculating/Estimating energy took 1.051 ms, Etot = -25.388369118, dEtot = 2.959e-05, dEband = 9.356e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2302697799966, which took 0.322 ms

iter_count = 108, r_2norm = 9.055e-06, tol*||rhs|| = 9.211e-06

Anderson update took 72.746 ms, out of which F'*F took 33.955 ms; b-Ax took 210.167 ms, out of which Lap took 187.698 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 471.627 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102429, int_b + int_rho = 4.002e-14, checking this took 0.133 ms
2-norm of RHS = 661.1610516953795, which took 0.196 ms

iter_count = 234, r_2norm = 6.128e-04, tol*||rhs|| = 6.612e-04

Anderson update took 142.811 ms, out of which F'*F took 66.551 ms; b-Ax took 471.507 ms, out of which Lap took 419.911 ms
Solving Poisson took 1000.675 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.192358 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.182480 
Total time for convolution: 	 convolve: 5.181654 
Total time for convolution: 	 convolve: 5.169063 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.767 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.354 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.017 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 0.964 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.376 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.366 ms

This SCF took 27779.139 ms, scf error = 2.138e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.125814, lowerbound = -0.824410, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1412.621 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.317 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.397 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 17.745 ms
rank =  0, finding HY took 22.749 ms
rank =  0, distributing HY into block cyclic form took 15.777 ms
rank =  0, finding Y'*HY took 3.928 ms
Rank 0, Project_Hamiltonian used 60.244 ms
Total time for projection: 60.262 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.821368058955853
    last  calculated eigval = 0.026917575868782
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82136805895585
lambda[   2] =  -0.66210120372204
lambda[   3] =  -0.50679031616552
lambda[   4] =  -0.45550726569194
lambda[   5] =  -0.37730154746362
lambda[   6] =  -0.35304879699349
lambda[   7] =  -0.34124433466355
lambda[   8] =  -0.27503167278582
lambda[   9] =  -0.21909548468101
lambda[  10] =  -0.04277224926277
lambda[  11] =  -0.03091407277279
lambda[  12] =   0.00448675955502
lambda[  13] =   0.01784453442250
lambda[  14] =   0.01803961542080
lambda[  15] =   0.02691757586878
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 4.332 ms
rank =  0, Distributing orbital back into band + domain format took 14.892 ms
rank = 0, Subspace_Rotation used 19.254 ms

Total time for subspace rotation: 19.259 ms
rank = 0, Efermi =  -0.071893659610 calculate fermi energy took 0.066 ms
rank = 0, --- Calculate rho: sum over local bands took 3.864 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.220 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.146 ms
rank = 0, Calculating density took 1499.698 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
rank = 0, D2D took 0.665 ms
rank = 0, Transfering density took 0.668 ms
Etot    =   -25.388352486557
Eband   =    -8.022977363145
E1      =    18.932020688713
E2      =    -7.032158107802
E3      =   -10.308055355375
Exc     =    -9.097936561177
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 2.079e-06, dEband = 6.590e-03
rank = 0, Calculating/Estimating energy took 3.561 ms, Etot = -25.388352487, dEtot = 2.079e-06, dEband = 6.590e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1526700819808, which took 0.154 ms

iter_count = 114, r_2norm = 4.701e-06, tol*||rhs|| = 6.107e-06

Anderson update took 72.093 ms, out of which F'*F took 35.857 ms; b-Ax took 228.654 ms, out of which Lap took 205.295 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 495.087 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102432, int_b + int_rho = 7.276e-14, checking this took 0.118 ms
2-norm of RHS = 661.1778441324165, which took 0.124 ms

iter_count = 192, r_2norm = 6.351e-04, tol*||rhs|| = 6.612e-04

Anderson update took 126.468 ms, out of which F'*F took 54.680 ms; b-Ax took 377.345 ms, out of which Lap took 337.429 ms
Solving Poisson took 823.135 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.188677 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.373 ms
Total time for convolution: 	 convolve: 5.187695 
Total time for convolution: 	 convolve: 5.185557 
Total time for convolution: 	 convolve: 5.208523 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.010 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.746 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 0.984 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.368 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.377 ms

This SCF took 27705.904 ms, scf error = 1.236e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.126918, lowerbound = -0.821368, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1383.297 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.100 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.330 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 18.470 ms
rank =  0, finding HY took 22.387 ms
rank =  0, distributing HY into block cyclic form took 14.473 ms
rank =  0, finding Y'*HY took 4.973 ms
Rank 0, Project_Hamiltonian used 60.344 ms
Total time for projection: 60.356 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.821109694280873
    last  calculated eigval = 0.026545941962174
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82110969428087
lambda[   2] =  -0.66174205153614
lambda[   3] =  -0.50646444648305
lambda[   4] =  -0.45520991255741
lambda[   5] =  -0.37690515605670
lambda[   6] =  -0.35275393917264
lambda[   7] =  -0.34082888982888
lambda[   8] =  -0.27469492425013
lambda[   9] =  -0.21877634613527
lambda[  10] =  -0.04244196019512
lambda[  11] =  -0.03010497942469
lambda[  12] =   0.00552724807592
lambda[  13] =   0.01850439569129
lambda[  14] =   0.01889107882620
lambda[  15] =   0.02654594196217
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 4.266 ms
rank =  0, Distributing orbital back into band + domain format took 14.557 ms
rank = 0, Subspace_Rotation used 18.864 ms

Total time for subspace rotation: 18.870 ms
rank = 0, Efermi =  -0.071563370462 calculate fermi energy took 0.133 ms
rank = 0, --- Calculate rho: sum over local bands took 3.832 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.820 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.310 ms
rank = 0, Calculating density took 1470.888 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.742 ms
rank = 0, D2D took 0.857 ms
rank = 0, Transfering density took 0.860 ms
Etot    =   -25.388381960219
Eband   =    -8.016970721494
E1      =    18.930482997002
E2      =    -7.027699005770
E3      =   -10.307742348957
Exc     =    -9.097662876329
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 3.684e-06, dEband = 7.508e-04
rank = 0, Calculating/Estimating energy took 1.422 ms, Etot = -25.388381960, dEtot = 3.684e-06, dEband = 7.508e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0894866704035, which took 0.548 ms

iter_count = 114, r_2norm = 2.339e-06, tol*||rhs|| = 3.579e-06

Anderson update took 73.483 ms, out of which F'*F took 31.722 ms; b-Ax took 224.372 ms, out of which Lap took 199.280 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 495.687 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102431, int_b + int_rho = 5.457e-14, checking this took 1.130 ms
2-norm of RHS = 661.1566107033012, which took 0.190 ms

iter_count = 210, r_2norm = 6.187e-04, tol*||rhs|| = 6.612e-04

Anderson update took 148.253 ms, out of which F'*F took 62.838 ms; b-Ax took 418.205 ms, out of which Lap took 372.531 ms
Solving Poisson took 913.251 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.189938 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.315263 
Total time for convolution: 	 convolve: 5.245711 
Total time for convolution: 	 convolve: 5.159195 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.767 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.810 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.953 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.369 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.345 ms

This SCF took 27930.244 ms, scf error = 9.258e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.126546, lowerbound = -0.821110, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1361.153 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 50.809 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.462 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 54.306 ms
rank =  0, finding HY took 25.098 ms
rank =  0, distributing HY into block cyclic form took 14.595 ms
rank =  0, finding Y'*HY took 7.428 ms
Rank 0, Project_Hamiltonian used 101.469 ms
Total time for projection: 101.485 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -0.820138791664870
    last  calculated eigval = 0.029053345604317
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82013879166487
lambda[   2] =  -0.66047845622257
lambda[   3] =  -0.50534980274380
lambda[   4] =  -0.45418928333041
lambda[   5] =  -0.37561205183575
lambda[   6] =  -0.35163015513980
lambda[   7] =  -0.33947910430607
lambda[   8] =  -0.27364387360676
lambda[   9] =  -0.21772941677833
lambda[  10] =  -0.04135567994273
lambda[  11] =  -0.02658453450261
lambda[  12] =   0.00991861442359
lambda[  13] =   0.02122130038025
lambda[  14] =   0.02320978559595
lambda[  15] =   0.02905334560432
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 4.380 ms
rank =  0, Distributing orbital back into band + domain format took 14.495 ms
rank = 0, Subspace_Rotation used 18.896 ms

Total time for subspace rotation: 18.901 ms
rank = 0, Efermi =  -0.070477090157 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 4.133 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.186 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.203 ms
rank = 0, Calculating density took 1489.369 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.745 ms
rank = 0, D2D took 0.956 ms
rank = 0, Transfering density took 0.960 ms
Etot    =   -25.388407314019
Eband   =    -7.996501872126
E1      =    18.920412690127
E2      =    -7.017046183897
E3      =   -10.309172771313
Exc     =    -9.098864373105
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 3.169e-06, dEband = 2.559e-03
rank = 0, Calculating/Estimating energy took 1.760 ms, Etot = -25.388407314, dEtot = 3.169e-06, dEband = 2.559e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0683915417802, which took 2.366 ms

iter_count = 114, r_2norm = 2.034e-06, tol*||rhs|| = 2.736e-06

Anderson update took 81.098 ms, out of which F'*F took 31.442 ms; b-Ax took 224.701 ms, out of which Lap took 201.452 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 504.790 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102430, int_b + int_rho = 4.729e-14, checking this took 0.170 ms
2-norm of RHS = 661.1543177113133, which took 0.265 ms

iter_count = 174, r_2norm = 5.765e-04, tol*||rhs|| = 6.612e-04

Anderson update took 120.151 ms, out of which F'*F took 52.261 ms; b-Ax took 350.061 ms, out of which Lap took 315.820 ms
Solving Poisson took 760.129 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.364672 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.150418 
Total time for convolution: 	 convolve: 5.378520 
Total time for convolution: 	 convolve: 5.467604 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.298 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.974 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.374 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.373 ms

This SCF took 28245.719 ms, scf error = 5.885e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129053, lowerbound = -0.820139, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1573.385 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.963 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.493 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 18.492 ms
rank =  0, finding HY took 22.222 ms
rank =  0, distributing HY into block cyclic form took 15.106 ms
rank =  0, finding Y'*HY took 4.213 ms
Rank 0, Project_Hamiltonian used 60.079 ms
Total time for projection: 60.091 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -0.819607987940400
    last  calculated eigval = 0.028197076142011
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.81960798794040
lambda[   2] =  -0.65996409561671
lambda[   3] =  -0.50488849305754
lambda[   4] =  -0.45372206681853
lambda[   5] =  -0.37513210083486
lambda[   6] =  -0.35111930961063
lambda[   7] =  -0.33898459804557
lambda[   8] =  -0.27315094255993
lambda[   9] =  -0.21722201257520
lambda[  10] =  -0.04091616143470
lambda[  11] =  -0.02600172339545
lambda[  12] =   0.01019386833636
lambda[  13] =   0.02150062723107
lambda[  14] =   0.02382917026156
lambda[  15] =   0.02819707614201
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 4.385 ms
rank =  0, Distributing orbital back into band + domain format took 14.689 ms
rank = 0, Subspace_Rotation used 19.097 ms

Total time for subspace rotation: 19.102 ms
rank = 0, Efermi =  -0.070037571692 calculate fermi energy took 0.069 ms
rank = 0, --- Calculate rho: sum over local bands took 4.506 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.923 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.221 ms
rank = 0, Calculating density took 1660.586 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.614 ms
rank = 0, D2D took 1.164 ms
rank = 0, Transfering density took 1.167 ms
Etot    =   -25.388478425062
Eband   =    -7.987583214979
E1      =    18.915284585046
E2      =    -7.012951068385
E3      =   -10.310347350274
Exc     =    -9.099805499664
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 8.889e-06, dEband = 1.115e-03
rank = 0, Calculating/Estimating energy took 2.079 ms, Etot = -25.388478425, dEtot = 8.889e-06, dEband = 1.115e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0645935757710, which took 0.088 ms

iter_count = 108, r_2norm = 1.940e-06, tol*||rhs|| = 2.584e-06

Anderson update took 63.722 ms, out of which F'*F took 31.607 ms; b-Ax took 218.877 ms, out of which Lap took 195.786 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 474.612 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102428, int_b + int_rho = 3.274e-14, checking this took 0.110 ms
2-norm of RHS = 661.1755882259340, which took 0.248 ms

iter_count = 186, r_2norm = 6.073e-04, tol*||rhs|| = 6.612e-04

Anderson update took 110.465 ms, out of which F'*F took 51.458 ms; b-Ax took 355.373 ms, out of which Lap took 314.249 ms
Solving Poisson took 782.292 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.397455 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.373 ms
Total time for convolution: 	 convolve: 6.260617 
Total time for convolution: 	 convolve: 5.144647 
Total time for convolution: 	 convolve: 6.438192 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.969 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.454 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.450 ms

This SCF took 30746.030 ms, scf error = 4.489e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.128197, lowerbound = -0.819608, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1387.785 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.353 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.247 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 18.639 ms
rank =  0, finding HY took 23.094 ms
rank =  0, distributing HY into block cyclic form took 14.527 ms
rank =  0, finding Y'*HY took 4.656 ms
Rank 0, Project_Hamiltonian used 60.957 ms
Total time for projection: 61.022 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -0.819253345545267
    last  calculated eigval = 0.031909317818343
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.81925334554527
lambda[   2] =  -0.65946661038849
lambda[   3] =  -0.50446103807474
lambda[   4] =  -0.45332548764951
lambda[   5] =  -0.37461841391249
lambda[   6] =  -0.35068741155206
lambda[   7] =  -0.33847220109305
lambda[   8] =  -0.27274113390291
lambda[   9] =  -0.21687685241629
lambda[  10] =  -0.04050012040496
lambda[  11] =  -0.02195639865293
lambda[  12] =   0.01323558008985
lambda[  13] =   0.02413280076509
lambda[  14] =   0.02841493498588
lambda[  15] =   0.03190931781834
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 4.231 ms
rank =  0, Distributing orbital back into band + domain format took 14.549 ms
rank = 0, Subspace_Rotation used 18.806 ms

Total time for subspace rotation: 18.812 ms
rank = 0, Efermi =  -0.069621530627 calculate fermi energy took 0.079 ms
rank = 0, --- Calculate rho: sum over local bands took 3.962 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.363 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.218 ms
rank = 0, Calculating density took 1475.528 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.646 ms
rank = 0, D2D took 0.794 ms
rank = 0, Transfering density took 0.802 ms
Etot    =   -25.388558158158
Eband   =    -7.979804989921
E1      =    18.912203756082
E2      =    -7.008236573230
E3      =   -10.310356857178
Exc     =    -9.099877640601
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 9.967e-06, dEband = 9.723e-04
rank = 0, Calculating/Estimating energy took 1.990 ms, Etot = -25.388558158, dEtot = 9.967e-06, dEband = 9.723e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0613362968117, which took 0.056 ms

iter_count = 108, r_2norm = 1.926e-06, tol*||rhs|| = 2.453e-06

Anderson update took 63.707 ms, out of which F'*F took 29.554 ms; b-Ax took 203.912 ms, out of which Lap took 181.076 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.586 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102434, int_b + int_rho = 9.095e-14, checking this took 0.131 ms
2-norm of RHS = 661.1746092055093, which took 0.218 ms

iter_count = 96, r_2norm = 6.590e-04, tol*||rhs|| = 6.612e-04

Anderson update took 57.244 ms, out of which F'*F took 27.107 ms; b-Ax took 183.749 ms, out of which Lap took 163.298 ms
Solving Poisson took 404.748 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.154621 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.381 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.324487 
Total time for convolution: 	 convolve: 5.273002 
Total time for convolution: 	 convolve: 5.486218 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.824 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
---Transfer Veff_loc: D2D took 0.972 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.368 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.364 ms

This SCF took 27641.420 ms, scf error = 3.264e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.131909, lowerbound = -0.819253, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1389.749 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.699 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.582 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 18.315 ms
rank =  0, finding HY took 22.080 ms
rank =  0, distributing HY into block cyclic form took 14.964 ms
rank =  0, finding Y'*HY took 4.304 ms
Rank 0, Project_Hamiltonian used 59.710 ms
Total time for projection: 59.730 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -0.819166775725626
    last  calculated eigval = 0.032020026047364
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.81916677572563
lambda[   2] =  -0.65939417718478
lambda[   3] =  -0.50439100158436
lambda[   4] =  -0.45325199868526
lambda[   5] =  -0.37455208516423
lambda[   6] =  -0.35061125074054
lambda[   7] =  -0.33840481517209
lambda[   8] =  -0.27266541838717
lambda[   9] =  -0.21679783609247
lambda[  10] =  -0.04043340157594
lambda[  11] =  -0.02180527290152
lambda[  12] =   0.01331526204898
lambda[  13] =   0.02401386797077
lambda[  14] =   0.02844667953358
lambda[  15] =   0.03202002604736
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 4.366 ms
rank =  0, Distributing orbital back into band + domain format took 14.457 ms
rank = 0, Subspace_Rotation used 18.843 ms

Total time for subspace rotation: 18.847 ms
rank = 0, Efermi =  -0.069554811811 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 3.860 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.586 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.223 ms
rank = 0, Calculating density took 1476.350 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.821 ms
rank = 0, D2D took 1.014 ms
rank = 0, Transfering density took 1.018 ms
Etot    =   -25.388563268392
Eband   =    -7.978470718323
E1      =    18.911410323829
E2      =    -7.007642775234
E3      =   -10.310569453669
Exc     =    -9.100042388677
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 6.388e-07, dEband = 1.668e-04
rank = 0, Calculating/Estimating energy took 1.043 ms, Etot = -25.388563268, dEtot = 6.388e-07, dEband = 1.668e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0388526432806, which took 0.076 ms

iter_count = 108, r_2norm = 1.312e-06, tol*||rhs|| = 1.554e-06

Anderson update took 63.863 ms, out of which F'*F took 29.960 ms; b-Ax took 203.817 ms, out of which Lap took 181.293 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.127 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102427, int_b + int_rho = 1.455e-14, checking this took 0.115 ms
2-norm of RHS = 661.1786306245439, which took 0.201 ms

iter_count = 162, r_2norm = 5.800e-04, tol*||rhs|| = 6.612e-04

Anderson update took 96.057 ms, out of which F'*F took 45.843 ms; b-Ax took 310.030 ms, out of which Lap took 275.029 ms
Solving Poisson took 681.267 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.102973 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.100837 
Total time for convolution: 	 convolve: 5.102887 
Total time for convolution: 	 convolve: 5.103940 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.830 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.399 ms
---Transfer Veff_loc: D2D took 0.948 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.381 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.352 ms

This SCF took 27062.016 ms, scf error = 2.833e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.132020, lowerbound = -0.819167, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1393.245 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.679 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.644 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 18.367 ms
rank =  0, finding HY took 22.121 ms
rank =  0, distributing HY into block cyclic form took 14.647 ms
rank =  0, finding Y'*HY took 4.517 ms
Rank 0, Project_Hamiltonian used 59.695 ms
Total time for projection: 59.709 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -0.818864554579127
    last  calculated eigval = 0.033391861144573
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.81886455457913
lambda[   2] =  -0.65911969879877
lambda[   3] =  -0.50411096429585
lambda[   4] =  -0.45296918898756
lambda[   5] =  -0.37428125005715
lambda[   6] =  -0.35033726618740
lambda[   7] =  -0.33813272335859
lambda[   8] =  -0.27238585770695
lambda[   9] =  -0.21653872605443
lambda[  10] =  -0.04023290495369
lambda[  11] =  -0.02178346174482
lambda[  12] =   0.01243882740264
lambda[  13] =   0.02371979669330
lambda[  14] =   0.02748078614913
lambda[  15] =   0.03339186114457
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 4.230 ms
rank =  0, Distributing orbital back into band + domain format took 14.283 ms
rank = 0, Subspace_Rotation used 18.542 ms

Total time for subspace rotation: 18.547 ms
rank = 0, Efermi =  -0.069354315154 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 4.062 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.282 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.217 ms
rank = 0, Calculating density took 1479.419 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.663 ms
rank = 0, D2D took 0.829 ms
rank = 0, Transfering density took 0.832 ms
Etot    =   -25.388623288524
Eband   =    -7.973480460898
E1      =    18.909045752627
E2      =    -7.004855735932
E3      =   -10.310941533211
Exc     =    -9.100313135272
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 7.503e-06, dEband = 6.238e-04
rank = 0, Calculating/Estimating energy took 1.559 ms, Etot = -25.388623289, dEtot = 7.503e-06, dEband = 6.238e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0303914256108, which took 0.092 ms

iter_count = 108, r_2norm = 1.017e-06, tol*||rhs|| = 1.216e-06

Anderson update took 63.903 ms, out of which F'*F took 29.640 ms; b-Ax took 216.866 ms, out of which Lap took 194.035 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 470.917 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102432, int_b + int_rho = 6.912e-14, checking this took 0.137 ms
2-norm of RHS = 661.1771925203259, which took 0.199 ms

iter_count = 132, r_2norm = 5.543e-04, tol*||rhs|| = 6.612e-04

Anderson update took 78.087 ms, out of which F'*F took 36.500 ms; b-Ax took 252.313 ms, out of which Lap took 223.933 ms
Solving Poisson took 555.332 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.128422 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.143425 
Total time for convolution: 	 convolve: 5.119586 
Total time for convolution: 	 convolve: 5.114951 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.840 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.958 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.376 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.357 ms

This SCF took 27040.890 ms, scf error = 2.345e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.133392, lowerbound = -0.818865, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1393.965 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.807 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.606 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 18.453 ms
rank =  0, finding HY took 22.229 ms
rank =  0, distributing HY into block cyclic form took 14.664 ms
rank =  0, finding Y'*HY took 4.574 ms
Rank 0, Project_Hamiltonian used 59.966 ms
Total time for projection: 59.978 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.818794551248134
    last  calculated eigval = 0.034686915873841
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.81879455124813
lambda[   2] =  -0.65906238995059
lambda[   3] =  -0.50404491613627
lambda[   4] =  -0.45290332518297
lambda[   5] =  -0.37422300681597
lambda[   6] =  -0.35027722960008
lambda[   7] =  -0.33807392396722
lambda[   8] =  -0.27232206180773
lambda[   9] =  -0.21647561540573
lambda[  10] =  -0.04019129672931
lambda[  11] =  -0.02121944929621
lambda[  12] =   0.01236366587786
lambda[  13] =   0.02390130993760
lambda[  14] =   0.02775166723347
lambda[  15] =   0.03468691587384
==subpsace eigenproblem: bcast eigvals took 0.057 ms
Total time for solving subspace eigenvalue problem: 0.218 ms
rank =  0, subspace rotation using ScaLAPACK took 4.209 ms
rank =  0, Distributing orbital back into band + domain format took 15.461 ms
rank = 0, Subspace_Rotation used 19.699 ms

Total time for subspace rotation: 19.705 ms
rank = 0, Efermi =  -0.069312706878 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 3.975 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.497 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.142 ms
rank = 0, Calculating density took 1481.633 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.509 ms
rank = 0, D2D took 0.633 ms
rank = 0, Transfering density took 0.639 ms
Etot    =   -25.388636000957
Eband   =    -7.972354041074
E1      =    18.908457681939
E2      =    -7.004291787065
E3      =   -10.311003379762
Exc     =    -9.100362094525
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 1.589e-06, dEband = 1.408e-04
rank = 0, Calculating/Estimating energy took 1.017 ms, Etot = -25.388636001, dEtot = 1.589e-06, dEband = 1.408e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0311105502657, which took 0.087 ms

iter_count = 108, r_2norm = 1.029e-06, tol*||rhs|| = 1.244e-06

Anderson update took 64.065 ms, out of which F'*F took 29.774 ms; b-Ax took 203.932 ms, out of which Lap took 181.067 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.096 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102431, int_b + int_rho = 5.821e-14, checking this took 0.133 ms
2-norm of RHS = 661.1770663917930, which took 0.153 ms

iter_count = 84, r_2norm = 5.806e-04, tol*||rhs|| = 6.612e-04

Anderson update took 49.814 ms, out of which F'*F took 23.575 ms; b-Ax took 160.898 ms, out of which Lap took 142.751 ms
Solving Poisson took 355.146 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.112880 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.794 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.112015 
Total time for convolution: 	 convolve: 5.126170 
Total time for convolution: 	 convolve: 5.109192 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.863 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.945 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.389 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.356 ms

This SCF took 26869.240 ms, scf error = 2.034e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.134687, lowerbound = -0.818795, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1388.919 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.533 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.511 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 18.078 ms
rank =  0, finding HY took 22.276 ms
rank =  0, distributing HY into block cyclic form took 14.497 ms
rank =  0, finding Y'*HY took 4.671 ms
Rank 0, Project_Hamiltonian used 59.565 ms
Total time for projection: 59.587 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.818756751929488
    last  calculated eigval = 0.035125039063261
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.81875675192949
lambda[   2] =  -0.65902260838827
lambda[   3] =  -0.50400801702345
lambda[   4] =  -0.45286738464936
lambda[   5] =  -0.37418461843912
lambda[   6] =  -0.35023809888035
lambda[   7] =  -0.33803416869426
lambda[   8] =  -0.27228483996837
lambda[   9] =  -0.21643692169162
lambda[  10] =  -0.04015672172459
lambda[  11] =  -0.02094838324764
lambda[  12] =   0.01248384557435
lambda[  13] =   0.02399910183734
lambda[  14] =   0.02793951111822
lambda[  15] =   0.03512503906326
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 4.109 ms
rank =  0, Distributing orbital back into band + domain format took 15.453 ms
rank = 0, Subspace_Rotation used 19.586 ms

Total time for subspace rotation: 19.590 ms
rank = 0, Efermi =  -0.069278131888 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 3.963 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.268 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.334 ms
rank = 0, Calculating density took 1476.047 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.609 ms
rank = 0, D2D took 0.725 ms
rank = 0, Transfering density took 0.727 ms
Etot    =   -25.388637204215
Eband   =    -7.971666820173
E1      =    18.908099511522
E2      =    -7.003950614735
E3      =   -10.311058404126
Exc     =    -9.100406200301
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 1.504e-07, dEband = 8.590e-05
rank = 0, Calculating/Estimating energy took 1.005 ms, Etot = -25.388637204, dEtot = 1.504e-07, dEband = 8.590e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0304902076417, which took 0.070 ms

iter_count = 108, r_2norm = 1.003e-06, tol*||rhs|| = 1.220e-06

Anderson update took 63.863 ms, out of which F'*F took 29.585 ms; b-Ax took 202.637 ms, out of which Lap took 179.440 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.583 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102436, int_b + int_rho = 1.128e-13, checking this took 0.115 ms
2-norm of RHS = 661.1777254910384, which took 0.153 ms

iter_count = 102, r_2norm = 6.392e-04, tol*||rhs|| = 6.612e-04

Anderson update took 60.500 ms, out of which F'*F took 28.448 ms; b-Ax took 194.870 ms, out of which Lap took 172.829 ms
Solving Poisson took 429.781 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.159 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.116248 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.110037 
Total time for convolution: 	 convolve: 5.090826 
Total time for convolution: 	 convolve: 5.074251 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.840 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.957 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.388 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.369 ms

This SCF took 28163.650 ms, scf error = 1.904e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.135125, lowerbound = -0.818757, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1417.177 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.559 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.740 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 18.333 ms
rank =  0, finding HY took 22.089 ms
rank =  0, distributing HY into block cyclic form took 14.507 ms
rank =  0, finding Y'*HY took 5.244 ms
Rank 0, Project_Hamiltonian used 60.246 ms
Total time for projection: 60.260 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -0.818662781093256
    last  calculated eigval = 0.035691518845342
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.81866278109326
lambda[   2] =  -0.65892989428060
lambda[   3] =  -0.50391846689980
lambda[   4] =  -0.45277758270720
lambda[   5] =  -0.37409674754008
lambda[   6] =  -0.35014514502857
lambda[   7] =  -0.33794592802625
lambda[   8] =  -0.27219476562867
lambda[   9] =  -0.21634899210571
lambda[  10] =  -0.04007320297229
lambda[  11] =  -0.02060845913010
lambda[  12] =   0.01256326576639
lambda[  13] =   0.02414651640907
lambda[  14] =   0.02815889438147
lambda[  15] =   0.03569151884534
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 4.245 ms
rank =  0, Distributing orbital back into band + domain format took 14.699 ms
rank = 0, Subspace_Rotation used 18.975 ms

Total time for subspace rotation: 18.980 ms
rank = 0, Efermi =  -0.069194613053 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 3.964 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.449 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.235 ms
rank = 0, Calculating density took 1504.371 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.860 ms
rank = 0, D2D took 1.003 ms
rank = 0, Transfering density took 1.010 ms
Etot    =   -25.388644269087
Eband   =    -7.970040607463
E1      =    18.907289377181
E2      =    -7.003098900633
E3      =   -10.311176258798
Exc     =    -9.100495484111
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 8.831e-07, dEband = 2.033e-04
rank = 0, Calculating/Estimating energy took 1.008 ms, Etot = -25.388644269, dEtot = 8.831e-07, dEband = 2.033e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0418626366552, which took 0.065 ms

iter_count = 102, r_2norm = 1.476e-06, tol*||rhs|| = 1.675e-06

Anderson update took 60.886 ms, out of which F'*F took 28.545 ms; b-Ax took 192.534 ms, out of which Lap took 171.364 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.162 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102433, int_b + int_rho = 8.004e-14, checking this took 0.108 ms
2-norm of RHS = 661.1778681047931, which took 0.210 ms

iter_count = 138, r_2norm = 5.974e-04, tol*||rhs|| = 6.612e-04

Anderson update took 82.068 ms, out of which F'*F took 39.236 ms; b-Ax took 263.273 ms, out of which Lap took 233.971 ms
Solving Poisson took 580.565 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.128256 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.386 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.098487 
Total time for convolution: 	 convolve: 5.081405 
Total time for convolution: 	 convolve: 5.091259 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.833 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.944 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.373 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.340 ms

This SCF took 26951.227 ms, scf error = 1.775e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.135692, lowerbound = -0.818663, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1401.292 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.545 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.839 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 18.417 ms
rank =  0, finding HY took 22.050 ms
rank =  0, distributing HY into block cyclic form took 14.522 ms
rank =  0, finding Y'*HY took 4.695 ms
Rank 0, Project_Hamiltonian used 59.752 ms
Total time for projection: 59.765 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.818600628009934
    last  calculated eigval = 0.035340719468414
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.81860062800993
lambda[   2] =  -0.65887315919306
lambda[   3] =  -0.50386198044201
lambda[   4] =  -0.45271731676638
lambda[   5] =  -0.37404418885634
lambda[   6] =  -0.35009005744921
lambda[   7] =  -0.33789637700312
lambda[   8] =  -0.27213339471388
lambda[   9] =  -0.21628938497850
lambda[  10] =  -0.04003104604445
lambda[  11] =  -0.02102651347466
lambda[  12] =   0.01200496186027
lambda[  13] =   0.02395641654790
lambda[  14] =   0.02756904425074
lambda[  15] =   0.03534071946841
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.191 ms
rank =  0, subspace rotation using ScaLAPACK took 4.258 ms
rank =  0, Distributing orbital back into band + domain format took 14.693 ms
rank = 0, Subspace_Rotation used 18.974 ms

Total time for subspace rotation: 18.978 ms
rank = 0, Efermi =  -0.069152456237 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 3.979 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.365 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.211 ms
rank = 0, Calculating density took 1487.914 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.788 ms
rank = 0, D2D took 0.997 ms
rank = 0, Transfering density took 1.002 ms
Etot    =   -25.388650933758
Eband   =    -7.969012975666
E1      =    18.906798160840
E2      =    -7.002552003559
E3      =   -10.311190210493
Exc     =    -9.100505618859
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 8.331e-07, dEband = 1.285e-04
rank = 0, Calculating/Estimating energy took 1.052 ms, Etot = -25.388650934, dEtot = 8.331e-07, dEband = 1.285e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0354461549573, which took 0.078 ms

iter_count = 108, r_2norm = 8.692e-07, tol*||rhs|| = 1.418e-06

Anderson update took 63.810 ms, out of which F'*F took 29.827 ms; b-Ax took 207.843 ms, out of which Lap took 185.188 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.000 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102430, int_b + int_rho = 5.093e-14, checking this took 0.107 ms
2-norm of RHS = 661.1796251203561, which took 0.154 ms

iter_count = 90, r_2norm = 5.996e-04, tol*||rhs|| = 6.612e-04

Anderson update took 53.390 ms, out of which F'*F took 25.258 ms; b-Ax took 171.363 ms, out of which Lap took 152.236 ms
Solving Poisson took 380.476 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.175921 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.106209 
Total time for convolution: 	 convolve: 5.090078 
Total time for convolution: 	 convolve: 5.085671 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 1.029 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.375 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.431 ms

This SCF took 26820.030 ms, scf error = 1.495e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.135341, lowerbound = -0.818601, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1382.826 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.714 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.595 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 18.347 ms
rank =  0, finding HY took 22.213 ms
rank =  0, distributing HY into block cyclic form took 14.506 ms
rank =  0, finding Y'*HY took 4.605 ms
Rank 0, Project_Hamiltonian used 59.715 ms
Total time for projection: 59.735 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -0.818594898660331
    last  calculated eigval = 0.036034334475312
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.81859489866033
lambda[   2] =  -0.65886021178201
lambda[   3] =  -0.50384774325019
lambda[   4] =  -0.45270556352488
lambda[   5] =  -0.37402793895330
lambda[   6] =  -0.35007948596517
lambda[   7] =  -0.33788116360857
lambda[   8] =  -0.27212268500759
lambda[   9] =  -0.21628296065890
lambda[  10] =  -0.04001859512690
lambda[  11] =  -0.02056298305265
lambda[  12] =   0.01221353762828
lambda[  13] =   0.02437010312363
lambda[  14] =   0.02789890119913
lambda[  15] =   0.03603433447531
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.191 ms
rank =  0, subspace rotation using ScaLAPACK took 4.230 ms
rank =  0, Distributing orbital back into band + domain format took 14.704 ms
rank = 0, Subspace_Rotation used 18.960 ms

Total time for subspace rotation: 18.964 ms
rank = 0, Efermi =  -0.069140005208 calculate fermi energy took 0.099 ms
rank = 0, --- Calculate rho: sum over local bands took 3.891 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.427 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.230 ms
rank = 0, Calculating density took 1469.429 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.858 ms
rank = 0, D2D took 1.009 ms
rank = 0, Transfering density took 1.011 ms
Etot    =   -25.388651999287
Eband   =    -7.968805303663
E1      =    18.906803202114
E2      =    -7.002347358096
E3      =   -10.311141124429
Exc     =    -9.100465666138
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 1.332e-07, dEband = 2.596e-05
rank = 0, Calculating/Estimating energy took 1.019 ms, Etot = -25.388651999, dEtot = 1.332e-07, dEband = 2.596e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0321041879575, which took 0.066 ms

iter_count = 108, r_2norm = 8.662e-07, tol*||rhs|| = 1.284e-06

Anderson update took 64.544 ms, out of which F'*F took 29.978 ms; b-Ax took 203.272 ms, out of which Lap took 180.783 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.861 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102432, int_b + int_rho = 6.548e-14, checking this took 0.108 ms
2-norm of RHS = 661.1782196682527, which took 0.076 ms

iter_count = 54, r_2norm = 5.676e-04, tol*||rhs|| = 6.612e-04

Anderson update took 31.594 ms, out of which F'*F took 15.089 ms; b-Ax took 103.739 ms, out of which Lap took 91.988 ms
Solving Poisson took 229.893 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.116184 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.622 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.113165 
Total time for convolution: 	 convolve: 5.117422 
Total time for convolution: 	 convolve: 5.074793 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.840 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.987 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.618 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.629 ms

This SCF took 26638.141 ms, scf error = 1.742e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.136034, lowerbound = -0.818595, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1409.561 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.631 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.656 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.317 ms
rank =  0, finding HY took 22.297 ms
rank =  0, distributing HY into block cyclic form took 14.508 ms
rank =  0, finding Y'*HY took 4.734 ms
Rank 0, Project_Hamiltonian used 59.896 ms
Total time for projection: 59.909 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.818547882627168
    last  calculated eigval = 0.035499119827945
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.81854788262717
lambda[   2] =  -0.65882457832554
lambda[   3] =  -0.50381483597206
lambda[   4] =  -0.45266876345158
lambda[   5] =  -0.37399883637448
lambda[   6] =  -0.35004010955250
lambda[   7] =  -0.33785169299762
lambda[   8] =  -0.27208550862947
lambda[   9] =  -0.21624509084112
lambda[  10] =  -0.03998566389059
lambda[  11] =  -0.02086807883475
lambda[  12] =   0.01205773845687
lambda[  13] =   0.02411012155873
lambda[  14] =   0.02763911702106
lambda[  15] =   0.03549911982795
==subpsace eigenproblem: bcast eigvals took 0.057 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 4.268 ms
rank =  0, Distributing orbital back into band + domain format took 14.641 ms
rank = 0, Subspace_Rotation used 18.933 ms

Total time for subspace rotation: 18.938 ms
rank = 0, Efermi =  -0.069107074022 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 4.025 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.383 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.222 ms
rank = 0, Calculating density took 1496.374 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.822 ms
rank = 0, D2D took 1.034 ms
rank = 0, Transfering density took 1.037 ms
Etot    =   -25.388650558214
Eband   =    -7.968154598384
E1      =    18.906358109927
E2      =    -7.002106919860
E3      =   -10.311289466220
Exc     =    -9.100577741713
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 1.801e-07, dEband = 8.134e-05
rank = 0, Calculating/Estimating energy took 1.026 ms, Etot = -25.388650558, dEtot = 1.801e-07, dEband = 8.134e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0298273412373, which took 0.079 ms

iter_count = 102, r_2norm = 1.151e-06, tol*||rhs|| = 1.193e-06

Anderson update took 60.233 ms, out of which F'*F took 28.177 ms; b-Ax took 191.645 ms, out of which Lap took 170.352 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 433.312 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102437, int_b + int_rho = 1.201e-13, checking this took 0.866 ms
2-norm of RHS = 661.1768524613439, which took 0.129 ms

iter_count = 132, r_2norm = 5.816e-04, tol*||rhs|| = 6.612e-04

Anderson update took 78.483 ms, out of which F'*F took 37.358 ms; b-Ax took 252.068 ms, out of which Lap took 224.268 ms
Solving Poisson took 555.520 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.082791 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.004 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.377 ms
Total time for convolution: 	 convolve: 5.083645 
Total time for convolution: 	 convolve: 5.095767 
Total time for convolution: 	 convolve: 5.093302 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.945 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.391 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.359 ms

This SCF took 26886.146 ms, scf error = 1.415e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.135499, lowerbound = -0.818548, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1371.643 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.629 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.730 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 18.392 ms
rank =  0, finding HY took 22.006 ms
rank =  0, distributing HY into block cyclic form took 14.557 ms
rank =  0, finding Y'*HY took 4.560 ms
Rank 0, Project_Hamiltonian used 59.555 ms
Total time for projection: 59.567 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -0.818466190957221
    last  calculated eigval = 0.033827707835575
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.81846619095722
lambda[   2] =  -0.65876986459135
lambda[   3] =  -0.50374886392599
lambda[   4] =  -0.45259345788350
lambda[   5] =  -0.37395280571535
lambda[   6] =  -0.34997651134052
lambda[   7] =  -0.33781364105912
lambda[   8] =  -0.27202034215625
lambda[   9] =  -0.21619082429726
lambda[  10] =  -0.03992542646017
lambda[  11] =  -0.02173184593356
lambda[  12] =   0.01175640002121
lambda[  13] =   0.02368752010508
lambda[  14] =   0.02673231935693
lambda[  15] =   0.03382770783558
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 4.226 ms
rank =  0, Distributing orbital back into band + domain format took 14.572 ms
rank = 0, Subspace_Rotation used 18.820 ms

Total time for subspace rotation: 18.825 ms
rank = 0, Efermi =  -0.069046836562 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 3.948 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.521 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.211 ms
rank = 0, Calculating density took 1458.033 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.818 ms
rank = 0, D2D took 1.020 ms
rank = 0, Transfering density took 1.024 ms
Etot    =   -25.388655829219
Eband   =    -7.967065004693
E1      =    18.905701401486
E2      =    -7.001626628378
E3      =   -10.311450438362
Exc     =    -9.100696578628
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 6.589e-07, dEband = 1.362e-04
rank = 0, Calculating/Estimating energy took 1.030 ms, Etot = -25.388655829, dEtot = 6.589e-07, dEband = 1.362e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0238326391907, which took 0.065 ms

iter_count = 102, r_2norm = 8.579e-07, tol*||rhs|| = 9.533e-07

Anderson update took 61.221 ms, out of which F'*F took 28.292 ms; b-Ax took 191.639 ms, out of which Lap took 170.753 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.755 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102431, int_b + int_rho = 6.185e-14, checking this took 0.120 ms
2-norm of RHS = 661.1748190168289, which took 0.201 ms

iter_count = 126, r_2norm = 5.941e-04, tol*||rhs|| = 6.612e-04

Anderson update took 74.812 ms, out of which F'*F took 35.617 ms; b-Ax took 242.722 ms, out of which Lap took 215.836 ms
Solving Poisson took 531.204 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.083513 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.258 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.080301 
Total time for convolution: 	 convolve: 5.082812 
Total time for convolution: 	 convolve: 5.095924 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.825 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.020 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.418 ms
---Transfer Veff_loc: D2D took 0.963 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.399 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.386 ms

This SCF took 26811.895 ms, scf error = 1.130e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.133828, lowerbound = -0.818466, upperbound = 267.580431

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1420.306 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.601 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.812 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 18.447 ms
rank =  0, finding HY took 22.089 ms
rank =  0, distributing HY into block cyclic form took 14.434 ms
rank =  0, finding Y'*HY took 4.753 ms
Rank 0, Project_Hamiltonian used 59.759 ms
Total time for projection: 59.771 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.818460007511594
    last  calculated eigval = 0.032720693493672
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.81846000751159
lambda[   2] =  -0.65877985781219
lambda[   3] =  -0.50374823009814
lambda[   4] =  -0.45258698373270
lambda[   5] =  -0.37396601529815
lambda[   6] =  -0.34998130817260
lambda[   7] =  -0.33783246923229
lambda[   8] =  -0.27201975661684
lambda[   9] =  -0.21619276744485
lambda[  10] =  -0.03992802258894
lambda[  11] =  -0.02242357601260
lambda[  12] =   0.01142673240528
lambda[  13] =   0.02343859576438
lambda[  14] =   0.02608383151318
lambda[  15] =   0.03272069349367
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 4.269 ms
rank =  0, Distributing orbital back into band + domain format took 14.571 ms
rank = 0, Subspace_Rotation used 18.861 ms

Total time for subspace rotation: 18.865 ms
rank = 0, Efermi =  -0.069049432737 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 3.970 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.471 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.210 ms
rank = 0, Calculating density took 1506.903 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.825 ms
rank = 0, D2D took 1.045 ms
rank = 0, Transfering density took 1.049 ms
Etot    =   -25.388657479209
Eband   =    -7.967134792678
E1      =    18.905647816135
E2      =    -7.001753856348
E3      =   -10.311450641495
Exc     =    -9.100702286384
Esc     =   -44.539672713494
Entropy =    -0.000000000631
dE = 2.062e-07, dEband = 8.723e-06
rank = 0, Calculating/Estimating energy took 1.050 ms, Etot = -25.388657479, dEtot = 2.062e-07, dEband = 8.723e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0154986709992, which took 0.063 ms

iter_count = 108, r_2norm = 4.753e-07, tol*||rhs|| = 6.199e-07

Anderson update took 64.625 ms, out of which F'*F took 29.839 ms; b-Ax took 202.336 ms, out of which Lap took 179.855 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.247 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002102425, int_rho =  18.00000002102422, int_b + int_rho = -2.547e-14, checking this took 0.127 ms
2-norm of RHS = 661.1735492630079, which took 0.212 ms

iter_count = 102, r_2norm = 5.923e-04, tol*||rhs|| = 6.612e-04

Anderson update took 60.758 ms, out of which F'*F took 28.760 ms; b-Ax took 194.489 ms, out of which Lap took 172.920 ms
Solving Poisson took 429.984 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.121 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.085163 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.209 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.074395 
Total time for convolution: 	 convolve: 5.082963 
Total time for convolution: 	 convolve: 5.077766 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.838 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.583 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 0.953 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.357 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.333 ms

This SCF took 26771.226 ms, scf error = 8.338e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.81846000751159, occ[   1] =   2.00000000000000
lambda[   2] =  -0.65877985781219, occ[   2] =   2.00000000000000
lambda[   3] =  -0.50374823009814, occ[   3] =   2.00000000000000
lambda[   4] =  -0.45258698373270, occ[   4] =   2.00000000000000
lambda[   5] =  -0.37396601529815, occ[   5] =   2.00000000000000
lambda[   6] =  -0.34998130817260, occ[   6] =   2.00000000000000
lambda[   7] =  -0.33783246923229, occ[   7] =   2.00000000000000
lambda[   8] =  -0.27201975661684, occ[   8] =   2.00000000000000
lambda[   9] =  -0.21619276744485, occ[   9] =   2.00000000000000
lambda[  10] =  -0.03992802258894, occ[  10] =   0.00000002102431
lambda[  11] =  -0.02242357601260, occ[  11] =   0.00000000000000
lambda[  12] =   0.01142673240528, occ[  12] =   0.00000000000000
lambda[  13] =   0.02343859576438, occ[  13] =   0.00000000000000
lambda[  14] =   0.02608383151318, occ[  14] =   0.00000000000000
lambda[  15] =   0.03272069349367, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.157 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.458 ms, time for Allreduce/Reduce: 8.738 ms 
Time for calculating local force components: 17.920 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.02269657365261   0.04465379946237  -0.00000000726720
  0.02883307091963  -0.00316347342166  -0.03902609707665
  0.02883306776840  -0.00316348621836   0.03902609665866
  0.01788129810716  -0.04586165307849  -0.00000000223580
 -0.03515209832086  -0.05089326568347  -0.00000000121903
 -0.01138395820177   0.03019449757443  -0.00000003305518
  0.03536254733677  -0.02437225878046   0.00000016012079
 -0.41068293264444   0.72306128837593   0.00000030514437
force_loc = 
  0.02241233218136  -0.04540445575417   0.00000006749296
 -0.02915318189612   0.00355279196198   0.03889773020320
 -0.02915319764951   0.00355288275590  -0.03889717249461
 -0.01733855002599   0.04761818678341  -0.00000003175508
  0.03606100491766   0.05001112093009   0.00000006537836
  0.01274917626533  -0.02874138452756  -0.00000036419466
 -0.04889004352657   0.02130288621651   0.00000019694971
  0.40971235532144  -0.70246389824004  -0.00000023156528
Time for calculating nonlocal force components: 32.892 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00026240236385  -0.00133842183270  -0.00000001788064
[0m[32m  0.00630603590488   0.00005968182787  -0.00000002515208
[0m[32m  0.00603866839432  -0.01859587896645  -0.00000001595128
[0mTime for calculating XC forces components: 25.371 ms
 Cartesian force = 
 -0.00028441941662  -0.00075177621494  -0.00000001753681
 -0.00032028892186   0.00038819861718  -0.00012844463602
 -0.00032030782648   0.00038827661440   0.00012884640148
  0.00054257013581   0.00175541378178  -0.00000011175345
  0.00090872865144  -0.00088326467652  -0.00000001360324
  0.00162744248204   0.00011357129103  -0.00000049289304
 -0.00722163823029  -0.00301081065922   0.00000025415585
  0.00506791312596   0.00200039124630  -0.00000002013476
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.363 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Time for printing density: 394.421 ms
The program took 643.250 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:31:07
Job ID:        2266642
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:11:36,vmem=8264K,walltime=00:10:58,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-4-2
---------------------------------------
