---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:31
Job ID:    2266838
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:34
Job ID:    2266838
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.052 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 11.557 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 12.
[32m
Time for finding element is 0.008 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8

Reading ion file took 41.713 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 109.666 ms

Freeing SPARC_INPUT_MPI datatype took 0.010 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.918 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.149 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   12.183970	   12.934020	
   10.000000	    7.816030	   12.934020	
   10.000000	   12.237795	    7.065980	
   10.000000	    7.762205	    7.065980	
    8.341161	   14.356796	    9.009316	
   11.658839	   14.356796	    9.009316	
   11.658839	    5.643204	    9.009316	
    8.341161	    5.643204	    9.009316	
   10.000000	   11.276204	   11.086775	
   10.000000	    8.723796	   11.086775	
   10.000000	   13.120393	    8.919809	
   10.000000	    6.879607	    8.919809	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.233 ms
Set up communicators.

--set up spincomm took 2.231 ms

--set up kptcomm took 0.379 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 19, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.004 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 19 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 19, mbQ = nbQ = 64
rank = 0, nr_Hp = 19, nc_Hp = 19
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.637 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.867 ms

Calculate_SplineDerivRadFun took 0.112 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.975 ms.
time spent on vectorized spline interp: 2.995 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.697 ms.
time spent on vectorized spline interp: 2.011 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.692 ms.

Calculating rb for all atom types took 12.379 ms
----------------------
Estimated memory usage
Total: 1.16 GB
orbitals             : 869.75 MB
global sized vectors : 213.62 MB
subspace matrices : 8.46 kB
others : 108.34 MB
----------------------------------------------
Estimated memory usage per processor: 99.31 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.053 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.015 ms
Calculating pseudocharge density ... 
the global sum of int_b = -24.0000000305649, sum_int_rho = 23.1970334555131
PosCharge = 24.000000030565, NegCharge = -23.197033455513, scal_fac = 1.034615054403
After scaling, int_rho = 24.0000000305650, PosCharge + NegCharge - NetCharge = -8.882e-14
--Calculate Vref took 0.547 ms
--Calculate rho_guess took 3.109 ms

 integral of b = -24.0000000305649,
 int{b} + Nelectron + NetCharge = -3.056e-08,
 Esc = -53.0342216728658,
 MPI_Reduce took 6.737 ms

Calculating b & b_ref took 17.859 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.071 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.139 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.067 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.651 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.006 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.008 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.007 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 46.447 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056502, int_b + int_rho = 8.004e-14, checking this took 0.091 ms
2-norm of RHS = 802.3875056292991, which took 0.770 ms

iter_count = 420, r_2norm = 6.510e-04, tol*||rhs|| = 8.024e-04

Anderson update took 258.418 ms, out of which F'*F took 116.501 ms; b-Ax took 809.203 ms, out of which Lap took 719.532 ms
Solving Poisson took 1766.385 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.397 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.834 ms
Total time for convolution: 	 convolve: 5.375958 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.852 ms
Total time for convolution: 	 convolve: 6.104440 
Total time for convolution: 	 convolve: 6.527736 
Total time for convolution: 	 convolve: 5.966347 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.751 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.239 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.424 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
rank = 0, XC calculation took 27879.122 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 4.906 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.986 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.090 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.312 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.853 ms
    Lanczos iter 54, eigmin  = -0.818992764, eigmax = 264.939644974, err_eigmin = 4.307e-04, err_eigmax = 9.598e-03
rank =   0, Lanczos took 161.506 ms, eigmin = -0.818992763804, eigmax = 267.589041423781

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.335024, lowerbound = -0.918993, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1584.125 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.815 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.836 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.678 ms
rank =  0, finding HY took 26.198 ms
rank =  0, distributing HY into block cyclic form took 22.770 ms
rank =  0, finding Y'*HY took 4.049 ms
Rank 0, Project_Hamiltonian used 77.736 ms
Total time for projection: 77.748 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.838 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.931 ms
    first calculated eigval = 2.734366691418240
    last  calculated eigval = 3.243599769878491
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =   2.81390201797498
lambda[   4] =   2.83069847482770
lambda[   5] =   2.87176281366427
lambda[   6] =   2.91241013182810
lambda[   7] =   2.92154564352318
lambda[   8] =   2.95548513710102
lambda[   9] =   2.99859342516989
lambda[  10] =   3.00558893715109
lambda[  11] =   3.00832047125198
lambda[  12] =   3.03348433675998
lambda[  13] =   3.08332289599341
lambda[  14] =   3.11786879144448
lambda[  15] =   3.13582757150896
lambda[  16] =   3.14279456487468
lambda[  17] =   3.18338428656190
lambda[  18] =   3.20957117895974
lambda[  19] =   3.24359976987849
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.952 ms
rank =  0, subspace rotation using ScaLAPACK took 8.400 ms
rank =  0, Distributing orbital back into band + domain format took 20.173 ms
rank = 0, Subspace_Rotation used 28.588 ms

Total time for subspace rotation: 28.591 ms
rank = 0, Efermi =   3.058413394749 calculate fermi energy took 0.045 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.343600, lowerbound = -0.918993, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1591.703 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.419 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.833 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.276 ms
rank =  0, finding HY took 25.255 ms
rank =  0, distributing HY into block cyclic form took 20.003 ms
rank =  0, finding Y'*HY took 3.695 ms
Rank 0, Project_Hamiltonian used 72.267 ms
Total time for projection: 72.281 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.228 ms
    first calculated eigval = -0.628487690794538
    last  calculated eigval = 0.459987756139523
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.40744358063248
lambda[   4] =  -0.23806188965096
lambda[   5] =  -0.21445948768745
lambda[   6] =  -0.09923789275475
lambda[   7] =  -0.08114845428720
lambda[   8] =  -0.06135628346816
lambda[   9] =   0.03441804043377
lambda[  10] =   0.11165087632294
lambda[  11] =   0.21989839265434
lambda[  12] =   0.25128749469040
lambda[  13] =   0.29424884542314
lambda[  14] =   0.32951607426666
lambda[  15] =   0.34880420910068
lambda[  16] =   0.36644040845586
lambda[  17] =   0.39153053172177
lambda[  18] =   0.41299859463860
lambda[  19] =   0.45998775613952
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.245 ms
rank =  0, subspace rotation using ScaLAPACK took 8.337 ms
rank =  0, Distributing orbital back into band + domain format took 19.695 ms
rank = 0, Subspace_Rotation used 28.048 ms

Total time for subspace rotation: 28.053 ms
rank = 0, Efermi =   0.272768680058 calculate fermi energy took 0.044 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.559988, lowerbound = -0.918993, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1594.885 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.979 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.681 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.682 ms
rank =  0, finding HY took 25.284 ms
rank =  0, distributing HY into block cyclic form took 19.809 ms
rank =  0, finding Y'*HY took 3.836 ms
Rank 0, Project_Hamiltonian used 71.645 ms
Total time for projection: 71.657 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.228 ms
    first calculated eigval = -0.824896108327380
    last  calculated eigval = 0.166858925935162
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.70974182833682
lambda[   4] =  -0.57225505925817
lambda[   5] =  -0.51873680271189
lambda[   6] =  -0.47430239903127
lambda[   7] =  -0.46748179205738
lambda[   8] =  -0.45282638071974
lambda[   9] =  -0.44635683382911
lambda[  10] =  -0.40596435809763
lambda[  11] =  -0.37698151874105
lambda[  12] =  -0.26488440280067
lambda[  13] =   0.01846887475405
lambda[  14] =   0.06821536824894
lambda[  15] =   0.08383320428660
lambda[  16] =   0.08969217787712
lambda[  17] =   0.10225837673155
lambda[  18] =   0.12067000931858
lambda[  19] =   0.16685892593516
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.245 ms
rank =  0, subspace rotation using ScaLAPACK took 8.444 ms
rank =  0, Distributing orbital back into band + domain format took 19.716 ms
rank = 0, Subspace_Rotation used 28.180 ms

Total time for subspace rotation: 28.184 ms
rank = 0, Efermi =  -0.010313759641 calculate fermi energy took 0.051 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.266859, lowerbound = -0.918993, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1603.908 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.077 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.764 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.863 ms
rank =  0, finding HY took 25.152 ms
rank =  0, distributing HY into block cyclic form took 19.603 ms
rank =  0, finding Y'*HY took 3.869 ms
Rank 0, Project_Hamiltonian used 71.528 ms
Total time for projection: 71.540 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.138 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.241 ms
    first calculated eigval = -0.825517224191697
    last  calculated eigval = 0.095345697348710
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.71055211485111
lambda[   4] =  -0.57622817056238
lambda[   5] =  -0.52278172744289
lambda[   6] =  -0.48174826992337
lambda[   7] =  -0.47213959866938
lambda[   8] =  -0.46246716259944
lambda[   9] =  -0.45317128944209
lambda[  10] =  -0.42158869938127
lambda[  11] =  -0.39221621342901
lambda[  12] =  -0.29332033451799
lambda[  13] =  -0.06180924531690
lambda[  14] =  -0.00253068318919
lambda[  15] =   0.03415070333273
lambda[  16] =   0.04421586683147
lambda[  17] =   0.05011988505384
lambda[  18] =   0.07657763981758
lambda[  19] =   0.09534569734871
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.255 ms
rank =  0, subspace rotation using ScaLAPACK took 8.304 ms
rank =  0, Distributing orbital back into band + domain format took 19.367 ms
rank = 0, Subspace_Rotation used 27.684 ms

Total time for subspace rotation: 27.688 ms
rank = 0, Efermi =  -0.090591879785 calculate fermi energy took 0.023 ms
rank = 0, --- Calculate rho: sum over local bands took 7.004 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.422 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.613 ms
rank = 0, Calculating density took 6965.422 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.953 ms
rank = 0, D2D took 2.208 ms
rank = 0, Transfering density took 2.219 ms
Etot    =   -28.994353259561
Eband   =   -12.761798205973
E1      =    26.538958860513
E2      =    -8.842845982338
E3      =   -12.209574729900
Exc     =   -10.789712952565
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 2.416e+00, dEband = 1.063e+00
rank = 0, Calculating/Estimating energy took 0.998 ms, Etot = -28.994353260, dEtot = 2.416e+00, dEband = 1.063e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 45.8223160657338, which took 0.623 ms

iter_count = 96, r_2norm = 1.748e-03, tol*||rhs|| = 1.833e-03

Anderson update took 56.726 ms, out of which F'*F took 26.428 ms; b-Ax took 182.458 ms, out of which Lap took 161.647 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 405.864 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056496, int_b + int_rho = 1.091e-14, checking this took 0.870 ms
2-norm of RHS = 797.6301462233056, which took 0.249 ms

iter_count = 288, r_2norm = 6.449e-04, tol*||rhs|| = 7.976e-04

Anderson update took 169.504 ms, out of which F'*F took 85.752 ms; b-Ax took 558.895 ms, out of which Lap took 496.717 ms
Solving Poisson took 1204.843 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.787 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.402 ms
Total time for convolution: 	 convolve: 6.522561 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.305961 
Total time for convolution: 	 convolve: 5.490620 
Total time for convolution: 	 convolve: 5.709955 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.381 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.171 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.494 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.134 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.741 ms

This SCF took 35912.972 ms, scf error = 2.182e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.195346, lowerbound = -0.825517, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1640.384 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.857 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.741 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.620 ms
rank =  0, finding HY took 25.460 ms
rank =  0, distributing HY into block cyclic form took 22.120 ms
rank =  0, finding Y'*HY took 3.567 ms
Rank 0, Project_Hamiltonian used 73.805 ms
Total time for projection: 73.826 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.794778586580334
    last  calculated eigval = 0.063671305866551
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.67540272207460
lambda[   4] =  -0.54731068416899
lambda[   5] =  -0.49549774379869
lambda[   6] =  -0.44811266317103
lambda[   7] =  -0.44228961626675
lambda[   8] =  -0.43154928847741
lambda[   9] =  -0.42112844231077
lambda[  10] =  -0.39208406074879
lambda[  11] =  -0.36352934544027
lambda[  12] =  -0.27159753711023
lambda[  13] =  -0.06358439191359
lambda[  14] =  -0.02769395609092
lambda[  15] =   0.01487785147154
lambda[  16] =   0.02156185434223
lambda[  17] =   0.02991677680407
lambda[  18] =   0.04195924955969
lambda[  19] =   0.06367130586655
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 7.993 ms
rank =  0, Distributing orbital back into band + domain format took 19.530 ms
rank = 0, Subspace_Rotation used 27.538 ms

Total time for subspace rotation: 27.542 ms
rank = 0, Efermi =  -0.092367026357 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 6.377 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.610 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.654 ms
rank = 0, Calculating density took 1760.745 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.906 ms
rank = 0, D2D took 2.004 ms
rank = 0, Transfering density took 2.006 ms
Etot    =   -28.925246785168
Eband   =   -12.037259231810
E1      =    25.878230029109
E2      =    -8.813599360477
E3      =   -12.405344009051
Exc     =   -10.950939278222
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 5.759e-03, dEband = 6.038e-02
rank = 0, Calculating/Estimating energy took 0.992 ms, Etot = -28.925246785, dEtot = 5.759e-03, dEband = 6.038e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 13.5761145084813, which took 0.069 ms

iter_count = 108, r_2norm = 3.354e-04, tol*||rhs|| = 5.430e-04

Anderson update took 63.709 ms, out of which F'*F took 29.613 ms; b-Ax took 203.779 ms, out of which Lap took 181.975 ms
rank = 0, Mixing (+ precond) took 461.190 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056505, int_b + int_rho = 1.128e-13, checking this took 0.132 ms
2-norm of RHS = 789.4175253355196, which took 0.174 ms

iter_count = 306, r_2norm = 6.406e-04, tol*||rhs|| = 7.894e-04

Anderson update took 181.610 ms, out of which F'*F took 84.630 ms; b-Ax took 572.510 ms, out of which Lap took 511.492 ms
Solving Poisson took 1267.262 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.259284 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.887 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.331904 
Total time for convolution: 	 convolve: 5.412521 
Total time for convolution: 	 convolve: 5.391950 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.402 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.361 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.656 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.135 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.830 ms

This SCF took 28966.550 ms, scf error = 1.530e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.163671, lowerbound = -0.794779, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1604.157 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.785 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.893 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.697 ms
rank =  0, finding HY took 26.820 ms
rank =  0, distributing HY into block cyclic form took 23.959 ms
rank =  0, finding Y'*HY took 3.914 ms
Rank 0, Project_Hamiltonian used 77.427 ms
Total time for projection: 77.438 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -0.733760482406910
    last  calculated eigval = 0.055129655553298
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.60672042628440
lambda[   4] =  -0.48891798929850
lambda[   5] =  -0.43986009767946
lambda[   6] =  -0.38538897387738
lambda[   7] =  -0.38356178697985
lambda[   8] =  -0.37243486822928
lambda[   9] =  -0.35981581091948
lambda[  10] =  -0.33193373917127
lambda[  11] =  -0.30577359620274
lambda[  12] =  -0.22576937635900
lambda[  13] =  -0.03297136768586
lambda[  14] =  -0.02619889886669
lambda[  15] =   0.01064363047348
lambda[  16] =   0.01679339597188
lambda[  17] =   0.02187239750303
lambda[  18] =   0.02656490820242
lambda[  19] =   0.05512965555330
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 8.035 ms
rank =  0, Distributing orbital back into band + domain format took 19.296 ms
rank = 0, Subspace_Rotation used 27.346 ms

Total time for subspace rotation: 27.350 ms
rank = 0, Efermi =  -0.061754235833 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 6.428 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.747 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.576 ms
rank = 0, Calculating density took 1728.032 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.888 ms
rank = 0, D2D took 2.011 ms
rank = 0, Transfering density took 2.013 ms
Etot    =   -28.864264348657
Eband   =   -10.610381942502
E1      =    24.620138081810
E2      =    -8.622194447072
E3      =   -12.862718275327
Exc     =   -11.324711536592
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 5.082e-03, dEband = 1.189e-01
rank = 0, Calculating/Estimating energy took 1.323 ms, Etot = -28.864264349, dEtot = 5.082e-03, dEband = 1.189e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.9300249699148, which took 0.641 ms

iter_count = 108, r_2norm = 1.244e-04, tol*||rhs|| = 1.972e-04

Anderson update took 63.135 ms, out of which F'*F took 30.247 ms; b-Ax took 205.357 ms, out of which Lap took 183.106 ms
rank = 0, Mixing (+ precond) took 457.100 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056497, int_b + int_rho = 2.910e-14, checking this took 0.126 ms
2-norm of RHS = 789.3576222521717, which took 0.079 ms

iter_count = 270, r_2norm = 6.875e-04, tol*||rhs|| = 7.894e-04

Anderson update took 159.001 ms, out of which F'*F took 75.051 ms; b-Ax took 512.404 ms, out of which Lap took 455.317 ms
Solving Poisson took 1111.306 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.221059 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.322908 
Total time for convolution: 	 convolve: 5.210421 
Total time for convolution: 	 convolve: 5.259287 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.407 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.148 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.187 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.534 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.147 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.714 ms

This SCF took 28392.435 ms, scf error = 4.737e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.155130, lowerbound = -0.733760, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1618.022 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.786 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.697 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.503 ms
rank =  0, finding HY took 25.134 ms
rank =  0, distributing HY into block cyclic form took 19.701 ms
rank =  0, finding Y'*HY took 3.733 ms
Rank 0, Project_Hamiltonian used 71.105 ms
Total time for projection: 71.123 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.725540815047550
    last  calculated eigval = 0.051781572724839
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.59839298717086
lambda[   4] =  -0.47960716426650
lambda[   5] =  -0.43020308702686
lambda[   6] =  -0.37823308955820
lambda[   7] =  -0.37653160984617
lambda[   8] =  -0.36519370354112
lambda[   9] =  -0.35272539332387
lambda[  10] =  -0.32235445958506
lambda[  11] =  -0.29710212039595
lambda[  12] =  -0.21742927343308
lambda[  13] =  -0.03407115304569
lambda[  14] =  -0.01901475746549
lambda[  15] =   0.00959114513076
lambda[  16] =   0.01508561098268
lambda[  17] =   0.01802268119201
lambda[  18] =   0.02060902724146
lambda[  19] =   0.05178157272484
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 8.044 ms
rank =  0, Distributing orbital back into band + domain format took 19.420 ms
rank = 0, Subspace_Rotation used 27.478 ms

Total time for subspace rotation: 27.482 ms
rank = 0, Efermi =  -0.062853787379 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 6.350 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.274 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.081 ms
rank = 0, Calculating density took 1736.728 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 2.111 ms
rank = 0, D2D took 2.223 ms
rank = 0, Transfering density took 2.229 ms
Etot    =   -28.859612527275
Eband   =   -10.416848760129
E1      =    24.516407441728
E2      =    -8.515867007727
E3      =   -12.945104414457
Exc     =   -11.385920957285
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 3.877e-04, dEband = 1.613e-02
rank = 0, Calculating/Estimating energy took 1.256 ms, Etot = -28.859612527, dEtot = 3.877e-04, dEband = 1.613e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.6169984847439, which took 0.066 ms

iter_count = 114, r_2norm = 4.327e-05, tol*||rhs|| = 6.468e-05

Anderson update took 68.816 ms, out of which F'*F took 32.217 ms; b-Ax took 219.853 ms, out of which Lap took 197.320 ms
rank = 0, Mixing (+ precond) took 485.911 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056496, int_b + int_rho = 1.091e-14, checking this took 0.162 ms
2-norm of RHS = 789.2737623948409, which took 0.214 ms

iter_count = 246, r_2norm = 7.794e-04, tol*||rhs|| = 7.893e-04

Anderson update took 144.995 ms, out of which F'*F took 67.964 ms; b-Ax took 462.212 ms, out of which Lap took 412.164 ms
Solving Poisson took 1018.478 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.236462 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.171526 
Total time for convolution: 	 convolve: 5.160085 
Total time for convolution: 	 convolve: 5.193589 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.556 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.731 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.325 ms

This SCF took 28081.345 ms, scf error = 1.351e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.151782, lowerbound = -0.725541, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1605.728 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.848 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.730 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.601 ms
rank =  0, finding HY took 25.580 ms
rank =  0, distributing HY into block cyclic form took 19.764 ms
rank =  0, finding Y'*HY took 4.013 ms
Rank 0, Project_Hamiltonian used 71.994 ms
Total time for projection: 72.005 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -0.719847785739524
    last  calculated eigval = 0.049714838953113
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.59232554467884
lambda[   4] =  -0.47378096942208
lambda[   5] =  -0.42448960114710
lambda[   6] =  -0.37254150188892
lambda[   7] =  -0.37070579071107
lambda[   8] =  -0.35927702266840
lambda[   9] =  -0.34667610923445
lambda[  10] =  -0.31647026077159
lambda[  11] =  -0.29134050370309
lambda[  12] =  -0.21281919711276
lambda[  13] =  -0.03425264191729
lambda[  14] =  -0.01498645767024
lambda[  15] =   0.00902178435967
lambda[  16] =   0.01458592338892
lambda[  17] =   0.01603814457848
lambda[  18] =   0.01800015976759
lambda[  19] =   0.04971483895311
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.218 ms
rank =  0, subspace rotation using ScaLAPACK took 8.086 ms
rank =  0, Distributing orbital back into band + domain format took 19.636 ms
rank = 0, Subspace_Rotation used 27.753 ms

Total time for subspace rotation: 27.757 ms
rank = 0, Efermi =  -0.063035276354 calculate fermi energy took 1.904 ms
rank = 0, --- Calculate rho: sum over local bands took 6.582 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.417 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.585 ms
rank = 0, Calculating density took 1726.272 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.884 ms
rank = 0, D2D took 3.937 ms
rank = 0, Transfering density took 3.948 ms
Etot    =   -28.858461745864
Eband   =   -10.278623046139
E1      =    24.427347772362
E2      =    -8.457106693523
E3      =   -12.989691471040
Exc     =   -11.419762962878
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 9.590e-05, dEband = 1.152e-02
rank = 0, Calculating/Estimating energy took 0.990 ms, Etot = -28.858461746, dEtot = 9.590e-05, dEband = 1.152e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6389321416383, which took 0.056 ms

iter_count = 114, r_2norm = 1.721e-05, tol*||rhs|| = 2.556e-05

Anderson update took 67.266 ms, out of which F'*F took 30.913 ms; b-Ax took 214.745 ms, out of which Lap took 190.093 ms
rank = 0, Mixing (+ precond) took 483.789 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056500, int_b + int_rho = 6.185e-14, checking this took 0.158 ms
2-norm of RHS = 789.7915128599282, which took 0.198 ms

iter_count = 252, r_2norm = 6.634e-04, tol*||rhs|| = 7.898e-04

Anderson update took 147.056 ms, out of which F'*F took 74.678 ms; b-Ax took 523.392 ms, out of which Lap took 469.874 ms
Solving Poisson took 1088.630 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.220791 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.335967 
Total time for convolution: 	 convolve: 5.222682 
Total time for convolution: 	 convolve: 5.242648 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.419 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.626 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.539 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.253 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.826 ms

This SCF took 28444.057 ms, scf error = 7.688e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.149715, lowerbound = -0.719848, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1602.371 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.904 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.748 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.677 ms
rank =  0, finding HY took 25.487 ms
rank =  0, distributing HY into block cyclic form took 19.876 ms
rank =  0, finding Y'*HY took 3.803 ms
Rank 0, Project_Hamiltonian used 71.879 ms
Total time for projection: 71.891 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.714933496455562
    last  calculated eigval = 0.048286824656913
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.58744502316824
lambda[   4] =  -0.46891480907525
lambda[   5] =  -0.41970693953827
lambda[   6] =  -0.36725606044826
lambda[   7] =  -0.36553236699137
lambda[   8] =  -0.35382310849272
lambda[   9] =  -0.34106041305217
lambda[  10] =  -0.31173378306471
lambda[  11] =  -0.28636010101476
lambda[  12] =  -0.20880522441955
lambda[  13] =  -0.03349453312386
lambda[  14] =  -0.01126393024166
lambda[  15] =   0.00908724523619
lambda[  16] =   0.01504876846573
lambda[  17] =   0.01587979867657
lambda[  18] =   0.01761523029624
lambda[  19] =   0.04828682465691
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 8.036 ms
rank =  0, Distributing orbital back into band + domain format took 20.339 ms
rank = 0, Subspace_Rotation used 28.394 ms

Total time for subspace rotation: 28.399 ms
rank = 0, Efermi =  -0.062277167519 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.725 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.735 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.562 ms
rank = 0, Calculating density took 1722.094 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 2.062 ms
rank = 0, D2D took 2.165 ms
rank = 0, Transfering density took 2.172 ms
Etot    =   -28.857850898341
Eband   =   -10.157604440595
E1      =    24.373623682385
E2      =    -8.382946392734
E3      =   -13.012840043344
Exc     =   -11.435434902438
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 5.090e-05, dEband = 1.008e-02
rank = 0, Calculating/Estimating energy took 0.997 ms, Etot = -28.857850898, dEtot = 5.090e-05, dEband = 1.008e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3057970296129, which took 0.051 ms

iter_count = 114, r_2norm = 8.477e-06, tol*||rhs|| = 1.223e-05

Anderson update took 68.673 ms, out of which F'*F took 32.454 ms; b-Ax took 220.096 ms, out of which Lap took 196.708 ms
rank = 0, Mixing (+ precond) took 485.818 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056497, int_b + int_rho = 2.547e-14, checking this took 0.137 ms
2-norm of RHS = 789.9527158859671, which took 0.194 ms

iter_count = 240, r_2norm = 6.874e-04, tol*||rhs|| = 7.900e-04

Anderson update took 141.890 ms, out of which F'*F took 67.567 ms; b-Ax took 464.835 ms, out of which Lap took 413.380 ms
Solving Poisson took 1003.250 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.250332 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.234830 
Total time for convolution: 	 convolve: 5.150339 
Total time for convolution: 	 convolve: 5.181211 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.190 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.309 ms
---Transfer Veff_loc: D2D took 3.561 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.290 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.893 ms

This SCF took 28102.142 ms, scf error = 3.337e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.148287, lowerbound = -0.714933, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1583.798 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.931 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.901 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.858 ms
rank =  0, finding HY took 25.963 ms
rank =  0, distributing HY into block cyclic form took 19.858 ms
rank =  0, finding Y'*HY took 3.715 ms
Rank 0, Project_Hamiltonian used 72.431 ms
Total time for projection: 72.443 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.710175805772976
    last  calculated eigval = 0.046815698966556
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.58288770222297
lambda[   4] =  -0.46452163574543
lambda[   5] =  -0.41531601938360
lambda[   6] =  -0.36321366815490
lambda[   7] =  -0.36098328404700
lambda[   8] =  -0.34983820049019
lambda[   9] =  -0.33692233074649
lambda[  10] =  -0.30740276613991
lambda[  11] =  -0.28206762104072
lambda[  12] =  -0.20435854845330
lambda[  13] =  -0.03184490610177
lambda[  14] =  -0.00710323541651
lambda[  15] =   0.01051784351908
lambda[  16] =   0.01668477204948
lambda[  17] =   0.01698729236368
lambda[  18] =   0.01840151550254
lambda[  19] =   0.04681569896656
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.253 ms
rank =  0, subspace rotation using ScaLAPACK took 8.033 ms
rank =  0, Distributing orbital back into band + domain format took 19.871 ms
rank = 0, Subspace_Rotation used 27.923 ms

Total time for subspace rotation: 27.928 ms
rank = 0, Efermi =  -0.060627540499 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 6.251 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.944 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.588 ms
rank = 0, Calculating density took 1703.495 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.001 ms
rank = 0, D2D took 2.108 ms
rank = 0, Transfering density took 2.115 ms
Etot    =   -28.857648919597
Eband   =   -10.053101556598
E1      =    24.319622008049
E2      =    -8.327738108756
E3      =   -13.030177464199
Exc     =   -11.447863270230
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 1.683e-05, dEband = 8.709e-03
rank = 0, Calculating/Estimating energy took 0.984 ms, Etot = -28.857648920, dEtot = 1.683e-05, dEband = 8.709e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1999628494116, which took 0.050 ms

iter_count = 114, r_2norm = 6.592e-06, tol*||rhs|| = 7.999e-06

Anderson update took 66.417 ms, out of which F'*F took 31.076 ms; b-Ax took 214.482 ms, out of which Lap took 190.015 ms
rank = 0, Mixing (+ precond) took 481.158 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056501, int_b + int_rho = 6.548e-14, checking this took 0.119 ms
2-norm of RHS = 789.9867007165695, which took 0.077 ms

iter_count = 210, r_2norm = 7.167e-04, tol*||rhs|| = 7.900e-04

Anderson update took 122.474 ms, out of which F'*F took 58.342 ms; b-Ax took 399.833 ms, out of which Lap took 353.896 ms
Solving Poisson took 868.543 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.253347 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.219671 
Total time for convolution: 	 convolve: 5.240736 
Total time for convolution: 	 convolve: 5.183654 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.405 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.190 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.416 ms
---Transfer Veff_loc: D2D took 3.515 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.287 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.838 ms

This SCF took 28025.483 ms, scf error = 1.855e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.146816, lowerbound = -0.710176, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1594.473 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.124 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.728 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.877 ms
rank =  0, finding HY took 25.727 ms
rank =  0, distributing HY into block cyclic form took 19.890 ms
rank =  0, finding Y'*HY took 3.725 ms
Rank 0, Project_Hamiltonian used 72.255 ms
Total time for projection: 72.267 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.420 ms
rank = 0, Solve_Generalized_EigenProblem used 0.570 ms
    first calculated eigval = -0.709054630434326
    last  calculated eigval = 0.044138753776287
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.58179100277098
lambda[   4] =  -0.46345930079776
lambda[   5] =  -0.41426137773776
lambda[   6] =  -0.36213694743277
lambda[   7] =  -0.35988159515804
lambda[   8] =  -0.34877914644938
lambda[   9] =  -0.33583898204801
lambda[  10] =  -0.30635790327215
lambda[  11] =  -0.28101161312222
lambda[  12] =  -0.20322845968575
lambda[  13] =  -0.03045123419061
lambda[  14] =  -0.00599022893334
lambda[  15] =   0.01201118265918
lambda[  16] =   0.01798430606794
lambda[  17] =   0.01819520119532
lambda[  18] =   0.01913727762117
lambda[  19] =   0.04413875377629
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.601 ms
rank =  0, subspace rotation using ScaLAPACK took 8.071 ms
rank =  0, Distributing orbital back into band + domain format took 19.369 ms
rank = 0, Subspace_Rotation used 27.456 ms

Total time for subspace rotation: 27.461 ms
rank = 0, Efermi =  -0.059233868627 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 6.316 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.933 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.604 ms
rank = 0, Calculating density took 1713.776 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.916 ms
rank = 0, D2D took 2.024 ms
rank = 0, Transfering density took 2.026 ms
Etot    =   -28.857612663562
Eband   =   -10.027104861516
E1      =    24.308683082033
E2      =    -8.312624152470
E3      =   -13.030059426575
Exc     =   -11.447652789351
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 3.021e-06, dEband = 2.166e-03
rank = 0, Calculating/Estimating energy took 0.982 ms, Etot = -28.857612664, dEtot = 3.021e-06, dEband = 2.166e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1097662393499, which took 0.057 ms

iter_count = 114, r_2norm = 3.364e-06, tol*||rhs|| = 4.391e-06

Anderson update took 67.201 ms, out of which F'*F took 31.394 ms; b-Ax took 213.911 ms, out of which Lap took 190.737 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.188 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056499, int_b + int_rho = 5.093e-14, checking this took 0.133 ms
2-norm of RHS = 789.9423263402446, which took 0.177 ms

iter_count = 216, r_2norm = 7.760e-04, tol*||rhs|| = 7.899e-04

Anderson update took 127.163 ms, out of which F'*F took 60.623 ms; b-Ax took 419.976 ms, out of which Lap took 372.641 ms
Solving Poisson took 903.571 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.260151 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.818 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.264327 
Total time for convolution: 	 convolve: 5.246995 
Total time for convolution: 	 convolve: 5.217095 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.382 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.186 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.875 ms
---Transfer Veff_loc: D2D took 3.514 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.244 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.793 ms

This SCF took 28198.245 ms, scf error = 1.390e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.144139, lowerbound = -0.709055, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1603.588 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.803 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.672 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.494 ms
rank =  0, finding HY took 25.537 ms
rank =  0, distributing HY into block cyclic form took 19.904 ms
rank =  0, finding Y'*HY took 3.818 ms
Rank 0, Project_Hamiltonian used 71.832 ms
Total time for projection: 71.847 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.706879386991008
    last  calculated eigval = 0.042897380720471
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.57955538224525
lambda[   4] =  -0.46127398418174
lambda[   5] =  -0.41209485376825
lambda[   6] =  -0.36000515868403
lambda[   7] =  -0.35773645845625
lambda[   8] =  -0.34663418031561
lambda[   9] =  -0.33365907204608
lambda[  10] =  -0.30416234944306
lambda[  11] =  -0.27886023287029
lambda[  12] =  -0.20113866142437
lambda[  13] =  -0.02685356120264
lambda[  14] =  -0.00388033912851
lambda[  15] =   0.01605111002787
lambda[  16] =   0.02164083362431
lambda[  17] =   0.02191459962539
lambda[  18] =   0.02239217996848
lambda[  19] =   0.04289738072047
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.249 ms
rank =  0, subspace rotation using ScaLAPACK took 8.058 ms
rank =  0, Distributing orbital back into band + domain format took 19.530 ms
rank = 0, Subspace_Rotation used 27.604 ms

Total time for subspace rotation: 27.609 ms
rank = 0, Efermi =  -0.055636195628 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 6.196 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.842 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.603 ms
rank = 0, Calculating density took 1722.074 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.046 ms
rank = 0, D2D took 2.147 ms
rank = 0, Transfering density took 2.156 ms
Etot    =   -28.857550270901
Eband   =    -9.975178544208
E1      =    24.280920780055
E2      =    -8.286941503194
E3      =   -13.037078715633
Exc     =   -11.453091051803
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 5.199e-06, dEband = 4.327e-03
rank = 0, Calculating/Estimating energy took 1.007 ms, Etot = -28.857550271, dEtot = 5.199e-06, dEband = 4.327e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0773316269231, which took 0.223 ms

iter_count = 114, r_2norm = 2.261e-06, tol*||rhs|| = 3.093e-06

Anderson update took 68.171 ms, out of which F'*F took 34.467 ms; b-Ax took 221.601 ms, out of which Lap took 198.536 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 490.063 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056504, int_b + int_rho = 9.823e-14, checking this took 0.139 ms
2-norm of RHS = 789.9498141622977, which took 0.075 ms

iter_count = 192, r_2norm = 7.325e-04, tol*||rhs|| = 7.899e-04

Anderson update took 112.741 ms, out of which F'*F took 52.032 ms; b-Ax took 368.059 ms, out of which Lap took 321.434 ms
Solving Poisson took 801.403 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.703 ms
Total time for convolution: 	 convolve: 5.353566 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.251495 
Total time for convolution: 	 convolve: 6.412817 
Total time for convolution: 	 convolve: 5.184284 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.846 ms
---Transfer Veff_loc: D2D took 3.474 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.029 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.540 ms

This SCF took 29409.653 ms, scf error = 7.427e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.142897, lowerbound = -0.706879, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1597.580 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.048 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.732 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.804 ms
rank =  0, finding HY took 25.641 ms
rank =  0, distributing HY into block cyclic form took 19.935 ms
rank =  0, finding Y'*HY took 3.778 ms
Rank 0, Project_Hamiltonian used 72.196 ms
Total time for projection: 72.209 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.706132633936182
    last  calculated eigval = 0.040610175527411
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.57884224680275
lambda[   4] =  -0.46055330793957
lambda[   5] =  -0.41136819135883
lambda[   6] =  -0.35926315640670
lambda[   7] =  -0.35699646647231
lambda[   8] =  -0.34590125734551
lambda[   9] =  -0.33290591538697
lambda[  10] =  -0.30344776181616
lambda[  11] =  -0.27813468249786
lambda[  12] =  -0.20039770524691
lambda[  13] =  -0.02448344710612
lambda[  14] =  -0.00312239612200
lambda[  15] =   0.01836333493605
lambda[  16] =   0.02363148262617
lambda[  17] =   0.02437997550351
lambda[  18] =   0.02512904783906
lambda[  19] =   0.04061017552741
==subpsace eigenproblem: bcast eigvals took 0.036 ms
Total time for solving subspace eigenvalue problem: 0.263 ms
rank =  0, subspace rotation using ScaLAPACK took 8.049 ms
rank =  0, Distributing orbital back into band + domain format took 19.631 ms
rank = 0, Subspace_Rotation used 27.697 ms

Total time for subspace rotation: 27.703 ms
rank = 0, Efermi =  -0.053266081519 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 6.813 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.389 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.634 ms
rank = 0, Calculating density took 1717.211 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.008 ms
rank = 0, D2D took 2.111 ms
rank = 0, Transfering density took 2.114 ms
Etot    =   -28.857571893151
Eband   =    -9.957537338738
E1      =    24.272839687844
E2      =    -8.277328766062
E3      =   -13.037480545975
Exc     =   -11.453461880521
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 1.802e-06, dEband = 1.470e-03
rank = 0, Calculating/Estimating energy took 1.000 ms, Etot = -28.857571893, dEtot = 1.802e-06, dEband = 1.470e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0460184630789, which took 0.052 ms

iter_count = 114, r_2norm = 1.181e-06, tol*||rhs|| = 1.841e-06

Anderson update took 66.472 ms, out of which F'*F took 32.088 ms; b-Ax took 224.138 ms, out of which Lap took 198.200 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 491.770 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056501, int_b + int_rho = 6.548e-14, checking this took 0.109 ms
2-norm of RHS = 789.9612218663455, which took 0.081 ms

iter_count = 186, r_2norm = 6.336e-04, tol*||rhs|| = 7.900e-04

Anderson update took 109.384 ms, out of which F'*F took 52.428 ms; b-Ax took 356.942 ms, out of which Lap took 317.109 ms
Solving Poisson took 775.660 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Total time for convolution: 	 convolve: 5.234406 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.302617 
Total time for convolution: 	 convolve: 5.279659 
Total time for convolution: 	 convolve: 5.250342 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.748 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.513 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.865 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.790 ms

This SCF took 28126.395 ms, scf error = 5.224e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.140610, lowerbound = -0.706133, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1589.940 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.859 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.921 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.801 ms
rank =  0, finding HY took 25.534 ms
rank =  0, distributing HY into block cyclic form took 19.863 ms
rank =  0, finding Y'*HY took 3.811 ms
Rank 0, Project_Hamiltonian used 72.041 ms
Total time for projection: 72.053 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -0.705328540567471
    last  calculated eigval = 0.039050434004800
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.57807712162468
lambda[   4] =  -0.45976695421855
lambda[   5] =  -0.41056683795547
lambda[   6] =  -0.35848024331760
lambda[   7] =  -0.35621132880980
lambda[   8] =  -0.34512189020101
lambda[   9] =  -0.33210665263964
lambda[  10] =  -0.30266350487474
lambda[  11] =  -0.27735402614855
lambda[  12] =  -0.19961445038063
lambda[  13] =  -0.02155012325770
lambda[  14] =  -0.00235099710803
lambda[  15] =   0.02029775190214
lambda[  16] =   0.02607705465585
lambda[  17] =   0.02869971987478
lambda[  18] =   0.02891744747530
lambda[  19] =   0.03905043400480
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 7.837 ms
rank =  0, Distributing orbital back into band + domain format took 19.284 ms
rank = 0, Subspace_Rotation used 27.136 ms

Total time for subspace rotation: 27.142 ms
rank = 0, Efermi =  -0.050332757645 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 6.757 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.152 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 1708.041 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.917 ms
rank = 0, D2D took 2.016 ms
rank = 0, Transfering density took 2.018 ms
Etot    =   -28.857665092834
Eband   =    -9.938633233196
E1      =    24.263602278723
E2      =    -8.267251725862
E3      =   -13.039185997771
Exc     =   -11.454850188222
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 7.767e-06, dEband = 1.575e-03
rank = 0, Calculating/Estimating energy took 1.010 ms, Etot = -28.857665093, dEtot = 7.767e-06, dEband = 1.575e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0354674027691, which took 0.055 ms

iter_count = 114, r_2norm = 1.001e-06, tol*||rhs|| = 1.419e-06

Anderson update took 68.578 ms, out of which F'*F took 32.986 ms; b-Ax took 219.719 ms, out of which Lap took 196.304 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.036 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056498, int_b + int_rho = 3.638e-14, checking this took 0.077 ms
2-norm of RHS = 789.9661698283752, which took 0.130 ms

iter_count = 150, r_2norm = 7.248e-04, tol*||rhs|| = 7.900e-04

Anderson update took 87.551 ms, out of which F'*F took 40.568 ms; b-Ax took 288.072 ms, out of which Lap took 250.377 ms
Solving Poisson took 632.649 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.228856 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.243025 
Total time for convolution: 	 convolve: 5.222255 
Total time for convolution: 	 convolve: 5.262807 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.831 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.574 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 3.487 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.354 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.877 ms

This SCF took 27988.313 ms, scf error = 3.225e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.139050, lowerbound = -0.705329, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1597.889 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.858 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.863 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.746 ms
rank =  0, finding HY took 25.595 ms
rank =  0, distributing HY into block cyclic form took 19.880 ms
rank =  0, finding Y'*HY took 3.831 ms
Rank 0, Project_Hamiltonian used 72.086 ms
Total time for projection: 72.097 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.203 ms
    first calculated eigval = -0.705033826750699
    last  calculated eigval = 0.037571255078471
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.57778689775757
lambda[   4] =  -0.45948778412535
lambda[   5] =  -0.41028751672677
lambda[   6] =  -0.35820307578574
lambda[   7] =  -0.35591923616881
lambda[   8] =  -0.34484598654052
lambda[   9] =  -0.33182317332793
lambda[  10] =  -0.30238508437563
lambda[  11] =  -0.27707957611312
lambda[  12] =  -0.19933339761672
lambda[  13] =  -0.02006833280496
lambda[  14] =  -0.00208511731084
lambda[  15] =   0.02128458642136
lambda[  16] =   0.02735974004263
lambda[  17] =   0.03040628460494
lambda[  18] =   0.03142385839467
lambda[  19] =   0.03757125507847
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.227 ms
rank =  0, subspace rotation using ScaLAPACK took 7.949 ms
rank =  0, Distributing orbital back into band + domain format took 19.243 ms
rank = 0, Subspace_Rotation used 27.205 ms

Total time for subspace rotation: 27.210 ms
rank = 0, Efermi =  -0.048850967180 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 6.485 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.627 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.606 ms
rank = 0, Calculating density took 1716.262 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.932 ms
rank = 0, D2D took 2.032 ms
rank = 0, Transfering density took 2.034 ms
Etot    =   -28.857701047692
Eband   =    -9.931838088449
E1      =    24.260040184056
E2      =    -8.263880049428
E3      =   -13.039771040953
Exc     =   -11.455332559909
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 2.996e-06, dEband = 5.663e-04
rank = 0, Calculating/Estimating energy took 1.011 ms, Etot = -28.857701048, dEtot = 2.996e-06, dEband = 5.663e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0331888061235, which took 0.060 ms

iter_count = 114, r_2norm = 8.138e-07, tol*||rhs|| = 1.328e-06

Anderson update took 67.777 ms, out of which F'*F took 31.946 ms; b-Ax took 217.730 ms, out of which Lap took 194.435 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.300 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056499, int_b + int_rho = 4.729e-14, checking this took 0.113 ms
2-norm of RHS = 789.9691383210906, which took 0.175 ms

iter_count = 144, r_2norm = 6.742e-04, tol*||rhs|| = 7.900e-04

Anderson update took 85.249 ms, out of which F'*F took 40.280 ms; b-Ax took 291.444 ms, out of which Lap took 260.375 ms
Solving Poisson took 618.973 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.266258 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 39.214 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.229353 
Total time for convolution: 	 convolve: 5.214894 
Total time for convolution: 	 convolve: 5.212022 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.580 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.392 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.012 ms
---Transfer Veff_loc: D2D took 3.575 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.346 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.960 ms

This SCF took 27866.888 ms, scf error = 2.246e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.137571, lowerbound = -0.705034, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1600.703 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.033 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.756 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.813 ms
rank =  0, finding HY took 25.624 ms
rank =  0, distributing HY into block cyclic form took 20.166 ms
rank =  0, finding Y'*HY took 3.621 ms
Rank 0, Project_Hamiltonian used 72.258 ms
Total time for projection: 72.275 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.704835394501148
    last  calculated eigval = 0.036840629257395
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.57757954466277
lambda[   4] =  -0.45929155907115
lambda[   5] =  -0.41009443579001
lambda[   6] =  -0.35801124780653
lambda[   7] =  -0.35572156127235
lambda[   8] =  -0.34465280699829
lambda[   9] =  -0.33162737012416
lambda[  10] =  -0.30218968510957
lambda[  11] =  -0.27688935405780
lambda[  12] =  -0.19914303658754
lambda[  13] =  -0.01958760189167
lambda[  14] =  -0.00192770757420
lambda[  15] =   0.02150898082016
lambda[  16] =   0.02792739736742
lambda[  17] =   0.03071476658960
lambda[  18] =   0.03220757915820
lambda[  19] =   0.03684062925739
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.236 ms
rank =  0, subspace rotation using ScaLAPACK took 7.983 ms
rank =  0, Distributing orbital back into band + domain format took 19.764 ms
rank = 0, Subspace_Rotation used 27.763 ms

Total time for subspace rotation: 27.768 ms
rank = 0, Efermi =  -0.048370236307 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 6.490 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.834 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.603 ms
rank = 0, Calculating density took 1720.031 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.961 ms
rank = 0, D2D took 2.993 ms
rank = 0, Transfering density took 2.995 ms
Etot    =   -28.857743955914
Eband   =    -9.927144673369
E1      =    24.257612448319
E2      =    -8.261493958920
E3      =   -13.040173070714
Exc     =   -11.455657086726
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 3.576e-06, dEband = 3.911e-04
rank = 0, Calculating/Estimating energy took 1.005 ms, Etot = -28.857743956, dEtot = 3.576e-06, dEband = 3.911e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0265935361566, which took 0.077 ms

iter_count = 108, r_2norm = 9.460e-07, tol*||rhs|| = 1.064e-06

Anderson update took 64.035 ms, out of which F'*F took 29.717 ms; b-Ax took 207.914 ms, out of which Lap took 183.809 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.881 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056499, int_b + int_rho = 5.093e-14, checking this took 0.136 ms
2-norm of RHS = 789.9719356769020, which took 0.138 ms

iter_count = 138, r_2norm = 6.915e-04, tol*||rhs|| = 7.900e-04

Anderson update took 80.689 ms, out of which F'*F took 38.083 ms; b-Ax took 259.212 ms, out of which Lap took 227.913 ms
Solving Poisson took 578.794 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.223832 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.255877 
Total time for convolution: 	 convolve: 5.249674 
Total time for convolution: 	 convolve: 5.186004 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.625 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.912 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.539 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.885 ms

This SCF took 27756.181 ms, scf error = 1.610e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136841, lowerbound = -0.704835, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1592.521 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.836 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.890 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.753 ms
rank =  0, finding HY took 25.457 ms
rank =  0, distributing HY into block cyclic form took 19.895 ms
rank =  0, finding Y'*HY took 3.824 ms
Rank 0, Project_Hamiltonian used 71.963 ms
Total time for projection: 71.975 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.262 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.359 ms
    first calculated eigval = -0.704794390614301
    last  calculated eigval = 0.036861850206586
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.57752188074816
lambda[   4] =  -0.45923816885506
lambda[   5] =  -0.41004541515683
lambda[   6] =  -0.35795915301107
lambda[   7] =  -0.35567830542650
lambda[   8] =  -0.34459817764787
lambda[   9] =  -0.33157660198362
lambda[  10] =  -0.30213770633844
lambda[  11] =  -0.27684175373114
lambda[  12] =  -0.19909661157111
lambda[  13] =  -0.01987558717055
lambda[  14] =  -0.00192244021580
lambda[  15] =   0.02087614240275
lambda[  16] =   0.02792468756547
lambda[  17] =   0.02999384564490
lambda[  18] =   0.03102891269660
lambda[  19] =   0.03686185020659
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.376 ms
rank =  0, subspace rotation using ScaLAPACK took 7.868 ms
rank =  0, Distributing orbital back into band + domain format took 19.641 ms
rank = 0, Subspace_Rotation used 27.523 ms

Total time for subspace rotation: 27.527 ms
rank = 0, Efermi =  -0.048658221542 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 6.563 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.481 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.576 ms
rank = 0, Calculating density took 1712.159 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.933 ms
rank = 0, D2D took 2.032 ms
rank = 0, Transfering density took 2.039 ms
Etot    =   -28.857784736368
Eband   =    -9.925961235742
E1      =    24.257247632190
E2      =    -8.260678070745
E3      =   -13.039986888342
Exc     =   -11.455514418131
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 3.398e-06, dEband = 9.862e-05
rank = 0, Calculating/Estimating energy took 1.708 ms, Etot = -28.857784736, dEtot = 3.398e-06, dEband = 9.862e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0241820690548, which took 0.058 ms

iter_count = 108, r_2norm = 8.838e-07, tol*||rhs|| = 9.673e-07

Anderson update took 64.308 ms, out of which F'*F took 30.414 ms; b-Ax took 206.037 ms, out of which Lap took 183.674 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.061 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056498, int_b + int_rho = 3.274e-14, checking this took 0.125 ms
2-norm of RHS = 789.9693993512988, which took 0.190 ms

iter_count = 96, r_2norm = 7.537e-04, tol*||rhs|| = 7.900e-04

Anderson update took 56.857 ms, out of which F'*F took 26.592 ms; b-Ax took 183.079 ms, out of which Lap took 160.183 ms
Solving Poisson took 400.544 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.260201 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.386 ms
Total time for convolution: 	 convolve: 5.237277 
Total time for convolution: 	 convolve: 5.292652 
Total time for convolution: 	 convolve: 5.329099 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.582 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.779 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
---Transfer Veff_loc: D2D took 3.614 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.241 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.895 ms

This SCF took 28522.625 ms, scf error = 1.324e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136862, lowerbound = -0.704794, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1599.999 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.790 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.646 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.455 ms
rank =  0, finding HY took 25.545 ms
rank =  0, distributing HY into block cyclic form took 19.732 ms
rank =  0, finding Y'*HY took 4.034 ms
Rank 0, Project_Hamiltonian used 71.802 ms
Total time for projection: 71.814 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.214 ms
    first calculated eigval = -0.704733622071226
    last  calculated eigval = 0.036748704006488
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.57746519183973
lambda[   4] =  -0.45918304705910
lambda[   5] =  -0.40998975693995
lambda[   6] =  -0.35790745339385
lambda[   7] =  -0.35561964323252
lambda[   8] =  -0.34454740463907
lambda[   9] =  -0.33152416659068
lambda[  10] =  -0.30208330221599
lambda[  11] =  -0.27678681846288
lambda[  12] =  -0.19904095916193
lambda[  13] =  -0.01959992514389
lambda[  14] =  -0.00187481686470
lambda[  15] =   0.02093849281501
lambda[  16] =   0.02811639924376
lambda[  17] =   0.03019145895297
lambda[  18] =   0.03139168492259
lambda[  19] =   0.03674870400649
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.240 ms
rank =  0, subspace rotation using ScaLAPACK took 7.952 ms
rank =  0, Distributing orbital back into band + domain format took 21.425 ms
rank = 0, Subspace_Rotation used 29.394 ms

Total time for subspace rotation: 29.399 ms
rank = 0, Efermi =  -0.048382559572 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 6.539 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.353 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.731 ms
rank = 0, Calculating density took 1720.273 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.921 ms
rank = 0, D2D took 2.021 ms
rank = 0, Transfering density took 2.023 ms
Etot    =   -28.857788505216
Eband   =    -9.924634509625
E1      =    24.256448073057
E2      =    -8.260124866157
E3      =   -13.040118059023
Exc     =   -11.455623320055
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 3.141e-07, dEband = 1.106e-04
rank = 0, Calculating/Estimating energy took 1.022 ms, Etot = -28.857788505, dEtot = 3.141e-07, dEband = 1.106e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0152738914762, which took 0.057 ms

iter_count = 114, r_2norm = 3.538e-07, tol*||rhs|| = 6.110e-07

Anderson update took 65.962 ms, out of which F'*F took 32.372 ms; b-Ax took 219.675 ms, out of which Lap took 195.799 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 487.753 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056497, int_b + int_rho = 2.547e-14, checking this took 0.166 ms
2-norm of RHS = 789.9654764031226, which took 0.166 ms

iter_count = 126, r_2norm = 7.741e-04, tol*||rhs|| = 7.900e-04

Anderson update took 73.946 ms, out of which F'*F took 34.299 ms; b-Ax took 238.847 ms, out of which Lap took 210.531 ms
Solving Poisson took 526.802 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 5.238663 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.395 ms
Total time for convolution: 	 convolve: 5.240370 
Total time for convolution: 	 convolve: 5.206973 
Total time for convolution: 	 convolve: 5.263776 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.838 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.649 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.517 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.857 ms

This SCF took 27829.767 ms, scf error = 1.040e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136749, lowerbound = -0.704734, upperbound = 267.589041

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1614.577 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.055 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.809 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.890 ms
rank =  0, finding HY took 25.596 ms
rank =  0, distributing HY into block cyclic form took 20.021 ms
rank =  0, finding Y'*HY took 3.976 ms
Rank 0, Project_Hamiltonian used 72.519 ms
Total time for projection: 72.536 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -0.704709639838217
    last  calculated eigval = 0.036181971878263
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.57745052172533
lambda[   4] =  -0.45916423341830
lambda[   5] =  -0.40996684746632
lambda[   6] =  -0.35789099070472
lambda[   7] =  -0.35560004003847
lambda[   8] =  -0.34453236987472
lambda[   9] =  -0.33150788665160
lambda[  10] =  -0.30206480134796
lambda[  11] =  -0.27676569513633
lambda[  12] =  -0.19901961363978
lambda[  13] =  -0.01997128960767
lambda[  14] =  -0.00187471325092
lambda[  15] =   0.02038664615379
lambda[  16] =   0.02771652661993
lambda[  17] =   0.02951199704029
lambda[  18] =   0.03066355105003
lambda[  19] =   0.03618197187826
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 7.910 ms
rank =  0, Distributing orbital back into band + domain format took 20.787 ms
rank = 0, Subspace_Rotation used 28.714 ms

Total time for subspace rotation: 28.719 ms
rank = 0, Efermi =  -0.048753923970 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 6.670 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.815 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.178 ms
rank = 0, Calculating density took 1735.889 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.187 ms
rank = 0, D2D took 2.308 ms
rank = 0, Transfering density took 2.316 ms
Etot    =   -28.857806423034
Eband   =    -9.924179445514
E1      =    24.256230149739
E2      =    -8.259904074690
E3      =   -13.039978668373
Exc     =   -11.455518196549
Esc     =   -53.034221672866
Entropy =    -0.000000000907
dE = 1.493e-06, dEband = 3.792e-05
rank = 0, Calculating/Estimating energy took 0.976 ms, Etot = -28.857806423, dEtot = 1.493e-06, dEband = 3.792e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0151206043798, which took 0.050 ms

iter_count = 108, r_2norm = 5.150e-07, tol*||rhs|| = 6.048e-07

Anderson update took 62.970 ms, out of which F'*F took 29.795 ms; b-Ax took 213.836 ms, out of which Lap took 185.912 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 464.085 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003056494, int_rho =  24.00000003056503, int_b + int_rho = 8.731e-14, checking this took 0.131 ms
2-norm of RHS = 789.9657902070938, which took 0.071 ms

iter_count = 96, r_2norm = 7.019e-04, tol*||rhs|| = 7.900e-04

Anderson update took 59.054 ms, out of which F'*F took 26.061 ms; b-Ax took 181.400 ms, out of which Lap took 160.033 ms
Solving Poisson took 404.885 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.277890 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.224551 
Total time for convolution: 	 convolve: 5.268645 
Total time for convolution: 	 convolve: 5.196515 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 0.890 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.575 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.489 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.882 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.406 ms

This SCF took 27619.141 ms, scf error = 7.910e-05
The last 17 occupations of kpoints #1 are (Nelectron = 24):
lambda[   3] =  -0.57745052172533, occ[   3] =   2.00000000000000
lambda[   4] =  -0.45916423341830, occ[   4] =   2.00000000000000
lambda[   5] =  -0.40996684746632, occ[   5] =   2.00000000000000
lambda[   6] =  -0.35789099070472, occ[   6] =   2.00000000000000
lambda[   7] =  -0.35560004003847, occ[   7] =   2.00000000000000
lambda[   8] =  -0.34453236987472, occ[   8] =   2.00000000000000
lambda[   9] =  -0.33150788665160, occ[   9] =   2.00000000000000
lambda[  10] =  -0.30206480134796, occ[  10] =   2.00000000000000
lambda[  11] =  -0.27676569513633, occ[  11] =   2.00000000000000
lambda[  12] =  -0.19901961363978, occ[  12] =   2.00000000000000
lambda[  13] =  -0.01997128960767, occ[  13] =   0.00000003056501
lambda[  14] =  -0.00187471325092, occ[  14] =   0.00000000000000
lambda[  15] =   0.02038664615379, occ[  15] =   0.00000000000000
lambda[  16] =   0.02771652661993, occ[  16] =   0.00000000000000
lambda[  17] =   0.02951199704029, occ[  17] =   0.00000000000000
lambda[  18] =   0.03066355105003, occ[  18] =   0.00000000000000
lambda[  19] =   0.03618197187826, occ[  19] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 17 (90%) = 0.000000000000000.
Occupation of state 19 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.669 ms, time for Allreduce/Reduce: 10.340 ms 
Time for calculating local force components: 22.309 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000000472297  -0.02190788267042  -0.04541695608602
 -0.00000001502390   0.02190794210370  -0.04541719902995
 -0.00000002356582   0.02103397654070   0.04544670114756
 -0.00000002063394  -0.02103392860544   0.04544675846294
  0.03900275357831  -0.02887275613725  -0.00175709377966
 -0.03900278089362  -0.02887275803973  -0.00175708733653
 -0.03900284257870   0.02887281842272  -0.00175707585479
  0.03900278709209   0.02887280510567  -0.00175707365897
 -0.00000009379854   0.02915507478659  -0.01291641914151
 -0.00000020693794  -0.02915950667167  -0.01291564110552
 -0.00000009793128  -0.00493409792465   0.01657903551419
 -0.00000032768863   0.00493633549923   0.01658208610736
force_loc = 
  0.00000009282126   0.02192322002552   0.04773455920144
  0.00000000465562  -0.02192444122800   0.04773732504439
  0.00000000953715  -0.02527081790909  -0.04957409918800
  0.00000003360005   0.02527050494689  -0.04957424025576
 -0.04048473979284   0.03022658037198   0.00277828693347
  0.04048488655413   0.03022660022366   0.00277831778510
  0.04048465421956  -0.03022672653056   0.00277808922769
 -0.04048460063915  -0.03022671944812   0.00277809191373
  0.00000016742749  -0.02970474879317   0.00881949053252
 -0.00000005925301   0.02970796995775   0.00881955844916
  0.00000014348489  -0.00016599621813  -0.01298737645806
  0.00000024347364   0.00016524136217  -0.01298810835943
Time for calculating nonlocal force components: 45.084 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000498387  -0.00580566516396   0.00188387436059
[0m[32m -0.00000000669184   0.00580557322597   0.00188391268528
[0m[32m  0.00000001785399   0.00113275081395  -0.00161879202549
[0m[32m  0.00000001841580  -0.00113266731727  -0.00161867481304
[0mTime for calculating XC forces components: 30.216 ms
 Cartesian force = 
  0.00000008830282   0.00001544729435   0.00231841559269
 -0.00000001016375  -0.00001638918505   0.00232093849172
 -0.00000001382415  -0.00423673142915  -0.00412658556316
  0.00000001317063   0.00423668628070  -0.00412666931554
 -0.00148198601000   0.00135393417398   0.00102200563108
  0.00148210586504   0.00135395212317   0.00102204292585
  0.00148181184539  -0.00135379816860   0.00102182585017
 -0.00148181334253  -0.00135380440320   0.00102183073204
  0.00000007881735  -0.00635522923129  -0.00221224177113
 -0.00000027267826   0.00635414645130  -0.00221135749380
  0.00000006361213  -0.00396723338958   0.00197367950792
 -0.00000006559467   0.00396901948338   0.00197611541216
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.360 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Time for printing density: 390.197 ms
The program took 490.845 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:35:46
Job ID:        2266838
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:40:24,vmem=8300K,walltime=00:08:22,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-018-7-2
---------------------------------------
