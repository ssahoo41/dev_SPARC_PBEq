---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:06
Job ID:    2266583
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:13
Job ID:    2266583
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.074 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 10.548 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 4.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 16.752 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 51.709 ms

Freeing SPARC_INPUT_MPI datatype took 0.015 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.969 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.094 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.076835	    8.954673	   10.000000	
    7.284882	   10.356984	   10.000000	
   12.715118	    9.772413	   10.000000	
    9.388756	   11.045327	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.170 ms
Set up communicators.

--set up spincomm took 3.919 ms

--set up kptcomm took 0.359 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.378 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.749 ms

Calculate_SplineDerivRadFun took 0.214 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.825 ms.
time spent on vectorized spline interp: 3.708 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.715 ms.
time spent on vectorized spline interp: 1.551 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.312 ms.
time spent on vectorized spline interp: 1.807 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.550 ms.

Calculating rb for all atom types took 16.478 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.831 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000136602, sum_int_rho = 17.8986471455756
PosCharge = 18.000000013660, NegCharge = -17.898647145576, scal_fac = 1.005662599372
After scaling, int_rho = 18.0000000136601, PosCharge + NegCharge - NetCharge = 7.816e-14
--Calculate Vref took 0.338 ms
--Calculate rho_guess took 1.844 ms

 integral of b = -18.0000000136602,
 int{b} + Nelectron + NetCharge = -1.366e-08,
 Esc = -66.0532270689393,
 MPI_Reduce took 2.209 ms

Calculating b & b_ref took 9.687 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.025 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.035 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.022 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.157 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 27.894 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366019, int_b + int_rho = 5.821e-14, checking this took 0.194 ms
2-norm of RHS = 541.7745821404961, which took 0.076 ms

iter_count = 420, r_2norm = 4.762e-04, tol*||rhs|| = 5.418e-04

Anderson update took 276.198 ms, out of which F'*F took 118.068 ms; b-Ax took 798.238 ms, out of which Lap took 711.067 ms
Solving Poisson took 1780.555 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.416 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
Total time for convolution: 	 convolve: 5.159456 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
Total time for convolution: 	 convolve: 5.115420 
Total time for convolution: 	 convolve: 5.099207 
Total time for convolution: 	 convolve: 5.106050 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.709 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.379 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
rank = 0, XC calculation took 24409.634 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 1.594 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.183 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.896 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.136 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.987 ms
    Lanczos iter 53, eigmin  = -1.160195717, eigmax = 264.923476135, err_eigmin = 3.899e-04, err_eigmax = 9.572e-03
rank =   0, Lanczos took 140.259 ms, eigmin = -1.160195716795, eigmax = 267.572710896411

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.156258, lowerbound = -1.260196, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1377.946 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.053 ms
rank =  0, Distribute orbital to block cyclic format took 39.392 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.640 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.950 ms
rank =  0, Distribute data + matrix mult took 45.004 ms
rank =  0, finding HY took 22.883 ms
rank =  0, distributing HY into block cyclic form took 14.315 ms
rank =  0, finding Y'*HY took 5.807 ms
Rank 0, Project_Hamiltonian used 88.092 ms
Total time for projection: 88.113 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.432 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.609 ms
rank = 0, Solve_Generalized_EigenProblem used 1.784 ms
    first calculated eigval = 2.802686303115442
    last  calculated eigval = 3.218466121017176
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.80268630311544
lambda[   2] =   2.86620350683403
lambda[   3] =   2.88686358412463
lambda[   4] =   2.90817847243163
lambda[   5] =   2.92587289380973
lambda[   6] =   2.96571030248850
lambda[   7] =   2.98673369427063
lambda[   8] =   2.99896177547383
lambda[   9] =   3.04443204892184
lambda[  10] =   3.06586769096468
lambda[  11] =   3.10682595898729
lambda[  12] =   3.11911287994584
lambda[  13] =   3.14050668573613
lambda[  14] =   3.15923283127034
lambda[  15] =   3.21846612101718
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.808 ms
rank =  0, subspace rotation using ScaLAPACK took 4.222 ms
rank =  0, Distributing orbital back into band + domain format took 14.922 ms
rank = 0, Subspace_Rotation used 19.186 ms

Total time for subspace rotation: 19.189 ms
rank = 0, Efermi =   3.055149870316 calculate fermi energy took 0.057 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.318466, lowerbound = -1.260196, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1390.785 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.472 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.561 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 18.063 ms
rank =  0, finding HY took 21.731 ms
rank =  0, distributing HY into block cyclic form took 14.288 ms
rank =  0, finding Y'*HY took 4.648 ms
Rank 0, Project_Hamiltonian used 58.765 ms
Total time for projection: 58.779 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.106 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -1.040669790716851
    last  calculated eigval = 0.449963191543147
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.04066979071685
lambda[   2] =  -0.77298136042737
lambda[   3] =  -0.32963963708860
lambda[   4] =  -0.23428111734785
lambda[   5] =  -0.05861350869342
lambda[   6] =  -0.03458520020873
lambda[   7] =   0.15465145060285
lambda[   8] =   0.27222254154824
lambda[   9] =   0.31845452209850
lambda[  10] =   0.34239614617629
lambda[  11] =   0.36361426769409
lambda[  12] =   0.37563545240965
lambda[  13] =   0.39971265849033
lambda[  14] =   0.43355459813182
lambda[  15] =   0.44996319154315
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.174 ms
rank =  0, subspace rotation using ScaLAPACK took 4.210 ms
rank =  0, Distributing orbital back into band + domain format took 14.117 ms
rank = 0, Subspace_Rotation used 18.343 ms

Total time for subspace rotation: 18.349 ms
rank = 0, Efermi =   0.330425334761 calculate fermi energy took 0.025 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.549963, lowerbound = -1.260196, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1381.886 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 14.537 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.521 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 18.087 ms
rank =  0, finding HY took 21.745 ms
rank =  0, distributing HY into block cyclic form took 14.257 ms
rank =  0, finding Y'*HY took 3.502 ms
Rank 0, Project_Hamiltonian used 58.794 ms
Total time for projection: 58.798 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -1.169170102662423
    last  calculated eigval = 0.166327476519370
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.16917010266242
lambda[   2] =  -1.03668305176131
lambda[   3] =  -0.66840039921585
lambda[   4] =  -0.56121888675854
lambda[   5] =  -0.50678537853114
lambda[   6] =  -0.45328395130147
lambda[   7] =  -0.42240821784436
lambda[   8] =  -0.35066505419858
lambda[   9] =  -0.23362739821877
lambda[  10] =   0.00574390561396
lambda[  11] =   0.08895215112107
lambda[  12] =   0.09403524656037
lambda[  13] =   0.09966357411462
lambda[  14] =   0.12824375959389
lambda[  15] =   0.16632747651937
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 4.244 ms
rank =  0, Distributing orbital back into band + domain format took 14.112 ms
rank = 0, Subspace_Rotation used 18.376 ms

Total time for subspace rotation: 18.381 ms
rank = 0, Efermi =  -0.023763348896 calculate fermi energy took 0.028 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.266327, lowerbound = -1.260196, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1380.951 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.609 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.376 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.043 ms
rank =  0, Distribute data + matrix mult took 18.049 ms
rank =  0, finding HY took 21.764 ms
rank =  0, distributing HY into block cyclic form took 14.089 ms
rank =  0, finding Y'*HY took 4.844 ms
Rank 0, Project_Hamiltonian used 58.776 ms
Total time for projection: 58.790 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -1.169285314817557
    last  calculated eigval = 0.097857691693646
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.16928531481756
lambda[   2] =  -1.03724570200049
lambda[   3] =  -0.67273574067976
lambda[   4] =  -0.56671003753575
lambda[   5] =  -0.51629018088375
lambda[   6] =  -0.48694013601500
lambda[   7] =  -0.42894226125306
lambda[   8] =  -0.37810014161861
lambda[   9] =  -0.29368861321003
lambda[  10] =  -0.12721186404172
lambda[  11] =   0.03347443266737
lambda[  12] =   0.04592921893671
lambda[  13] =   0.06493204805573
lambda[  14] =   0.08984825964289
lambda[  15] =   0.09785769169365
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 4.178 ms
rank =  0, Distributing orbital back into band + domain format took 14.189 ms
rank = 0, Subspace_Rotation used 18.386 ms

Total time for subspace rotation: 18.391 ms
rank = 0, Efermi =  -0.156719118548 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.007 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.080 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.201 ms
rank = 0, Calculating density took 6022.721 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.624 ms
rank = 0, D2D took 1.734 ms
rank = 0, Transfering density took 1.740 ms
Etot    =   -43.991382204306
Eband   =   -11.099876257766
E1      =    21.362963064250
E2      =   -10.527746749323
E3      =   -12.663902391257
Exc     =   -11.392891082016
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 1.100e+01, dEband = 2.775e+00
rank = 0, Calculating/Estimating energy took 0.985 ms, Etot = -43.991382204, dEtot = 1.100e+01, dEband = 2.775e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 66.6692958210351, which took 0.156 ms

iter_count = 90, r_2norm = 1.719e-03, tol*||rhs|| = 2.667e-03

Anderson update took 53.035 ms, out of which F'*F took 25.133 ms; b-Ax took 169.855 ms, out of which Lap took 150.594 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 382.905 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366005, int_b + int_rho = -8.731e-14, checking this took 0.101 ms
2-norm of RHS = 538.9785785052212, which took 0.161 ms

iter_count = 282, r_2norm = 4.334e-04, tol*||rhs|| = 5.390e-04

Anderson update took 171.527 ms, out of which F'*F took 78.303 ms; b-Ax took 526.965 ms, out of which Lap took 468.201 ms
Solving Poisson took 1177.110 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.806 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.122902 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 120.779 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.141570 
Total time for convolution: 	 convolve: 5.119139 
Total time for convolution: 	 convolve: 5.117676 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.168 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 0.963 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.833 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.816 ms

This SCF took 32155.015 ms, scf error = 1.307e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.197858, lowerbound = -1.169285, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1372.728 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.401 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.552 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.259 ms
rank =  0, Distribute data + matrix mult took 18.233 ms
rank =  0, finding HY took 22.237 ms
rank =  0, distributing HY into block cyclic form took 14.583 ms
rank =  0, finding Y'*HY took 4.420 ms
Rank 0, Project_Hamiltonian used 59.505 ms
Total time for projection: 59.524 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -1.162970584421903
    last  calculated eigval = 0.075571980959563
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.16297058442190
lambda[   2] =  -1.00690885027206
lambda[   3] =  -0.65589808783863
lambda[   4] =  -0.54740617728069
lambda[   5] =  -0.49273962490416
lambda[   6] =  -0.48101182675934
lambda[   7] =  -0.40566119649422
lambda[   8] =  -0.34393052350177
lambda[   9] =  -0.27523191268815
lambda[  10] =  -0.14524092717075
lambda[  11] =   0.00736545571504
lambda[  12] =   0.02511229387167
lambda[  13] =   0.03177378012561
lambda[  14] =   0.05229714523818
lambda[  15] =   0.07557198095956
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 4.269 ms
rank =  0, Distributing orbital back into band + domain format took 14.136 ms
rank = 0, Subspace_Rotation used 18.422 ms

Total time for subspace rotation: 18.427 ms
rank = 0, Efermi =  -0.174748181681 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 3.358 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.808 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.187 ms
rank = 0, Calculating density took 1458.230 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.734 ms
rank = 0, D2D took 0.984 ms
rank = 0, Transfering density took 0.998 ms
Etot    =   -43.962539940545
Eband   =   -10.743517570306
E1      =    21.076611227882
E2      =   -10.461745255103
E3      =   -12.774215310373
Exc     =   -11.478367094242
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 7.211e-03, dEband = 8.909e-02
rank = 0, Calculating/Estimating energy took 1.058 ms, Etot = -43.962539941, dEtot = 7.211e-03, dEband = 8.909e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 34.5036507432395, which took 0.097 ms

iter_count = 90, r_2norm = 1.127e-03, tol*||rhs|| = 1.380e-03

Anderson update took 52.881 ms, out of which F'*F took 25.071 ms; b-Ax took 171.402 ms, out of which Lap took 152.043 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 383.427 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366008, int_b + int_rho = -5.457e-14, checking this took 0.102 ms
2-norm of RHS = 538.0398038369202, which took 0.168 ms

iter_count = 276, r_2norm = 4.892e-04, tol*||rhs|| = 5.380e-04

Anderson update took 160.473 ms, out of which F'*F took 77.490 ms; b-Ax took 520.597 ms, out of which Lap took 464.533 ms
Solving Poisson took 1140.632 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.874 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.213287 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.193906 
Total time for convolution: 	 convolve: 5.211464 
Total time for convolution: 	 convolve: 5.276788 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.586 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.195 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.967 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.836 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.823 ms

This SCF took 27848.569 ms, scf error = 7.613e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.175572, lowerbound = -1.162971, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1425.010 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.384 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.866 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.004 ms
rank =  0, Distribute data + matrix mult took 18.274 ms
rank =  0, finding HY took 22.551 ms
rank =  0, distributing HY into block cyclic form took 14.742 ms
rank =  0, finding Y'*HY took 5.490 ms
Rank 0, Project_Hamiltonian used 61.095 ms
Total time for projection: 61.118 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -1.155598712816037
    last  calculated eigval = 0.068566895371851
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.15559871281604
lambda[   2] =  -0.98773152258156
lambda[   3] =  -0.64077613241397
lambda[   4] =  -0.53114870222662
lambda[   5] =  -0.47465666338457
lambda[   6] =  -0.47364952943645
lambda[   7] =  -0.38552677118950
lambda[   8] =  -0.32339542271072
lambda[   9] =  -0.25706276930915
lambda[  10] =  -0.13943566439920
lambda[  11] =  -0.01699129297782
lambda[  12] =   0.01016780902112
lambda[  13] =   0.02521501553623
lambda[  14] =   0.04483911799609
lambda[  15] =   0.06856689537185
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 4.118 ms
rank =  0, Distributing orbital back into band + domain format took 14.399 ms
rank = 0, Subspace_Rotation used 18.550 ms

Total time for subspace rotation: 18.555 ms
rank = 0, Efermi =  -0.168942918937 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 3.070 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.594 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.193 ms
rank = 0, Calculating density took 1511.879 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.638 ms
rank = 0, D2D took 0.773 ms
rank = 0, Transfering density took 0.780 ms
Etot    =   -43.952617156134
Eband   =   -10.459092454042
E1      =    20.856162423857
E2      =   -10.386436072408
E3      =   -12.866575176188
Exc     =   -11.549471305191
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 2.481e-03, dEband = 7.111e-02
rank = 0, Calculating/Estimating energy took 1.693 ms, Etot = -43.952617156, dEtot = 2.481e-03, dEband = 7.111e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 7.8798380394837, which took 0.185 ms

iter_count = 102, r_2norm = 1.972e-04, tol*||rhs|| = 3.152e-04

Anderson update took 62.957 ms, out of which F'*F took 28.716 ms; b-Ax took 190.587 ms, out of which Lap took 170.866 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 434.363 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366016, int_b + int_rho = 2.910e-14, checking this took 0.151 ms
2-norm of RHS = 538.9877996447887, which took 0.151 ms

iter_count = 276, r_2norm = 4.904e-04, tol*||rhs|| = 5.390e-04

Anderson update took 163.287 ms, out of which F'*F took 75.784 ms; b-Ax took 516.128 ms, out of which Lap took 458.510 ms
Solving Poisson took 1146.127 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.128521 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.804 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.125340 
Total time for convolution: 	 convolve: 5.125156 
Total time for convolution: 	 convolve: 5.121207 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.187 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 0.970 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.834 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.824 ms

This SCF took 27563.481 ms, scf error = 3.873e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.168567, lowerbound = -1.155599, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1448.644 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.677 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.506 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 18.231 ms
rank =  0, finding HY took 21.937 ms
rank =  0, distributing HY into block cyclic form took 13.863 ms
rank =  0, finding Y'*HY took 6.168 ms
Rank 0, Project_Hamiltonian used 60.243 ms
Total time for projection: 60.256 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -1.147633785313607
    last  calculated eigval = 0.063229872287873
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.14763378531361
lambda[   2] =  -0.98194863500972
lambda[   3] =  -0.63124444408116
lambda[   4] =  -0.51967202242131
lambda[   5] =  -0.46797819773724
lambda[   6] =  -0.46067695508504
lambda[   7] =  -0.37409619645021
lambda[   8] =  -0.31799848998699
lambda[   9] =  -0.24429535733983
lambda[  10] =  -0.13077311592838
lambda[  11] =  -0.02773826910017
lambda[  12] =   0.00662315408887
lambda[  13] =   0.02385493676950
lambda[  14] =   0.04186306184427
lambda[  15] =   0.06322987228787
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 4.705 ms
rank =  0, Distributing orbital back into band + domain format took 13.687 ms
rank = 0, Subspace_Rotation used 18.413 ms

Total time for subspace rotation: 18.433 ms
rank = 0, Efermi =  -0.160280370364 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.696 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.705 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.345 ms
rank = 0, Calculating density took 1536.288 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.583 ms
rank = 0, D2D took 0.703 ms
rank = 0, Transfering density took 0.708 ms
Etot    =   -43.949747156488
Eband   =   -10.291088168637
E1      =    20.745399461716
E2      =   -10.318001923084
E3      =   -12.924084235544
Exc     =   -11.592917538841
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 7.175e-04, dEband = 4.200e-02
rank = 0, Calculating/Estimating energy took 1.004 ms, Etot = -43.949747156, dEtot = 7.175e-04, dEband = 4.200e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.1255870952355, which took 0.075 ms

iter_count = 102, r_2norm = 1.011e-04, tol*||rhs|| = 1.250e-04

Anderson update took 60.326 ms, out of which F'*F took 28.315 ms; b-Ax took 192.998 ms, out of which Lap took 170.612 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.575 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366006, int_b + int_rho = -7.640e-14, checking this took 0.117 ms
2-norm of RHS = 539.5446186308218, which took 0.101 ms

iter_count = 240, r_2norm = 5.375e-04, tol*||rhs|| = 5.395e-04

Anderson update took 143.161 ms, out of which F'*F took 64.493 ms; b-Ax took 442.043 ms, out of which Lap took 393.046 ms
Solving Poisson took 1008.731 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.107100 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.968 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.255691 
Total time for convolution: 	 convolve: 5.091130 
Total time for convolution: 	 convolve: 5.089871 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.482 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.937 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.823 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.781 ms

This SCF took 27524.661 ms, scf error = 9.779e-03
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.163230, lowerbound = -1.147634, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1421.581 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.638 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.633 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.295 ms
rank =  0, finding HY took 22.135 ms
rank =  0, distributing HY into block cyclic form took 14.155 ms
rank =  0, finding Y'*HY took 4.685 ms
Rank 0, Project_Hamiltonian used 59.309 ms
Total time for projection: 59.321 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -1.146833297921268
    last  calculated eigval = 0.057104702810399
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.14683329792127
lambda[   2] =  -0.98057281324171
lambda[   3] =  -0.63003618740531
lambda[   4] =  -0.51823602626301
lambda[   5] =  -0.46738923213736
lambda[   6] =  -0.45899982839692
lambda[   7] =  -0.37245597887794
lambda[   8] =  -0.31681005895552
lambda[   9] =  -0.24277354019171
lambda[  10] =  -0.13012262122450
lambda[  11] =  -0.03177136522843
lambda[  12] =   0.00536983368557
lambda[  13] =   0.02325904332630
lambda[  14] =   0.03933170962758
lambda[  15] =   0.05710470281040
==subpsace eigenproblem: bcast eigvals took 0.562 ms
Total time for solving subspace eigenvalue problem: 1.479 ms
rank =  0, subspace rotation using ScaLAPACK took 4.276 ms
rank =  0, Distributing orbital back into band + domain format took 23.893 ms
rank = 0, Subspace_Rotation used 28.188 ms

Total time for subspace rotation: 28.199 ms
rank = 0, Efermi =  -0.159629875762 calculate fermi energy took 4.112 ms
rank = 0, --- Calculate rho: sum over local bands took 4.138 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.104 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.205 ms
rank = 0, Calculating density took 1521.213 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.659 ms
rank = 0, D2D took 0.893 ms
rank = 0, Transfering density took 0.903 ms
Etot    =   -43.949563152981
Eband   =   -10.268213928559
E1      =    20.739479831498
E2      =   -10.299260705864
E3      =   -12.930287889236
Exc     =   -11.597150581665
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 4.600e-05, dEband = 5.719e-03
rank = 0, Calculating/Estimating energy took 1.319 ms, Etot = -43.949563153, dEtot = 4.600e-05, dEband = 5.719e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7956365586914, which took 0.051 ms

iter_count = 108, r_2norm = 2.957e-05, tol*||rhs|| = 3.183e-05

Anderson update took 64.542 ms, out of which F'*F took 28.841 ms; b-Ax took 200.813 ms, out of which Lap took 175.113 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 473.740 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366009, int_b + int_rho = -4.366e-14, checking this took 0.150 ms
2-norm of RHS = 540.3252133346090, which took 0.129 ms

iter_count = 252, r_2norm = 5.080e-04, tol*||rhs|| = 5.403e-04

Anderson update took 150.733 ms, out of which F'*F took 66.848 ms; b-Ax took 453.262 ms, out of which Lap took 402.649 ms
Solving Poisson took 1078.637 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.088945 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.684 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.102590 
Total time for convolution: 	 convolve: 5.100279 
Total time for convolution: 	 convolve: 5.095486 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.515 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.643 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.955 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.377 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.353 ms

This SCF took 27503.953 ms, scf error = 6.007e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.157105, lowerbound = -1.146833, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1399.512 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.620 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.610 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 18.272 ms
rank =  0, finding HY took 22.696 ms
rank =  0, distributing HY into block cyclic form took 14.094 ms
rank =  0, finding Y'*HY took 4.232 ms
Rank 0, Project_Hamiltonian used 59.802 ms
Total time for projection: 59.818 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -1.146229703569696
    last  calculated eigval = 0.050061760714141
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.14622970356970
lambda[   2] =  -0.97933296357755
lambda[   3] =  -0.62943045237885
lambda[   4] =  -0.51754461144336
lambda[   5] =  -0.46706843567105
lambda[   6] =  -0.45816104823009
lambda[   7] =  -0.37152667387430
lambda[   8] =  -0.31577963778233
lambda[   9] =  -0.24211907593745
lambda[  10] =  -0.13011960773805
lambda[  11] =  -0.03404582925366
lambda[  12] =   0.00506043971875
lambda[  13] =   0.02290659093967
lambda[  14] =   0.03699124172389
lambda[  15] =   0.05006176071414
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 4.240 ms
rank =  0, Distributing orbital back into band + domain format took 14.052 ms
rank = 0, Subspace_Rotation used 18.306 ms

Total time for subspace rotation: 18.310 ms
rank = 0, Efermi =  -0.159626862182 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.076 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.459 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.190 ms
rank = 0, Calculating density took 1485.667 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.718 ms
rank = 0, D2D took 0.944 ms
rank = 0, Transfering density took 0.947 ms
Etot    =   -43.949418970303
Eband   =   -10.254385206707
E1      =    20.747502826124
E2      =   -10.276606463032
E3      =   -12.930414049802
Exc     =   -11.596330033200
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 3.605e-05, dEband = 3.457e-03
rank = 0, Calculating/Estimating energy took 1.210 ms, Etot = -43.949418970, dEtot = 3.605e-05, dEband = 3.457e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5166684254424, which took 0.057 ms

iter_count = 108, r_2norm = 1.637e-05, tol*||rhs|| = 2.067e-05

Anderson update took 63.083 ms, out of which F'*F took 28.230 ms; b-Ax took 196.958 ms, out of which Lap took 173.406 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 480.055 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366017, int_b + int_rho = 3.638e-14, checking this took 0.106 ms
2-norm of RHS = 540.2930763519873, which took 0.165 ms

iter_count = 234, r_2norm = 4.388e-04, tol*||rhs|| = 5.403e-04

Anderson update took 138.206 ms, out of which F'*F took 67.396 ms; b-Ax took 456.604 ms, out of which Lap took 408.392 ms
Solving Poisson took 987.745 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.093879 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.196 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.859 ms
Total time for convolution: 	 convolve: 5.124983 
Total time for convolution: 	 convolve: 5.095161 
Total time for convolution: 	 convolve: 5.098186 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.951 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.360 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.335 ms

This SCF took 27337.091 ms, scf error = 2.096e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.150062, lowerbound = -1.146230, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1415.242 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.560 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.578 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 18.120 ms
rank =  0, finding HY took 22.501 ms
rank =  0, distributing HY into block cyclic form took 14.356 ms
rank =  0, finding Y'*HY took 4.354 ms
Rank 0, Project_Hamiltonian used 59.368 ms
Total time for projection: 59.389 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -1.144603027355150
    last  calculated eigval = 0.043399309983272
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.14460302735515
lambda[   2] =  -0.97875028729861
lambda[   3] =  -0.62835558780864
lambda[   4] =  -0.51626589290769
lambda[   5] =  -0.46569627943618
lambda[   6] =  -0.45686838592419
lambda[   7] =  -0.37042145739031
lambda[   8] =  -0.31515929905730
lambda[   9] =  -0.24077513849240
lambda[  10] =  -0.12874951136802
lambda[  11] =  -0.03532630624676
lambda[  12] =   0.00463780813641
lambda[  13] =   0.02224865300769
lambda[  14] =   0.03443136498012
lambda[  15] =   0.04339930998327
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 4.228 ms
rank =  0, Distributing orbital back into band + domain format took 14.166 ms
rank = 0, Subspace_Rotation used 18.412 ms

Total time for subspace rotation: 18.417 ms
rank = 0, Efermi =  -0.158256765854 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 4.080 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.419 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.207 ms
rank = 0, Calculating density took 1501.077 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.795 ms
rank = 0, D2D took 1.027 ms
rank = 0, Transfering density took 1.038 ms
Etot    =   -43.949414846836
Eband   =   -10.233790713100
E1      =    20.735398994537
E2      =   -10.267228026160
E3      =   -12.934005741445
Exc     =   -11.599029826524
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 1.031e-06, dEband = 5.149e-03
rank = 0, Calculating/Estimating energy took 1.064 ms, Etot = -43.949414847, dEtot = 1.031e-06, dEband = 5.149e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3097182893487, which took 0.056 ms

iter_count = 108, r_2norm = 9.661e-06, tol*||rhs|| = 1.239e-05

Anderson update took 64.592 ms, out of which F'*F took 28.671 ms; b-Ax took 197.461 ms, out of which Lap took 173.540 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 476.513 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366007, int_b + int_rho = -6.548e-14, checking this took 0.127 ms
2-norm of RHS = 540.3069242839925, which took 0.104 ms

iter_count = 234, r_2norm = 4.445e-04, tol*||rhs|| = 5.403e-04

Anderson update took 139.830 ms, out of which F'*F took 66.996 ms; b-Ax took 458.467 ms, out of which Lap took 407.716 ms
Solving Poisson took 994.245 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.085 ms
Total time for convolution: 	 convolve: 5.112920 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.107632 
Total time for convolution: 	 convolve: 5.098540 
Total time for convolution: 	 convolve: 5.088796 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.939 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.363 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.323 ms

This SCF took 27355.238 ms, scf error = 1.458e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.143399, lowerbound = -1.144603, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1395.663 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.524 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.507 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.058 ms
rank =  0, finding HY took 22.268 ms
rank =  0, distributing HY into block cyclic form took 14.277 ms
rank =  0, finding Y'*HY took 4.506 ms
Rank 0, Project_Hamiltonian used 59.141 ms
Total time for projection: 59.158 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -1.143662566738020
    last  calculated eigval = 0.038967442324585
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.14366256673802
lambda[   2] =  -0.97770733259004
lambda[   3] =  -0.62749371960737
lambda[   4] =  -0.51540208046779
lambda[   5] =  -0.46482837491135
lambda[   6] =  -0.45594204573539
lambda[   7] =  -0.36950463167835
lambda[   8] =  -0.31410342646401
lambda[   9] =  -0.23993333523047
lambda[  10] =  -0.12793805470862
lambda[  11] =  -0.03586930364394
lambda[  12] =   0.00484072905792
lambda[  13] =   0.02215628731370
lambda[  14] =   0.03217229066000
lambda[  15] =   0.03896744232459
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.188 ms
rank =  0, subspace rotation using ScaLAPACK took 4.235 ms
rank =  0, Distributing orbital back into band + domain format took 14.208 ms
rank = 0, Subspace_Rotation used 18.461 ms

Total time for subspace rotation: 18.466 ms
rank = 0, Efermi =  -0.157445309166 calculate fermi energy took 0.096 ms
rank = 0, --- Calculate rho: sum over local bands took 3.945 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.408 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.217 ms
rank = 0, Calculating density took 1481.205 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.728 ms
rank = 0, D2D took 0.970 ms
rank = 0, Transfering density took 0.974 ms
Etot    =   -43.949437498533
Eband   =   -10.217155028593
E1      =    20.727716723607
E2      =   -10.257779912433
E3      =   -12.935558946634
Exc     =   -11.600110983260
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 5.663e-06, dEband = 4.159e-03
rank = 0, Calculating/Estimating energy took 1.147 ms, Etot = -43.949437499, dEtot = 5.663e-06, dEband = 4.159e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2004190542463, which took 0.057 ms

iter_count = 108, r_2norm = 6.739e-06, tol*||rhs|| = 8.017e-06

Anderson update took 65.063 ms, out of which F'*F took 34.780 ms; b-Ax took 218.831 ms, out of which Lap took 196.071 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 493.900 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366009, int_b + int_rho = -4.366e-14, checking this took 0.141 ms
2-norm of RHS = 540.2872602691604, which took 0.161 ms

iter_count = 210, r_2norm = 4.684e-04, tol*||rhs|| = 5.403e-04

Anderson update took 137.034 ms, out of which F'*F took 60.467 ms; b-Ax took 423.538 ms, out of which Lap took 379.749 ms
Solving Poisson took 917.853 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.108771 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.254 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 6.218239 
Total time for convolution: 	 convolve: 5.090620 
Total time for convolution: 	 convolve: 5.093822 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.948 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.942 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.266 ms

This SCF took 28388.238 ms, scf error = 8.211e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.138967, lowerbound = -1.143663, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1394.528 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.716 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.398 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 18.137 ms
rank =  0, finding HY took 22.371 ms
rank =  0, distributing HY into block cyclic form took 14.134 ms
rank =  0, finding Y'*HY took 4.614 ms
Rank 0, Project_Hamiltonian used 59.288 ms
Total time for projection: 59.309 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -1.142966816782931
    last  calculated eigval = 0.036578014209875
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.14296681678293
lambda[   2] =  -0.97732103811371
lambda[   3] =  -0.62692452958101
lambda[   4] =  -0.51474159191688
lambda[   5] =  -0.46416263985492
lambda[   6] =  -0.45528145821534
lambda[   7] =  -0.36890747612342
lambda[   8] =  -0.31367495653108
lambda[   9] =  -0.23925549109655
lambda[  10] =  -0.12724907648439
lambda[  11] =  -0.03576507839077
lambda[  12] =   0.00498953538540
lambda[  13] =   0.02215457122011
lambda[  14] =   0.02985787074554
lambda[  15] =   0.03657801420987
==subpsace eigenproblem: bcast eigvals took 0.046 ms
Total time for solving subspace eigenvalue problem: 0.211 ms
rank =  0, subspace rotation using ScaLAPACK took 4.276 ms
rank =  0, Distributing orbital back into band + domain format took 14.050 ms
rank = 0, Subspace_Rotation used 18.342 ms

Total time for subspace rotation: 18.347 ms
rank = 0, Efermi =  -0.156756330934 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.052 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.417 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.208 ms
rank = 0, Calculating density took 1480.235 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.761 ms
rank = 0, D2D took 0.999 ms
rank = 0, Transfering density took 1.003 ms
Etot    =   -43.949487012014
Eband   =   -10.206471998170
E1      =    20.721768923345
E2      =   -10.252713141774
E3      =   -12.936823271677
Exc     =   -11.601093281285
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 1.238e-05, dEband = 2.671e-03
rank = 0, Calculating/Estimating energy took 1.119 ms, Etot = -43.949487012, dEtot = 1.238e-05, dEband = 2.671e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0929611033963, which took 0.053 ms

iter_count = 108, r_2norm = 3.674e-06, tol*||rhs|| = 3.718e-06

Anderson update took 63.923 ms, out of which F'*F took 28.520 ms; b-Ax took 197.724 ms, out of which Lap took 173.722 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 478.439 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366012, int_b + int_rho = -1.455e-14, checking this took 0.075 ms
2-norm of RHS = 540.3078748972072, which took 0.120 ms

iter_count = 210, r_2norm = 5.294e-04, tol*||rhs|| = 5.403e-04

Anderson update took 125.303 ms, out of which F'*F took 60.404 ms; b-Ax took 413.506 ms, out of which Lap took 368.534 ms
Solving Poisson took 892.847 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.098818 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.881 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.105511 
Total time for convolution: 	 convolve: 5.102895 
Total time for convolution: 	 convolve: 5.091434 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.951 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.368 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.339 ms

This SCF took 27226.203 ms, scf error = 5.841e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.136578, lowerbound = -1.142967, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1393.179 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.524 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.533 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 18.083 ms
rank =  0, finding HY took 22.436 ms
rank =  0, distributing HY into block cyclic form took 14.138 ms
rank =  0, finding Y'*HY took 4.688 ms
Rank 0, Project_Hamiltonian used 59.379 ms
Total time for projection: 59.395 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -1.142409926434462
    last  calculated eigval = 0.035881438328908
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.14240992643446
lambda[   2] =  -0.97679173093313
lambda[   3] =  -0.62640496817356
lambda[   4] =  -0.51417793595387
lambda[   5] =  -0.46358330233197
lambda[   6] =  -0.45473418351101
lambda[   7] =  -0.36835567313718
lambda[   8] =  -0.31310259248343
lambda[   9] =  -0.23870416614142
lambda[  10] =  -0.12670168198095
lambda[  11] =  -0.03448403969274
lambda[  12] =   0.00581074484463
lambda[  13] =   0.02268287178761
lambda[  14] =   0.02933391020030
lambda[  15] =   0.03588143832891
==subpsace eigenproblem: bcast eigvals took 0.077 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 4.250 ms
rank =  0, Distributing orbital back into band + domain format took 14.141 ms
rank = 0, Subspace_Rotation used 18.405 ms

Total time for subspace rotation: 18.411 ms
rank = 0, Efermi =  -0.156208936499 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.032 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.407 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.236 ms
rank = 0, Calculating density took 1479.014 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.736 ms
rank = 0, D2D took 0.958 ms
rank = 0, Transfering density took 0.964 ms
Etot    =   -43.949550452233
Eband   =   -10.196528959931
E1      =    20.717790991571
E2      =   -10.246668044658
E3      =   -12.936882510066
Exc     =   -11.601135969243
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 1.586e-05, dEband = 2.486e-03
rank = 0, Calculating/Estimating energy took 1.155 ms, Etot = -43.949550452, dEtot = 1.586e-05, dEband = 2.486e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0797135355266, which took 0.071 ms

iter_count = 108, r_2norm = 3.018e-06, tol*||rhs|| = 3.189e-06

Anderson update took 64.640 ms, out of which F'*F took 28.477 ms; b-Ax took 197.328 ms, out of which Lap took 173.316 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 475.957 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366004, int_b + int_rho = -9.459e-14, checking this took 0.115 ms
2-norm of RHS = 540.3129762446514, which took 0.181 ms

iter_count = 192, r_2norm = 4.654e-04, tol*||rhs|| = 5.403e-04

Anderson update took 114.551 ms, out of which F'*F took 55.562 ms; b-Ax took 376.743 ms, out of which Lap took 335.326 ms
Solving Poisson took 815.630 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.123069 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.100751 
Total time for convolution: 	 convolve: 5.091314 
Total time for convolution: 	 convolve: 5.097332 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.700 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.945 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.371 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.338 ms

This SCF took 27153.429 ms, scf error = 3.483e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.135881, lowerbound = -1.142410, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1396.199 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.642 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.416 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 18.086 ms
rank =  0, finding HY took 22.163 ms
rank =  0, distributing HY into block cyclic form took 14.202 ms
rank =  0, finding Y'*HY took 4.590 ms
Rank 0, Project_Hamiltonian used 59.070 ms
Total time for projection: 59.088 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -1.141912669151436
    last  calculated eigval = 0.035809831077839
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.14191266915144
lambda[   2] =  -0.97629080378791
lambda[   3] =  -0.62595514839752
lambda[   4] =  -0.51372378069744
lambda[   5] =  -0.46311939091075
lambda[   6] =  -0.45428854291085
lambda[   7] =  -0.36789761588400
lambda[   8] =  -0.31261505349283
lambda[   9] =  -0.23826559688679
lambda[  10] =  -0.12627087730287
lambda[  11] =  -0.03300446734736
lambda[  12] =   0.00628927915819
lambda[  13] =   0.02309458923688
lambda[  14] =   0.02903329692406
lambda[  15] =   0.03580983107784
==subpsace eigenproblem: bcast eigvals took 0.057 ms
Total time for solving subspace eigenvalue problem: 0.225 ms
rank =  0, subspace rotation using ScaLAPACK took 4.251 ms
rank =  0, Distributing orbital back into band + domain format took 14.039 ms
rank = 0, Subspace_Rotation used 18.304 ms

Total time for subspace rotation: 18.308 ms
rank = 0, Efermi =  -0.155778131810 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.110 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.458 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.207 ms
rank = 0, Calculating density took 1481.702 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.745 ms
rank = 0, D2D took 0.992 ms
rank = 0, Transfering density took 0.997 ms
Etot    =   -43.949596028163
Eband   =   -10.188137205964
E1      =    20.713532760010
E2      =   -10.242361390376
E3      =   -12.937492930760
Exc     =   -11.601618833991
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 1.139e-05, dEband = 2.098e-03
rank = 0, Calculating/Estimating energy took 1.957 ms, Etot = -43.949596028, dEtot = 1.139e-05, dEband = 2.098e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0537890692427, which took 0.105 ms

iter_count = 108, r_2norm = 1.692e-06, tol*||rhs|| = 2.152e-06

Anderson update took 64.368 ms, out of which F'*F took 28.259 ms; b-Ax took 196.949 ms, out of which Lap took 172.972 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 476.159 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366015, int_b + int_rho = 1.455e-14, checking this took 0.138 ms
2-norm of RHS = 540.3196545489644, which took 0.108 ms

iter_count = 186, r_2norm = 4.839e-04, tol*||rhs|| = 5.403e-04

Anderson update took 110.824 ms, out of which F'*F took 53.468 ms; b-Ax took 366.424 ms, out of which Lap took 326.354 ms
Solving Poisson took 790.880 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.103290 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.445 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.100512 
Total time for convolution: 	 convolve: 5.097001 
Total time for convolution: 	 convolve: 5.092581 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 0.953 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.372 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.347 ms

This SCF took 27141.014 ms, scf error = 2.550e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.135810, lowerbound = -1.141913, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1393.866 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.600 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.507 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 18.138 ms
rank =  0, finding HY took 22.258 ms
rank =  0, distributing HY into block cyclic form took 14.166 ms
rank =  0, finding Y'*HY took 4.645 ms
Rank 0, Project_Hamiltonian used 59.242 ms
Total time for projection: 59.256 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -1.141422115711394
    last  calculated eigval = 0.036337882987385
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.14142211571139
lambda[   2] =  -0.97592586795744
lambda[   3] =  -0.62555086300666
lambda[   4] =  -0.51330014157190
lambda[   5] =  -0.46265972070062
lambda[   6] =  -0.45388737094175
lambda[   7] =  -0.36750400155703
lambda[   8] =  -0.31226313894722
lambda[   9] =  -0.23785462101088
lambda[  10] =  -0.12583484757570
lambda[  11] =  -0.03062293755740
lambda[  12] =   0.00695197130846
lambda[  13] =   0.02404180948487
lambda[  14] =   0.02975460215349
lambda[  15] =   0.03633788298739
==subpsace eigenproblem: bcast eigvals took 0.066 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 4.232 ms
rank =  0, Distributing orbital back into band + domain format took 14.136 ms
rank = 0, Subspace_Rotation used 18.383 ms

Total time for subspace rotation: 18.388 ms
rank = 0, Efermi =  -0.155342102004 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.052 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.465 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.214 ms
rank = 0, Calculating density took 1479.584 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.987 ms
rank = 0, D2D took 2.097 ms
rank = 0, Transfering density took 2.102 ms
Etot    =   -43.949629465765
Eband   =   -10.180735684529
E1      =    20.709806430562
E2      =   -10.238561681409
E3      =   -12.937973427905
Exc     =   -11.602008251759
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 8.359e-06, dEband = 1.850e-03
rank = 0, Calculating/Estimating energy took 0.992 ms, Etot = -43.949629466, dEtot = 8.359e-06, dEband = 1.850e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0340718942094, which took 0.057 ms

iter_count = 114, r_2norm = 8.775e-07, tol*||rhs|| = 1.363e-06

Anderson update took 67.890 ms, out of which F'*F took 29.897 ms; b-Ax took 208.616 ms, out of which Lap took 182.021 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 502.105 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366003, int_b + int_rho = -1.055e-13, checking this took 0.110 ms
2-norm of RHS = 540.3218579433187, which took 0.102 ms

iter_count = 156, r_2norm = 4.749e-04, tol*||rhs|| = 5.403e-04

Anderson update took 92.807 ms, out of which F'*F took 45.112 ms; b-Ax took 308.236 ms, out of which Lap took 274.541 ms
Solving Poisson took 662.809 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.095174 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.275 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.184170 
Total time for convolution: 	 convolve: 5.091941 
Total time for convolution: 	 convolve: 5.093529 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.117 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
---Transfer Veff_loc: D2D took 0.970 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.376 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.368 ms

This SCF took 27088.924 ms, scf error = 1.627e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136338, lowerbound = -1.141422, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1420.171 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.615 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.581 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 18.219 ms
rank =  0, finding HY took 22.276 ms
rank =  0, distributing HY into block cyclic form took 14.102 ms
rank =  0, finding Y'*HY took 4.718 ms
Rank 0, Project_Hamiltonian used 59.346 ms
Total time for projection: 59.360 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -1.141191806516915
    last  calculated eigval = 0.036580814652488
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.14119180651692
lambda[   2] =  -0.97569544286271
lambda[   3] =  -0.62533431118315
lambda[   4] =  -0.51308424567271
lambda[   5] =  -0.46243921491356
lambda[   6] =  -0.45367635947099
lambda[   7] =  -0.36728973089014
lambda[   8] =  -0.31203785610494
lambda[   9] =  -0.23764817144509
lambda[  10] =  -0.12562633665532
lambda[  11] =  -0.02962053078971
lambda[  12] =   0.00716588062877
lambda[  13] =   0.02447323813429
lambda[  14] =   0.02999690889364
lambda[  15] =   0.03658081465249
==subpsace eigenproblem: bcast eigvals took 0.087 ms
Total time for solving subspace eigenvalue problem: 0.245 ms
rank =  0, subspace rotation using ScaLAPACK took 4.240 ms
rank =  0, Distributing orbital back into band + domain format took 14.061 ms
rank = 0, Subspace_Rotation used 18.315 ms

Total time for subspace rotation: 18.327 ms
rank = 0, Efermi =  -0.155133591113 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 4.109 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.809 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.199 ms
rank = 0, Calculating density took 1505.832 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.760 ms
rank = 0, D2D took 0.974 ms
rank = 0, Transfering density took 0.978 ms
Etot    =   -43.949645441838
Eband   =   -10.176794279836
E1      =    20.707796005057
E2      =   -10.236545307641
E3      =   -12.938297444657
Exc     =   -11.602262850002
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 3.994e-06, dEband = 9.854e-04
rank = 0, Calculating/Estimating energy took 1.152 ms, Etot = -43.949645442, dEtot = 3.994e-06, dEband = 9.854e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0251361391672, which took 0.066 ms

iter_count = 108, r_2norm = 8.122e-07, tol*||rhs|| = 1.005e-06

Anderson update took 64.003 ms, out of which F'*F took 28.523 ms; b-Ax took 197.629 ms, out of which Lap took 173.432 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 478.682 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366010, int_b + int_rho = -4.002e-14, checking this took 0.109 ms
2-norm of RHS = 540.3300250287188, which took 0.156 ms

iter_count = 168, r_2norm = 4.546e-04, tol*||rhs|| = 5.403e-04

Anderson update took 100.899 ms, out of which F'*F took 48.651 ms; b-Ax took 330.578 ms, out of which Lap took 294.762 ms
Solving Poisson took 715.410 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.094671 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.955 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.096253 
Total time for convolution: 	 convolve: 5.103450 
Total time for convolution: 	 convolve: 5.093265 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.533 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 0.929 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.371 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.322 ms

This SCF took 27077.122 ms, scf error = 1.244e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136581, lowerbound = -1.141192, upperbound = 267.572711

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1399.842 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.544 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.502 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 18.087 ms
rank =  0, finding HY took 22.161 ms
rank =  0, distributing HY into block cyclic form took 14.206 ms
rank =  0, finding Y'*HY took 4.601 ms
Rank 0, Project_Hamiltonian used 59.087 ms
Total time for projection: 59.102 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -1.140970027929819
    last  calculated eigval = 0.037242083426944
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.14097002792982
lambda[   2] =  -0.97545965322639
lambda[   3] =  -0.62510021046966
lambda[   4] =  -0.51285230186727
lambda[   5] =  -0.46220478944738
lambda[   6] =  -0.45345179102939
lambda[   7] =  -0.36706293334452
lambda[   8] =  -0.31179869595419
lambda[   9] =  -0.23743087415656
lambda[  10] =  -0.12540452520726
lambda[  11] =  -0.02755998979831
lambda[  12] =   0.00736829319376
lambda[  13] =   0.02570201704663
lambda[  14] =   0.03114180156241
lambda[  15] =   0.03724208342694
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 4.184 ms
rank =  0, Distributing orbital back into band + domain format took 14.910 ms
rank = 0, Subspace_Rotation used 19.110 ms

Total time for subspace rotation: 19.115 ms
rank = 0, Efermi =  -0.154911779734 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.035 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.160 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.229 ms
rank = 0, Calculating density took 1485.780 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.780 ms
rank = 0, D2D took 0.889 ms
rank = 0, Transfering density took 0.892 ms
Etot    =   -43.949667737272
Eband   =   -10.172662556563
E1      =    20.705949538765
E2      =   -10.234200078902
E3      =   -12.938466795722
Exc     =   -11.602394524744
Esc     =   -66.053227068939
Entropy =    -0.000000000415
dE = 5.574e-06, dEband = 1.033e-03
rank = 0, Calculating/Estimating energy took 1.006 ms, Etot = -43.949667737, dEtot = 5.574e-06, dEband = 1.033e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0170028850924, which took 0.116 ms

iter_count = 108, r_2norm = 6.653e-07, tol*||rhs|| = 6.801e-07

Anderson update took 64.090 ms, out of which F'*F took 28.583 ms; b-Ax took 200.008 ms, out of which Lap took 175.860 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 477.308 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001366013, int_rho =  18.00000001366011, int_b + int_rho = -2.910e-14, checking this took 0.115 ms
2-norm of RHS = 540.3331698017564, which took 0.140 ms

iter_count = 138, r_2norm = 5.256e-04, tol*||rhs|| = 5.403e-04

Anderson update took 82.145 ms, out of which F'*F took 39.886 ms; b-Ax took 273.120 ms, out of which Lap took 243.425 ms
Solving Poisson took 586.922 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.104999 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.997 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.104832 
Total time for convolution: 	 convolve: 5.105786 
Total time for convolution: 	 convolve: 5.090764 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.839 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.942 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.370 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.333 ms

This SCF took 26943.956 ms, scf error = 8.274e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -1.14097002792982, occ[   1] =   2.00000000000000
lambda[   2] =  -0.97545965322639, occ[   2] =   2.00000000000000
lambda[   3] =  -0.62510021046966, occ[   3] =   2.00000000000000
lambda[   4] =  -0.51285230186727, occ[   4] =   2.00000000000000
lambda[   5] =  -0.46220478944738, occ[   5] =   2.00000000000000
lambda[   6] =  -0.45345179102939, occ[   6] =   2.00000000000000
lambda[   7] =  -0.36706293334452, occ[   7] =   2.00000000000000
lambda[   8] =  -0.31179869595419, occ[   8] =   2.00000000000000
lambda[   9] =  -0.23743087415656, occ[   9] =   2.00000000000000
lambda[  10] =  -0.12540452520726, occ[  10] =   0.00000001366010
lambda[  11] =  -0.02755998979831, occ[  11] =   0.00000000000000
lambda[  12] =   0.00736829319376, occ[  12] =   0.00000000000000
lambda[  13] =   0.02570201704663, occ[  13] =   0.00000000000000
lambda[  14] =   0.03114180156241, occ[  14] =   0.00000000000000
lambda[  15] =   0.03724208342694, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.061 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.423 ms, time for Allreduce/Reduce: 5.936 ms 
Time for calculating local force components: 14.542 ms
Start Calculating nonlocal forces
force_nloc = 
  0.35911309148732   0.92269137854455   0.00000324537477
  1.30804996303097   0.36243455415910  -0.00000029379264
 -0.06740770933280  -0.03170782849887   0.00000000826861
 -0.59392915857069  -0.95781913514439  -0.00000064619813
force_loc = 
 -0.33870713152957  -0.91094319110691  -0.00000521293198
 -1.28881966982062  -0.35668860317651  -0.00000682869918
  0.07055660042774   0.03320466293490   0.00000018308781
  0.58414552891762   0.94122745495091  -0.00002867343133
Time for calculating nonlocal force components: 32.373 ms
[32mforces_xc: 
[0m[32m -0.01111287795826  -0.02670069118650  -0.00000034025495
[0m[32m -0.03146370124097  -0.00776339135364  -0.00000019910498
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00890770359488   0.03208003998467  -0.00000114702345
[0mTime for calculating XC forces components: 17.129 ms
 Cartesian force = 
  0.00945992224809  -0.01495631627569   0.00000766836419
 -0.01206656778203  -0.00202125289787   0.00000265457957
  0.00331573134354   0.00149302190920   0.00001016753279
 -0.00070908580959   0.01548454726436  -0.00002049047655
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.351 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Time for printing density: 386.290 ms
The program took 416.249 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:10
Job ID:        2266583
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:26:00,vmem=8440K,walltime=00:07:10,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-22-2
---------------------------------------
