---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:27
Job ID:    2266927
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:33
Job ID:    2266927
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.088 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 19.012 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 0.008 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 22.783 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 54.767 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.938 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.095 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.312104	   12.139848	   10.000000	
   11.809692	   11.933785	   10.000000	
    8.190308	    7.860152	   10.000000	
   10.000750	   10.935764	   10.000000	
   10.000750	    8.541902	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.006 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.174 ms
Set up communicators.

--set up spincomm took 2.273 ms

--set up kptcomm took 0.328 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.007 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 12, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 12 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 1), actual size (1000000, 1)
rank = 0, mb = nb = 12, mbQ = nbQ = 64
rank = 0, nr_Hp = 12, nc_Hp = 12
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.149 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.896 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 1
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.938 ms

Calculate_SplineDerivRadFun took 0.182 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.705 ms.
time spent on vectorized spline interp: 2.674 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.832 ms.
time spent on vectorized spline interp: 1.476 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.314 ms.
time spent on vectorized spline interp: 1.488 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.317 ms.

Calculating rb for all atom types took 14.813 ms
----------------------
Estimated memory usage
Total: 839.24 MB
orbitals             : 549.32 MB
global sized vectors : 213.62 MB
subspace matrices : 3.38 kB
others : 76.29 MB
----------------------------------------------
Estimated memory usage per processor: 69.94 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.935 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -12.0000000126870, sum_int_rho = 11.6998250078045
PosCharge = 12.000000012687, NegCharge = -11.699825007804, scal_fac = 1.025656367055
After scaling, int_rho = 12.0000000126870, PosCharge + NegCharge - NetCharge = 5.329e-15
--Calculate Vref took 0.238 ms
--Calculate rho_guess took 1.260 ms

 integral of b = -12.0000000126870,
 int{b} + Nelectron + NetCharge = -1.269e-08,
 Esc = -31.2818721769951,
 MPI_Reduce took 1.293 ms

Calculating b & b_ref took 7.196 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.090 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.111 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.029 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.271 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 20.417 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268694, int_b + int_rho = 1.091e-14, checking this took 0.088 ms
2-norm of RHS = 536.2827982923679, which took 0.817 ms

iter_count = 420, r_2norm = 4.681e-04, tol*||rhs|| = 5.363e-04

Anderson update took 183.424 ms, out of which F'*F took 90.856 ms; b-Ax took 597.845 ms, out of which Lap took 547.899 ms
Solving Poisson took 1142.716 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.772 ms
Total time for convolution: 	 convolve: 4.803875 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
Total time for convolution: 	 convolve: 4.787278 
Total time for convolution: 	 convolve: 4.757298 
Total time for convolution: 	 convolve: 4.802890 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.721 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.503 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.152 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.377 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
rank = 0, XC calculation took 22739.208 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 4.977 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.204 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 15.249 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.012 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.402 ms
    Lanczos iter 53, eigmin  = -0.937912327, eigmax = 264.922686640, err_eigmin = 7.985e-04, err_eigmax = 9.714e-03
rank =   0, Lanczos took 90.994 ms, eigmin = -0.937912326850, eigmax = 267.571913506728

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.267001, lowerbound = -1.037912, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 652.400 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.969 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.306 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.286 ms
rank =  0, finding HY took 12.148 ms
rank =  0, distributing HY into block cyclic form took 7.747 ms
rank =  0, finding Y'*HY took 2.622 ms
Rank 0, Project_Hamiltonian used 32.824 ms
Total time for projection: 32.834 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.251 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.365 ms
    first calculated eigval = 2.833437750050116
    last  calculated eigval = 3.201215459942550
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =   2.83343775005012
lambda[   2] =   2.86018569786804
lambda[   3] =   2.89607755536095
lambda[   4] =   2.92436514452628
lambda[   5] =   2.96845641749929
lambda[   6] =   2.98990471808408
lambda[   7] =   3.03111585514157
lambda[   8] =   3.04436333417862
lambda[   9] =   3.09168079429469
lambda[  10] =   3.11538692354057
lambda[  11] =   3.14786846817861
lambda[  12] =   3.20121545994255
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.377 ms
rank =  0, subspace rotation using ScaLAPACK took 1.649 ms
rank =  0, Distributing orbital back into band + domain format took 9.937 ms
rank = 0, Subspace_Rotation used 11.600 ms

Total time for subspace rotation: 11.604 ms
rank = 0, Efermi =   3.010510393051 calculate fermi energy took 0.074 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.301215, lowerbound = -1.037912, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 657.394 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 6.972 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.285 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.267 ms
rank =  0, finding HY took 11.231 ms
rank =  0, distributing HY into block cyclic form took 6.909 ms
rank =  0, finding Y'*HY took 2.575 ms
Rank 0, Project_Hamiltonian used 30.005 ms
Total time for projection: 30.015 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -0.706462636041155
    last  calculated eigval = 0.434832191681909
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.70646263604115
lambda[   2] =  -0.28283735030222
lambda[   3] =  -0.02290548461033
lambda[   4] =   0.04274565497431
lambda[   5] =   0.11588085280213
lambda[   6] =   0.30963693892487
lambda[   7] =   0.32691261699478
lambda[   8] =   0.35339144523987
lambda[   9] =   0.35695948523756
lambda[  10] =   0.38274345106255
lambda[  11] =   0.41811367434714
lambda[  12] =   0.43483219168191
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 1.859 ms
rank =  0, Distributing orbital back into band + domain format took 6.760 ms
rank = 0, Subspace_Rotation used 8.628 ms

Total time for subspace rotation: 8.632 ms
rank = 0, Efermi =   0.318274778124 calculate fermi energy took 0.025 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.534832, lowerbound = -1.037912, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 654.908 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 6.971 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.165 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.145 ms
rank =  0, finding HY took 11.284 ms
rank =  0, distributing HY into block cyclic form took 6.848 ms
rank =  0, finding Y'*HY took 2.554 ms
Rank 0, Project_Hamiltonian used 29.861 ms
Total time for projection: 29.865 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.006 ms
rank = 0, Solve_Generalized_EigenProblem used 1.107 ms
    first calculated eigval = -0.943621564720735
    last  calculated eigval = 0.146895075347627
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.94362156472074
lambda[   2] =  -0.65514472396516
lambda[   3] =  -0.54727593049022
lambda[   4] =  -0.47572537859587
lambda[   5] =  -0.37625619315222
lambda[   6] =  -0.27320559501166
lambda[   7] =  -0.04938981419918
lambda[   8] =   0.07383845075967
lambda[   9] =   0.09581462808285
lambda[  10] =   0.10119168143521
lambda[  11] =   0.11511107448293
lambda[  12] =   0.14689507534763
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 1.115 ms
rank =  0, subspace rotation using ScaLAPACK took 1.868 ms
rank =  0, Distributing orbital back into band + domain format took 6.777 ms
rank = 0, Subspace_Rotation used 8.654 ms

Total time for subspace rotation: 8.657 ms
rank = 0, Efermi =  -0.078962721061 calculate fermi energy took 0.025 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.246895, lowerbound = -1.037912, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 655.057 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 6.925 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.183 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.118 ms
rank =  0, finding HY took 11.236 ms
rank =  0, distributing HY into block cyclic form took 6.911 ms
rank =  0, finding Y'*HY took 2.585 ms
Rank 0, Project_Hamiltonian used 29.866 ms
Total time for projection: 29.870 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -0.943821607122892
    last  calculated eigval = 0.087189117432800
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.94382160712289
lambda[   2] =  -0.65926162151943
lambda[   3] =  -0.55507718757256
lambda[   4] =  -0.48398065694725
lambda[   5] =  -0.38806270639437
lambda[   6] =  -0.33264605259293
lambda[   7] =  -0.13213838176021
lambda[   8] =   0.02379487617539
lambda[   9] =   0.04024256617586
lambda[  10] =   0.05173222129493
lambda[  11] =   0.06153441300253
lambda[  12] =   0.08718911743280
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 1.876 ms
rank =  0, Distributing orbital back into band + domain format took 6.757 ms
rank = 0, Subspace_Rotation used 8.643 ms

Total time for subspace rotation: 8.647 ms
rank = 0, Efermi =  -0.161711288645 calculate fermi energy took 0.023 ms
rank = 0, --- Calculate rho: sum over local bands took 1.565 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.744 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.554 ms
rank = 0, Calculating density took 2887.886 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.656 ms
rank = 0, D2D took 1.799 ms
rank = 0, Transfering density took 1.804 ms
Etot    =   -18.208801904899
Eband   =    -6.725699665975
E1      =    13.832145371178
E2      =    -5.235513863999
E3      =    -6.669301425043
Exc     =    -5.938190721762
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 3.642e+00, dEband = 1.345e+00
rank = 0, Calculating/Estimating energy took 0.806 ms, Etot = -18.208801905, dEtot = 3.642e+00, dEband = 1.345e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 39.0229949389111, which took 0.079 ms

iter_count = 96, r_2norm = 1.179e-03, tol*||rhs|| = 1.561e-03

Anderson update took 39.382 ms, out of which F'*F took 20.747 ms; b-Ax took 135.794 ms, out of which Lap took 124.457 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 261.788 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268697, int_b + int_rho = 4.184e-14, checking this took 0.077 ms
2-norm of RHS = 533.0117770754920, which took 0.078 ms

iter_count = 288, r_2norm = 4.082e-04, tol*||rhs|| = 5.330e-04

Anderson update took 117.639 ms, out of which F'*F took 61.357 ms; b-Ax took 402.720 ms, out of which Lap took 369.388 ms
Solving Poisson took 769.465 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.359 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Total time for convolution: 	 convolve: 4.718861 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.572 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 4.772176 
Total time for convolution: 	 convolve: 4.713500 
Total time for convolution: 	 convolve: 4.714573 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.150 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.161 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.569 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.251 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.849 ms

This SCF took 26552.106 ms, scf error = 1.877e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.187189, lowerbound = -0.943822, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 656.309 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.064 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.218 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.292 ms
rank =  0, finding HY took 11.308 ms
rank =  0, distributing HY into block cyclic form took 6.926 ms
rank =  0, finding Y'*HY took 2.609 ms
Rank 0, Project_Hamiltonian used 31.159 ms
Total time for projection: 31.173 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.906047200923095
    last  calculated eigval = 0.060481243481871
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.90604720092309
lambda[   2] =  -0.63276826693803
lambda[   3] =  -0.52526347857671
lambda[   4] =  -0.45448555970156
lambda[   5] =  -0.36032800437005
lambda[   6] =  -0.29942746069216
lambda[   7] =  -0.11435687303841
lambda[   8] =  -0.01258376901245
lambda[   9] =   0.01207660566823
lambda[  10] =   0.02607557506492
lambda[  11] =   0.03770838778774
lambda[  12] =   0.06048124348187
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 1.883 ms
rank =  0, Distributing orbital back into band + domain format took 6.799 ms
rank = 0, Subspace_Rotation used 8.691 ms

Total time for subspace rotation: 8.694 ms
rank = 0, Efermi =  -0.143929779909 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 1.610 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.691 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.596 ms
rank = 0, Calculating density took 709.373 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.727 ms
rank = 0, D2D took 1.858 ms
rank = 0, Transfering density took 1.859 ms
Etot    =   -18.181025962150
Eband   =    -6.356639943854
E1      =    13.507172850915
E2      =    -5.199855791859
E3      =    -6.768451532199
Exc     =    -6.017994015887
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 5.555e-03, dEband = 7.381e-02
rank = 0, Calculating/Estimating energy took 1.524 ms, Etot = -18.181025962, dEtot = 5.555e-03, dEband = 7.381e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 14.9421144038045, which took 0.043 ms

iter_count = 102, r_2norm = 4.181e-04, tol*||rhs|| = 5.977e-04

Anderson update took 41.255 ms, out of which F'*F took 21.765 ms; b-Ax took 142.738 ms, out of which Lap took 130.620 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 278.400 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268695, int_b + int_rho = 2.001e-14, checking this took 0.077 ms
2-norm of RHS = 528.9469123105214, which took 0.087 ms

iter_count = 300, r_2norm = 4.311e-04, tol*||rhs|| = 5.289e-04

Anderson update took 124.306 ms, out of which F'*F took 63.781 ms; b-Ax took 417.698 ms, out of which Lap took 383.264 ms
Solving Poisson took 799.945 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Total time for convolution: 	 convolve: 4.707124 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 44.698 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 4.717106 
Total time for convolution: 	 convolve: 4.722221 
Total time for convolution: 	 convolve: 4.728946 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.496 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.256 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.791 ms

This SCF took 24432.662 ms, scf error = 1.289e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.160481, lowerbound = -0.906047, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 653.190 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.048 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.964 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.025 ms
rank =  0, finding HY took 11.517 ms
rank =  0, distributing HY into block cyclic form took 6.934 ms
rank =  0, finding Y'*HY took 2.570 ms
Rank 0, Project_Hamiltonian used 32.072 ms
Total time for projection: 32.084 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.168 ms
    first calculated eigval = -0.850800767958426
    last  calculated eigval = 0.044584605816461
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.85080076795843
lambda[   2] =  -0.58686318929347
lambda[   3] =  -0.47601110126466
lambda[   4] =  -0.40523837137335
lambda[   5] =  -0.32024715210731
lambda[   6] =  -0.25005371674094
lambda[   7] =  -0.07804261428996
lambda[   8] =  -0.02762398217891
lambda[   9] =   0.00279280545762
lambda[  10] =   0.01982164487125
lambda[  11] =   0.02641481938701
lambda[  12] =   0.04458460581646
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 1.904 ms
rank =  0, Distributing orbital back into band + domain format took 6.746 ms
rank = 0, Subspace_Rotation used 8.658 ms

Total time for subspace rotation: 8.662 ms
rank = 0, Efermi =  -0.107615521154 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 1.585 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.692 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.575 ms
rank = 0, Calculating density took 707.083 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.722 ms
rank = 0, D2D took 1.879 ms
rank = 0, Transfering density took 1.881 ms
Etot    =   -18.158258311648
Eband   =    -5.778428598466
E1      =    13.017592597766
E2      =    -5.098841628425
E3      =    -6.946390169589
Exc     =    -6.160781931580
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 4.554e-03, dEband = 1.156e-01
rank = 0, Calculating/Estimating energy took 0.762 ms, Etot = -18.158258312, dEtot = 4.554e-03, dEband = 1.156e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.7232323210159, which took 0.043 ms

iter_count = 102, r_2norm = 1.779e-04, tol*||rhs|| = 1.889e-04

Anderson update took 41.767 ms, out of which F'*F took 21.736 ms; b-Ax took 141.746 ms, out of which Lap took 130.330 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 278.925 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268700, int_b + int_rho = 6.730e-14, checking this took 0.076 ms
2-norm of RHS = 529.0041896614345, which took 0.085 ms

iter_count = 276, r_2norm = 4.254e-04, tol*||rhs|| = 5.290e-04

Anderson update took 113.517 ms, out of which F'*F took 58.026 ms; b-Ax took 383.794 ms, out of which Lap took 350.600 ms
Solving Poisson took 735.128 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 4.768945 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 4.723360 
Total time for convolution: 	 convolve: 4.724035 
Total time for convolution: 	 convolve: 4.743721 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.262 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.389 ms
---Transfer Veff_loc: D2D took 3.505 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.249 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.783 ms

This SCF took 24402.215 ms, scf error = 4.478e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.144585, lowerbound = -0.850801, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 656.969 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.078 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.225 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.314 ms
rank =  0, finding HY took 11.064 ms
rank =  0, distributing HY into block cyclic form took 7.022 ms
rank =  0, finding Y'*HY took 2.778 ms
Rank 0, Project_Hamiltonian used 31.214 ms
Total time for projection: 31.229 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.842334960071139
    last  calculated eigval = 0.035635848889560
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.84233496007114
lambda[   2] =  -0.57472562371337
lambda[   3] =  -0.46438652148946
lambda[   4] =  -0.39303874653851
lambda[   5] =  -0.31432481311306
lambda[   6] =  -0.24155707678105
lambda[   7] =  -0.07175335470019
lambda[   8] =  -0.03189147100979
lambda[   9] =  -0.00035568236727
lambda[  10] =   0.01898235385407
lambda[  11] =   0.02225156975556
lambda[  12] =   0.03563584888956
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 1.921 ms
rank =  0, Distributing orbital back into band + domain format took 6.774 ms
rank = 0, Subspace_Rotation used 8.705 ms

Total time for subspace rotation: 8.709 ms
rank = 0, Efermi =  -0.101326261582 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 1.377 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.342 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.970 ms
rank = 0, Calculating density took 711.923 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.869 ms
rank = 0, D2D took 2.004 ms
rank = 0, Transfering density took 2.006 ms
Etot    =   -18.155612212142
Eband   =    -5.660735484324
E1      =    12.941987621043
E2      =    -5.049102760351
E3      =    -6.990552908203
Exc     =    -6.194647840034
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 5.292e-04, dEband = 2.354e-02
rank = 0, Calculating/Estimating energy took 0.749 ms, Etot = -18.155612212, dEtot = 5.292e-04, dEband = 2.354e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.1347684498716, which took 0.124 ms

iter_count = 114, r_2norm = 2.959e-05, tol*||rhs|| = 4.539e-05

Anderson update took 46.817 ms, out of which F'*F took 24.351 ms; b-Ax took 160.568 ms, out of which Lap took 147.180 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 312.894 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268696, int_b + int_rho = 3.092e-14, checking this took 0.078 ms
2-norm of RHS = 529.4379891130694, which took 0.092 ms

iter_count = 264, r_2norm = 4.609e-04, tol*||rhs|| = 5.294e-04

Anderson update took 108.552 ms, out of which F'*F took 55.772 ms; b-Ax took 369.379 ms, out of which Lap took 338.107 ms
Solving Poisson took 707.978 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Total time for convolution: 	 convolve: 4.718971 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.300 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 4.759748 
Total time for convolution: 	 convolve: 4.729310 
Total time for convolution: 	 convolve: 4.749605 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.151 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.391 ms
---Transfer Veff_loc: D2D took 3.509 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.725 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.267 ms

This SCF took 24435.673 ms, scf error = 1.700e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.135636, lowerbound = -0.842335, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 653.945 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.450 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.224 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.686 ms
rank =  0, finding HY took 11.035 ms
rank =  0, distributing HY into block cyclic form took 7.138 ms
rank =  0, finding Y'*HY took 2.622 ms
Rank 0, Project_Hamiltonian used 31.505 ms
Total time for projection: 31.517 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.074 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -0.838647578960448
    last  calculated eigval = 0.030191680171627
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.83864757896045
lambda[   2] =  -0.57006272518360
lambda[   3] =  -0.45996659854330
lambda[   4] =  -0.38831525888379
lambda[   5] =  -0.31157347752855
lambda[   6] =  -0.23655732065079
lambda[   7] =  -0.06931879943037
lambda[   8] =  -0.03333786006982
lambda[   9] =  -0.00164246316740
lambda[  10] =   0.01860843774586
lambda[  11] =   0.02042067747574
lambda[  12] =   0.03019168017163
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 1.914 ms
rank =  0, Distributing orbital back into band + domain format took 6.747 ms
rank = 0, Subspace_Rotation used 8.689 ms

Total time for subspace rotation: 8.694 ms
rank = 0, Efermi =  -0.098891706275 calculate fermi energy took 1.779 ms
rank = 0, --- Calculate rho: sum over local bands took 1.974 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.878 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.527 ms
rank = 0, Calculating density took 708.545 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.724 ms
rank = 0, D2D took 1.857 ms
rank = 0, Transfering density took 1.859 ms
Etot    =   -18.154868307425
Eband   =    -5.610245920380
E1      =    12.923080081347
E2      =    -5.012941654615
E3      =    -7.008534134613
Exc     =    -6.207306080239
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 1.488e-04, dEband = 1.010e-02
rank = 0, Calculating/Estimating energy took 0.777 ms, Etot = -18.154868307, dEtot = 1.488e-04, dEband = 1.010e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7060297888510, which took 0.093 ms

iter_count = 108, r_2norm = 2.606e-05, tol*||rhs|| = 2.824e-05

Anderson update took 43.346 ms, out of which F'*F took 23.024 ms; b-Ax took 150.817 ms, out of which Lap took 137.560 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 294.489 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268698, int_b + int_rho = 4.729e-14, checking this took 0.077 ms
2-norm of RHS = 529.6316946130379, which took 0.086 ms

iter_count = 240, r_2norm = 4.325e-04, tol*||rhs|| = 5.296e-04

Anderson update took 97.061 ms, out of which F'*F took 51.023 ms; b-Ax took 337.301 ms, out of which Lap took 308.554 ms
Solving Poisson took 642.408 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Total time for convolution: 	 convolve: 4.757592 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 4.730196 
Total time for convolution: 	 convolve: 4.739062 
Total time for convolution: 	 convolve: 4.722085 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.157 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.396 ms
---Transfer Veff_loc: D2D took 3.546 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.094 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.673 ms

This SCF took 24322.016 ms, scf error = 5.906e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.130192, lowerbound = -0.838648, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 656.170 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.891 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.232 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.133 ms
rank =  0, finding HY took 11.112 ms
rank =  0, distributing HY into block cyclic form took 7.158 ms
rank =  0, finding Y'*HY took 2.546 ms
Rank 0, Project_Hamiltonian used 30.970 ms
Total time for projection: 30.982 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.124 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -0.837131952480476
    last  calculated eigval = 0.027652884645141
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.83713195248048
lambda[   2] =  -0.56891608580039
lambda[   3] =  -0.45882400455865
lambda[   4] =  -0.38712201479096
lambda[   5] =  -0.31007510481897
lambda[   6] =  -0.23484135162144
lambda[   7] =  -0.06814501179588
lambda[   8] =  -0.03371699023621
lambda[   9] =  -0.00223162066840
lambda[  10] =   0.01805939116788
lambda[  11] =   0.01990897004823
lambda[  12] =   0.02765288464514
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 1.856 ms
rank =  0, Distributing orbital back into band + domain format took 7.763 ms
rank = 0, Subspace_Rotation used 9.632 ms

Total time for subspace rotation: 9.637 ms
rank = 0, Efermi =  -0.097717918695 calculate fermi energy took 0.066 ms
rank = 0, --- Calculate rho: sum over local bands took 1.650 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.935 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.598 ms
rank = 0, Calculating density took 710.353 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.767 ms
rank = 0, D2D took 1.911 ms
rank = 0, Transfering density took 1.918 ms
Etot    =   -18.154776284300
Eband   =    -5.593821029006
E1      =    12.919114644573
E2      =    -4.999573434574
E3      =    -7.010604009257
Exc     =    -6.208375166316
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 1.840e-05, dEband = 3.285e-03
rank = 0, Calculating/Estimating energy took 0.761 ms, Etot = -18.154776284, dEtot = 1.840e-05, dEband = 3.285e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2810830884887, which took 0.142 ms

iter_count = 114, r_2norm = 7.296e-06, tol*||rhs|| = 1.124e-05

Anderson update took 46.616 ms, out of which F'*F took 24.594 ms; b-Ax took 161.228 ms, out of which Lap took 147.696 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 313.554 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268696, int_b + int_rho = 2.910e-14, checking this took 0.076 ms
2-norm of RHS = 529.8307070732801, which took 0.080 ms

iter_count = 252, r_2norm = 4.823e-04, tol*||rhs|| = 5.298e-04

Anderson update took 102.475 ms, out of which F'*F took 53.938 ms; b-Ax took 358.660 ms, out of which Lap took 328.478 ms
Solving Poisson took 680.125 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Total time for convolution: 	 convolve: 4.714099 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.709 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 4.715838 
Total time for convolution: 	 convolve: 4.716334 
Total time for convolution: 	 convolve: 4.716280 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.514 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.150 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.704 ms
---Transfer Veff_loc: D2D took 3.553 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.078 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.663 ms

This SCF took 24339.907 ms, scf error = 4.113e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.127653, lowerbound = -0.837132, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 653.210 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.773 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.162 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.948 ms
rank =  0, finding HY took 11.136 ms
rank =  0, distributing HY into block cyclic form took 7.088 ms
rank =  0, finding Y'*HY took 2.536 ms
Rank 0, Project_Hamiltonian used 30.733 ms
Total time for projection: 30.744 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.114 ms
rank = 0, Solve_Generalized_EigenProblem used 0.203 ms
    first calculated eigval = -0.832628626412341
    last  calculated eigval = 0.027362173835313
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.83262862641234
lambda[   2] =  -0.56498434821764
lambda[   3] =  -0.45489187367423
lambda[   4] =  -0.38304925450506
lambda[   5] =  -0.30589753989574
lambda[   6] =  -0.23047793396433
lambda[   7] =  -0.06445767764300
lambda[   8] =  -0.03287458677908
lambda[   9] =  -0.00132044085839
lambda[  10] =   0.01824545701595
lambda[  11] =   0.02118102961673
lambda[  12] =   0.02736217383531
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.240 ms
rank =  0, subspace rotation using ScaLAPACK took 1.831 ms
rank =  0, Distributing orbital back into band + domain format took 7.519 ms
rank = 0, Subspace_Rotation used 9.359 ms

Total time for subspace rotation: 9.365 ms
rank = 0, Efermi =  -0.094030584494 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 1.618 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.846 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.560 ms
rank = 0, Calculating density took 706.716 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.724 ms
rank = 0, D2D took 1.877 ms
rank = 0, Transfering density took 1.879 ms
Etot    =   -18.154686563759
Eband   =    -5.543859154156
E1      =    12.894931973542
E2      =    -4.971174249171
E3      =    -7.019713979582
Exc     =    -6.214775434517
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 1.794e-05, dEband = 9.992e-03
rank = 0, Calculating/Estimating energy took 0.796 ms, Etot = -18.154686564, dEtot = 1.794e-05, dEband = 9.992e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1886874277673, which took 0.123 ms

iter_count = 108, r_2norm = 6.094e-06, tol*||rhs|| = 7.547e-06

Anderson update took 45.046 ms, out of which F'*F took 23.107 ms; b-Ax took 150.864 ms, out of which Lap took 139.134 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 294.557 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268700, int_b + int_rho = 7.094e-14, checking this took 0.076 ms
2-norm of RHS = 529.7705862670065, which took 0.081 ms

iter_count = 240, r_2norm = 4.338e-04, tol*||rhs|| = 5.298e-04

Anderson update took 97.687 ms, out of which F'*F took 51.867 ms; b-Ax took 339.777 ms, out of which Lap took 311.620 ms
Solving Poisson took 642.589 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 4.721306 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.326 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 4.760732 
Total time for convolution: 	 convolve: 4.741961 
Total time for convolution: 	 convolve: 4.722174 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.714 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.687 ms
---Transfer Veff_loc: D2D took 3.544 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.101 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.678 ms

This SCF took 24339.874 ms, scf error = 1.911e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.127362, lowerbound = -0.832629, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 654.897 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 8.315 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.227 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.555 ms
rank =  0, finding HY took 11.086 ms
rank =  0, distributing HY into block cyclic form took 7.079 ms
rank =  0, finding Y'*HY took 2.576 ms
Rank 0, Project_Hamiltonian used 31.320 ms
Total time for projection: 31.334 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.115 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.830239413657108
    last  calculated eigval = 0.029004982458781
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.83023941365711
lambda[   2] =  -0.56279891262997
lambda[   3] =  -0.45273441881961
lambda[   4] =  -0.38076468986476
lambda[   5] =  -0.30352816311397
lambda[   6] =  -0.22798222626514
lambda[   7] =  -0.06196811370352
lambda[   8] =  -0.02991984790546
lambda[   9] =   0.00301793021089
lambda[  10] =   0.01910088385010
lambda[  11] =   0.02405187815164
lambda[  12] =   0.02900498245878
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.236 ms
rank =  0, subspace rotation using ScaLAPACK took 1.854 ms
rank =  0, Distributing orbital back into band + domain format took 7.483 ms
rank = 0, Subspace_Rotation used 9.346 ms

Total time for subspace rotation: 9.351 ms
rank = 0, Efermi =  -0.091541020578 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 1.618 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.838 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.547 ms
rank = 0, Calculating density took 708.937 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.716 ms
rank = 0, D2D took 1.859 ms
rank = 0, Transfering density took 1.862 ms
Etot    =   -18.154803629625
Eband   =    -5.516095649487
E1      =    12.880219193749
E2      =    -4.957359880636
E3      =    -7.022768258043
Exc     =    -6.217183135184
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 2.341e-05, dEband = 5.553e-03
rank = 0, Calculating/Estimating energy took 0.783 ms, Etot = -18.154803630, dEtot = 2.341e-05, dEband = 5.553e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1399029904131, which took 0.097 ms

iter_count = 108, r_2norm = 5.303e-06, tol*||rhs|| = 5.596e-06

Anderson update took 44.055 ms, out of which F'*F took 23.367 ms; b-Ax took 152.117 ms, out of which Lap took 140.045 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.155 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268696, int_b + int_rho = 2.728e-14, checking this took 0.073 ms
2-norm of RHS = 529.7835903925642, which took 0.084 ms

iter_count = 192, r_2norm = 4.993e-04, tol*||rhs|| = 5.298e-04

Anderson update took 78.521 ms, out of which F'*F took 41.404 ms; b-Ax took 271.588 ms, out of which Lap took 249.330 ms
Solving Poisson took 514.440 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 4.714795 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 86.792 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 4.719409 
Total time for convolution: 	 convolve: 4.722524 
Total time for convolution: 	 convolve: 4.724982 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.234 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 3.533 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.271 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.838 ms

This SCF took 24208.489 ms, scf error = 1.036e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.129005, lowerbound = -0.830239, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 656.290 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.532 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.252 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.795 ms
rank =  0, finding HY took 11.084 ms
rank =  0, distributing HY into block cyclic form took 47.442 ms
rank =  0, finding Y'*HY took 2.711 ms
Rank 0, Project_Hamiltonian used 72.055 ms
Total time for projection: 72.068 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.123 ms
rank = 0, Solve_Generalized_EigenProblem used 0.195 ms
    first calculated eigval = -0.829933140136144
    last  calculated eigval = 0.029165203490122
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82993314013614
lambda[   2] =  -0.56240646897098
lambda[   3] =  -0.45237755788260
lambda[   4] =  -0.38038748713718
lambda[   5] =  -0.30320786825015
lambda[   6] =  -0.22767791701889
lambda[   7] =  -0.06157976091932
lambda[   8] =  -0.02892077808266
lambda[   9] =   0.00433619660629
lambda[  10] =   0.01915672378257
lambda[  11] =   0.02492543737420
lambda[  12] =   0.02916520349012
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.236 ms
rank =  0, subspace rotation using ScaLAPACK took 1.782 ms
rank =  0, Distributing orbital back into band + domain format took 7.480 ms
rank = 0, Subspace_Rotation used 9.273 ms

Total time for subspace rotation: 9.278 ms
rank = 0, Efermi =  -0.091152667764 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 1.615 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.960 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.573 ms
rank = 0, Calculating density took 751.158 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.719 ms
rank = 0, D2D took 1.855 ms
rank = 0, Transfering density took 1.857 ms
Etot    =   -18.154843415830
Eband   =    -5.511980879573
E1      =    12.878819911648
E2      =    -4.954528610444
E3      =    -7.023094618155
Exc     =    -6.217433499123
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 7.957e-06, dEband = 8.230e-04
rank = 0, Calculating/Estimating energy took 0.774 ms, Etot = -18.154843416, dEtot = 7.957e-06, dEband = 8.230e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0852796619921, which took 0.120 ms

iter_count = 108, r_2norm = 2.287e-06, tol*||rhs|| = 3.411e-06

Anderson update took 66.862 ms, out of which F'*F took 88.392 ms; b-Ax took 217.998 ms, out of which Lap took 205.414 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 382.962 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268701, int_b + int_rho = 7.640e-14, checking this took 0.075 ms
2-norm of RHS = 529.7978227072540, which took 0.082 ms

iter_count = 216, r_2norm = 4.302e-04, tol*||rhs|| = 5.298e-04

Anderson update took 87.673 ms, out of which F'*F took 46.284 ms; b-Ax took 304.375 ms, out of which Lap took 279.311 ms
Solving Poisson took 576.723 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 4.750325 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.351 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 4.734570 
Total time for convolution: 	 convolve: 4.752391 
Total time for convolution: 	 convolve: 4.755036 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 1.231 ms
======D2D: initiated sending and receiving took 2.403 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.158 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.545 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.091 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.669 ms

This SCF took 24433.675 ms, scf error = 7.757e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.129165, lowerbound = -0.829933, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 653.905 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.170 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.237 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.419 ms
rank =  0, finding HY took 11.056 ms
rank =  0, distributing HY into block cyclic form took 7.678 ms
rank =  0, finding Y'*HY took 2.576 ms
Rank 0, Project_Hamiltonian used 31.786 ms
Total time for projection: 31.802 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.118 ms
rank = 0, Solve_Generalized_EigenProblem used 0.198 ms
    first calculated eigval = -0.828699383397601
    last  calculated eigval = 0.032065599216201
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82869938339760
lambda[   2] =  -0.56120985861144
lambda[   3] =  -0.45121865843562
lambda[   4] =  -0.37921540976551
lambda[   5] =  -0.30201155820030
lambda[   6] =  -0.22665019599185
lambda[   7] =  -0.06028828574226
lambda[   8] =  -0.02418630607819
lambda[   9] =   0.01020829193071
lambda[  10] =   0.02144809008866
lambda[  11] =   0.02972961837722
lambda[  12] =   0.03206559921620
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 1.901 ms
rank =  0, Distributing orbital back into band + domain format took 6.835 ms
rank = 0, Subspace_Rotation used 8.745 ms

Total time for subspace rotation: 8.751 ms
rank = 0, Efermi =  -0.089861192589 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 1.623 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.939 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.554 ms
rank = 0, Calculating density took 707.907 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.739 ms
rank = 0, D2D took 1.880 ms
rank = 0, Transfering density took 1.886 ms
Etot    =   -18.154910891858
Eband   =    -5.498010129569
E1      =    12.872019577658
E2      =    -4.947057473727
E3      =    -7.024464673744
Exc     =    -6.218570310035
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 1.350e-05, dEband = 2.794e-03
rank = 0, Calculating/Estimating energy took 0.778 ms, Etot = -18.154910892, dEtot = 1.350e-05, dEband = 2.794e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0596789873008, which took 0.105 ms

iter_count = 108, r_2norm = 2.072e-06, tol*||rhs|| = 2.387e-06

Anderson update took 44.034 ms, out of which F'*F took 23.415 ms; b-Ax took 152.306 ms, out of which Lap took 140.097 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.099 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268700, int_b + int_rho = 6.730e-14, checking this took 0.075 ms
2-norm of RHS = 529.7932591604585, which took 0.094 ms

iter_count = 156, r_2norm = 5.099e-04, tol*||rhs|| = 5.298e-04

Anderson update took 63.254 ms, out of which F'*F took 33.657 ms; b-Ax took 220.581 ms, out of which Lap took 202.205 ms
Solving Poisson took 416.829 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Total time for convolution: 	 convolve: 4.729286 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.963 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 4.727099 
Total time for convolution: 	 convolve: 4.772566 
Total time for convolution: 	 convolve: 4.754825 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.769 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 3.551 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.084 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.666 ms

This SCF took 24141.376 ms, scf error = 5.332e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.132066, lowerbound = -0.828699, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 657.089 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.659 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.224 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.894 ms
rank =  0, finding HY took 11.079 ms
rank =  0, distributing HY into block cyclic form took 7.111 ms
rank =  0, finding Y'*HY took 2.562 ms
Rank 0, Project_Hamiltonian used 31.691 ms
Total time for projection: 31.704 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.132 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -0.828407557405667
    last  calculated eigval = 0.031814669857709
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82840755740567
lambda[   2] =  -0.56096846511348
lambda[   3] =  -0.45096945608885
lambda[   4] =  -0.37896387644268
lambda[   5] =  -0.30174349905851
lambda[   6] =  -0.22633682621226
lambda[   7] =  -0.06009693870193
lambda[   8] =  -0.02376000006695
lambda[   9] =   0.01080874680675
lambda[  10] =   0.02080671600197
lambda[  11] =   0.02973019867076
lambda[  12] =   0.03181466985771
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.249 ms
rank =  0, subspace rotation using ScaLAPACK took 1.920 ms
rank =  0, Distributing orbital back into band + domain format took 6.744 ms
rank = 0, Subspace_Rotation used 8.671 ms

Total time for subspace rotation: 8.676 ms
rank = 0, Efermi =  -0.089669845583 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 1.628 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.882 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.562 ms
rank = 0, Calculating density took 710.898 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.740 ms
rank = 0, D2D took 1.872 ms
rank = 0, Transfering density took 1.874 ms
Etot    =   -18.154945190996
Eband   =    -5.494779361405
E1      =    12.870105395195
E2      =    -4.945607134198
E3      =    -7.024952485226
Exc     =    -6.218958666829
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 6.860e-06, dEband = 6.462e-04
rank = 0, Calculating/Estimating energy took 0.778 ms, Etot = -18.154945191, dEtot = 6.860e-06, dEband = 6.462e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0480915166912, which took 0.117 ms

iter_count = 108, r_2norm = 1.373e-06, tol*||rhs|| = 1.924e-06

Anderson update took 43.776 ms, out of which F'*F took 23.387 ms; b-Ax took 152.530 ms, out of which Lap took 140.241 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 294.907 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268698, int_b + int_rho = 4.729e-14, checking this took 0.081 ms
2-norm of RHS = 529.8098684174812, which took 0.093 ms

iter_count = 180, r_2norm = 4.234e-04, tol*||rhs|| = 5.298e-04

Anderson update took 73.212 ms, out of which F'*F took 38.707 ms; b-Ax took 254.151 ms, out of which Lap took 233.198 ms
Solving Poisson took 481.339 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 4.742620 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.899 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 4.719143 
Total time for convolution: 	 convolve: 4.720198 
Total time for convolution: 	 convolve: 4.728398 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.775 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.157 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 3.547 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.081 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.660 ms

This SCF took 24277.680 ms, scf error = 3.474e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.131815, lowerbound = -0.828408, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 654.359 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.301 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.261 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.573 ms
rank =  0, finding HY took 11.100 ms
rank =  0, distributing HY into block cyclic form took 7.064 ms
rank =  0, finding Y'*HY took 2.621 ms
Rank 0, Project_Hamiltonian used 31.380 ms
Total time for projection: 31.394 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.128 ms
rank = 0, Solve_Generalized_EigenProblem used 0.210 ms
    first calculated eigval = -0.828295430869996
    last  calculated eigval = 0.034189510709647
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82829543087000
lambda[   2] =  -0.56076961528222
lambda[   3] =  -0.45079778541367
lambda[   4] =  -0.37878331216744
lambda[   5] =  -0.30158356477060
lambda[   6] =  -0.22619489365833
lambda[   7] =  -0.05997427003621
lambda[   8] =  -0.02122714152282
lambda[   9] =   0.01267343934161
lambda[  10] =   0.02124341032961
lambda[  11] =   0.03203793940321
lambda[  12] =   0.03418951070965
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 2.040 ms
rank =  0, Distributing orbital back into band + domain format took 6.752 ms
rank = 0, Subspace_Rotation used 8.803 ms

Total time for subspace rotation: 8.808 ms
rank = 0, Efermi =  -0.089547176890 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 1.697 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.860 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.564 ms
rank = 0, Calculating density took 708.034 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.734 ms
rank = 0, D2D took 1.871 ms
rank = 0, Transfering density took 1.873 ms
Etot    =   -18.154998982437
Eband   =    -5.492849205085
E1      =    12.869725349364
E2      =    -4.944075550572
E3      =    -7.024703385929
Exc     =    -6.218781885836
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 1.076e-05, dEband = 3.860e-04
rank = 0, Calculating/Estimating energy took 0.817 ms, Etot = -18.154998982, dEtot = 1.076e-05, dEband = 3.860e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0464133640166, which took 0.046 ms

iter_count = 108, r_2norm = 1.396e-06, tol*||rhs|| = 1.857e-06

Anderson update took 43.823 ms, out of which F'*F took 23.387 ms; b-Ax took 152.902 ms, out of which Lap took 140.519 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 296.358 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268700, int_b + int_rho = 6.912e-14, checking this took 0.080 ms
2-norm of RHS = 529.8086353534758, which took 0.081 ms

iter_count = 138, r_2norm = 4.630e-04, tol*||rhs|| = 5.298e-04

Anderson update took 56.019 ms, out of which F'*F took 29.559 ms; b-Ax took 194.149 ms, out of which Lap took 178.425 ms
Solving Poisson took 368.170 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Total time for convolution: 	 convolve: 4.727794 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.293 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 4.725693 
Total time for convolution: 	 convolve: 4.769501 
Total time for convolution: 	 convolve: 4.734643 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 4.644 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 3.556 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.908 ms

This SCF took 24069.541 ms, scf error = 3.813e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134190, lowerbound = -0.828295, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 655.716 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.433 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.254 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.698 ms
rank =  0, finding HY took 11.088 ms
rank =  0, distributing HY into block cyclic form took 7.107 ms
rank =  0, finding Y'*HY took 2.528 ms
Rank 0, Project_Hamiltonian used 31.445 ms
Total time for projection: 31.459 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.120 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -0.828216246345598
    last  calculated eigval = 0.034818970803422
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82821624634560
lambda[   2] =  -0.56069703182969
lambda[   3] =  -0.45072501474024
lambda[   4] =  -0.37870683689757
lambda[   5] =  -0.30150716663423
lambda[   6] =  -0.22609430190701
lambda[   7] =  -0.05991439821225
lambda[   8] =  -0.02061546990742
lambda[   9] =   0.01289336292472
lambda[  10] =   0.02118325134527
lambda[  11] =   0.03249567103540
lambda[  12] =   0.03481897080342
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.232 ms
rank =  0, subspace rotation using ScaLAPACK took 1.919 ms
rank =  0, Distributing orbital back into band + domain format took 6.722 ms
rank = 0, Subspace_Rotation used 8.650 ms

Total time for subspace rotation: 8.656 ms
rank = 0, Efermi =  -0.089487305066 calculate fermi energy took 0.078 ms
rank = 0, --- Calculate rho: sum over local bands took 1.621 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.829 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.564 ms
rank = 0, Calculating density took 709.211 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.728 ms
rank = 0, D2D took 1.867 ms
rank = 0, Transfering density took 1.869 ms
Etot    =   -18.155007532459
Eband   =    -5.491893197469
E1      =    12.869204988770
E2      =    -4.943613477694
E3      =    -7.024806654583
Exc     =    -6.218867278656
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 1.710e-06, dEband = 1.912e-04
rank = 0, Calculating/Estimating energy took 0.776 ms, Etot = -18.155007532, dEtot = 1.710e-06, dEband = 1.912e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0473434355860, which took 0.083 ms

iter_count = 108, r_2norm = 1.464e-06, tol*||rhs|| = 1.894e-06

Anderson update took 43.455 ms, out of which F'*F took 23.464 ms; b-Ax took 152.360 ms, out of which Lap took 140.037 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 294.400 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268694, int_b + int_rho = 9.095e-15, checking this took 0.075 ms
2-norm of RHS = 529.8097346745257, which took 0.087 ms

iter_count = 66, r_2norm = 5.277e-04, tol*||rhs|| = 5.298e-04

Anderson update took 26.576 ms, out of which F'*F took 14.172 ms; b-Ax took 93.378 ms, out of which Lap took 85.556 ms
Solving Poisson took 178.433 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 4.756171 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 4.755032 
Total time for convolution: 	 convolve: 4.740802 
Total time for convolution: 	 convolve: 4.722295 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.776 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.154 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 3.569 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.290 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.892 ms

This SCF took 24034.204 ms, scf error = 3.194e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.134819, lowerbound = -0.828216, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 654.444 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 8.169 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.214 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.393 ms
rank =  0, finding HY took 11.087 ms
rank =  0, distributing HY into block cyclic form took 7.121 ms
rank =  0, finding Y'*HY took 2.565 ms
Rank 0, Project_Hamiltonian used 31.190 ms
Total time for projection: 31.204 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.122 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -0.828226871272678
    last  calculated eigval = 0.034503070487736
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82822687127268
lambda[   2] =  -0.56070975139816
lambda[   3] =  -0.45073770565619
lambda[   4] =  -0.37871921483729
lambda[   5] =  -0.30151360134254
lambda[   6] =  -0.22610190004299
lambda[   7] =  -0.05991633786146
lambda[   8] =  -0.02074713529716
lambda[   9] =   0.01283835524873
lambda[  10] =   0.02093159212779
lambda[  11] =   0.03225010450013
lambda[  12] =   0.03450307048774
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.244 ms
rank =  0, subspace rotation using ScaLAPACK took 1.915 ms
rank =  0, Distributing orbital back into band + domain format took 6.772 ms
rank = 0, Subspace_Rotation used 8.698 ms

Total time for subspace rotation: 8.703 ms
rank = 0, Efermi =  -0.089489244756 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 1.597 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.900 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.571 ms
rank = 0, Calculating density took 707.783 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.723 ms
rank = 0, D2D took 1.871 ms
rank = 0, Transfering density took 1.873 ms
Etot    =   -18.155008247239
Eband   =    -5.492018089860
E1      =    12.869319165832
E2      =    -4.943632382469
E3      =    -7.024750793763
Exc     =    -6.218820322061
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 1.430e-07, dEband = 2.498e-05
rank = 0, Calculating/Estimating energy took 0.818 ms, Etot = -18.155008247, dEtot = 1.430e-07, dEband = 2.498e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0438920953393, which took 0.099 ms

iter_count = 108, r_2norm = 1.423e-06, tol*||rhs|| = 1.756e-06

Anderson update took 43.812 ms, out of which F'*F took 23.295 ms; b-Ax took 152.231 ms, out of which Lap took 139.863 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.049 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268695, int_b + int_rho = 2.001e-14, checking this took 0.898 ms
2-norm of RHS = 529.8072300557986, which took 0.085 ms

iter_count = 108, r_2norm = 4.877e-04, tol*||rhs|| = 5.298e-04

Anderson update took 43.970 ms, out of which F'*F took 23.329 ms; b-Ax took 152.704 ms, out of which Lap took 140.276 ms
Solving Poisson took 289.811 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Total time for convolution: 	 convolve: 4.735454 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.615 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 4.724733 
Total time for convolution: 	 convolve: 4.730362 
Total time for convolution: 	 convolve: 4.725663 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 3.584 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.324 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.942 ms

This SCF took 23965.934 ms, scf error = 3.291e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.134503, lowerbound = -0.828227, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 656.660 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.163 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.285 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.460 ms
rank =  0, finding HY took 11.071 ms
rank =  0, distributing HY into block cyclic form took 7.020 ms
rank =  0, finding Y'*HY took 2.557 ms
Rank 0, Project_Hamiltonian used 31.131 ms
Total time for projection: 31.147 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.120 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -0.828302569571026
    last  calculated eigval = 0.034254156062764
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82830256957103
lambda[   2] =  -0.56076983054936
lambda[   3] =  -0.45079937471065
lambda[   4] =  -0.37878194308473
lambda[   5] =  -0.30158451719829
lambda[   6] =  -0.22617586555290
lambda[   7] =  -0.05998594538882
lambda[   8] =  -0.02091145985267
lambda[   9] =   0.01264764048447
lambda[  10] =   0.02067577514011
lambda[  11] =   0.03200235064916
lambda[  12] =   0.03425415606276
==subpsace eigenproblem: bcast eigvals took 0.047 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 1.920 ms
rank =  0, Distributing orbital back into band + domain format took 6.774 ms
rank = 0, Subspace_Rotation used 8.702 ms

Total time for subspace rotation: 8.708 ms
rank = 0, Efermi =  -0.089558852230 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 1.598 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.862 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.551 ms
rank = 0, Calculating density took 709.903 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.706 ms
rank = 0, D2D took 1.840 ms
rank = 0, Transfering density took 1.842 ms
Etot    =   -18.155006002241
Eband   =    -5.492828202095
E1      =    12.869702706262
E2      =    -4.944094175799
E3      =    -7.024639283419
Exc     =    -6.218741788244
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 4.490e-07, dEband = 1.620e-04
rank = 0, Calculating/Estimating energy took 0.774 ms, Etot = -18.155006002, dEtot = 4.490e-07, dEband = 1.620e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0470110905405, which took 0.062 ms

iter_count = 108, r_2norm = 1.383e-06, tol*||rhs|| = 1.880e-06

Anderson update took 43.937 ms, out of which F'*F took 23.329 ms; b-Ax took 152.336 ms, out of which Lap took 139.921 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 296.271 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268698, int_b + int_rho = 4.911e-14, checking this took 0.075 ms
2-norm of RHS = 529.8106139729024, which took 0.094 ms

iter_count = 96, r_2norm = 4.993e-04, tol*||rhs|| = 5.298e-04

Anderson update took 38.912 ms, out of which F'*F took 20.512 ms; b-Ax took 134.782 ms, out of which Lap took 123.779 ms
Solving Poisson took 257.126 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 4.719631 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.449 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 4.762122 
Total time for convolution: 	 convolve: 4.722702 
Total time for convolution: 	 convolve: 4.772866 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.526 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.153 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.163 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.341 ms
---Transfer Veff_loc: D2D took 3.539 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.098 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.669 ms

This SCF took 23968.717 ms, scf error = 3.420e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.134254, lowerbound = -0.828303, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 657.082 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.354 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.189 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.556 ms
rank =  0, finding HY took 11.111 ms
rank =  0, distributing HY into block cyclic form took 7.002 ms
rank =  0, finding Y'*HY took 2.547 ms
Rank 0, Project_Hamiltonian used 31.236 ms
Total time for projection: 31.250 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.118 ms
rank = 0, Solve_Generalized_EigenProblem used 0.199 ms
    first calculated eigval = -0.828246733966617
    last  calculated eigval = 0.034216105630779
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82824673396662
lambda[   2] =  -0.56071853820305
lambda[   3] =  -0.45074802946242
lambda[   4] =  -0.37872974977662
lambda[   5] =  -0.30153238700273
lambda[   6] =  -0.22612032932671
lambda[   7] =  -0.05994177364010
lambda[   8] =  -0.02088031789230
lambda[   9] =   0.01261566547702
lambda[  10] =   0.02054976499934
lambda[  11] =   0.03192405675690
lambda[  12] =   0.03421610563078
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.232 ms
rank =  0, subspace rotation using ScaLAPACK took 1.920 ms
rank =  0, Distributing orbital back into band + domain format took 6.742 ms
rank = 0, Subspace_Rotation used 8.672 ms

Total time for subspace rotation: 8.677 ms
rank = 0, Efermi =  -0.089514680482 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 1.619 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.622 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.956 ms
rank = 0, Calculating density took 710.559 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.854 ms
rank = 0, D2D took 1.992 ms
rank = 0, Transfering density took 1.994 ms
Etot    =   -18.155006347194
Eband   =    -5.492191536237
E1      =    12.869423419739
E2      =    -4.943698122969
E3      =    -7.024768296909
Exc     =    -6.218832473192
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 6.899e-08, dEband = 1.273e-04
rank = 0, Calculating/Estimating energy took 0.782 ms, Etot = -18.155006347, dEtot = 6.899e-08, dEband = 1.273e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0478985947118, which took 0.048 ms

iter_count = 108, r_2norm = 1.369e-06, tol*||rhs|| = 1.916e-06

Anderson update took 43.763 ms, out of which F'*F took 23.518 ms; b-Ax took 152.740 ms, out of which Lap took 140.378 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.679 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268695, int_b + int_rho = 2.365e-14, checking this took 0.079 ms
2-norm of RHS = 529.8100834628043, which took 0.085 ms

iter_count = 48, r_2norm = 4.794e-04, tol*||rhs|| = 5.298e-04

Anderson update took 19.486 ms, out of which F'*F took 10.392 ms; b-Ax took 67.880 ms, out of which Lap took 62.436 ms
Solving Poisson took 130.391 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Total time for convolution: 	 convolve: 4.724057 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 49.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 4.719690 
Total time for convolution: 	 convolve: 4.725506 
Total time for convolution: 	 convolve: 4.750133 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.154 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.561 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.094 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.687 ms

This SCF took 23834.831 ms, scf error = 3.446e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.134216, lowerbound = -0.828247, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 654.378 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 9.348 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.288 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.647 ms
rank =  0, finding HY took 11.098 ms
rank =  0, distributing HY into block cyclic form took 7.038 ms
rank =  0, finding Y'*HY took 2.560 ms
Rank 0, Project_Hamiltonian used 32.368 ms
Total time for projection: 32.385 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.113 ms
rank = 0, Solve_Generalized_EigenProblem used 0.196 ms
    first calculated eigval = -0.828240010493849
    last  calculated eigval = 0.033891849650410
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82824001049385
lambda[   2] =  -0.56071858698093
lambda[   3] =  -0.45074677846422
lambda[   4] =  -0.37872927688563
lambda[   5] =  -0.30152926065476
lambda[   6] =  -0.22611931659897
lambda[   7] =  -0.05995888872573
lambda[   8] =  -0.02115176488470
lambda[   9] =   0.01224015728807
lambda[  10] =   0.02029525853360
lambda[  11] =   0.03158535467702
lambda[  12] =   0.03389184965041
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 1.932 ms
rank =  0, Distributing orbital back into band + domain format took 6.719 ms
rank = 0, Subspace_Rotation used 8.661 ms

Total time for subspace rotation: 8.667 ms
rank = 0, Efermi =  -0.089531795580 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 1.593 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.948 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.564 ms
rank = 0, Calculating density took 708.897 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.715 ms
rank = 0, D2D took 1.849 ms
rank = 0, Transfering density took 1.851 ms
Etot    =   -18.155012359753
Eband   =    -5.492166460917
E1      =    12.869374852562
E2      =    -4.943716589468
E3      =    -7.024766617163
Exc     =    -6.218831780648
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 1.203e-06, dEband = 5.015e-06
rank = 0, Calculating/Estimating energy took 0.803 ms, Etot = -18.155012360, dEtot = 1.203e-06, dEband = 5.015e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0447469771520, which took 0.047 ms

iter_count = 108, r_2norm = 1.216e-06, tol*||rhs|| = 1.790e-06

Anderson update took 43.856 ms, out of which F'*F took 23.577 ms; b-Ax took 152.931 ms, out of which Lap took 140.619 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.583 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268696, int_b + int_rho = 3.456e-14, checking this took 0.076 ms
2-norm of RHS = 529.8084238241817, which took 0.084 ms

iter_count = 120, r_2norm = 4.738e-04, tol*||rhs|| = 5.298e-04

Anderson update took 48.487 ms, out of which F'*F took 25.774 ms; b-Ax took 168.834 ms, out of which Lap took 155.125 ms
Solving Poisson took 321.588 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.121 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Total time for convolution: 	 convolve: 4.719385 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 66.855 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 4.801774 
Total time for convolution: 	 convolve: 4.727763 
Total time for convolution: 	 convolve: 4.736717 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.524 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.154 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.533 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.096 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.663 ms

This SCF took 24107.450 ms, scf error = 3.254e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.133892, lowerbound = -0.828240, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 655.092 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 8.587 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.237 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.836 ms
rank =  0, finding HY took 11.061 ms
rank =  0, distributing HY into block cyclic form took 7.066 ms
rank =  0, finding Y'*HY took 2.548 ms
Rank 0, Project_Hamiltonian used 31.534 ms
Total time for projection: 31.553 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.131 ms
rank = 0, Solve_Generalized_EigenProblem used 0.214 ms
    first calculated eigval = -0.828165345354869
    last  calculated eigval = 0.033613579967885
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82816534535487
lambda[   2] =  -0.56066744071781
lambda[   3] =  -0.45068861592146
lambda[   4] =  -0.37867897446936
lambda[   5] =  -0.30147572843021
lambda[   6] =  -0.22607985241292
lambda[   7] =  -0.05995209158156
lambda[   8] =  -0.02152019307326
lambda[   9] =   0.01164684971541
lambda[  10] =   0.01991746231090
lambda[  11] =   0.03120648868285
lambda[  12] =   0.03361357996789
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 1.901 ms
rank =  0, Distributing orbital back into band + domain format took 6.754 ms
rank = 0, Subspace_Rotation used 8.664 ms

Total time for subspace rotation: 8.670 ms
rank = 0, Efermi =  -0.089524998458 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 1.616 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.953 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.558 ms
rank = 0, Calculating density took 708.802 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.735 ms
rank = 0, D2D took 1.862 ms
rank = 0, Transfering density took 1.864 ms
Etot    =   -18.155020533993
Eband   =    -5.491511915374
E1      =    12.868873207642
E2      =    -4.943514972287
E3      =    -7.024925871136
Exc     =    -6.218950492303
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 1.635e-06, dEband = 1.309e-04
rank = 0, Calculating/Estimating energy took 1.154 ms, Etot = -18.155020534, dEtot = 1.635e-06, dEband = 1.309e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0323233022734, which took 0.049 ms

iter_count = 108, r_2norm = 8.451e-07, tol*||rhs|| = 1.293e-06

Anderson update took 43.821 ms, out of which F'*F took 23.312 ms; b-Ax took 152.505 ms, out of which Lap took 140.069 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.272 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268698, int_b + int_rho = 4.911e-14, checking this took 0.077 ms
2-norm of RHS = 529.8048260773792, which took 0.081 ms

iter_count = 162, r_2norm = 4.387e-04, tol*||rhs|| = 5.298e-04

Anderson update took 66.093 ms, out of which F'*F took 34.844 ms; b-Ax took 227.827 ms, out of which Lap took 209.864 ms
Solving Poisson took 432.480 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 4.806707 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 4.726997 
Total time for convolution: 	 convolve: 4.733120 
Total time for convolution: 	 convolve: 4.729337 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.161 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 3.571 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.350 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.955 ms

This SCF took 24160.212 ms, scf error = 2.546e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.133614, lowerbound = -0.828165, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 654.360 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.121 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.218 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.351 ms
rank =  0, finding HY took 11.093 ms
rank =  0, distributing HY into block cyclic form took 7.005 ms
rank =  0, finding Y'*HY took 2.569 ms
Rank 0, Project_Hamiltonian used 32.043 ms
Total time for projection: 32.061 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.124 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -0.827803575565073
    last  calculated eigval = 0.035527834662961
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82780357556507
lambda[   2] =  -0.56036546575914
lambda[   3] =  -0.45037581687075
lambda[   4] =  -0.37837652664435
lambda[   5] =  -0.30115405212739
lambda[   6] =  -0.22577551811660
lambda[   7] =  -0.05971282467459
lambda[   8] =  -0.02042642947855
lambda[   9] =   0.01169049411429
lambda[  10] =   0.02017037204019
lambda[  11] =   0.03249400714378
lambda[  12] =   0.03552783466296
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.236 ms
rank =  0, subspace rotation using ScaLAPACK took 1.915 ms
rank =  0, Distributing orbital back into band + domain format took 6.831 ms
rank = 0, Subspace_Rotation used 8.757 ms

Total time for subspace rotation: 8.763 ms
rank = 0, Efermi =  -0.089285731564 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 1.620 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.863 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.548 ms
rank = 0, Calculating density took 708.586 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.736 ms
rank = 0, D2D took 1.863 ms
rank = 0, Transfering density took 1.865 ms
Etot    =   -18.155045337585
Eband   =    -5.487701910924
E1      =    12.866783715901
E2      =    -4.941662729043
E3      =    -7.025370318479
Exc     =    -6.219288012702
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 4.961e-06, dEband = 7.620e-04
rank = 0, Calculating/Estimating energy took 0.796 ms, Etot = -18.155045338, dEtot = 4.961e-06, dEband = 7.620e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0266271263090, which took 0.050 ms

iter_count = 108, r_2norm = 6.296e-07, tol*||rhs|| = 1.065e-06

Anderson update took 43.978 ms, out of which F'*F took 23.635 ms; b-Ax took 153.444 ms, out of which Lap took 140.831 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 297.449 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268694, int_b + int_rho = 7.276e-15, checking this took 0.074 ms
2-norm of RHS = 529.8060853758540, which took 0.095 ms

iter_count = 144, r_2norm = 4.491e-04, tol*||rhs|| = 5.298e-04

Anderson update took 58.547 ms, out of which F'*F took 31.561 ms; b-Ax took 203.987 ms, out of which Lap took 187.494 ms
Solving Poisson took 386.470 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 4.730858 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 78.478 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 4.744307 
Total time for convolution: 	 convolve: 4.726457 
Total time for convolution: 	 convolve: 4.726627 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.778 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.528 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.086 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.648 ms

This SCF took 24120.417 ms, scf error = 1.360e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.135528, lowerbound = -0.827804, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 654.792 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 9.007 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.228 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.247 ms
rank =  0, finding HY took 11.040 ms
rank =  0, distributing HY into block cyclic form took 7.102 ms
rank =  0, finding Y'*HY took 2.567 ms
Rank 0, Project_Hamiltonian used 31.983 ms
Total time for projection: 32.000 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.123 ms
rank = 0, Solve_Generalized_EigenProblem used 0.205 ms
    first calculated eigval = -0.827774702560333
    last  calculated eigval = 0.036293635574625
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82777470256033
lambda[   2] =  -0.56030950131236
lambda[   3] =  -0.45032486032546
lambda[   4] =  -0.37832796654465
lambda[   5] =  -0.30112199708366
lambda[   6] =  -0.22575793578900
lambda[   7] =  -0.05971290297118
lambda[   8] =  -0.02034290121047
lambda[   9] =   0.01129506065994
lambda[  10] =   0.02019514807450
lambda[  11] =   0.03292377339088
lambda[  12] =   0.03629363557463
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 1.916 ms
rank =  0, Distributing orbital back into band + domain format took 6.769 ms
rank = 0, Subspace_Rotation used 8.693 ms

Total time for subspace rotation: 8.716 ms
rank = 0, Efermi =  -0.089285809809 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 1.575 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.650 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.553 ms
rank = 0, Calculating density took 709.630 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.731 ms
rank = 0, D2D took 1.875 ms
rank = 0, Transfering density took 1.877 ms
Etot    =   -18.155055175749
Eband   =    -5.487233927989
E1      =    12.866632994069
E2      =    -4.941340362775
E3      =    -7.025342888431
Exc     =    -6.219265315655
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 1.968e-06, dEband = 9.360e-05
rank = 0, Calculating/Estimating energy took 0.797 ms, Etot = -18.155055176, dEtot = 1.968e-06, dEband = 9.360e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0251162265006, which took 0.095 ms

iter_count = 108, r_2norm = 6.166e-07, tol*||rhs|| = 1.005e-06

Anderson update took 43.518 ms, out of which F'*F took 23.371 ms; b-Ax took 153.423 ms, out of which Lap took 140.776 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.690 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268697, int_b + int_rho = 3.820e-14, checking this took 0.072 ms
2-norm of RHS = 529.8060201091761, which took 0.082 ms

iter_count = 108, r_2norm = 4.494e-04, tol*||rhs|| = 5.298e-04

Anderson update took 44.036 ms, out of which F'*F took 23.286 ms; b-Ax took 152.376 ms, out of which Lap took 140.135 ms
Solving Poisson took 289.806 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
Total time for convolution: 	 convolve: 4.733291 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.787 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 4.783243 
Total time for convolution: 	 convolve: 4.759506 
Total time for convolution: 	 convolve: 4.855716 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.768 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.153 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.600 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.086 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.719 ms

This SCF took 24608.159 ms, scf error = 1.324e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.136294, lowerbound = -0.827775, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 655.908 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 8.466 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.262 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.739 ms
rank =  0, finding HY took 11.117 ms
rank =  0, distributing HY into block cyclic form took 7.011 ms
rank =  0, finding Y'*HY took 2.560 ms
Rank 0, Project_Hamiltonian used 31.452 ms
Total time for projection: 31.467 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.118 ms
rank = 0, Solve_Generalized_EigenProblem used 0.201 ms
    first calculated eigval = -0.827737471722202
    last  calculated eigval = 0.036648539677221
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82773747172220
lambda[   2] =  -0.56027154588851
lambda[   3] =  -0.45028728471169
lambda[   4] =  -0.37829190201225
lambda[   5] =  -0.30108562758391
lambda[   6] =  -0.22572513105387
lambda[   7] =  -0.05969329610036
lambda[   8] =  -0.02026408669672
lambda[   9] =   0.01113884376935
lambda[  10] =   0.02036116494770
lambda[  11] =   0.03319860653865
lambda[  12] =   0.03664853967722
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.225 ms
rank =  0, subspace rotation using ScaLAPACK took 1.832 ms
rank =  0, Distributing orbital back into band + domain format took 7.622 ms
rank = 0, Subspace_Rotation used 9.463 ms

Total time for subspace rotation: 9.469 ms
rank = 0, Efermi =  -0.089266202978 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 1.625 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.669 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.566 ms
rank = 0, Calculating density took 710.078 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.707 ms
rank = 0, D2D took 1.841 ms
rank = 0, Transfering density took 1.843 ms
Etot    =   -18.155059192714
Eband   =    -5.486797926702
E1      =    12.866425485373
E2      =    -4.941107104493
E3      =    -7.025351559758
Exc     =    -6.219273238254
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 8.034e-07, dEband = 8.720e-05
rank = 0, Calculating/Estimating energy took 0.805 ms, Etot = -18.155059193, dEtot = 8.034e-07, dEband = 8.720e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0222969680611, which took 0.048 ms

iter_count = 108, r_2norm = 5.935e-07, tol*||rhs|| = 8.919e-07

Anderson update took 44.045 ms, out of which F'*F took 23.402 ms; b-Ax took 152.797 ms, out of which Lap took 140.350 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.636 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268693, int_b + int_rho = 3.638e-15, checking this took 0.074 ms
2-norm of RHS = 529.8054128240709, which took 0.080 ms

iter_count = 90, r_2norm = 4.863e-04, tol*||rhs|| = 5.298e-04

Anderson update took 36.476 ms, out of which F'*F took 19.297 ms; b-Ax took 126.335 ms, out of which Lap took 116.143 ms
Solving Poisson took 241.202 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 4.728257 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.316 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 4.719992 
Total time for convolution: 	 convolve: 4.796047 
Total time for convolution: 	 convolve: 4.755999 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 3.554 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.388 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.975 ms

This SCF took 24009.159 ms, scf error = 1.240e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.136649, lowerbound = -0.827737, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 657.480 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 9.158 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.212 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.381 ms
rank =  0, finding HY took 11.083 ms
rank =  0, distributing HY into block cyclic form took 7.148 ms
rank =  0, finding Y'*HY took 2.568 ms
Rank 0, Project_Hamiltonian used 32.202 ms
Total time for projection: 32.220 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.117 ms
rank = 0, Solve_Generalized_EigenProblem used 0.199 ms
    first calculated eigval = -0.827694222726683
    last  calculated eigval = 0.036542847152794
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82769422272668
lambda[   2] =  -0.56023380175221
lambda[   3] =  -0.45024902356411
lambda[   4] =  -0.37825377123385
lambda[   5] =  -0.30104597010623
lambda[   6] =  -0.22568449272736
lambda[   7] =  -0.05966904840810
lambda[   8] =  -0.02045343175267
lambda[   9] =   0.01087084591956
lambda[  10] =   0.02044730243326
lambda[  11] =   0.03311991655134
lambda[  12] =   0.03654284715279
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 1.810 ms
rank =  0, Distributing orbital back into band + domain format took 7.548 ms
rank = 0, Subspace_Rotation used 9.367 ms

Total time for subspace rotation: 9.373 ms
rank = 0, Efermi =  -0.089241955267 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 1.632 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.743 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.561 ms
rank = 0, Calculating density took 712.379 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.706 ms
rank = 0, D2D took 1.844 ms
rank = 0, Transfering density took 1.846 ms
Etot    =   -18.155060526277
Eband   =    -5.486322564978
E1      =    12.866146288199
E2      =    -4.940898503759
E3      =    -7.025409609195
Exc     =    -6.219320185072
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 2.667e-07, dEband = 9.507e-05
rank = 0, Calculating/Estimating energy took 0.797 ms, Etot = -18.155060526, dEtot = 2.667e-07, dEband = 9.507e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0143905349995, which took 0.111 ms

iter_count = 108, r_2norm = 5.145e-07, tol*||rhs|| = 5.756e-07

Anderson update took 44.016 ms, out of which F'*F took 23.416 ms; b-Ax took 152.492 ms, out of which Lap took 140.255 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.584 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268693, int_b + int_rho = -3.638e-15, checking this took 0.076 ms
2-norm of RHS = 529.8071798967978, which took 0.095 ms

iter_count = 108, r_2norm = 4.301e-04, tol*||rhs|| = 5.298e-04

Anderson update took 43.999 ms, out of which F'*F took 23.629 ms; b-Ax took 153.118 ms, out of which Lap took 140.897 ms
Solving Poisson took 290.412 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 4.731695 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.196 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 4.826637 
Total time for convolution: 	 convolve: 4.723453 
Total time for convolution: 	 convolve: 4.734389 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.155 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.017 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 3.561 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.101 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.694 ms

This SCF took 24070.736 ms, scf error = 1.026e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.136543, lowerbound = -0.827694, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 656.138 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.401 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.186 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.600 ms
rank =  0, finding HY took 11.111 ms
rank =  0, distributing HY into block cyclic form took 7.048 ms
rank =  0, finding Y'*HY took 2.533 ms
Rank 0, Project_Hamiltonian used 31.312 ms
Total time for projection: 31.332 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.106 ms
rank = 0, Solve_Generalized_EigenProblem used 0.192 ms
    first calculated eigval = -0.827674416670728
    last  calculated eigval = 0.037104877176858
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82767441667073
lambda[   2] =  -0.56019472936573
lambda[   3] =  -0.45021421234987
lambda[   4] =  -0.37821704417625
lambda[   5] =  -0.30101682696333
lambda[   6] =  -0.22565014254384
lambda[   7] =  -0.05964662547434
lambda[   8] =  -0.02046129327312
lambda[   9] =   0.01073335051292
lambda[  10] =   0.02095107439464
lambda[  11] =   0.03342000026892
lambda[  12] =   0.03710487717686
==subpsace eigenproblem: bcast eigvals took 0.046 ms
Total time for solving subspace eigenvalue problem: 0.245 ms
rank =  0, subspace rotation using ScaLAPACK took 1.854 ms
rank =  0, Distributing orbital back into band + domain format took 7.415 ms
rank = 0, Subspace_Rotation used 9.277 ms

Total time for subspace rotation: 9.282 ms
rank = 0, Efermi =  -0.089219532363 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 1.615 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.728 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.562 ms
rank = 0, Calculating density took 710.039 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.709 ms
rank = 0, D2D took 1.840 ms
rank = 0, Transfering density took 1.842 ms
Etot    =   -18.155064515235
Eband   =    -5.485934744896
E1      =    12.866037348571
E2      =    -4.940621161346
E3      =    -7.025394745331
Exc     =    -6.219310848206
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 7.978e-07, dEband = 7.756e-05
rank = 0, Calculating/Estimating energy took 0.796 ms, Etot = -18.155064515, dEtot = 7.978e-07, dEband = 7.756e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0156968299231, which took 0.049 ms

iter_count = 108, r_2norm = 4.689e-07, tol*||rhs|| = 6.279e-07

Anderson update took 43.535 ms, out of which F'*F took 23.515 ms; b-Ax took 152.811 ms, out of which Lap took 140.523 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.176 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268694, int_b + int_rho = 9.095e-15, checking this took 0.076 ms
2-norm of RHS = 529.8083188948149, which took 0.077 ms

iter_count = 96, r_2norm = 5.012e-04, tol*||rhs|| = 5.298e-04

Anderson update took 39.195 ms, out of which F'*F took 20.771 ms; b-Ax took 135.856 ms, out of which Lap took 124.665 ms
Solving Poisson took 259.955 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 4.727751 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.462 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 4.805874 
Total time for convolution: 	 convolve: 4.751324 
Total time for convolution: 	 convolve: 4.807329 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.154 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.138 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.523 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.076 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.632 ms

This SCF took 24111.910 ms, scf error = 1.238e-04
-------------
SCF iter 24  
-------------

 Chebfilt 27, in Chebyshev filtering, lambda_cutoff = 0.137105, lowerbound = -0.827674, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 654.416 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 9.338 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.236 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.584 ms
rank =  0, finding HY took 11.062 ms
rank =  0, distributing HY into block cyclic form took 7.112 ms
rank =  0, finding Y'*HY took 2.551 ms
Rank 0, Project_Hamiltonian used 32.345 ms
Total time for projection: 32.365 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.517 ms
rank = 0, Solve_Generalized_EigenProblem used 0.634 ms
    first calculated eigval = -0.827698460663234
    last  calculated eigval = 0.037290782523098
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82769846066323
lambda[   2] =  -0.56020974451836
lambda[   3] =  -0.45023039946290
lambda[   4] =  -0.37823357416846
lambda[   5] =  -0.30103401011547
lambda[   6] =  -0.22566632642359
lambda[   7] =  -0.05967099517105
lambda[   8] =  -0.02065449665650
lambda[   9] =   0.01049319035009
lambda[  10] =   0.02144749629763
lambda[  11] =   0.03336479932701
lambda[  12] =   0.03729078252310
==subpsace eigenproblem: bcast eigvals took 0.047 ms
Total time for solving subspace eigenvalue problem: 0.689 ms
rank =  0, subspace rotation using ScaLAPACK took 1.889 ms
rank =  0, Distributing orbital back into band + domain format took 7.097 ms
rank = 0, Subspace_Rotation used 8.997 ms

Total time for subspace rotation: 9.003 ms
rank = 0, Efermi =  -0.089243902053 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 1.641 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.650 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.558 ms
rank = 0, Calculating density took 709.447 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.722 ms
rank = 0, D2D took 1.866 ms
rank = 0, Transfering density took 1.868 ms
Etot    =   -18.155063751422
Eband   =    -5.486145031461
E1      =    12.866208260274
E2      =    -4.940678359625
E3      =    -7.025321940936
Exc     =    -6.219255103414
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 1.528e-07, dEband = 4.206e-05
rank = 0, Calculating/Estimating energy took 0.812 ms, Etot = -18.155063751, dEtot = 1.528e-07, dEband = 4.206e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0141025435439, which took 0.050 ms

iter_count = 108, r_2norm = 4.796e-07, tol*||rhs|| = 5.641e-07

Anderson update took 43.817 ms, out of which F'*F took 23.319 ms; b-Ax took 152.548 ms, out of which Lap took 140.100 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.413 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268698, int_b + int_rho = 4.729e-14, checking this took 0.076 ms
2-norm of RHS = 529.8082153254485, which took 0.089 ms

iter_count = 84, r_2norm = 5.164e-04, tol*||rhs|| = 5.298e-04

Anderson update took 34.003 ms, out of which F'*F took 18.092 ms; b-Ax took 118.286 ms, out of which Lap took 108.786 ms
Solving Poisson took 225.646 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Total time for convolution: 	 convolve: 4.787871 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 54.296 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 4.726003 
Total time for convolution: 	 convolve: 4.721421 
Total time for convolution: 	 convolve: 4.748869 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.152 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 3.544 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.889 ms

This SCF took 24000.034 ms, scf error = 1.451e-04
-------------
SCF iter 25  
-------------

 Chebfilt 28, in Chebyshev filtering, lambda_cutoff = 0.137291, lowerbound = -0.827698, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 655.434 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.243 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.236 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.491 ms
rank =  0, finding HY took 11.050 ms
rank =  0, distributing HY into block cyclic form took 7.124 ms
rank =  0, finding Y'*HY took 2.753 ms
Rank 0, Project_Hamiltonian used 31.458 ms
Total time for projection: 31.471 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.122 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -0.827643914963249
    last  calculated eigval = 0.036790491932893
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82764391496325
lambda[   2] =  -0.56016447398867
lambda[   3] =  -0.45018415404566
lambda[   4] =  -0.37818677257202
lambda[   5] =  -0.30098527394713
lambda[   6] =  -0.22561644486606
lambda[   7] =  -0.05961594250549
lambda[   8] =  -0.02039062177941
lambda[   9] =   0.01076442558186
lambda[  10] =   0.02117421500927
lambda[  11] =   0.03348590349576
lambda[  12] =   0.03679049193289
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.244 ms
rank =  0, subspace rotation using ScaLAPACK took 1.939 ms
rank =  0, Distributing orbital back into band + domain format took 6.735 ms
rank = 0, Subspace_Rotation used 8.682 ms

Total time for subspace rotation: 8.689 ms
rank = 0, Efermi =  -0.089188849395 calculate fermi energy took 0.069 ms
rank = 0, --- Calculate rho: sum over local bands took 1.633 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.122 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.559 ms
rank = 0, Calculating density took 709.277 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.703 ms
rank = 0, D2D took 1.834 ms
rank = 0, Transfering density took 1.836 ms
Etot    =   -18.155067196348
Eband   =    -5.485562069522
E1      =    12.865880194393
E2      =    -4.940394729743
E3      =    -7.025423897199
Exc     =    -6.219331770781
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 6.890e-07, dEband = 1.166e-04
rank = 0, Calculating/Estimating energy took 0.793 ms, Etot = -18.155067196, dEtot = 6.890e-07, dEband = 1.166e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0138398801420, which took 0.162 ms

iter_count = 108, r_2norm = 4.929e-07, tol*||rhs|| = 5.536e-07

Anderson update took 43.722 ms, out of which F'*F took 23.429 ms; b-Ax took 152.909 ms, out of which Lap took 140.555 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.732 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268697, int_b + int_rho = 4.002e-14, checking this took 0.078 ms
2-norm of RHS = 529.8073530428015, which took 0.077 ms

iter_count = 48, r_2norm = 4.907e-04, tol*||rhs|| = 5.298e-04

Anderson update took 19.560 ms, out of which F'*F took 10.589 ms; b-Ax took 67.983 ms, out of which Lap took 62.490 ms
Solving Poisson took 130.741 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 4.746695 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.160 ms
Total time for convolution: 	 convolve: 4.731360 
Total time for convolution: 	 convolve: 4.744689 
Total time for convolution: 	 convolve: 4.756327 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.528 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.089 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.649 ms

This SCF took 23837.029 ms, scf error = 1.269e-04
-------------
SCF iter 26  
-------------

 Chebfilt 29, in Chebyshev filtering, lambda_cutoff = 0.136790, lowerbound = -0.827644, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 654.813 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 8.497 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.243 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.754 ms
rank =  0, finding HY took 11.091 ms
rank =  0, distributing HY into block cyclic form took 7.085 ms
rank =  0, finding Y'*HY took 2.530 ms
Rank 0, Project_Hamiltonian used 31.486 ms
Total time for projection: 31.501 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.123 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -0.827613762836546
    last  calculated eigval = 0.036832787966598
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82761376283655
lambda[   2] =  -0.56014376719489
lambda[   3] =  -0.45016174509771
lambda[   4] =  -0.37816485912440
lambda[   5] =  -0.30096132545169
lambda[   6] =  -0.22559350963987
lambda[   7] =  -0.05959458153823
lambda[   8] =  -0.02023445555917
lambda[   9] =   0.01087453634563
lambda[  10] =   0.02125280141650
lambda[  11] =   0.03369148963685
lambda[  12] =   0.03683278796660
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.249 ms
rank =  0, subspace rotation using ScaLAPACK took 1.941 ms
rank =  0, Distributing orbital back into band + domain format took 6.729 ms
rank = 0, Subspace_Rotation used 8.679 ms

Total time for subspace rotation: 8.684 ms
rank = 0, Efermi =  -0.089167488378 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 1.621 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.826 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.545 ms
rank = 0, Calculating density took 708.359 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.719 ms
rank = 0, D2D took 1.865 ms
rank = 0, Transfering density took 1.867 ms
Etot    =   -18.155063968072
Eband   =    -5.485277939446
E1      =    12.865677274162
E2      =    -4.940297611643
E3      =    -7.025507693041
Exc     =    -6.219396430091
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 6.457e-07, dEband = 5.683e-05
rank = 0, Calculating/Estimating energy took 0.765 ms, Etot = -18.155063968, dEtot = 6.457e-07, dEband = 5.683e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0146026435131, which took 0.115 ms

iter_count = 102, r_2norm = 5.424e-07, tol*||rhs|| = 5.841e-07

Anderson update took 41.199 ms, out of which F'*F took 22.052 ms; b-Ax took 144.315 ms, out of which Lap took 132.608 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 279.196 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268696, int_b + int_rho = 3.092e-14, checking this took 0.090 ms
2-norm of RHS = 529.8050008625149, which took 0.088 ms

iter_count = 126, r_2norm = 4.743e-04, tol*||rhs|| = 5.298e-04

Anderson update took 51.255 ms, out of which F'*F took 27.199 ms; b-Ax took 177.502 ms, out of which Lap took 163.197 ms
Solving Poisson took 337.268 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Total time for convolution: 	 convolve: 4.725006 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 111.416 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 4.720225 
Total time for convolution: 	 convolve: 4.765692 
Total time for convolution: 	 convolve: 4.775795 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.776 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 3.560 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.353 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.948 ms

This SCF took 24175.643 ms, scf error = 1.024e-04
-------------
SCF iter 27  
-------------

 Chebfilt 30, in Chebyshev filtering, lambda_cutoff = 0.136833, lowerbound = -0.827614, upperbound = 267.571914

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 654.930 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.470 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.223 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.704 ms
rank =  0, finding HY took 11.106 ms
rank =  0, distributing HY into block cyclic form took 7.065 ms
rank =  0, finding Y'*HY took 2.522 ms
Rank 0, Project_Hamiltonian used 31.418 ms
Total time for projection: 31.431 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.134 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.827444777883478
    last  calculated eigval = 0.035860146486424
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.82744477788348
lambda[   2] =  -0.56000399136269
lambda[   3] =  -0.45001651721905
lambda[   4] =  -0.37802411282370
lambda[   5] =  -0.30081072478375
lambda[   6] =  -0.22545942952448
lambda[   7] =  -0.05945330843182
lambda[   8] =  -0.02100914273839
lambda[   9] =   0.01056844513397
lambda[  10] =   0.02116172082197
lambda[  11] =   0.03290337141419
lambda[  12] =   0.03586014648642
==subpsace eigenproblem: bcast eigvals took 0.047 ms
Total time for solving subspace eigenvalue problem: 0.272 ms
rank =  0, subspace rotation using ScaLAPACK took 1.931 ms
rank =  0, Distributing orbital back into band + domain format took 6.733 ms
rank = 0, Subspace_Rotation used 8.673 ms

Total time for subspace rotation: 8.677 ms
rank = 0, Efermi =  -0.089026215270 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 1.613 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.720 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.550 ms
rank = 0, Calculating density took 708.313 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.694 ms
rank = 0, D2D took 1.837 ms
rank = 0, Transfering density took 1.838 ms
Etot    =   -18.155067197555
Eband   =    -5.483519107949
E1      =    12.864618157587
E2      =    -4.939530817142
E3      =    -7.025802798870
Exc     =    -6.219627685825
Esc     =   -31.281872176995
Entropy =    -0.000000000386
dE = 6.459e-07, dEband = 3.518e-04
rank = 0, Calculating/Estimating energy took 0.783 ms, Etot = -18.155067198, dEtot = 6.459e-07, dEband = 3.518e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0081041719532, which took 0.114 ms

iter_count = 108, r_2norm = 2.388e-07, tol*||rhs|| = 3.242e-07

Anderson update took 43.914 ms, out of which F'*F took 23.469 ms; b-Ax took 152.526 ms, out of which Lap took 140.203 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.372 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001268693, int_rho =  12.00000001268694, int_b + int_rho = 1.273e-14, checking this took 0.073 ms
2-norm of RHS = 529.8055524743753, which took 0.081 ms

iter_count = 72, r_2norm = 5.049e-04, tol*||rhs|| = 5.298e-04

Anderson update took 28.903 ms, out of which F'*F took 15.415 ms; b-Ax took 100.968 ms, out of which Lap took 92.748 ms
Solving Poisson took 193.310 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 4.729157 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 41.631 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 4.718051 
Total time for convolution: 	 convolve: 4.792388 
Total time for convolution: 	 convolve: 4.787290 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.158 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 3.542 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.369 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.947 ms

This SCF took 24008.475 ms, scf error = 3.892e-05
The last 12 occupations of kpoints #1 are (Nelectron = 12):
lambda[   1] =  -0.82744477788348, occ[   1] =   2.00000000000000
lambda[   2] =  -0.56000399136269, occ[   2] =   2.00000000000000
lambda[   3] =  -0.45001651721905, occ[   3] =   2.00000000000000
lambda[   4] =  -0.37802411282370, occ[   4] =   2.00000000000000
lambda[   5] =  -0.30081072478375, occ[   5] =   2.00000000000000
lambda[   6] =  -0.22545942952448, occ[   6] =   2.00000000000000
lambda[   7] =  -0.05945330843182, occ[   7] =   0.00000001268697
lambda[   8] =  -0.02100914273839, occ[   8] =   0.00000000000000
lambda[   9] =   0.01056844513397, occ[   9] =   0.00000000000000
lambda[  10] =   0.02116172082197, occ[  10] =   0.00000000000000
lambda[  11] =   0.03290337141419, occ[  11] =   0.00000000000000
lambda[  12] =   0.03586014648642, occ[  12] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 11 (90%) = 0.000000000000000.
Occupation of state 12 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.267 ms, time for Allreduce/Reduce: 5.177 ms 
Time for calculating local force components: 11.296 ms
Start Calculating nonlocal forces
force_nloc = 
  0.04056416067715  -0.02906341846430   0.00000000229786
 -0.04510204222953  -0.02413977783910  -0.00000000723083
  0.05743670295240   0.02420313514361   0.00000000738567
  0.00216024865695  -0.05612985905305   0.00000025763614
 -0.63257948776835   0.56338184953067  -0.00000016259344
force_loc = 
 -0.04314787135167   0.02970511026924   0.00000003786042
  0.04719798722209   0.02493400652616   0.00000007164095
 -0.05936649671875  -0.02619603440876  -0.00000004032321
 -0.00005961684026   0.06965369138745   0.00000038967024
  0.61584553765769  -0.56066839693465   0.00000018058668
Time for calculating nonlocal force components: 16.553 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00013202350317  -0.00567855527436   0.00000000540171
[0m[32m  0.01720517181972  -0.01004853622739  -0.00000000632336
[0mTime for calculating XC forces components: 14.743 ms
 Cartesian force = 
 -0.00258816478937   0.00065104887384  -0.00000010704348
  0.00209149087771   0.00080358575596  -0.00000008279165
 -0.00193424788120  -0.00198354219625  -0.00000018013930
  0.00196415419866   0.00785463412893   0.00000050550632
  0.00046676759421  -0.00732572656248  -0.00000013553189
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Time for printing density: 366.422 ms
The program took 680.537 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:39:55
Job ID:        2266927
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:19:00,vmem=8476K,walltime=00:11:35,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-006-15-2
---------------------------------------
