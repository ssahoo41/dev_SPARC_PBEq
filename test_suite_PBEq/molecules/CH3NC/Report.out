---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:42
Job ID:    2266679
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:46
Job ID:    2266679
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.071 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.017 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 1.278 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 6.
[32m
Time for finding element is 0.016 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 1.010 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 10.997 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.960 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.191 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   11.455282	    7.200313	
   11.680414	    8.544718	    7.200313	
    8.319586	    8.544718	    7.200313	
   10.000000	    9.514905	    7.910427	
   10.000000	    9.514905	   12.799687	
   10.000000	    9.514905	   10.586111	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.264 ms
Set up communicators.

--set up spincomm took 3.801 ms

--set up kptcomm took 0.335 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.012 ms

--set up blacscomm took 0.006 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.099 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.344 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.988 ms

Calculate_SplineDerivRadFun took 0.199 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.286 ms.
time spent on vectorized spline interp: 2.430 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.003 ms.
time spent on vectorized spline interp: 1.904 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.516 ms.
time spent on vectorized spline interp: 1.797 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.509 ms.

Calculating rb for all atom types took 15.476 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.066 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000176681, sum_int_rho = 15.6929692199706
PosCharge = 16.000000017668, NegCharge = -15.692969219971, scal_fac = 1.019564863309
After scaling, int_rho = 16.0000000176681, PosCharge + NegCharge - NetCharge = 3.553e-15
--Calculate Vref took 0.410 ms
--Calculate rho_guess took 2.473 ms

 integral of b = -16.0000000176681,
 int{b} + Nelectron + NetCharge = -1.767e-08,
 Esc = -41.6317171714796,
 MPI_Reduce took 2.267 ms

Calculating b & b_ref took 11.197 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.027 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.096 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.003 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.033 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.005 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.006 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.009 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 26.995 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766809, int_b + int_rho = -3.329e-13, checking this took 0.088 ms
2-norm of RHS = 584.7212413625560, which took 0.460 ms

iter_count = 420, r_2norm = 5.357e-04, tol*||rhs|| = 5.847e-04

Anderson update took 261.212 ms, out of which F'*F took 117.607 ms; b-Ax took 796.349 ms, out of which Lap took 711.980 ms
Solving Poisson took 1762.142 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.416 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.831 ms
Total time for convolution: 	 convolve: 5.121272 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.767 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
Total time for convolution: 	 convolve: 5.092471 
Total time for convolution: 	 convolve: 5.090282 
Total time for convolution: 	 convolve: 5.096428 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.710 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.355 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
rank = 0, XC calculation took 24353.911 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 1.120 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.792 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 3.001 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.127 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.877 ms
    Lanczos iter 54, eigmin  = -0.961749206, eigmax = 264.923204743, err_eigmin = 1.048e-03, err_eigmax = 9.878e-03
rank =   0, Lanczos took 136.211 ms, eigmin = -0.961749205764, eigmax = 267.572436790036

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.255344, lowerbound = -1.061749, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1370.847 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 16.506 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.601 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.058 ms
rank =  0, Distribute data + matrix mult took 19.191 ms
rank =  0, finding HY took 21.555 ms
rank =  0, distributing HY into block cyclic form took 15.738 ms
rank =  0, finding Y'*HY took 2.322 ms
Rank 0, Project_Hamiltonian used 58.857 ms
Total time for projection: 58.872 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.697 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 1.844 ms
    first calculated eigval = 2.799997829698452
    last  calculated eigval = 3.181298219693742
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.79999782969845
lambda[   2] =   2.83906002143995
lambda[   3] =   2.84957206090091
lambda[   4] =   2.90839230670240
lambda[   5] =   2.94930669436567
lambda[   6] =   2.98078678396580
lambda[   7] =   3.01899641955492
lambda[   8] =   3.04886973839792
lambda[   9] =   3.06645946596120
lambda[  10] =   3.07795605762499
lambda[  11] =   3.09577578905955
lambda[  12] =   3.12612444803336
lambda[  13] =   3.15481022820092
lambda[  14] =   3.18129821969374
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.863 ms
rank =  0, subspace rotation using ScaLAPACK took 4.707 ms
rank =  0, Distributing orbital back into band + domain format took 13.583 ms
rank = 0, Subspace_Rotation used 18.314 ms

Total time for subspace rotation: 18.318 ms
rank = 0, Efermi =   3.057663315563 calculate fermi energy took 0.069 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.281298, lowerbound = -1.061749, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1360.265 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.803 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.583 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 16.440 ms
rank =  0, finding HY took 20.742 ms
rank =  0, distributing HY into block cyclic form took 14.844 ms
rank =  0, finding Y'*HY took 2.349 ms
Rank 0, Project_Hamiltonian used 54.426 ms
Total time for projection: 54.439 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.192 ms
    first calculated eigval = -0.811836178506916
    last  calculated eigval = 0.420474895080540
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.81183617850692
lambda[   2] =  -0.60581395425715
lambda[   3] =  -0.17871469776649
lambda[   4] =  -0.08280041596868
lambda[   5] =  -0.04624534806931
lambda[   6] =  -0.01580847600182
lambda[   7] =   0.15743022634933
lambda[   8] =   0.24432598354435
lambda[   9] =   0.30472623446509
lambda[  10] =   0.33125971568457
lambda[  11] =   0.33545786980226
lambda[  12] =   0.38187336765421
lambda[  13] =   0.41593366597017
lambda[  14] =   0.42047489508054
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 4.077 ms
rank =  0, Distributing orbital back into band + domain format took 14.068 ms
rank = 0, Subspace_Rotation used 18.169 ms

Total time for subspace rotation: 18.173 ms
rank = 0, Efermi =   0.275540300240 calculate fermi energy took 0.023 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.520475, lowerbound = -1.061749, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1321.370 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.546 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.568 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 19.169 ms
rank =  0, finding HY took 20.767 ms
rank =  0, distributing HY into block cyclic form took 14.926 ms
rank =  0, finding Y'*HY took 2.349 ms
Rank 0, Project_Hamiltonian used 57.286 ms
Total time for projection: 57.294 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -0.977589135588447
    last  calculated eigval = 0.151830156038208
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.97758913558845
lambda[   2] =  -0.81233583957905
lambda[   3] =  -0.59844227297811
lambda[   4] =  -0.51640238609155
lambda[   5] =  -0.51289111461491
lambda[   6] =  -0.37742077526661
lambda[   7] =  -0.37084321792367
lambda[   8] =  -0.29005078572276
lambda[   9] =  -0.01929962175433
lambda[  10] =  -0.00617858405413
lambda[  11] =   0.07332505000125
lambda[  12] =   0.08726263824768
lambda[  13] =   0.10545451343677
lambda[  14] =   0.15183015603821
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 4.324 ms
rank =  0, Distributing orbital back into band + domain format took 14.186 ms
rank = 0, Subspace_Rotation used 18.533 ms

Total time for subspace rotation: 18.537 ms
rank = 0, Efermi =  -0.048577237150 calculate fermi energy took 0.022 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.251830, lowerbound = -1.061749, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1357.944 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 14.795 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.533 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 16.389 ms
rank =  0, finding HY took 20.687 ms
rank =  0, distributing HY into block cyclic form took 14.925 ms
rank =  0, finding Y'*HY took 2.352 ms
Rank 0, Project_Hamiltonian used 54.394 ms
Total time for projection: 54.402 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.977821231118768
    last  calculated eigval = 0.070292747309992
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.97782123111877
lambda[   2] =  -0.81332630391861
lambda[   3] =  -0.60530640773690
lambda[   4] =  -0.52029676011649
lambda[   5] =  -0.52018614490168
lambda[   6] =  -0.38262549317474
lambda[   7] =  -0.38245982300148
lambda[   8] =  -0.33681646674114
lambda[   9] =  -0.06392077072447
lambda[  10] =  -0.05907276029688
lambda[  11] =   0.01753533902523
lambda[  12] =   0.03899364829587
lambda[  13] =   0.05901553932298
lambda[  14] =   0.07029274730999
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 4.148 ms
rank =  0, Distributing orbital back into band + domain format took 14.053 ms
rank = 0, Subspace_Rotation used 18.223 ms

Total time for subspace rotation: 18.227 ms
rank = 0, Efermi =  -0.093200997674 calculate fermi energy took 0.021 ms
rank = 0, --- Calculate rho: sum over local bands took 15.515 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.402 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.055 ms
rank = 0, Calculating density took 5865.875 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.374 ms
rank = 0, D2D took 0.476 ms
rank = 0, Transfering density took 0.484 ms
Etot    =   -24.226168306814
Eband   =    -9.077677262549
E1      =    18.563068222609
E2      =    -7.038726351665
E3      =    -8.813123676280
Exc     =    -7.931692122807
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 4.038e+00, dEband = 1.513e+00
rank = 0, Calculating/Estimating energy took 1.156 ms, Etot = -24.226168307, dEtot = 4.038e+00, dEband = 1.513e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 39.9558864826135, which took 0.127 ms

iter_count = 96, r_2norm = 1.205e-03, tol*||rhs|| = 1.598e-03

Anderson update took 57.689 ms, out of which F'*F took 26.760 ms; b-Ax took 179.271 ms, out of which Lap took 160.079 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 403.900 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766804, int_b + int_rho = -3.856e-13, checking this took 0.137 ms
2-norm of RHS = 581.2229914580105, which took 0.070 ms

iter_count = 282, r_2norm = 5.277e-04, tol*||rhs|| = 5.812e-04

Anderson update took 170.555 ms, out of which F'*F took 78.803 ms; b-Ax took 526.989 ms, out of which Lap took 470.159 ms
Solving Poisson took 1168.785 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.203 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.088750 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 37.785 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
Total time for convolution: 	 convolve: 5.132316 
Total time for convolution: 	 convolve: 5.090641 
Total time for convolution: 	 convolve: 5.088017 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.401 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.335 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.984 ms

This SCF took 31956.620 ms, scf error = 1.903e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.170293, lowerbound = -0.977821, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1299.623 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.687 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.528 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 16.269 ms
rank =  0, finding HY took 21.454 ms
rank =  0, distributing HY into block cyclic form took 14.725 ms
rank =  0, finding Y'*HY took 3.203 ms
Rank 0, Project_Hamiltonian used 55.701 ms
Total time for projection: 55.722 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.944248157887972
    last  calculated eigval = 0.041610389399692
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.94424815788797
lambda[   2] =  -0.78082173920649
lambda[   3] =  -0.57504082901972
lambda[   4] =  -0.49303569819786
lambda[   5] =  -0.49296409910443
lambda[   6] =  -0.35873319493927
lambda[   7] =  -0.35872793569194
lambda[   8] =  -0.31948270463132
lambda[   9] =  -0.05655584681314
lambda[  10] =  -0.05549261059929
lambda[  11] =  -0.01950099093947
lambda[  12] =   0.02254530545841
lambda[  13] =   0.03930754375946
lambda[  14] =   0.04161038939969
==subpsace eigenproblem: bcast eigvals took 0.047 ms
Total time for solving subspace eigenvalue problem: 0.239 ms
rank =  0, subspace rotation using ScaLAPACK took 3.963 ms
rank =  0, Distributing orbital back into band + domain format took 14.139 ms
rank = 0, Subspace_Rotation used 18.125 ms

Total time for subspace rotation: 18.129 ms
rank = 0, Efermi =  -0.086065151272 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.438 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.800 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.865 ms
rank = 0, Calculating density took 1378.554 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.390 ms
rank = 0, D2D took 0.510 ms
rank = 0, Transfering density took 0.515 ms
Etot    =   -24.187732026834
Eband   =    -8.646108718353
E1      =    18.170658956099
E2      =    -7.015437939146
E3      =    -8.931683381744
Exc     =    -8.027686413450
Esc     =   -41.631717171480
Entropy =    -0.000000000541
dE = 6.406e-03, dEband = 7.193e-02
rank = 0, Calculating/Estimating energy took 1.000 ms, Etot = -24.187732027, dEtot = 6.406e-03, dEband = 7.193e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 11.6676749106828, which took 0.068 ms

iter_count = 102, r_2norm = 4.081e-04, tol*||rhs|| = 4.667e-04

Anderson update took 60.432 ms, out of which F'*F took 29.881 ms; b-Ax took 203.158 ms, out of which Lap took 180.861 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 445.461 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766804, int_b + int_rho = -3.802e-13, checking this took 0.121 ms
2-norm of RHS = 576.1492757162466, which took 0.125 ms

iter_count = 300, r_2norm = 5.002e-04, tol*||rhs|| = 5.761e-04

Anderson update took 179.605 ms, out of which F'*F took 85.041 ms; b-Ax took 572.649 ms, out of which Lap took 509.466 ms
Solving Poisson took 1259.153 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.463 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.098156 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.092100 
Total time for convolution: 	 convolve: 5.096479 
Total time for convolution: 	 convolve: 5.099265 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.377 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 0.906 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.193 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.369 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.684 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.289 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.993 ms

This SCF took 27594.019 ms, scf error = 1.299e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.141610, lowerbound = -0.944248, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1363.427 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.911 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.667 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 16.620 ms
rank =  0, finding HY took 22.541 ms
rank =  0, distributing HY into block cyclic form took 15.571 ms
rank =  0, finding Y'*HY took 2.067 ms
Rank 0, Project_Hamiltonian used 56.844 ms
Total time for projection: 56.870 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.889990658897957
    last  calculated eigval = 0.034828513858288
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88999065889796
lambda[   2] =  -0.72273154965106
lambda[   3] =  -0.52230209534782
lambda[   4] =  -0.44464737409709
lambda[   5] =  -0.44459265104175
lambda[   6] =  -0.31687044359841
lambda[   7] =  -0.31686164574085
lambda[   8] =  -0.27780267889578
lambda[   9] =  -0.03297013946563
lambda[  10] =  -0.03014573613499
lambda[  11] =  -0.02756393176054
lambda[  12] =   0.01876823627792
lambda[  13] =   0.02636954531127
lambda[  14] =   0.03482851385829
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 3.986 ms
rank =  0, Distributing orbital back into band + domain format took 14.215 ms
rank = 0, Subspace_Rotation used 18.630 ms

Total time for subspace rotation: 18.652 ms
rank = 0, Efermi =  -0.062281395141 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.515 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.672 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.108 ms
rank = 0, Calculating density took 1442.612 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.650 ms
rank = 0, D2D took 0.872 ms
rank = 0, Transfering density took 0.883 ms
Etot    =   -24.152817256983
Eband   =    -7.871598195122
E1      =    17.489033707916
E2      =    -6.908550429543
E3      =    -9.182501467671
Exc     =    -8.229587494976
Esc     =   -41.631717171480
Entropy =    -0.000000000535
dE = 5.819e-03, dEband = 1.291e-01
rank = 0, Calculating/Estimating energy took 1.073 ms, Etot = -24.152817257, dEtot = 5.819e-03, dEband = 1.291e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.4583669650630, which took 0.054 ms

iter_count = 108, r_2norm = 1.120e-04, tol*||rhs|| = 1.783e-04

Anderson update took 603.017 ms, out of which F'*F took 267.304 ms; b-Ax took 1119.092 ms, out of which Lap took 1102.527 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 2170.130 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766807, int_b + int_rho = -3.529e-13, checking this took 0.112 ms
2-norm of RHS = 576.2132458806145, which took 0.085 ms

iter_count = 258, r_2norm = 5.512e-04, tol*||rhs|| = 5.762e-04

Anderson update took 338.785 ms, out of which F'*F took 110.698 ms; b-Ax took 787.047 ms, out of which Lap took 722.140 ms
Solving Poisson took 1659.495 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.218 ms
Total time for convolution: 	 convolve: 5.074716 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.802 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.081424 
Total time for convolution: 	 convolve: 5.078513 
Total time for convolution: 	 convolve: 5.074939 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.715 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.366 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.688 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.310 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.026 ms

This SCF took 29567.411 ms, scf error = 3.450e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.134829, lowerbound = -0.889991, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1303.209 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.815 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.514 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 16.385 ms
rank =  0, finding HY took 20.646 ms
rank =  0, distributing HY into block cyclic form took 14.660 ms
rank =  0, finding Y'*HY took 2.472 ms
Rank 0, Project_Hamiltonian used 54.223 ms
Total time for projection: 54.237 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.140 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.074 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -0.884257580632477
    last  calculated eigval = 0.029961270230409
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88425758063248
lambda[   2] =  -0.71581286252573
lambda[   3] =  -0.51558222048988
lambda[   4] =  -0.43793990004493
lambda[   5] =  -0.43788493637891
lambda[   6] =  -0.31108076287855
lambda[   7] =  -0.31106624488368
lambda[   8] =  -0.26998381390724
lambda[   9] =  -0.03534454980980
lambda[  10] =  -0.02592887623487
lambda[  11] =  -0.02479658086647
lambda[  12] =   0.01605299114747
lambda[  13] =   0.02156646236855
lambda[  14] =   0.02996127023041
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 4.656 ms
rank =  0, Distributing orbital back into band + domain format took 12.621 ms
rank = 0, Subspace_Rotation used 17.320 ms

Total time for subspace rotation: 17.331 ms
rank = 0, Efermi =  -0.064622171042 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 2.391 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.151 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.119 ms
rank = 0, Calculating density took 1380.093 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.599 ms
rank = 0, D2D took 0.834 ms
rank = 0, Transfering density took 0.844 ms
Etot    =   -24.150729560961
Eband   =    -7.767216644107
E1      =    17.420591035277
E2      =    -6.864434246607
E3      =    -9.224934333767
Exc     =    -8.261755360492
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 3.479e-04, dEband = 1.740e-02
rank = 0, Calculating/Estimating energy took 1.115 ms, Etot = -24.150729561, dEtot = 3.479e-04, dEband = 1.740e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0472470494630, which took 0.051 ms

iter_count = 114, r_2norm = 3.247e-05, tol*||rhs|| = 4.189e-05

Anderson update took 67.534 ms, out of which F'*F took 31.581 ms; b-Ax took 214.915 ms, out of which Lap took 192.228 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.324 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766806, int_b + int_rho = -3.638e-13, checking this took 0.114 ms
2-norm of RHS = 576.8491208813122, which took 0.127 ms

iter_count = 258, r_2norm = 5.478e-04, tol*||rhs|| = 5.768e-04

Anderson update took 152.437 ms, out of which F'*F took 73.149 ms; b-Ax took 491.240 ms, out of which Lap took 439.036 ms
Solving Poisson took 1070.706 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.418 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.079192 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.081497 
Total time for convolution: 	 convolve: 5.083138 
Total time for convolution: 	 convolve: 5.087174 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.682 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.329 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.044 ms

This SCF took 27249.712 ms, scf error = 1.772e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.129961, lowerbound = -0.884258, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1332.439 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 24.286 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.585 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 25.927 ms
rank =  0, finding HY took 20.789 ms
rank =  0, distributing HY into block cyclic form took 14.783 ms
rank =  0, finding Y'*HY took 2.475 ms
Rank 0, Project_Hamiltonian used 64.025 ms
Total time for projection: 64.041 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.147 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -0.881780141761212
    last  calculated eigval = 0.027216848983558
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88178014176121
lambda[   2] =  -0.71275550129600
lambda[   3] =  -0.51201068907863
lambda[   4] =  -0.43410449046972
lambda[   5] =  -0.43405170240021
lambda[   6] =  -0.30791509653620
lambda[   7] =  -0.30789485793845
lambda[   8] =  -0.26534852383375
lambda[   9] =  -0.03648986663677
lambda[  10] =  -0.02292848072753
lambda[  11] =  -0.02232153005427
lambda[  12] =   0.01435946954794
lambda[  13] =   0.02022433018603
lambda[  14] =   0.02721684898356
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 4.458 ms
rank =  0, Distributing orbital back into band + domain format took 13.284 ms
rank = 0, Subspace_Rotation used 17.771 ms

Total time for subspace rotation: 17.778 ms
rank = 0, Efermi =  -0.065767482008 calculate fermi energy took 0.134 ms
rank = 0, --- Calculate rho: sum over local bands took 2.510 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.685 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.070 ms
rank = 0, Calculating density took 1418.543 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.584 ms
rank = 0, D2D took 0.941 ms
rank = 0, Transfering density took 0.945 ms
Etot    =   -24.149682894132
Eband   =    -7.711722007273
E1      =    17.404271432195
E2      =    -6.818997050135
E3      =    -9.248325793352
Exc     =    -8.277837990528
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 1.744e-04, dEband = 9.249e-03
rank = 0, Calculating/Estimating energy took 1.130 ms, Etot = -24.149682894, dEtot = 1.744e-04, dEband = 9.249e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5670756506611, which took 0.057 ms

iter_count = 114, r_2norm = 1.550e-05, tol*||rhs|| = 2.268e-05

Anderson update took 69.171 ms, out of which F'*F took 32.258 ms; b-Ax took 216.718 ms, out of which Lap took 193.569 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.242 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766807, int_b + int_rho = -3.547e-13, checking this took 0.127 ms
2-norm of RHS = 577.1225846063162, which took 0.109 ms

iter_count = 246, r_2norm = 5.008e-04, tol*||rhs|| = 5.771e-04

Anderson update took 144.853 ms, out of which F'*F took 69.663 ms; b-Ax took 469.902 ms, out of which Lap took 419.842 ms
Solving Poisson took 1027.009 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.455 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.076474 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.076091 
Total time for convolution: 	 convolve: 5.075107 
Total time for convolution: 	 convolve: 5.073736 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.519 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.633 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.697 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.315 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.041 ms

This SCF took 27234.385 ms, scf error = 5.908e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.127217, lowerbound = -0.881780, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1380.950 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.702 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.572 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.050 ms
rank =  0, Distribute data + matrix mult took 16.352 ms
rank =  0, finding HY took 20.758 ms
rank =  0, distributing HY into block cyclic form took 14.824 ms
rank =  0, finding Y'*HY took 2.318 ms
Rank 0, Project_Hamiltonian used 54.293 ms
Total time for projection: 54.313 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.662 ms
    first calculated eigval = -0.878680261752462
    last  calculated eigval = 0.025315426002843
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87868026175246
lambda[   2] =  -0.70938269793957
lambda[   3] =  -0.50857956338344
lambda[   4] =  -0.43095678735931
lambda[   5] =  -0.43090652567501
lambda[   6] =  -0.30515612088739
lambda[   7] =  -0.30513495277268
lambda[   8] =  -0.26229654096648
lambda[   9] =  -0.03688235123670
lambda[  10] =  -0.02077139478298
lambda[  11] =  -0.02042994169701
lambda[  12] =   0.01376949437956
lambda[  13] =   0.01996942413025
lambda[  14] =   0.02531542600284
==subpsace eigenproblem: bcast eigvals took 0.087 ms
Total time for solving subspace eigenvalue problem: 0.757 ms
rank =  0, subspace rotation using ScaLAPACK took 4.496 ms
rank =  0, Distributing orbital back into band + domain format took 13.703 ms
rank = 0, Subspace_Rotation used 18.229 ms

Total time for subspace rotation: 18.234 ms
rank = 0, Efermi =  -0.066159966642 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 2.456 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.827 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1457.770 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.748 ms
rank = 0, D2D took 0.967 ms
rank = 0, Transfering density took 0.974 ms
Etot    =   -24.149476043618
Eband   =    -7.662186902124
E1      =    17.380451593570
E2      =    -6.789958395143
E3      =    -9.259802385594
Exc     =    -8.285784343788
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 3.448e-05, dEband = 8.256e-03
rank = 0, Calculating/Estimating energy took 1.053 ms, Etot = -24.149476044, dEtot = 3.448e-05, dEband = 8.256e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3460720325032, which took 0.051 ms

iter_count = 114, r_2norm = 9.671e-06, tol*||rhs|| = 1.384e-05

Anderson update took 67.801 ms, out of which F'*F took 31.992 ms; b-Ax took 217.390 ms, out of which Lap took 195.356 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.822 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766802, int_b + int_rho = -4.002e-13, checking this took 0.149 ms
2-norm of RHS = 577.2799624166372, which took 0.091 ms

iter_count = 228, r_2norm = 5.696e-04, tol*||rhs|| = 5.773e-04

Anderson update took 134.912 ms, out of which F'*F took 63.760 ms; b-Ax took 434.677 ms, out of which Lap took 388.471 ms
Solving Poisson took 957.202 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.079625 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.082824 
Total time for convolution: 	 convolve: 5.074188 
Total time for convolution: 	 convolve: 5.078706 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.773 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.666 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.989 ms

This SCF took 27255.647 ms, scf error = 3.202e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.125315, lowerbound = -0.878680, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1367.069 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 27.911 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.552 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 29.511 ms
rank =  0, finding HY took 20.768 ms
rank =  0, distributing HY into block cyclic form took 14.694 ms
rank =  0, finding Y'*HY took 2.253 ms
Rank 0, Project_Hamiltonian used 67.309 ms
Total time for projection: 67.326 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.107 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.168 ms
    first calculated eigval = -0.877078760525227
    last  calculated eigval = 0.024573976402038
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87707876052523
lambda[   2] =  -0.70789961198009
lambda[   3] =  -0.50722051402284
lambda[   4] =  -0.42970712918484
lambda[   5] =  -0.42965702855108
lambda[   6] =  -0.30359289085350
lambda[   7] =  -0.30357154866627
lambda[   8] =  -0.25991274771276
lambda[   9] =  -0.03656149697395
lambda[  10] =  -0.01915330999682
lambda[  11] =  -0.01899629360557
lambda[  12] =   0.01407882435416
lambda[  13] =   0.02038405610747
lambda[  14] =   0.02457397640204
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 3.791 ms
rank =  0, Distributing orbital back into band + domain format took 14.442 ms
rank = 0, Subspace_Rotation used 18.257 ms

Total time for subspace rotation: 18.260 ms
rank = 0, Efermi =  -0.065839112383 calculate fermi energy took 0.096 ms
rank = 0, --- Calculate rho: sum over local bands took 2.516 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.680 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.072 ms
rank = 0, Calculating density took 1456.273 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.514 ms
rank = 0, D2D took 0.805 ms
rank = 0, Transfering density took 0.816 ms
Etot    =   -24.149441756752
Eband   =    -7.637280463639
E1      =    17.370547868959
E2      =    -6.773404868636
E3      =    -9.264427218748
Exc     =    -8.288824077445
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 5.714e-06, dEband = 4.151e-03
rank = 0, Calculating/Estimating energy took 1.338 ms, Etot = -24.149441757, dEtot = 5.714e-06, dEband = 4.151e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2306370379273, which took 0.067 ms

iter_count = 108, r_2norm = 8.809e-06, tol*||rhs|| = 9.225e-06

Anderson update took 317.695 ms, out of which F'*F took 30.027 ms; b-Ax took 203.394 ms, out of which Lap took 181.138 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 711.715 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766804, int_b + int_rho = -3.802e-13, checking this took 0.107 ms
2-norm of RHS = 577.2912079564247, which took 0.089 ms

iter_count = 234, r_2norm = 5.023e-04, tol*||rhs|| = 5.773e-04

Anderson update took 140.172 ms, out of which F'*F took 65.608 ms; b-Ax took 444.228 ms, out of which Lap took 395.173 ms
Solving Poisson took 978.896 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.075124 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.909 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.083458 
Total time for convolution: 	 convolve: 5.076292 
Total time for convolution: 	 convolve: 5.076541 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.684 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.014 ms

This SCF took 27455.572 ms, scf error = 2.161e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.124574, lowerbound = -0.877079, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1369.044 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.241 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.368 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 15.670 ms
rank =  0, finding HY took 21.009 ms
rank =  0, distributing HY into block cyclic form took 14.755 ms
rank =  0, finding Y'*HY took 2.726 ms
Rank 0, Project_Hamiltonian used 55.301 ms
Total time for projection: 55.329 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.200 ms
    first calculated eigval = -0.874161123757619
    last  calculated eigval = 0.025056487017780
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87416112375762
lambda[   2] =  -0.70551140202174
lambda[   3] =  -0.50513171174060
lambda[   4] =  -0.42788499798669
lambda[   5] =  -0.42783532949508
lambda[   6] =  -0.30102800669013
lambda[   7] =  -0.30100742170315
lambda[   8] =  -0.25667206091097
lambda[   9] =  -0.03493055010820
lambda[  10] =  -0.01669112691130
lambda[  11] =  -0.01665433722953
lambda[  12] =   0.01612636605111
lambda[  13] =   0.02125465819485
lambda[  14] =   0.02505648701778
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 3.814 ms
rank =  0, Distributing orbital back into band + domain format took 14.274 ms
rank = 0, Subspace_Rotation used 18.110 ms

Total time for subspace rotation: 18.115 ms
rank = 0, Efermi =  -0.064208165501 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.450 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.800 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1446.149 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.723 ms
rank = 0, D2D took 0.951 ms
rank = 0, Transfering density took 0.960 ms
Etot    =   -24.149476802523
Eband   =    -7.598464109229
E1      =    17.349163347671
E2      =    -6.754135321284
E3      =    -9.271351334248
Exc     =    -8.293945524485
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 5.841e-06, dEband = 6.469e-03
rank = 0, Calculating/Estimating energy took 1.054 ms, Etot = -24.149476803, dEtot = 5.841e-06, dEband = 6.469e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1246389831565, which took 0.057 ms

iter_count = 114, r_2norm = 4.146e-06, tol*||rhs|| = 4.986e-06

Anderson update took 68.437 ms, out of which F'*F took 31.938 ms; b-Ax took 214.920 ms, out of which Lap took 191.224 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.733 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766808, int_b + int_rho = -3.402e-13, checking this took 0.139 ms
2-norm of RHS = 577.2951371200095, which took 0.124 ms

iter_count = 210, r_2norm = 4.842e-04, tol*||rhs|| = 5.773e-04

Anderson update took 124.778 ms, out of which F'*F took 58.990 ms; b-Ax took 399.380 ms, out of which Lap took 355.001 ms
Solving Poisson took 879.370 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.164 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.367 ms
Total time for convolution: 	 convolve: 5.081056 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.076987 
Total time for convolution: 	 convolve: 5.086426 
Total time for convolution: 	 convolve: 5.072825 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.255 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.334 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.654 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.979 ms

This SCF took 27120.713 ms, scf error = 1.276e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.125056, lowerbound = -0.874161, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1311.651 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.601 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.542 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 16.191 ms
rank =  0, finding HY took 20.780 ms
rank =  0, distributing HY into block cyclic form took 14.771 ms
rank =  0, finding Y'*HY took 2.282 ms
Rank 0, Project_Hamiltonian used 54.082 ms
Total time for projection: 54.104 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.212 ms
    first calculated eigval = -0.873598804091535
    last  calculated eigval = 0.025827767948738
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87359880409153
lambda[   2] =  -0.70523235623515
lambda[   3] =  -0.50488256373765
lambda[   4] =  -0.42762745870715
lambda[   5] =  -0.42757756480339
lambda[   6] =  -0.30046164142016
lambda[   7] =  -0.30044141530090
lambda[   8] =  -0.25603304233536
lambda[   9] =  -0.03328120113047
lambda[  10] =  -0.01597654682178
lambda[  11] =  -0.01590265011727
lambda[  12] =   0.01766431477793
lambda[  13] =   0.02181257995727
lambda[  14] =   0.02582776794874
==subpsace eigenproblem: bcast eigvals took 0.039 ms
Total time for solving subspace eigenvalue problem: 0.261 ms
rank =  0, subspace rotation using ScaLAPACK took 3.811 ms
rank =  0, Distributing orbital back into band + domain format took 14.276 ms
rank = 0, Subspace_Rotation used 18.109 ms

Total time for subspace rotation: 18.113 ms
rank = 0, Efermi =  -0.062558816484 calculate fermi energy took 0.038 ms
rank = 0, --- Calculate rho: sum over local bands took 2.531 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.716 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1387.599 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.691 ms
rank = 0, D2D took 0.920 ms
rank = 0, Transfering density took 0.927 ms
Etot    =   -24.149567555629
Eband   =    -7.591709693851
E1      =    17.347738681903
E2      =    -6.748869207539
E3      =    -9.270653616151
Exc     =    -8.293402195359
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 1.513e-05, dEband = 1.126e-03
rank = 0, Calculating/Estimating energy took 1.053 ms, Etot = -24.149567556, dEtot = 1.513e-05, dEband = 1.126e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0922910136629, which took 0.051 ms

iter_count = 108, r_2norm = 3.424e-06, tol*||rhs|| = 3.692e-06

Anderson update took 64.704 ms, out of which F'*F took 29.874 ms; b-Ax took 203.907 ms, out of which Lap took 181.520 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.036 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766809, int_b + int_rho = -3.311e-13, checking this took 0.110 ms
2-norm of RHS = 577.2789795729614, which took 0.137 ms

iter_count = 210, r_2norm = 5.406e-04, tol*||rhs|| = 5.773e-04

Anderson update took 125.561 ms, out of which F'*F took 58.748 ms; b-Ax took 398.683 ms, out of which Lap took 354.221 ms
Solving Poisson took 881.371 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.072569 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.374 ms
Total time for convolution: 	 convolve: 5.081873 
Total time for convolution: 	 convolve: 5.078068 
Total time for convolution: 	 convolve: 5.073955 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.662 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.691 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.732 ms

This SCF took 27021.028 ms, scf error = 9.284e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.125828, lowerbound = -0.873599, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1298.958 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 14.546 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.530 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.121 ms
rank =  0, finding HY took 20.852 ms
rank =  0, distributing HY into block cyclic form took 14.797 ms
rank =  0, finding Y'*HY took 2.297 ms
Rank 0, Project_Hamiltonian used 54.114 ms
Total time for projection: 54.136 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.872441852615131
    last  calculated eigval = 0.029369522728185
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87244185261513
lambda[   2] =  -0.70412302738338
lambda[   3] =  -0.50383162246196
lambda[   4] =  -0.42659235824372
lambda[   5] =  -0.42654230538550
lambda[   6] =  -0.29934484762663
lambda[   7] =  -0.29932462731163
lambda[   8] =  -0.25478768334615
lambda[   9] =  -0.02931309136673
lambda[  10] =  -0.01444370436116
lambda[  11] =  -0.01432039926149
lambda[  12] =   0.02139818100732
lambda[  13] =   0.02450681433177
lambda[  14] =   0.02936952272819
==subpsace eigenproblem: bcast eigvals took 0.038 ms
Total time for solving subspace eigenvalue problem: 0.212 ms
rank =  0, subspace rotation using ScaLAPACK took 3.785 ms
rank =  0, Distributing orbital back into band + domain format took 14.280 ms
rank = 0, Subspace_Rotation used 18.089 ms

Total time for subspace rotation: 18.094 ms
rank = 0, Efermi =  -0.058590706717 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.538 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.708 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1374.896 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.668 ms
rank = 0, D2D took 0.907 ms
rank = 0, Transfering density took 0.914 ms
Etot    =   -24.149622182384
Eband   =    -7.573976649266
E1      =    17.338579887471
E2      =    -6.739827266114
E3      =    -9.272823001105
Exc     =    -8.295158515796
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 9.104e-06, dEband = 2.956e-03
rank = 0, Calculating/Estimating energy took 1.093 ms, Etot = -24.149622182, dEtot = 9.104e-06, dEband = 2.956e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0558713144719, which took 0.064 ms

iter_count = 114, r_2norm = 1.875e-06, tol*||rhs|| = 2.235e-06

Anderson update took 68.336 ms, out of which F'*F took 31.966 ms; b-Ax took 215.437 ms, out of which Lap took 191.719 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.693 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766804, int_b + int_rho = -3.783e-13, checking this took 0.133 ms
2-norm of RHS = 577.2740710110953, which took 0.068 ms

iter_count = 168, r_2norm = 5.130e-04, tol*||rhs|| = 5.773e-04

Anderson update took 100.036 ms, out of which F'*F took 47.408 ms; b-Ax took 318.983 ms, out of which Lap took 283.360 ms
Solving Poisson took 703.994 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.076653 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.074452 
Total time for convolution: 	 convolve: 5.079146 
Total time for convolution: 	 convolve: 5.078972 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.691 ms
---Transfer Veff_loc: D2D took 1.136 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.819 ms

This SCF took 26859.230 ms, scf error = 5.178e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129370, lowerbound = -0.872442, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1373.307 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.645 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.574 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.260 ms
rank =  0, finding HY took 20.643 ms
rank =  0, distributing HY into block cyclic form took 14.680 ms
rank =  0, finding Y'*HY took 2.559 ms
Rank 0, Project_Hamiltonian used 54.192 ms
Total time for projection: 54.215 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.138 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -0.872010111440340
    last  calculated eigval = 0.030385324499505
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87201011144034
lambda[   2] =  -0.70371424548375
lambda[   3] =  -0.50345657985524
lambda[   4] =  -0.42624277196227
lambda[   5] =  -0.42619248012665
lambda[   6] =  -0.29896109747511
lambda[   7] =  -0.29894070122781
lambda[   8] =  -0.25439809864018
lambda[   9] =  -0.02840378975429
lambda[  10] =  -0.01408242027342
lambda[  11] =  -0.01396224311352
lambda[  12] =   0.02148706392291
lambda[  13] =   0.02535996187069
lambda[  14] =   0.03038532449950
==subpsace eigenproblem: bcast eigvals took 0.050 ms
Total time for solving subspace eigenvalue problem: 0.276 ms
rank =  0, subspace rotation using ScaLAPACK took 3.780 ms
rank =  0, Distributing orbital back into band + domain format took 14.277 ms
rank = 0, Subspace_Rotation used 18.080 ms

Total time for subspace rotation: 18.084 ms
rank = 0, Efermi =  -0.057681405122 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.513 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.764 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.073 ms
rank = 0, Calculating density took 1449.353 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.655 ms
rank = 0, D2D took 0.904 ms
rank = 0, Transfering density took 0.916 ms
Etot    =   -24.149659641883
Eband   =    -7.567832172925
E1      =    17.334894082311
E2      =    -6.737148242063
E3      =    -9.273748264363
Exc     =    -8.295900885685
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 6.243e-06, dEband = 1.024e-03
rank = 0, Calculating/Estimating energy took 1.107 ms, Etot = -24.149659642, dEtot = 6.243e-06, dEband = 1.024e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0427247607921, which took 0.053 ms

iter_count = 108, r_2norm = 1.436e-06, tol*||rhs|| = 1.709e-06

Anderson update took 64.971 ms, out of which F'*F took 29.960 ms; b-Ax took 203.685 ms, out of which Lap took 181.218 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.388 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766808, int_b + int_rho = -3.420e-13, checking this took 0.134 ms
2-norm of RHS = 577.2872153746233, which took 0.112 ms

iter_count = 186, r_2norm = 5.708e-04, tol*||rhs|| = 5.773e-04

Anderson update took 111.129 ms, out of which F'*F took 51.942 ms; b-Ax took 352.264 ms, out of which Lap took 312.682 ms
Solving Poisson took 779.666 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.075824 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.373 ms
Total time for convolution: 	 convolve: 5.073022 
Total time for convolution: 	 convolve: 5.077914 
Total time for convolution: 	 convolve: 5.075366 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.647 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.676 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.297 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.993 ms

This SCF took 26966.268 ms, scf error = 4.130e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.130385, lowerbound = -0.872010, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1368.973 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.663 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.541 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.078 ms
rank =  0, Distribute data + matrix mult took 16.305 ms
rank =  0, finding HY took 20.807 ms
rank =  0, distributing HY into block cyclic form took 14.776 ms
rank =  0, finding Y'*HY took 2.254 ms
Rank 0, Project_Hamiltonian used 54.188 ms
Total time for projection: 54.209 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.074 ms
rank = 0, Solve_Generalized_EigenProblem used 0.213 ms
    first calculated eigval = -0.871537832678246
    last  calculated eigval = 0.034127571702271
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87153783267825
lambda[   2] =  -0.70327247377413
lambda[   3] =  -0.50302453722454
lambda[   4] =  -0.42579719900057
lambda[   5] =  -0.42574597888177
lambda[   6] =  -0.29848325056782
lambda[   7] =  -0.29846229653123
lambda[   8] =  -0.25393138321624
lambda[   9] =  -0.02540765423040
lambda[  10] =  -0.01345977809805
lambda[  11] =  -0.01336257539524
lambda[  12] =   0.02323965379616
lambda[  13] =   0.02905603103251
lambda[  14] =   0.03412757170227
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 3.790 ms
rank =  0, Distributing orbital back into band + domain format took 14.310 ms
rank = 0, Subspace_Rotation used 18.122 ms

Total time for subspace rotation: 18.126 ms
rank = 0, Efermi =  -0.054685269791 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.524 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.761 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.073 ms
rank = 0, Calculating density took 1445.004 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.692 ms
rank = 0, D2D took 0.929 ms
rank = 0, Transfering density took 0.933 ms
Etot    =   -24.149732080973
Eband   =    -7.560509904198
E1      =    17.331818101064
E2      =    -6.732805422130
E3      =    -9.274020024286
Exc     =    -8.296148552243
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 1.207e-05, dEband = 1.220e-03
rank = 0, Calculating/Estimating energy took 2.018 ms, Etot = -24.149732081, dEtot = 1.207e-05, dEband = 1.220e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0490086141777, which took 0.064 ms

iter_count = 108, r_2norm = 1.393e-06, tol*||rhs|| = 1.960e-06

Anderson update took 64.773 ms, out of which F'*F took 30.055 ms; b-Ax took 203.454 ms, out of which Lap took 180.988 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.496 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766804, int_b + int_rho = -3.856e-13, checking this took 0.131 ms
2-norm of RHS = 577.2862758287405, which took 0.134 ms

iter_count = 156, r_2norm = 4.954e-04, tol*||rhs|| = 5.773e-04

Anderson update took 92.779 ms, out of which F'*F took 43.853 ms; b-Ax took 296.287 ms, out of which Lap took 263.039 ms
Solving Poisson took 653.295 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.073345 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.380 ms
Total time for convolution: 	 convolve: 5.073284 
Total time for convolution: 	 convolve: 5.082207 
Total time for convolution: 	 convolve: 5.072738 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.568 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.186 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.662 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.980 ms

This SCF took 26836.680 ms, scf error = 2.803e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134128, lowerbound = -0.871538, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1311.808 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.720 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.556 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 16.326 ms
rank =  0, finding HY took 20.704 ms
rank =  0, distributing HY into block cyclic form took 14.896 ms
rank =  0, finding Y'*HY took 2.210 ms
Rank 0, Project_Hamiltonian used 54.184 ms
Total time for projection: 54.204 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.196 ms
    first calculated eigval = -0.871318317403155
    last  calculated eigval = 0.035479027455881
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87131831740315
lambda[   2] =  -0.70307477493387
lambda[   3] =  -0.50284145041859
lambda[   4] =  -0.42562305572797
lambda[   5] =  -0.42557160672252
lambda[   6] =  -0.29828338088008
lambda[   7] =  -0.29826231341190
lambda[   8] =  -0.25374258680773
lambda[   9] =  -0.02443058607053
lambda[  10] =  -0.01334357606845
lambda[  11] =  -0.01326026805978
lambda[  12] =   0.02329755515687
lambda[  13] =   0.03016240372554
lambda[  14] =   0.03547902745588
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.211 ms
rank =  0, subspace rotation using ScaLAPACK took 3.776 ms
rank =  0, Distributing orbital back into band + domain format took 14.336 ms
rank = 0, Subspace_Rotation used 18.140 ms

Total time for subspace rotation: 18.145 ms
rank = 0, Efermi =  -0.053708202191 calculate fermi energy took 0.103 ms
rank = 0, --- Calculate rho: sum over local bands took 2.527 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.708 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.074 ms
rank = 0, Calculating density took 1387.880 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.746 ms
rank = 0, D2D took 1.848 ms
rank = 0, Transfering density took 1.855 ms
Etot    =   -24.149770137475
Eband   =    -7.557434973043
E1      =    17.330134860491
E2      =    -6.731328337227
E3      =    -9.274302605191
Exc     =    -8.296383795327
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 6.343e-06, dEband = 5.125e-04
rank = 0, Calculating/Estimating energy took 0.963 ms, Etot = -24.149770137, dEtot = 6.343e-06, dEband = 5.125e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0288130121842, which took 0.066 ms

iter_count = 108, r_2norm = 1.115e-06, tol*||rhs|| = 1.153e-06

Anderson update took 64.728 ms, out of which F'*F took 29.825 ms; b-Ax took 203.909 ms, out of which Lap took 181.335 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.061 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766807, int_b + int_rho = -3.529e-13, checking this took 0.102 ms
2-norm of RHS = 577.2910391019918, which took 0.112 ms

iter_count = 156, r_2norm = 5.074e-04, tol*||rhs|| = 5.773e-04

Anderson update took 93.097 ms, out of which F'*F took 43.633 ms; b-Ax took 296.534 ms, out of which Lap took 263.323 ms
Solving Poisson took 654.873 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.077535 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.075984 
Total time for convolution: 	 convolve: 5.089670 
Total time for convolution: 	 convolve: 5.073681 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.545 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.411 ms
---Transfer Veff_loc: D2D took 0.672 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.993 ms

This SCF took 26844.672 ms, scf error = 2.047e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135479, lowerbound = -0.871318, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1351.440 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.586 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.551 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 16.177 ms
rank =  0, finding HY took 20.871 ms
rank =  0, distributing HY into block cyclic form took 14.748 ms
rank =  0, finding Y'*HY took 2.238 ms
Rank 0, Project_Hamiltonian used 54.061 ms
Total time for projection: 54.079 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.871282374841857
    last  calculated eigval = 0.035901320191486
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87128237484186
lambda[   2] =  -0.70302112069775
lambda[   3] =  -0.50278009163731
lambda[   4] =  -0.42554737259947
lambda[   5] =  -0.42549593809195
lambda[   6] =  -0.29822866933155
lambda[   7] =  -0.29820765203725
lambda[   8] =  -0.25370302036218
lambda[   9] =  -0.02394384151086
lambda[  10] =  -0.01347634627832
lambda[  11] =  -0.01340685492026
lambda[  12] =   0.02344811681616
lambda[  13] =   0.03117492343831
lambda[  14] =   0.03590132019149
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 3.747 ms
rank =  0, Distributing orbital back into band + domain format took 14.334 ms
rank = 0, Subspace_Rotation used 18.093 ms

Total time for subspace rotation: 18.097 ms
rank = 0, Efermi =  -0.053221458918 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.524 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.723 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.075 ms
rank = 0, Calculating density took 1427.274 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.128 ms
rank = 0, D2D took 1.248 ms
rank = 0, Transfering density took 1.255 ms
Etot    =   -24.149805536836
Eband   =    -7.556532479622
E1      =    17.330035822615
E2      =    -6.730549296111
E3      =    -9.274050571803
Exc     =    -8.296191575730
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 5.900e-06, dEband = 1.504e-04
rank = 0, Calculating/Estimating energy took 1.506 ms, Etot = -24.149805537, dEtot = 5.900e-06, dEband = 1.504e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0309490221942, which took 0.094 ms

iter_count = 108, r_2norm = 1.123e-06, tol*||rhs|| = 1.238e-06

Anderson update took 64.282 ms, out of which F'*F took 30.105 ms; b-Ax took 203.644 ms, out of which Lap took 181.162 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.674 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766806, int_b + int_rho = -3.620e-13, checking this took 0.113 ms
2-norm of RHS = 577.2865353929321, which took 0.124 ms

iter_count = 102, r_2norm = 5.753e-04, tol*||rhs|| = 5.773e-04

Anderson update took 60.555 ms, out of which F'*F took 28.730 ms; b-Ax took 193.309 ms, out of which Lap took 171.522 ms
Solving Poisson took 428.292 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.246223 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
Total time for convolution: 	 convolve: 5.083757 
Total time for convolution: 	 convolve: 5.078422 
Total time for convolution: 	 convolve: 5.072890 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.289 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.435 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.685 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.009 ms

This SCF took 26765.842 ms, scf error = 2.033e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.135901, lowerbound = -0.871282, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1369.443 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.486 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.535 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.053 ms
rank =  0, finding HY took 20.680 ms
rank =  0, distributing HY into block cyclic form took 14.756 ms
rank =  0, finding Y'*HY took 2.216 ms
Rank 0, Project_Hamiltonian used 53.734 ms
Total time for projection: 53.751 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.147 ms
    first calculated eigval = -0.871156735741350
    last  calculated eigval = 0.036107017531226
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87115673574135
lambda[   2] =  -0.70291705936503
lambda[   3] =  -0.50268819818367
lambda[   4] =  -0.42546895578726
lambda[   5] =  -0.42541746036731
lambda[   6] =  -0.29813034030117
lambda[   7] =  -0.29810931281382
lambda[   8] =  -0.25362483536293
lambda[   9] =  -0.02378895821640
lambda[  10] =  -0.01339126421887
lambda[  11] =  -0.01332170200737
lambda[  12] =   0.02318403896048
lambda[  13] =   0.03081106939223
lambda[  14] =   0.03610701753123
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 3.776 ms
rank =  0, Distributing orbital back into band + domain format took 14.213 ms
rank = 0, Subspace_Rotation used 18.000 ms

Total time for subspace rotation: 18.712 ms
rank = 0, Efermi =  -0.053066575814 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.008 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.495 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.103 ms
rank = 0, Calculating density took 1445.783 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.016 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.606 ms
rank = 0, D2D took 0.800 ms
rank = 0, Transfering density took 0.806 ms
Etot    =   -24.149804207024
Eband   =    -7.555025796265
E1      =    17.328986690135
E2      =    -6.730032530216
E3      =    -9.274342845576
Exc     =    -8.296423304675
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 2.216e-07, dEband = 2.511e-04
rank = 0, Calculating/Estimating energy took 1.069 ms, Etot = -24.149804207, dEtot = 2.216e-07, dEband = 2.511e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0194410207107, which took 0.062 ms

iter_count = 114, r_2norm = 5.266e-07, tol*||rhs|| = 7.776e-07

Anderson update took 67.815 ms, out of which F'*F took 31.527 ms; b-Ax took 214.689 ms, out of which Lap took 191.120 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.073 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766810, int_b + int_rho = -3.256e-13, checking this took 0.106 ms
2-norm of RHS = 577.2867532485809, which took 0.132 ms

iter_count = 138, r_2norm = 5.551e-04, tol*||rhs|| = 5.773e-04

Anderson update took 82.363 ms, out of which F'*F took 39.119 ms; b-Ax took 261.746 ms, out of which Lap took 232.735 ms
Solving Poisson took 579.599 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.074001 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.878 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.078626 
Total time for convolution: 	 convolve: 5.080218 
Total time for convolution: 	 convolve: 5.074436 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.751 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.395 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.352 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.996 ms

This SCF took 26811.126 ms, scf error = 1.517e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136107, lowerbound = -0.871157, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1297.761 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.757 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.549 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 16.341 ms
rank =  0, finding HY took 20.820 ms
rank =  0, distributing HY into block cyclic form took 14.726 ms
rank =  0, finding Y'*HY took 2.286 ms
Rank 0, Project_Hamiltonian used 54.201 ms
Total time for projection: 54.216 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.871060296422324
    last  calculated eigval = 0.035666908363872
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87106029642232
lambda[   2] =  -0.70281812887920
lambda[   3] =  -0.50258959270261
lambda[   4] =  -0.42537031255080
lambda[   5] =  -0.42531886698895
lambda[   6] =  -0.29804343757463
lambda[   7] =  -0.29802242099256
lambda[   8] =  -0.25358163491950
lambda[   9] =  -0.02411290589715
lambda[  10] =  -0.01348839284617
lambda[  11] =  -0.01341990574848
lambda[  12] =   0.02291681980464
lambda[  13] =   0.03029379944362
lambda[  14] =   0.03566690836387
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 4.484 ms
rank =  0, Distributing orbital back into band + domain format took 12.860 ms
rank = 0, Subspace_Rotation used 17.363 ms

Total time for subspace rotation: 17.382 ms
rank = 0, Efermi =  -0.053390522837 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.292 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.858 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.111 ms
rank = 0, Calculating density took 1374.811 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.721 ms
rank = 0, D2D took 0.905 ms
rank = 0, Transfering density took 0.910 ms
Etot    =   -24.149821667198
Eband   =    -7.553609382487
E1      =    17.328272245929
E2      =    -6.729299022075
E3      =    -9.274390888377
Exc     =    -8.296457269080
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 2.910e-06, dEband = 2.361e-04
rank = 0, Calculating/Estimating energy took 1.038 ms, Etot = -24.149821667, dEtot = 2.910e-06, dEband = 2.361e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0161319852165, which took 0.055 ms

iter_count = 108, r_2norm = 5.114e-07, tol*||rhs|| = 6.453e-07

Anderson update took 64.346 ms, out of which F'*F took 30.254 ms; b-Ax took 203.371 ms, out of which Lap took 181.042 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.894 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766806, int_b + int_rho = -3.583e-13, checking this took 0.125 ms
2-norm of RHS = 577.2895426609056, which took 0.118 ms

iter_count = 144, r_2norm = 5.749e-04, tol*||rhs|| = 5.773e-04

Anderson update took 85.188 ms, out of which F'*F took 40.514 ms; b-Ax took 273.506 ms, out of which Lap took 243.065 ms
Solving Poisson took 603.698 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.075378 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.090407 
Total time for convolution: 	 convolve: 5.075155 
Total time for convolution: 	 convolve: 5.073470 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.066 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.209 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.693 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.308 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.024 ms

This SCF took 26721.898 ms, scf error = 1.158e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.135667, lowerbound = -0.871060, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1374.186 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.692 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.554 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.039 ms
rank =  0, Distribute data + matrix mult took 16.296 ms
rank =  0, finding HY took 20.826 ms
rank =  0, distributing HY into block cyclic form took 14.722 ms
rank =  0, finding Y'*HY took 2.245 ms
Rank 0, Project_Hamiltonian used 54.118 ms
Total time for projection: 54.140 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.871037887488298
    last  calculated eigval = 0.036479456536076
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87103788748830
lambda[   2] =  -0.70277438658556
lambda[   3] =  -0.50254221444479
lambda[   4] =  -0.42531164033592
lambda[   5] =  -0.42526018548507
lambda[   6] =  -0.29800708772833
lambda[   7] =  -0.29798605549943
lambda[   8] =  -0.25356270815736
lambda[   9] =  -0.02368461692014
lambda[  10] =  -0.01356329286888
lambda[  11] =  -0.01349622432903
lambda[  12] =   0.02355545715716
lambda[  13] =   0.03028915073901
lambda[  14] =   0.03647945653608
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.163 ms
rank =  0, subspace rotation using ScaLAPACK took 4.473 ms
rank =  0, Distributing orbital back into band + domain format took 13.415 ms
rank = 0, Subspace_Rotation used 17.906 ms

Total time for subspace rotation: 17.932 ms
rank = 0, Efermi =  -0.052962235520 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.526 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.691 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1450.314 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.714 ms
rank = 0, D2D took 0.915 ms
rank = 0, Transfering density took 0.920 ms
Etot    =   -24.149830154338
Eband   =    -7.552964331868
E1      =    17.328108023006
E2      =    -6.728821118275
E3      =    -9.274313152386
Exc     =    -8.296390944125
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 1.415e-06, dEband = 1.075e-04
rank = 0, Calculating/Estimating energy took 1.044 ms, Etot = -24.149830154, dEtot = 1.415e-06, dEband = 1.075e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0115854576611, which took 0.062 ms

iter_count = 114, r_2norm = 3.345e-07, tol*||rhs|| = 4.634e-07

Anderson update took 68.206 ms, out of which F'*F took 31.673 ms; b-Ax took 215.074 ms, out of which Lap took 191.334 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.001 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766809, int_b + int_rho = -3.365e-13, checking this took 0.119 ms
2-norm of RHS = 577.2883631318234, which took 0.129 ms

iter_count = 78, r_2norm = 5.315e-04, tol*||rhs|| = 5.773e-04

Anderson update took 46.248 ms, out of which F'*F took 22.062 ms; b-Ax took 147.825 ms, out of which Lap took 131.574 ms
Solving Poisson took 328.739 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.080090 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.076104 
Total time for convolution: 	 convolve: 5.079686 
Total time for convolution: 	 convolve: 5.074458 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.058 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.680 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.009 ms

This SCF took 26538.164 ms, scf error = 1.289e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.136479, lowerbound = -0.871038, upperbound = 267.572437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1373.226 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.619 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.554 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 16.208 ms
rank =  0, finding HY took 20.873 ms
rank =  0, distributing HY into block cyclic form took 14.770 ms
rank =  0, finding Y'*HY took 2.226 ms
Rank 0, Project_Hamiltonian used 54.104 ms
Total time for projection: 54.124 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.510 ms
    first calculated eigval = -0.870995416796152
    last  calculated eigval = 0.036053548411701
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87099541679615
lambda[   2] =  -0.70274278188423
lambda[   3] =  -0.50251475642068
lambda[   4] =  -0.42528977437990
lambda[   5] =  -0.42523834318213
lambda[   6] =  -0.29797689628349
lambda[   7] =  -0.29795588124651
lambda[   8] =  -0.25354613276927
lambda[   9] =  -0.02396967452664
lambda[  10] =  -0.01358563651737
lambda[  11] =  -0.01351768409595
lambda[  12] =   0.02330503167108
lambda[  13] =   0.02943614421359
lambda[  14] =   0.03605354841170
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.542 ms
rank =  0, subspace rotation using ScaLAPACK took 4.341 ms
rank =  0, Distributing orbital back into band + domain format took 13.788 ms
rank = 0, Subspace_Rotation used 18.144 ms

Total time for subspace rotation: 18.149 ms
rank = 0, Efermi =  -0.053247292195 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.540 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.676 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.072 ms
rank = 0, Calculating density took 1449.474 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.652 ms
rank = 0, D2D took 0.882 ms
rank = 0, Transfering density took 0.889 ms
Etot    =   -24.149829377365
Eband   =    -7.552519966348
E1      =    17.327787208854
E2      =    -6.728680621584
E3      =    -9.274391207144
Exc     =    -8.296451276587
Esc     =   -41.631717171480
Entropy =    -0.000000000533
dE = 1.295e-07, dEband = 7.406e-05
rank = 0, Calculating/Estimating energy took 1.076 ms, Etot = -24.149829377, dEtot = 1.295e-07, dEband = 7.406e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0089147091208, which took 0.067 ms

iter_count = 114, r_2norm = 3.112e-07, tol*||rhs|| = 3.566e-07

Anderson update took 78.978 ms, out of which F'*F took 42.095 ms; b-Ax took 235.890 ms, out of which Lap took 212.601 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 510.977 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001766842, int_rho =  16.00000001766807, int_b + int_rho = -3.547e-13, checking this took 0.103 ms
2-norm of RHS = 577.2878524842440, which took 0.114 ms

iter_count = 96, r_2norm = 5.361e-04, tol*||rhs|| = 5.773e-04

Anderson update took 56.833 ms, out of which F'*F took 26.893 ms; b-Ax took 182.513 ms, out of which Lap took 162.189 ms
Solving Poisson took 403.245 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
Total time for convolution: 	 convolve: 5.082277 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.664 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.080935 
Total time for convolution: 	 convolve: 5.074084 
Total time for convolution: 	 convolve: 5.076755 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.342 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.700 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.323 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.045 ms

This SCF took 26642.921 ms, scf error = 9.530e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -0.87099541679615, occ[   1] =   2.00000000000000
lambda[   2] =  -0.70274278188423, occ[   2] =   2.00000000000000
lambda[   3] =  -0.50251475642068, occ[   3] =   2.00000000000000
lambda[   4] =  -0.42528977437990, occ[   4] =   2.00000000000000
lambda[   5] =  -0.42523834318213, occ[   5] =   2.00000000000000
lambda[   6] =  -0.29797689628349, occ[   6] =   2.00000000000000
lambda[   7] =  -0.29795588124651, occ[   7] =   2.00000000000000
lambda[   8] =  -0.25354613276927, occ[   8] =   2.00000000000000
lambda[   9] =  -0.02396967452664, occ[   9] =   0.00000001766802
lambda[  10] =  -0.01358563651737, occ[  10] =   0.00000000000002
lambda[  11] =  -0.01351768409595, occ[  11] =   0.00000000000002
lambda[  12] =   0.02330503167108, occ[  12] =   0.00000000000000
lambda[  13] =   0.02943614421359, occ[  13] =   0.00000000000000
lambda[  14] =   0.03605354841170, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.440 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.592 ms, time for Allreduce/Reduce: 5.587 ms 
Time for calculating local force components: 15.224 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000000573961  -0.04758238668219   0.01788129560023
 -0.04127928796894   0.02387853988812   0.01797589003000
  0.04127929637314   0.02387854861411   0.01797591554525
  0.00000005159515   0.00002983150033   0.21558535714865
 -0.00000085547468   0.00003908531233  -0.61841454482177
 -0.00000043171345  -0.00020182222640  -0.01367708551891
force_loc = 
 -0.00000014084322   0.04890883523041  -0.01815671116652
  0.04230486233218  -0.02445832512406  -0.01814366070658
 -0.04230598353434  -0.02445883847477  -0.01814458751444
  0.00000220229403  -0.00018370901198  -0.20848384640767
 -0.00000207706548  -0.00004049440742   0.62481830555937
  0.00000007235862   0.00018788296327  -0.00758160745447
Time for calculating nonlocal force components: 28.109 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000006931116  -0.00000573951629  -0.00949505037678
[0m[32m -0.00000006360432  -0.00000061231109   0.00283787294347
[0m[32m -0.00000001851336  -0.00000095721233   0.01496149340467
[0mTime for calculating XC forces components: 19.557 ms
 Cartesian force = 
  0.00000023844936   0.00132814212455  -0.00026525494370
  0.00102595939543  -0.00057809165961  -0.00015761005399
 -0.00102630212902  -0.00057859628433  -0.00015851134661
  0.00000270823253  -0.00015792345162  -0.00238337901322
 -0.00000261111229  -0.00000032782985   0.00925179430366
  0.00000000716400  -0.00001320289913  -0.00628703894613
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.369 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.949 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.027 ms
Time for printing density: 383.037 ms
The program took 521.257 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:28
Job ID:        2266679
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:50:00,vmem=8460K,walltime=00:09:10,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-18-2
---------------------------------------
