---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:52
Job ID:    2266514
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:58
Job ID:    2266514
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 8.852 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 4.
[32m
Time for finding element is 0.023 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 8.678 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 56.316 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.169 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.129 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    9.187929	    8.110850	   10.000000	
   10.812071	    7.270013	   10.000000	
    9.489251	   10.545596	   10.000000	
    9.644647	   12.729987	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.201 ms
Set up communicators.

--set up spincomm took 3.714 ms

--set up kptcomm took 0.359 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.011 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.006 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.041 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.352 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 14.327 ms

Calculate_SplineDerivRadFun took 0.293 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.283 ms.
time spent on vectorized spline interp: 2.734 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.070 ms.
time spent on vectorized spline interp: 1.474 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.295 ms.
time spent on vectorized spline interp: 1.653 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.497 ms.
time spent on vectorized spline interp: 1.758 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.619 ms.

Calculating rb for all atom types took 19.394 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.829 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000124962, sum_int_rho = 15.8924533949603
PosCharge = 16.000000012496, NegCharge = -15.892453394960, scal_fac = 1.006767150097
After scaling, int_rho = 16.0000000124961, PosCharge + NegCharge - NetCharge = 3.197e-14
--Calculate Vref took 0.332 ms
--Calculate rho_guess took 1.803 ms

 integral of b = -16.0000000124962,
 int{b} + Nelectron + NetCharge = -1.250e-08,
 Esc = -52.3883896031804,
 MPI_Reduce took 4.169 ms

Calculating b & b_ref took 11.646 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.059 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.068 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 27.395 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249620, int_b + int_rho = 4.002e-14, checking this took 0.091 ms
2-norm of RHS = 513.1106318853804, which took 0.080 ms

iter_count = 420, r_2norm = 5.079e-04, tol*||rhs|| = 5.131e-04

Anderson update took 246.541 ms, out of which F'*F took 105.837 ms; b-Ax took 772.455 ms, out of which Lap took 695.554 ms
Solving Poisson took 1583.581 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
Total time for convolution: 	 convolve: 5.133534 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
Total time for convolution: 	 convolve: 5.184729 
Total time for convolution: 	 convolve: 5.139723 
Total time for convolution: 	 convolve: 5.498468 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.719 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.568 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.700 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
rank = 0, XC calculation took 25446.007 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.396 ms
---Transfer Veff_loc: D2D took 1.077 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.864 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 3.075 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.145 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 27.601 ms
    Lanczos iter 53, eigmin  = -1.090946750, eigmax = 264.925427685, err_eigmin = 6.954e-04, err_eigmax = 9.737e-03
rank =   0, Lanczos took 1161.345 ms, eigmin = -1.090946749923, eigmax = 267.574681961748

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.191868, lowerbound = -1.190947, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1275.375 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 674.195 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.581 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.818 ms
rank =  0, Distribute data + matrix mult took 677.616 ms
rank =  0, finding HY took 18.946 ms
rank =  0, distributing HY into block cyclic form took 14.791 ms
rank =  0, finding Y'*HY took 1.975 ms
Rank 0, Project_Hamiltonian used 713.369 ms
Total time for projection: 713.382 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.353 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.417 ms
    first calculated eigval = 2.787606613063365
    last  calculated eigval = 3.190026025735630
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.78760661306337
lambda[   2] =   2.83535898287629
lambda[   3] =   2.86891428048985
lambda[   4] =   2.91716544072746
lambda[   5] =   2.96366202632591
lambda[   6] =   2.98529477128284
lambda[   7] =   3.00837041936207
lambda[   8] =   3.04929237713638
lambda[   9] =   3.07420377474902
lambda[  10] =   3.08572381029320
lambda[  11] =   3.12016678361879
lambda[  12] =   3.13584804792430
lambda[  13] =   3.14878813096743
lambda[  14] =   3.19002602573563
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.434 ms
rank =  0, subspace rotation using ScaLAPACK took 3.540 ms
rank =  0, Distributing orbital back into band + domain format took 12.754 ms
rank = 0, Subspace_Rotation used 16.318 ms

Total time for subspace rotation: 16.322 ms
rank = 0, Efermi =   3.061747848565 calculate fermi energy took 0.052 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.290026, lowerbound = -1.190947, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1140.361 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 22.359 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.440 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 23.823 ms
rank =  0, finding HY took 18.720 ms
rank =  0, distributing HY into block cyclic form took 14.015 ms
rank =  0, finding Y'*HY took 13.229 ms
Rank 0, Project_Hamiltonian used 69.822 ms
Total time for projection: 69.828 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.887646686685413
    last  calculated eigval = 0.476506754133974
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88764668668541
lambda[   2] =  -0.69049279789842
lambda[   3] =  -0.42425777335241
lambda[   4] =  -0.18944478224724
lambda[   5] =   0.03267654610321
lambda[   6] =   0.12303875850268
lambda[   7] =   0.19202592504231
lambda[   8] =   0.27384952223944
lambda[   9] =   0.29918334372131
lambda[  10] =   0.33557394545776
lambda[  11] =   0.38133485359820
lambda[  12] =   0.38930506232594
lambda[  13] =   0.43969762224896
lambda[  14] =   0.47650675413397
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 3.174 ms
rank =  0, Distributing orbital back into band + domain format took 13.030 ms
rank = 0, Subspace_Rotation used 16.221 ms

Total time for subspace rotation: 16.225 ms
rank = 0, Efermi =   0.286516433774 calculate fermi energy took 0.022 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.576507, lowerbound = -1.190947, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1080.983 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 132.707 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.436 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 134.168 ms
rank =  0, finding HY took 18.109 ms
rank =  0, distributing HY into block cyclic form took 12.768 ms
rank =  0, finding Y'*HY took 2.077 ms
Rank 0, Project_Hamiltonian used 167.156 ms
Total time for projection: 167.163 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -1.111254760938378
    last  calculated eigval = 0.154386804868291
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.11125476093838
lambda[   2] =  -0.99739359137484
lambda[   3] =  -0.66809942160450
lambda[   4] =  -0.51255466187759
lambda[   5] =  -0.47528057914197
lambda[   6] =  -0.44972379180848
lambda[   7] =  -0.36290759831943
lambda[   8] =  -0.35277419654176
lambda[   9] =  -0.00156790471147
lambda[  10] =   0.03228402883207
lambda[  11] =   0.08378120629705
lambda[  12] =   0.09994903569301
lambda[  13] =   0.10622586915068
lambda[  14] =   0.15438680486829
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 3.158 ms
rank =  0, Distributing orbital back into band + domain format took 12.203 ms
rank = 0, Subspace_Rotation used 15.378 ms

Total time for subspace rotation: 15.382 ms
rank = 0, Efermi =  -0.031154259233 calculate fermi energy took 0.029 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.254387, lowerbound = -1.190947, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1121.278 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.592 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.505 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 14.124 ms
rank =  0, finding HY took 18.006 ms
rank =  0, distributing HY into block cyclic form took 12.540 ms
rank =  0, finding Y'*HY took 2.207 ms
Rank 0, Project_Hamiltonian used 46.908 ms
Total time for projection: 46.916 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -1.111521446437068
    last  calculated eigval = 0.094309566276220
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.11152144643707
lambda[   2] =  -0.99767588992480
lambda[   3] =  -0.66966538540205
lambda[   4] =  -0.52206394566490
lambda[   5] =  -0.48500807673682
lambda[   6] =  -0.46311183309609
lambda[   7] =  -0.40722153107954
lambda[   8] =  -0.38055155972939
lambda[   9] =  -0.05418230268768
lambda[  10] =  -0.04299879726237
lambda[  11] =  -0.01695093396162
lambda[  12] =   0.04508508031060
lambda[  13] =   0.05935810140840
lambda[  14] =   0.09430956627622
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 3.383 ms
rank =  0, Distributing orbital back into band + domain format took 11.947 ms
rank = 0, Subspace_Rotation used 15.350 ms

Total time for subspace rotation: 15.353 ms
rank = 0, Efermi =  -0.083768657332 calculate fermi energy took 0.025 ms
rank = 0, --- Calculate rho: sum over local bands took 2.095 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.718 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.093 ms
rank = 0, Calculating density took 6846.266 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.021 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.484 ms
rank = 0, D2D took 0.694 ms
rank = 0, Transfering density took 0.699 ms
Etot    =   -33.570187350071
Eband   =   -10.073639336818
E1      =    19.174685957862
E2      =    -8.740970696388
E3      =   -10.306913687411
Exc     =    -9.330728751353
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 8.393e+00, dEband = 2.518e+00
rank = 0, Calculating/Estimating energy took 1.031 ms, Etot = -33.570187350, dEtot = 8.393e+00, dEband = 2.518e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 51.9028319260773, which took 0.052 ms

iter_count = 96, r_2norm = 1.582e-03, tol*||rhs|| = 2.076e-03

Anderson update took 52.083 ms, out of which F'*F took 24.657 ms; b-Ax took 164.097 ms, out of which Lap took 147.156 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 352.379 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249620, int_b + int_rho = 3.820e-14, checking this took 0.103 ms
2-norm of RHS = 509.2617636909788, which took 0.126 ms

iter_count = 294, r_2norm = 4.420e-04, tol*||rhs|| = 5.093e-04

Anderson update took 166.252 ms, out of which F'*F took 93.563 ms; b-Ax took 523.856 ms, out of which Lap took 471.252 ms
Solving Poisson took 1086.796 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.710 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.124977 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.143753 
Total time for convolution: 	 convolve: 5.179016 
Total time for convolution: 	 convolve: 5.198217 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.294 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 0.703 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.030 ms

This SCF took 33060.250 ms, scf error = 1.549e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.194310, lowerbound = -1.111521, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1099.217 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.625 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.581 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.231 ms
rank =  0, finding HY took 18.167 ms
rank =  0, distributing HY into block cyclic form took 12.686 ms
rank =  0, finding Y'*HY took 2.830 ms
Rank 0, Project_Hamiltonian used 47.971 ms
Total time for projection: 47.988 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -1.095771153840613
    last  calculated eigval = 0.072555090717748
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.09577115384061
lambda[   2] =  -0.93873363572059
lambda[   3] =  -0.65587806531365
lambda[   4] =  -0.50113405996319
lambda[   5] =  -0.46381225544646
lambda[   6] =  -0.40544180050946
lambda[   7] =  -0.36753209664324
lambda[   8] =  -0.34061093506758
lambda[   9] =  -0.06070159477386
lambda[  10] =  -0.04366148465268
lambda[  11] =  -0.02755579234948
lambda[  12] =   0.02439284883307
lambda[  13] =   0.04347641667584
lambda[  14] =   0.07255509071775
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 3.137 ms
rank =  0, Distributing orbital back into band + domain format took 12.063 ms
rank = 0, Subspace_Rotation used 15.223 ms

Total time for subspace rotation: 15.227 ms
rank = 0, Efermi =  -0.090287949203 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 2.214 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.615 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.090 ms
rank = 0, Calculating density took 1165.674 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.457 ms
rank = 0, D2D took 0.660 ms
rank = 0, Transfering density took 0.664 ms
Etot    =   -33.511753291066
Eband   =    -9.537828005768
E1      =    18.741456122482
E2      =    -8.666423055727
E3      =   -10.448905663469
Exc     =    -9.442320523415
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 1.461e-02, dEband = 1.340e-01
rank = 0, Calculating/Estimating energy took 0.986 ms, Etot = -33.511753291, dEtot = 1.461e-02, dEband = 1.340e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 28.8511432848210, which took 0.125 ms

iter_count = 96, r_2norm = 1.119e-03, tol*||rhs|| = 1.154e-03

Anderson update took 51.533 ms, out of which F'*F took 23.633 ms; b-Ax took 165.888 ms, out of which Lap took 148.323 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 355.308 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249608, int_b + int_rho = -8.185e-14, checking this took 0.118 ms
2-norm of RHS = 507.5375493082357, which took 0.166 ms

iter_count = 294, r_2norm = 4.036e-04, tol*||rhs|| = 5.075e-04

Anderson update took 157.257 ms, out of which F'*F took 75.139 ms; b-Ax took 510.951 ms, out of which Lap took 456.632 ms
Solving Poisson took 1063.948 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.489 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.148214 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 239.395 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.138714 
Total time for convolution: 	 convolve: 5.140394 
Total time for convolution: 	 convolve: 5.114141 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.342 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.689 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.308 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.019 ms

This SCF took 27510.490 ms, scf error = 9.240e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.172555, lowerbound = -1.095771, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1117.974 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.560 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.734 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 14.336 ms
rank =  0, finding HY took 19.617 ms
rank =  0, distributing HY into block cyclic form took 13.082 ms
rank =  0, finding Y'*HY took 1.935 ms
Rank 0, Project_Hamiltonian used 49.008 ms
Total time for projection: 49.023 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -1.076977074194956
    last  calculated eigval = 0.059829719071840
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.07697707419496
lambda[   2] =  -0.88766471613823
lambda[   3] =  -0.63832136807884
lambda[   4] =  -0.47855229833281
lambda[   5] =  -0.44136656326624
lambda[   6] =  -0.36687202656272
lambda[   7] =  -0.33623397511617
lambda[   8] =  -0.30947220975688
lambda[   9] =  -0.06349076257263
lambda[  10] =  -0.02755145852837
lambda[  11] =  -0.00683221330400
lambda[  12] =   0.01827335325687
lambda[  13] =   0.03671444951832
lambda[  14] =   0.05982971907184
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 3.240 ms
rank =  0, Distributing orbital back into band + domain format took 12.094 ms
rank = 0, Subspace_Rotation used 15.350 ms

Total time for subspace rotation: 15.354 ms
rank = 0, Efermi =  -0.093077117228 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.657 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.810 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.110 ms
rank = 0, Calculating density took 1185.208 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.436 ms
rank = 0, D2D took 0.566 ms
rank = 0, Transfering density took 0.572 ms
Etot    =   -33.487743934446
Eband   =    -9.070920463687
E1      =    18.378901306348
E2      =    -8.559824737186
E3      =   -10.570497681425
Exc     =    -9.537657592158
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 6.002e-03, dEband = 1.167e-01
rank = 0, Calculating/Estimating energy took 2.339 ms, Etot = -33.487743934, dEtot = 6.002e-03, dEband = 1.167e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.4025510220007, which took 0.065 ms

iter_count = 102, r_2norm = 2.894e-04, tol*||rhs|| = 2.961e-04

Anderson update took 55.698 ms, out of which F'*F took 25.477 ms; b-Ax took 178.857 ms, out of which Lap took 160.714 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 380.142 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249610, int_b + int_rho = -6.730e-14, checking this took 0.087 ms
2-norm of RHS = 508.2128316753660, which took 0.113 ms

iter_count = 294, r_2norm = 4.222e-04, tol*||rhs|| = 5.082e-04

Anderson update took 157.763 ms, out of which F'*F took 73.369 ms; b-Ax took 498.798 ms, out of which Lap took 446.299 ms
Solving Poisson took 1054.345 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
Total time for convolution: 	 convolve: 5.133743 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.141553 
Total time for convolution: 	 convolve: 5.140669 
Total time for convolution: 	 convolve: 5.119437 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.212 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.427 ms
---Transfer Veff_loc: D2D took 0.694 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.024 ms

This SCF took 27248.597 ms, scf error = 5.031e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.159830, lowerbound = -1.076977, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.412 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.546 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.595 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.166 ms
rank =  0, finding HY took 18.638 ms
rank =  0, distributing HY into block cyclic form took 13.037 ms
rank =  0, finding Y'*HY took 1.916 ms
Rank 0, Project_Hamiltonian used 47.795 ms
Total time for projection: 47.809 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -1.064074263908291
    last  calculated eigval = 0.050797686292560
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06407426390829
lambda[   2] =  -0.84851900265831
lambda[   3] =  -0.62534309582418
lambda[   4] =  -0.46247865815467
lambda[   5] =  -0.42423464161609
lambda[   6] =  -0.34112688570639
lambda[   7] =  -0.31326833175015
lambda[   8] =  -0.28820411173114
lambda[   9] =  -0.06327183211129
lambda[  10] =  -0.01222537067021
lambda[  11] =   0.01285454078631
lambda[  12] =   0.01606381459375
lambda[  13] =   0.02817892214778
lambda[  14] =   0.05079768629256
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 3.301 ms
rank =  0, Distributing orbital back into band + domain format took 12.348 ms
rank = 0, Subspace_Rotation used 15.666 ms

Total time for subspace rotation: 15.670 ms
rank = 0, Efermi =  -0.092858186617 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 2.118 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.940 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.093 ms
rank = 0, Calculating density took 1187.386 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.387 ms
rank = 0, D2D took 0.665 ms
rank = 0, Transfering density took 0.672 ms
Etot    =   -33.478979066008
Eband   =    -8.734497983489
E1      =    18.148331108002
E2      =    -8.443185139511
E3      =   -10.656646725686
Exc     =    -9.604254452157
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 2.191e-03, dEband = 8.411e-02
rank = 0, Calculating/Estimating energy took 1.112 ms, Etot = -33.478979066, dEtot = 2.191e-03, dEband = 8.411e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.4473602213626, which took 0.059 ms

iter_count = 108, r_2norm = 8.768e-05, tol*||rhs|| = 9.789e-05

Anderson update took 61.964 ms, out of which F'*F took 27.003 ms; b-Ax took 184.374 ms, out of which Lap took 164.448 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 402.477 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249606, int_b + int_rho = -1.073e-13, checking this took 0.111 ms
2-norm of RHS = 509.3669502292158, which took 0.126 ms

iter_count = 270, r_2norm = 4.995e-04, tol*||rhs|| = 5.094e-04

Anderson update took 143.706 ms, out of which F'*F took 68.821 ms; b-Ax took 463.563 ms, out of which Lap took 415.999 ms
Solving Poisson took 973.885 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.398 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.139931 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.136233 
Total time for convolution: 	 convolve: 5.133925 
Total time for convolution: 	 convolve: 5.172642 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.666 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.012 ms

This SCF took 27231.135 ms, scf error = 1.550e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.150798, lowerbound = -1.064074, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1168.859 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.595 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.432 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 14.059 ms
rank =  0, finding HY took 18.634 ms
rank =  0, distributing HY into block cyclic form took 12.849 ms
rank =  0, finding Y'*HY took 2.097 ms
Rank 0, Project_Hamiltonian used 47.679 ms
Total time for projection: 47.695 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.157 ms
rank = 0, Solve_Generalized_EigenProblem used 0.245 ms
    first calculated eigval = -1.064907528153459
    last  calculated eigval = 0.044988966229357
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06490752815346
lambda[   2] =  -0.84078163062784
lambda[   3] =  -0.62574445536392
lambda[   4] =  -0.46232265693819
lambda[   5] =  -0.42318890885139
lambda[   6] =  -0.33249180555730
lambda[   7] =  -0.30814993961601
lambda[   8] =  -0.28375348687318
lambda[   9] =  -0.06457096671783
lambda[  10] =  -0.00921135628931
lambda[  11] =   0.01378216696306
lambda[  12] =   0.01685473499625
lambda[  13] =   0.01981127531613
lambda[  14] =   0.04498896622936
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.264 ms
rank =  0, subspace rotation using ScaLAPACK took 3.146 ms
rank =  0, Distributing orbital back into band + domain format took 12.159 ms
rank = 0, Subspace_Rotation used 15.321 ms

Total time for subspace rotation: 15.325 ms
rank = 0, Efermi =  -0.094157321357 calculate fermi energy took 0.072 ms
rank = 0, --- Calculate rho: sum over local bands took 2.228 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.779 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1235.379 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.558 ms
rank = 0, D2D took 0.741 ms
rank = 0, Transfering density took 0.749 ms
Etot    =   -33.477565489061
Eband   =    -8.682680824769
E1      =    18.136543855426
E2      =    -8.400279243293
E3      =   -10.669478517566
Exc     =    -9.612796677016
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 3.534e-04, dEband = 1.295e-02
rank = 0, Calculating/Estimating energy took 0.958 ms, Etot = -33.477565489, dEtot = 3.534e-04, dEband = 1.295e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.5707873320621, which took 0.055 ms

iter_count = 108, r_2norm = 4.761e-05, tol*||rhs|| = 6.283e-05

Anderson update took 58.241 ms, out of which F'*F took 26.895 ms; b-Ax took 184.222 ms, out of which Lap took 162.940 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 404.499 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249608, int_b + int_rho = -8.185e-14, checking this took 0.114 ms
2-norm of RHS = 509.8843598881318, which took 0.896 ms

iter_count = 258, r_2norm = 4.839e-04, tol*||rhs|| = 5.099e-04

Anderson update took 137.195 ms, out of which F'*F took 64.389 ms; b-Ax took 439.052 ms, out of which Lap took 392.160 ms
Solving Poisson took 944.131 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.384 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.153600 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.142730 
Total time for convolution: 	 convolve: 5.118255 
Total time for convolution: 	 convolve: 5.109591 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.608 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
---Transfer Veff_loc: D2D took 0.708 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.030 ms

This SCF took 27193.216 ms, scf error = 7.778e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.144989, lowerbound = -1.064908, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1114.256 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.656 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.526 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 14.210 ms
rank =  0, finding HY took 18.661 ms
rank =  0, distributing HY into block cyclic form took 12.560 ms
rank =  0, finding Y'*HY took 2.123 ms
Rank 0, Project_Hamiltonian used 47.590 ms
Total time for projection: 47.603 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -1.064454083092821
    last  calculated eigval = 0.040798187825269
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06445408309282
lambda[   2] =  -0.84028890130959
lambda[   3] =  -0.62564837445365
lambda[   4] =  -0.46195669615057
lambda[   5] =  -0.42257317135686
lambda[   6] =  -0.33001782054881
lambda[   7] =  -0.30699123291804
lambda[   8] =  -0.28257620545423
lambda[   9] =  -0.06561636176698
lambda[  10] =  -0.00873204250843
lambda[  11] =   0.01112086039887
lambda[  12] =   0.01412356338410
lambda[  13] =   0.01911712030961
lambda[  14] =   0.04079818782527
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 3.242 ms
rank =  0, Distributing orbital back into band + domain format took 12.084 ms
rank = 0, Subspace_Rotation used 15.342 ms

Total time for subspace rotation: 15.346 ms
rank = 0, Efermi =  -0.095202716361 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.189 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.718 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.170 ms
rank = 0, Calculating density took 1180.608 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.629 ms
rank = 0, D2D took 0.767 ms
rank = 0, Transfering density took 0.770 ms
Etot    =   -33.477114440060
Eband   =    -8.669012971389
E1      =    18.143405518305
E2      =    -8.378862286904
E3      =   -10.671061058266
Exc     =    -9.613040728586
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 1.128e-04, dEband = 3.417e-03
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -33.477114440, dEtot = 1.128e-04, dEband = 3.417e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6848394404229, which took 0.052 ms

iter_count = 108, r_2norm = 2.560e-05, tol*||rhs|| = 2.739e-05

Anderson update took 57.118 ms, out of which F'*F took 26.351 ms; b-Ax took 184.366 ms, out of which Lap took 163.935 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 406.456 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249614, int_b + int_rho = -2.365e-14, checking this took 0.110 ms
2-norm of RHS = 509.9985941112047, which took 0.101 ms

iter_count = 252, r_2norm = 4.984e-04, tol*||rhs|| = 5.100e-04

Anderson update took 134.381 ms, out of which F'*F took 64.393 ms; b-Ax took 441.983 ms, out of which Lap took 394.466 ms
Solving Poisson took 920.921 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.150168 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.149089 
Total time for convolution: 	 convolve: 5.202034 
Total time for convolution: 	 convolve: 5.141666 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.604 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.663 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 27250.707 ms, scf error = 4.232e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.140798, lowerbound = -1.064454, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1125.543 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.802 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.414 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.240 ms
rank =  0, finding HY took 18.731 ms
rank =  0, distributing HY into block cyclic form took 12.554 ms
rank =  0, finding Y'*HY took 2.068 ms
Rank 0, Project_Hamiltonian used 47.632 ms
Total time for projection: 47.645 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -1.062884899549920
    last  calculated eigval = 0.037739667623999
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06288489954992
lambda[   2] =  -0.83697368242546
lambda[   3] =  -0.62443902297724
lambda[   4] =  -0.46030404555746
lambda[   5] =  -0.42074264994268
lambda[   6] =  -0.32596926571903
lambda[   7] =  -0.30415473334604
lambda[   8] =  -0.27976213912796
lambda[   9] =  -0.06652399800585
lambda[  10] =  -0.00722371836543
lambda[  11] =   0.00780351089032
lambda[  12] =   0.01420533209958
lambda[  13] =   0.02133519114869
lambda[  14] =   0.03773966762400
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.266 ms
rank =  0, Distributing orbital back into band + domain format took 12.287 ms
rank = 0, Subspace_Rotation used 15.567 ms

Total time for subspace rotation: 15.570 ms
rank = 0, Efermi =  -0.096110352511 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.109 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.772 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1192.025 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.592 ms
rank = 0, D2D took 0.777 ms
rank = 0, Transfering density took 0.780 ms
Etot    =   -33.476830301850
Eband   =    -8.630460878123
E1      =    18.124656473801
E2      =    -8.356946441504
E3      =   -10.679272211991
Exc     =    -9.618854947463
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 7.103e-05, dEband = 9.638e-03
rank = 0, Calculating/Estimating energy took 0.945 ms, Etot = -33.476830302, dEtot = 7.103e-05, dEband = 9.638e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3188318068494, which took 0.052 ms

iter_count = 108, r_2norm = 1.215e-05, tol*||rhs|| = 1.275e-05

Anderson update took 56.916 ms, out of which F'*F took 26.629 ms; b-Ax took 183.282 ms, out of which Lap took 163.374 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 403.746 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249609, int_b + int_rho = -7.276e-14, checking this took 0.121 ms
2-norm of RHS = 509.8930565560210, which took 0.108 ms

iter_count = 258, r_2norm = 4.472e-04, tol*||rhs|| = 5.099e-04

Anderson update took 139.293 ms, out of which F'*F took 80.291 ms; b-Ax took 462.612 ms, out of which Lap took 414.450 ms
Solving Poisson took 955.989 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Total time for convolution: 	 convolve: 5.189811 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.206664 
Total time for convolution: 	 convolve: 5.191772 
Total time for convolution: 	 convolve: 5.145627 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.985 ms

This SCF took 27390.631 ms, scf error = 2.731e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.137740, lowerbound = -1.062885, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.906 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.672 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.417 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 14.120 ms
rank =  0, finding HY took 18.866 ms
rank =  0, distributing HY into block cyclic form took 12.619 ms
rank =  0, finding Y'*HY took 2.047 ms
Rank 0, Project_Hamiltonian used 47.694 ms
Total time for projection: 47.708 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -1.061531376380590
    last  calculated eigval = 0.035183842423399
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06153137638059
lambda[   2] =  -0.83314819459667
lambda[   3] =  -0.62329185295057
lambda[   4] =  -0.45884296328278
lambda[   5] =  -0.41889735606210
lambda[   6] =  -0.32195340310756
lambda[   7] =  -0.30086209744359
lambda[   8] =  -0.27675515855452
lambda[   9] =  -0.06650916587846
lambda[  10] =  -0.00519254918676
lambda[  11] =   0.00569202012245
lambda[  12] =   0.01685457852398
lambda[  13] =   0.02403796571204
lambda[  14] =   0.03518384242340
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 3.340 ms
rank =  0, Distributing orbital back into band + domain format took 12.147 ms
rank = 0, Subspace_Rotation used 15.507 ms

Total time for subspace rotation: 15.511 ms
rank = 0, Efermi =  -0.096095520428 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.107 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.830 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1187.407 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.570 ms
rank = 0, D2D took 0.772 ms
rank = 0, Transfering density took 0.775 ms
Etot    =   -33.476825016531
Eband   =    -8.590564805588
E1      =    18.103148110132
E2      =    -8.337073800920
E3      =   -10.684836090788
Exc     =    -9.622928609223
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 1.321e-06, dEband = 9.974e-03
rank = 0, Calculating/Estimating energy took 1.625 ms, Etot = -33.476825017, dEtot = 1.321e-06, dEband = 9.974e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2575774016903, which took 0.098 ms

iter_count = 108, r_2norm = 9.015e-06, tol*||rhs|| = 1.030e-05

Anderson update took 56.523 ms, out of which F'*F took 26.536 ms; b-Ax took 184.232 ms, out of which Lap took 164.432 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 403.408 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249613, int_b + int_rho = -3.092e-14, checking this took 0.164 ms
2-norm of RHS = 509.9104684096034, which took 0.067 ms

iter_count = 234, r_2norm = 4.340e-04, tol*||rhs|| = 5.099e-04

Anderson update took 123.776 ms, out of which F'*F took 58.741 ms; b-Ax took 408.054 ms, out of which Lap took 363.454 ms
Solving Poisson took 851.092 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Total time for convolution: 	 convolve: 5.190345 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.147656 
Total time for convolution: 	 convolve: 5.146286 
Total time for convolution: 	 convolve: 5.150179 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
---Transfer Veff_loc: D2D took 0.768 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.091 ms

This SCF took 27177.322 ms, scf error = 1.364e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.135184, lowerbound = -1.061531, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1122.006 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.610 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.412 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 14.046 ms
rank =  0, finding HY took 18.841 ms
rank =  0, distributing HY into block cyclic form took 12.822 ms
rank =  0, finding Y'*HY took 2.003 ms
Rank 0, Project_Hamiltonian used 47.748 ms
Total time for projection: 47.762 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -1.060280789007625
    last  calculated eigval = 0.033527947883026
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06028078900763
lambda[   2] =  -0.83138135608343
lambda[   3] =  -0.62211241804461
lambda[   4] =  -0.45758830293546
lambda[   5] =  -0.41755078883163
lambda[   6] =  -0.32047801166881
lambda[   7] =  -0.29932716481464
lambda[   8] =  -0.27529806607327
lambda[   9] =  -0.06389549563353
lambda[  10] =  -0.00419579799559
lambda[  11] =   0.00490687226774
lambda[  12] =   0.01948493374795
lambda[  13] =   0.02521254266624
lambda[  14] =   0.03352794788303
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.348 ms
rank =  0, Distributing orbital back into band + domain format took 12.022 ms
rank = 0, Subspace_Rotation used 15.390 ms

Total time for subspace rotation: 15.394 ms
rank = 0, Efermi =  -0.093481849979 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 2.183 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.698 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1188.430 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.575 ms
rank = 0, D2D took 0.746 ms
rank = 0, Transfering density took 0.749 ms
Etot    =   -33.476939967484
Eband   =    -8.568033795717
E1      =    18.091764703440
E2      =    -8.325317921630
E3      =   -10.687044891361
Exc     =    -9.624644084637
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 2.874e-05, dEband = 5.633e-03
rank = 0, Calculating/Estimating energy took 1.664 ms, Etot = -33.476939967, dEtot = 2.874e-05, dEband = 5.633e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1549199678194, which took 0.052 ms

iter_count = 108, r_2norm = 5.286e-06, tol*||rhs|| = 6.197e-06

Anderson update took 56.887 ms, out of which F'*F took 26.547 ms; b-Ax took 184.176 ms, out of which Lap took 164.415 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 403.254 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249611, int_b + int_rho = -6.003e-14, checking this took 0.127 ms
2-norm of RHS = 509.9300858786365, which took 0.120 ms

iter_count = 216, r_2norm = 4.778e-04, tol*||rhs|| = 5.099e-04

Anderson update took 114.152 ms, out of which F'*F took 54.984 ms; b-Ax took 374.551 ms, out of which Lap took 334.556 ms
Solving Poisson took 784.856 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.153456 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.153431 
Total time for convolution: 	 convolve: 5.170701 
Total time for convolution: 	 convolve: 5.140874 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.041 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.676 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.286 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.976 ms

This SCF took 27136.428 ms, scf error = 1.041e-03
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.133528, lowerbound = -1.060281, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.807 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.662 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.397 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 14.085 ms
rank =  0, finding HY took 18.836 ms
rank =  0, distributing HY into block cyclic form took 12.734 ms
rank =  0, finding Y'*HY took 2.021 ms
Rank 0, Project_Hamiltonian used 47.710 ms
Total time for projection: 47.724 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.140 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -1.059572654670817
    last  calculated eigval = 0.032643629112534
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05957265467082
lambda[   2] =  -0.83068552383843
lambda[   3] =  -0.62143174930781
lambda[   4] =  -0.45692107177457
lambda[   5] =  -0.41686292496002
lambda[   6] =  -0.31967661259053
lambda[   7] =  -0.29857981280349
lambda[   8] =  -0.27453307435024
lambda[   9] =  -0.06054976585631
lambda[  10] =  -0.00377547850173
lambda[  11] =   0.00447611172863
lambda[  12] =   0.02101437448146
lambda[  13] =   0.02561258729243
lambda[  14] =   0.03264362911253
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.239 ms
rank =  0, subspace rotation using ScaLAPACK took 3.341 ms
rank =  0, Distributing orbital back into band + domain format took 12.120 ms
rank = 0, Subspace_Rotation used 15.479 ms

Total time for subspace rotation: 15.483 ms
rank = 0, Efermi =  -0.090136120259 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.986 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.814 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1187.268 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.446 ms
rank = 0, D2D took 0.595 ms
rank = 0, Transfering density took 0.602 ms
Etot    =   -33.477069538342
Eband   =    -8.556526849348
E1      =    18.086705937759
E2      =    -8.318697890003
E3      =   -10.687429307296
Exc     =    -9.624986220490
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 3.239e-05, dEband = 2.877e-03
rank = 0, Calculating/Estimating energy took 1.830 ms, Etot = -33.477069538, dEtot = 3.239e-05, dEband = 2.877e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0901343460560, which took 0.050 ms

iter_count = 108, r_2norm = 2.984e-06, tol*||rhs|| = 3.605e-06

Anderson update took 57.037 ms, out of which F'*F took 26.646 ms; b-Ax took 183.241 ms, out of which Lap took 163.158 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 403.215 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249608, int_b + int_rho = -8.004e-14, checking this took 0.108 ms
2-norm of RHS = 509.9649186467063, which took 0.068 ms

iter_count = 210, r_2norm = 5.030e-04, tol*||rhs|| = 5.100e-04

Anderson update took 111.231 ms, out of which F'*F took 52.817 ms; b-Ax took 365.953 ms, out of which Lap took 325.984 ms
Solving Poisson took 764.465 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.207920 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.150142 
Total time for convolution: 	 convolve: 5.250813 
Total time for convolution: 	 convolve: 5.149637 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.676 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.292 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.982 ms

This SCF took 27206.091 ms, scf error = 6.120e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.132644, lowerbound = -1.059573, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.885 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.711 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.395 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.130 ms
rank =  0, finding HY took 18.843 ms
rank =  0, distributing HY into block cyclic form took 12.599 ms
rank =  0, finding Y'*HY took 2.712 ms
Rank 0, Project_Hamiltonian used 48.317 ms
Total time for projection: 48.331 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -1.058512969238842
    last  calculated eigval = 0.033614275114727
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05851296923884
lambda[   2] =  -0.82972551412255
lambda[   3] =  -0.62044422985648
lambda[   4] =  -0.45593690542115
lambda[   5] =  -0.41583907631027
lambda[   6] =  -0.31869654428916
lambda[   7] =  -0.29757767169331
lambda[   8] =  -0.27354245942626
lambda[   9] =  -0.05589244252457
lambda[  10] =  -0.00325955053196
lambda[  11] =   0.00498517810090
lambda[  12] =   0.02405452181355
lambda[  13] =   0.02656939286467
lambda[  14] =   0.03361427511473
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.163 ms
rank =  0, subspace rotation using ScaLAPACK took 3.277 ms
rank =  0, Distributing orbital back into band + domain format took 11.983 ms
rank = 0, Subspace_Rotation used 15.283 ms

Total time for subspace rotation: 15.288 ms
rank = 0, Efermi =  -0.085478796972 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 2.118 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.812 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1187.804 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.574 ms
rank = 0, D2D took 0.763 ms
rank = 0, Transfering density took 0.770 ms
Etot    =   -33.477178524003
Eband   =    -8.540550741414
E1      =    18.079364088492
E2      =    -8.309724829570
E3      =   -10.688540372563
Exc     =    -9.625867469653
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 2.725e-05, dEband = 3.994e-03
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -33.477178524, dEtot = 2.725e-05, dEband = 3.994e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1107021918232, which took 0.051 ms

iter_count = 108, r_2norm = 2.927e-06, tol*||rhs|| = 4.428e-06

Anderson update took 56.803 ms, out of which F'*F took 26.449 ms; b-Ax took 183.297 ms, out of which Lap took 163.252 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 403.475 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249617, int_b + int_rho = 0.000e+00, checking this took 0.112 ms
2-norm of RHS = 509.9615773846808, which took 0.064 ms

iter_count = 174, r_2norm = 4.386e-04, tol*||rhs|| = 5.100e-04

Anderson update took 92.561 ms, out of which F'*F took 44.462 ms; b-Ax took 303.083 ms, out of which Lap took 269.531 ms
Solving Poisson took 633.157 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.150935 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.139760 
Total time for convolution: 	 convolve: 5.106353 
Total time for convolution: 	 convolve: 5.127703 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.426 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.289 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.972 ms

This SCF took 26853.194 ms, scf error = 4.324e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.133614, lowerbound = -1.058513, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1119.641 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.609 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.415 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.047 ms
rank =  0, finding HY took 18.650 ms
rank =  0, distributing HY into block cyclic form took 12.894 ms
rank =  0, finding Y'*HY took 1.975 ms
Rank 0, Project_Hamiltonian used 47.600 ms
Total time for projection: 47.613 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -1.058346992549056
    last  calculated eigval = 0.034024511572680
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05834699254906
lambda[   2] =  -0.82947784833214
lambda[   3] =  -0.62027607486055
lambda[   4] =  -0.45575396825043
lambda[   5] =  -0.41565039178755
lambda[   6] =  -0.31843363597118
lambda[   7] =  -0.29733966577475
lambda[   8] =  -0.27331104225328
lambda[   9] =  -0.05515508108091
lambda[  10] =  -0.00328380636556
lambda[  11] =   0.00498098283794
lambda[  12] =   0.02490729405883
lambda[  13] =   0.02678704486272
lambda[  14] =   0.03402451157268
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 3.133 ms
rank =  0, Distributing orbital back into band + domain format took 12.022 ms
rank = 0, Subspace_Rotation used 15.174 ms

Total time for subspace rotation: 15.178 ms
rank = 0, Efermi =  -0.084741435795 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.237 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.611 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.072 ms
rank = 0, Calculating density took 1185.695 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
rank = 0, D2D took 0.752 ms
rank = 0, Transfering density took 0.761 ms
Etot    =   -33.477216227319
Eband   =    -8.537179240247
E1      =    18.077748735226
E2      =    -8.307932994257
E3      =   -10.688635637400
Exc     =    -9.625964750394
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 9.426e-06, dEband = 8.429e-04
rank = 0, Calculating/Estimating energy took 0.967 ms, Etot = -33.477216227, dEtot = 9.426e-06, dEband = 8.429e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1124519681731, which took 0.053 ms

iter_count = 108, r_2norm = 2.877e-06, tol*||rhs|| = 4.498e-06

Anderson update took 57.666 ms, out of which F'*F took 26.811 ms; b-Ax took 182.475 ms, out of which Lap took 162.514 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 403.031 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249612, int_b + int_rho = -4.547e-14, checking this took 0.119 ms
2-norm of RHS = 509.9608533671288, which took 0.103 ms

iter_count = 138, r_2norm = 4.316e-04, tol*||rhs|| = 5.100e-04

Anderson update took 73.204 ms, out of which F'*F took 34.517 ms; b-Ax took 239.047 ms, out of which Lap took 213.199 ms
Solving Poisson took 502.706 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.150578 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.145392 
Total time for convolution: 	 convolve: 5.175957 
Total time for convolution: 	 convolve: 5.112933 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.825 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.023 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.290 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 26762.038 ms, scf error = 3.920e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134025, lowerbound = -1.058347, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1121.562 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.596 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.410 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.030 ms
rank =  0, finding HY took 18.596 ms
rank =  0, distributing HY into block cyclic form took 12.718 ms
rank =  0, finding Y'*HY took 2.031 ms
Rank 0, Project_Hamiltonian used 47.410 ms
Total time for projection: 47.424 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -1.058258531955997
    last  calculated eigval = 0.033928800004413
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05825853195600
lambda[   2] =  -0.82934907408163
lambda[   3] =  -0.62019116071830
lambda[   4] =  -0.45566006323493
lambda[   5] =  -0.41555545614423
lambda[   6] =  -0.31831839351873
lambda[   7] =  -0.29723091690414
lambda[   8] =  -0.27320368871377
lambda[   9] =  -0.05502970481809
lambda[  10] =  -0.00332879228546
lambda[  11] =   0.00480892672989
lambda[  12] =   0.02498017281768
lambda[  13] =   0.02682895717198
lambda[  14] =   0.03392880000441
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 3.175 ms
rank =  0, Distributing orbital back into band + domain format took 12.029 ms
rank = 0, Subspace_Rotation used 15.218 ms

Total time for subspace rotation: 15.222 ms
rank = 0, Efermi =  -0.084616059518 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.177 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.673 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.075 ms
rank = 0, Calculating density took 1187.486 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
rank = 0, D2D took 0.753 ms
rank = 0, Transfering density took 0.756 ms
Etot    =   -33.477228768946
Eband   =    -8.535534571231
E1      =    18.076860818465
E2      =    -8.307125213604
E3      =   -10.688818614675
Exc     =    -9.626109240898
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 3.135e-06, dEband = 4.112e-04
rank = 0, Calculating/Estimating energy took 0.961 ms, Etot = -33.477228769, dEtot = 3.135e-06, dEband = 4.112e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1125298225473, which took 0.052 ms

iter_count = 102, r_2norm = 3.383e-06, tol*||rhs|| = 4.501e-06

Anderson update took 54.505 ms, out of which F'*F took 25.137 ms; b-Ax took 172.398 ms, out of which Lap took 153.898 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 381.932 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249611, int_b + int_rho = -5.639e-14, checking this took 0.125 ms
2-norm of RHS = 509.9723716278114, which took 0.103 ms

iter_count = 186, r_2norm = 4.336e-04, tol*||rhs|| = 5.100e-04

Anderson update took 98.722 ms, out of which F'*F took 47.375 ms; b-Ax took 323.101 ms, out of which Lap took 288.617 ms
Solving Poisson took 676.100 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.121146 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.120937 
Total time for convolution: 	 convolve: 5.154049 
Total time for convolution: 	 convolve: 5.110729 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.572 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.422 ms
---Transfer Veff_loc: D2D took 0.681 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.294 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.989 ms

This SCF took 26862.865 ms, scf error = 3.673e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133929, lowerbound = -1.058259, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.848 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.740 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.434 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.199 ms
rank =  0, finding HY took 18.865 ms
rank =  0, distributing HY into block cyclic form took 12.685 ms
rank =  0, finding Y'*HY took 2.076 ms
Rank 0, Project_Hamiltonian used 47.864 ms
Total time for projection: 47.894 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -1.058049236839743
    last  calculated eigval = 0.034371352539810
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05804923683974
lambda[   2] =  -0.82921732204498
lambda[   3] =  -0.61997218844920
lambda[   4] =  -0.45546192626137
lambda[   5] =  -0.41535804051111
lambda[   6] =  -0.31819631219164
lambda[   7] =  -0.29706915841700
lambda[   8] =  -0.27303986389548
lambda[   9] =  -0.05600481346246
lambda[  10] =  -0.00311552362951
lambda[  11] =   0.00543822748908
lambda[  12] =   0.02538496726158
lambda[  13] =   0.02684299028207
lambda[  14] =   0.03437135253981
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.138 ms
rank =  0, subspace rotation using ScaLAPACK took 3.180 ms
rank =  0, Distributing orbital back into band + domain format took 12.189 ms
rank = 0, Subspace_Rotation used 15.391 ms

Total time for subspace rotation: 15.394 ms
rank = 0, Efermi =  -0.085591167858 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.132 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.788 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1187.443 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.582 ms
rank = 0, D2D took 0.770 ms
rank = 0, Transfering density took 0.778 ms
Etot    =   -33.477291244005
Eband   =    -8.532728097921
E1      =    18.075938105054
E2      =    -8.305238164990
E3      =   -10.688562121499
Exc     =    -9.625911934066
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 1.562e-05, dEband = 7.016e-04
rank = 0, Calculating/Estimating energy took 0.951 ms, Etot = -33.477291244, dEtot = 1.562e-05, dEband = 7.016e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0957718605152, which took 0.052 ms

iter_count = 102, r_2norm = 3.609e-06, tol*||rhs|| = 3.831e-06

Anderson update took 53.765 ms, out of which F'*F took 25.179 ms; b-Ax took 172.385 ms, out of which Lap took 154.088 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 380.890 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249615, int_b + int_rho = -1.273e-14, checking this took 0.098 ms
2-norm of RHS = 509.9713702842237, which took 0.102 ms

iter_count = 168, r_2norm = 4.233e-04, tol*||rhs|| = 5.100e-04

Anderson update took 89.094 ms, out of which F'*F took 42.512 ms; b-Ax took 291.627 ms, out of which Lap took 260.530 ms
Solving Poisson took 611.203 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.128134 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.123498 
Total time for convolution: 	 convolve: 5.120016 
Total time for convolution: 	 convolve: 5.109704 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
---Transfer Veff_loc: D2D took 0.708 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.029 ms

This SCF took 26740.239 ms, scf error = 3.928e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.134371, lowerbound = -1.058049, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1119.315 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.905 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.440 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.392 ms
rank =  0, finding HY took 18.649 ms
rank =  0, distributing HY into block cyclic form took 12.760 ms
rank =  0, finding Y'*HY took 2.003 ms
Rank 0, Project_Hamiltonian used 47.839 ms
Total time for projection: 47.855 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -1.057841649874909
    last  calculated eigval = 0.034659962493013
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05784164987491
lambda[   2] =  -0.82891641659669
lambda[   3] =  -0.61978673334318
lambda[   4] =  -0.45525037535184
lambda[   5] =  -0.41514354975107
lambda[   6] =  -0.31789975310768
lambda[   7] =  -0.29681676519391
lambda[   8] =  -0.27278564666693
lambda[   9] =  -0.05592235566326
lambda[  10] =  -0.00288359131385
lambda[  11] =   0.00571078157680
lambda[  12] =   0.02577037411815
lambda[  13] =   0.02703133937872
lambda[  14] =   0.03465996249301
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 3.247 ms
rank =  0, Distributing orbital back into band + domain format took 12.113 ms
rank = 0, Subspace_Rotation used 15.374 ms

Total time for subspace rotation: 15.378 ms
rank = 0, Efermi =  -0.085508710031 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 2.154 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.736 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1185.831 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
rank = 0, D2D took 0.727 ms
rank = 0, Transfering density took 0.731 ms
Etot    =   -33.477300562547
Eband   =    -8.528881780471
E1      =    18.073775926515
E2      =    -8.303378541702
E3      =   -10.689239962896
Exc     =    -9.626423609629
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 2.330e-06, dEband = 9.616e-04
rank = 0, Calculating/Estimating energy took 0.986 ms, Etot = -33.477300563, dEtot = 2.330e-06, dEband = 9.616e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0792200545417, which took 0.052 ms

iter_count = 108, r_2norm = 2.495e-06, tol*||rhs|| = 3.169e-06

Anderson update took 56.843 ms, out of which F'*F took 26.730 ms; b-Ax took 183.373 ms, out of which Lap took 163.604 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 403.159 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249611, int_b + int_rho = -5.639e-14, checking this took 0.096 ms
2-norm of RHS = 509.9676635451768, which took 0.105 ms

iter_count = 108, r_2norm = 4.517e-04, tol*||rhs|| = 5.100e-04

Anderson update took 57.195 ms, out of which F'*F took 27.755 ms; b-Ax took 187.179 ms, out of which Lap took 167.109 ms
Solving Poisson took 393.684 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.126033 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.123337 
Total time for convolution: 	 convolve: 5.121012 
Total time for convolution: 	 convolve: 5.121709 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 0.682 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.291 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.988 ms

This SCF took 26567.962 ms, scf error = 3.159e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.134660, lowerbound = -1.057842, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1123.592 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.637 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.407 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.070 ms
rank =  0, finding HY took 18.851 ms
rank =  0, distributing HY into block cyclic form took 12.745 ms
rank =  0, finding Y'*HY took 2.074 ms
Rank 0, Project_Hamiltonian used 47.777 ms
Total time for projection: 47.792 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -1.057752714125208
    last  calculated eigval = 0.034483323086481
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05775271412521
lambda[   2] =  -0.82884675876213
lambda[   3] =  -0.61970519978307
lambda[   4] =  -0.45516977528671
lambda[   5] =  -0.41506789448017
lambda[   6] =  -0.31785375593757
lambda[   7] =  -0.29675956927625
lambda[   8] =  -0.27272364626354
lambda[   9] =  -0.05613640101371
lambda[  10] =  -0.00295226996156
lambda[  11] =   0.00570583083795
lambda[  12] =   0.02556972028894
lambda[  13] =   0.02703702828380
lambda[  14] =   0.03448332308648
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.372 ms
rank =  0, Distributing orbital back into band + domain format took 12.002 ms
rank = 0, Subspace_Rotation used 15.393 ms

Total time for subspace rotation: 15.397 ms
rank = 0, Efermi =  -0.085722755605 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.117 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.888 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1190.139 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.605 ms
rank = 0, D2D took 0.785 ms
rank = 0, Transfering density took 0.788 ms
Etot    =   -33.477309579865
Eband   =    -8.527758628531
E1      =    18.072994564789
E2      =    -8.302986068445
E3      =   -10.689445184254
Exc     =    -9.626587165261
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 2.254e-06, dEband = 2.808e-04
rank = 0, Calculating/Estimating energy took 0.953 ms, Etot = -33.477309580, dEtot = 2.254e-06, dEband = 2.808e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0491099862880, which took 0.053 ms

iter_count = 108, r_2norm = 1.749e-06, tol*||rhs|| = 1.964e-06

Anderson update took 56.786 ms, out of which F'*F took 26.573 ms; b-Ax took 182.245 ms, out of which Lap took 162.552 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 402.042 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249612, int_b + int_rho = -4.366e-14, checking this took 0.103 ms
2-norm of RHS = 509.9708613184083, which took 0.118 ms

iter_count = 186, r_2norm = 4.953e-04, tol*||rhs|| = 5.100e-04

Anderson update took 98.636 ms, out of which F'*F took 47.649 ms; b-Ax took 323.524 ms, out of which Lap took 288.705 ms
Solving Poisson took 676.327 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.124763 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.128045 
Total time for convolution: 	 convolve: 5.175549 
Total time for convolution: 	 convolve: 5.146898 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.668 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 26925.528 ms, scf error = 2.718e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.134483, lowerbound = -1.057753, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1114.807 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.935 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.320 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.096 ms
rank =  0, Distribute data + matrix mult took 18.367 ms
rank =  0, finding HY took 19.737 ms
rank =  0, distributing HY into block cyclic form took 12.691 ms
rank =  0, finding Y'*HY took 2.008 ms
Rank 0, Project_Hamiltonian used 52.930 ms
Total time for projection: 52.952 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -1.057739291524647
    last  calculated eigval = 0.035136293501476
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05773929152465
lambda[   2] =  -0.82897453182334
lambda[   3] =  -0.61966415679840
lambda[   4] =  -0.45516284099691
lambda[   5] =  -0.41507492500213
lambda[   6] =  -0.31801655040956
lambda[   7] =  -0.29684103096009
lambda[   8] =  -0.27280147682006
lambda[   9] =  -0.05746217707749
lambda[  10] =  -0.00273038268487
lambda[  11] =   0.00681029356954
lambda[  12] =   0.02607609897930
lambda[  13] =   0.02696672106231
lambda[  14] =   0.03513629350148
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 3.260 ms
rank =  0, Distributing orbital back into band + domain format took 12.706 ms
rank = 0, Subspace_Rotation used 15.989 ms

Total time for subspace rotation: 15.998 ms
rank = 0, Efermi =  -0.087048531497 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 2.628 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.842 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.315 ms
rank = 0, Calculating density took 1187.879 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
rank = 0, D2D took 0.944 ms
rank = 0, Transfering density took 0.949 ms
Etot    =   -33.477339116728
Eband   =    -8.528549609388
E1      =    18.073677390219
E2      =    -8.303221621176
E3      =   -10.688826905659
Exc     =    -9.626125820832
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 7.384e-06, dEband = 1.977e-04
rank = 0, Calculating/Estimating energy took 1.551 ms, Etot = -33.477339117, dEtot = 7.384e-06, dEband = 1.977e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0569091996946, which took 0.890 ms

iter_count = 108, r_2norm = 1.748e-06, tol*||rhs|| = 2.276e-06

Anderson update took 64.134 ms, out of which F'*F took 26.730 ms; b-Ax took 184.797 ms, out of which Lap took 165.199 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.483 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249608, int_b + int_rho = -8.185e-14, checking this took 0.118 ms
2-norm of RHS = 509.9710499873673, which took 0.097 ms

iter_count = 108, r_2norm = 4.585e-04, tol*||rhs|| = 5.100e-04

Anderson update took 61.337 ms, out of which F'*F took 27.531 ms; b-Ax took 187.728 ms, out of which Lap took 167.446 ms
Solving Poisson took 398.623 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.149737 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.125092 
Total time for convolution: 	 convolve: 5.160730 
Total time for convolution: 	 convolve: 5.115373 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.169 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.686 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.291 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.992 ms

This SCF took 26688.297 ms, scf error = 2.974e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.135136, lowerbound = -1.057739, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.143 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.582 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.417 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 23.024 ms
rank =  0, finding HY took 18.662 ms
rank =  0, distributing HY into block cyclic form took 12.772 ms
rank =  0, finding Y'*HY took 1.998 ms
Rank 0, Project_Hamiltonian used 56.499 ms
Total time for projection: 56.515 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -1.057663516316986
    last  calculated eigval = 0.035218304666304
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05766351631699
lambda[   2] =  -0.82890492007041
lambda[   3] =  -0.61959086412845
lambda[   4] =  -0.45508998689071
lambda[   5] =  -0.41500407748578
lambda[   6] =  -0.31795838954201
lambda[   7] =  -0.29677726206988
lambda[   8] =  -0.27273588752998
lambda[   9] =  -0.05720996153144
lambda[  10] =  -0.00257377630840
lambda[  11] =   0.00708942688819
lambda[  12] =   0.02650309844272
lambda[  13] =   0.02702348314615
lambda[  14] =   0.03521830466630
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 3.291 ms
rank =  0, Distributing orbital back into band + domain format took 12.163 ms
rank = 0, Subspace_Rotation used 15.472 ms

Total time for subspace rotation: 15.476 ms
rank = 0, Efermi =  -0.086796316096 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.116 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.781 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1195.384 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.568 ms
rank = 0, D2D took 0.768 ms
rank = 0, Transfering density took 0.776 ms
Etot    =   -33.477340120159
Eband   =    -8.527449808783
E1      =    18.073075698567
E2      =    -8.302691658165
E3      =   -10.688960417562
Exc     =    -9.626228482108
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 2.509e-07, dEband = 2.750e-04
rank = 0, Calculating/Estimating energy took 0.957 ms, Etot = -33.477340120, dEtot = 2.509e-07, dEband = 2.750e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1085714252493, which took 0.052 ms

iter_count = 96, r_2norm = 4.307e-06, tol*||rhs|| = 4.343e-06

Anderson update took 50.465 ms, out of which F'*F took 23.707 ms; b-Ax took 162.119 ms, out of which Lap took 144.842 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 360.112 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249616, int_b + int_rho = -5.457e-15, checking this took 0.648 ms
2-norm of RHS = 509.9855727383217, which took 0.150 ms

iter_count = 156, r_2norm = 4.573e-04, tol*||rhs|| = 5.100e-04

Anderson update took 83.258 ms, out of which F'*F took 39.275 ms; b-Ax took 270.997 ms, out of which Lap took 241.913 ms
Solving Poisson took 568.508 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.119865 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.201018 
Total time for convolution: 	 convolve: 5.137039 
Total time for convolution: 	 convolve: 5.366676 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.297 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.977 ms

This SCF took 27037.886 ms, scf error = 2.744e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.135218, lowerbound = -1.057664, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1115.274 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 24.510 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.443 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 25.977 ms
rank =  0, finding HY took 18.586 ms
rank =  0, distributing HY into block cyclic form took 12.658 ms
rank =  0, finding Y'*HY took 2.046 ms
Rank 0, Project_Hamiltonian used 59.304 ms
Total time for projection: 59.320 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -1.057685299564046
    last  calculated eigval = 0.036044255381294
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05768529956405
lambda[   2] =  -0.82888687045617
lambda[   3] =  -0.61958508834687
lambda[   4] =  -0.45508156354304
lambda[   5] =  -0.41499341291516
lambda[   6] =  -0.31788858510930
lambda[   7] =  -0.29672844729585
lambda[   8] =  -0.27269639028684
lambda[   9] =  -0.05658204848452
lambda[  10] =  -0.00198864232790
lambda[  11] =   0.00864641440460
lambda[  12] =   0.02706796173447
lambda[  13] =   0.02801512046105
lambda[  14] =   0.03604425538129
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.262 ms
rank =  0, Distributing orbital back into band + domain format took 12.108 ms
rank = 0, Subspace_Rotation used 15.385 ms

Total time for subspace rotation: 15.389 ms
rank = 0, Efermi =  -0.086168402944 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 2.100 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.782 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.090 ms
rank = 0, Calculating density took 1193.292 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
rank = 0, D2D took 0.760 ms
rank = 0, Transfering density took 0.762 ms
Etot    =   -33.477343323737
Eband   =    -8.527091315742
E1      =    18.073591798950
E2      =    -8.301899537305
E3      =   -10.688573854162
Exc     =    -9.625927594852
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 8.009e-07, dEband = 8.962e-05
rank = 0, Calculating/Estimating energy took 0.968 ms, Etot = -33.477343324, dEtot = 8.009e-07, dEband = 8.962e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0747933583203, which took 0.048 ms

iter_count = 102, r_2norm = 2.602e-06, tol*||rhs|| = 2.992e-06

Anderson update took 53.516 ms, out of which F'*F took 25.032 ms; b-Ax took 172.236 ms, out of which Lap took 153.883 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 380.897 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249614, int_b + int_rho = -2.728e-14, checking this took 0.106 ms
2-norm of RHS = 509.9718878668413, which took 0.108 ms

iter_count = 144, r_2norm = 4.716e-04, tol*||rhs|| = 5.100e-04

Anderson update took 76.359 ms, out of which F'*F took 36.321 ms; b-Ax took 249.530 ms, out of which Lap took 222.401 ms
Solving Poisson took 523.643 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.126697 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.128640 
Total time for convolution: 	 convolve: 5.118949 
Total time for convolution: 	 convolve: 5.143777 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.820 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.640 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.468 ms
---Transfer Veff_loc: D2D took 0.732 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.286 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.042 ms

This SCF took 26698.718 ms, scf error = 4.229e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.136044, lowerbound = -1.057685, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1118.590 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.675 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.410 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 14.112 ms
rank =  0, finding HY took 18.722 ms
rank =  0, distributing HY into block cyclic form took 12.550 ms
rank =  0, finding Y'*HY took 2.104 ms
Rank 0, Project_Hamiltonian used 47.523 ms
Total time for projection: 47.539 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -1.057389814267978
    last  calculated eigval = 0.034681392287242
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05738981426798
lambda[   2] =  -0.82864354139347
lambda[   3] =  -0.61932519655470
lambda[   4] =  -0.45483559956255
lambda[   5] =  -0.41475178569392
lambda[   6] =  -0.31773968685908
lambda[   7] =  -0.29654012470240
lambda[   8] =  -0.27249458264900
lambda[   9] =  -0.05696700644699
lambda[  10] =  -0.00225073988782
lambda[  11] =   0.00773577679456
lambda[  12] =   0.02680741688577
lambda[  13] =   0.02713441658550
lambda[  14] =   0.03468139228724
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.362 ms
rank =  0, Distributing orbital back into band + domain format took 12.055 ms
rank = 0, Subspace_Rotation used 15.437 ms

Total time for subspace rotation: 15.441 ms
rank = 0, Efermi =  -0.086553361118 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.112 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.829 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.083 ms
rank = 0, Calculating density took 1184.846 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.577 ms
rank = 0, D2D took 0.767 ms
rank = 0, Transfering density took 0.770 ms
Etot    =   -33.477344290919
Eband   =    -8.523440664078
E1      =    18.070837879758
E2      =    -8.300799650797
E3      =   -10.689457984270
Exc     =    -9.626609538105
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 2.418e-07, dEband = 9.127e-04
rank = 0, Calculating/Estimating energy took 0.967 ms, Etot = -33.477344291, dEtot = 2.418e-07, dEband = 9.127e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0740601611992, which took 0.057 ms

iter_count = 102, r_2norm = 1.831e-06, tol*||rhs|| = 2.962e-06

Anderson update took 53.694 ms, out of which F'*F took 25.174 ms; b-Ax took 172.288 ms, out of which Lap took 153.769 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 380.955 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249613, int_b + int_rho = -3.456e-14, checking this took 0.117 ms
2-norm of RHS = 509.9723907235207, which took 0.076 ms

iter_count = 156, r_2norm = 4.995e-04, tol*||rhs|| = 5.100e-04

Anderson update took 82.355 ms, out of which F'*F took 42.434 ms; b-Ax took 273.984 ms, out of which Lap took 244.810 ms
Solving Poisson took 569.648 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.145965 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.117490 
Total time for convolution: 	 convolve: 5.117859 
Total time for convolution: 	 convolve: 5.119249 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.691 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.289 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.994 ms

This SCF took 26723.801 ms, scf error = 2.061e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.134681, lowerbound = -1.057390, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1118.974 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.721 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.399 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 14.145 ms
rank =  0, finding HY took 18.600 ms
rank =  0, distributing HY into block cyclic form took 12.583 ms
rank =  0, finding Y'*HY took 2.045 ms
Rank 0, Project_Hamiltonian used 47.407 ms
Total time for projection: 47.454 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -1.057090269636036
    last  calculated eigval = 0.033427689706571
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05709026963604
lambda[   2] =  -0.82836121378119
lambda[   3] =  -0.61903956268766
lambda[   4] =  -0.45456895100839
lambda[   5] =  -0.41448372386990
lambda[   6] =  -0.31752485288451
lambda[   7] =  -0.29629438874795
lambda[   8] =  -0.27224570265560
lambda[   9] =  -0.05830122177163
lambda[  10] =  -0.00199642605125
lambda[  11] =   0.00857715657568
lambda[  12] =   0.02595448959593
lambda[  13] =   0.02709476844675
lambda[  14] =   0.03342768970657
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 3.258 ms
rank =  0, Distributing orbital back into band + domain format took 12.129 ms
rank = 0, Subspace_Rotation used 15.402 ms

Total time for subspace rotation: 15.405 ms
rank = 0, Efermi =  -0.087887576329 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.123 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.759 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1185.110 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.582 ms
rank = 0, D2D took 0.755 ms
rank = 0, Transfering density took 0.760 ms
Etot    =   -33.477348607404
Eband   =    -8.519217331271
E1      =    18.068364822921
E2      =    -8.298869801099
E3      =   -10.690149392134
Exc     =    -9.627125688726
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 1.079e-06, dEband = 1.056e-03
rank = 0, Calculating/Estimating energy took 2.078 ms, Etot = -33.477348607, dEtot = 1.079e-06, dEband = 1.056e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0442121656740, which took 0.050 ms

iter_count = 102, r_2norm = 1.212e-06, tol*||rhs|| = 1.768e-06

Anderson update took 53.852 ms, out of which F'*F took 25.098 ms; b-Ax took 172.152 ms, out of which Lap took 153.689 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 381.503 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249608, int_b + int_rho = -8.549e-14, checking this took 0.108 ms
2-norm of RHS = 509.9751932730193, which took 0.098 ms

iter_count = 150, r_2norm = 4.755e-04, tol*||rhs|| = 5.100e-04

Anderson update took 79.460 ms, out of which F'*F took 38.034 ms; b-Ax took 260.173 ms, out of which Lap took 232.245 ms
Solving Poisson took 545.364 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.126944 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.121235 
Total time for convolution: 	 convolve: 5.116068 
Total time for convolution: 	 convolve: 5.112194 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.643 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.671 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.291 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.976 ms

This SCF took 26682.490 ms, scf error = 1.201e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.133428, lowerbound = -1.057090, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1116.666 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.592 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.508 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 14.126 ms
rank =  0, finding HY took 18.596 ms
rank =  0, distributing HY into block cyclic form took 12.688 ms
rank =  0, finding Y'*HY took 2.068 ms
Rank 0, Project_Hamiltonian used 47.512 ms
Total time for projection: 47.526 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -1.056985000275601
    last  calculated eigval = 0.033514163134637
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05698500027560
lambda[   2] =  -0.82825736877880
lambda[   3] =  -0.61892525485644
lambda[   4] =  -0.45446275219617
lambda[   5] =  -0.41437933697803
lambda[   6] =  -0.31744459536639
lambda[   7] =  -0.29619397233300
lambda[   8] =  -0.27214787149777
lambda[   9] =  -0.05856638335044
lambda[  10] =  -0.00175125779281
lambda[  11] =   0.00956422718468
lambda[  12] =   0.02621338627190
lambda[  13] =   0.02726683983796
lambda[  14] =   0.03351416313464
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.256 ms
rank =  0, Distributing orbital back into band + domain format took 12.056 ms
rank = 0, Subspace_Rotation used 15.329 ms

Total time for subspace rotation: 15.333 ms
rank = 0, Efermi =  -0.088152737914 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.360 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.546 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.074 ms
rank = 0, Calculating density took 1182.789 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.532 ms
rank = 0, D2D took 0.687 ms
rank = 0, Transfering density took 0.694 ms
Etot    =   -33.477351041591
Eband   =    -8.517592305296
E1      =    18.067613019496
E2      =    -8.297968012654
E3      =   -10.690245818890
Exc     =    -9.627195983773
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 6.085e-07, dEband = 4.063e-04
rank = 0, Calculating/Estimating energy took 1.583 ms, Etot = -33.477351042, dEtot = 6.085e-07, dEband = 4.063e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0361957247911, which took 0.050 ms

iter_count = 102, r_2norm = 1.137e-06, tol*||rhs|| = 1.448e-06

Anderson update took 53.342 ms, out of which F'*F took 25.266 ms; b-Ax took 172.302 ms, out of which Lap took 153.688 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 380.512 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249608, int_b + int_rho = -8.549e-14, checking this took 0.103 ms
2-norm of RHS = 509.9717480972179, which took 0.112 ms

iter_count = 120, r_2norm = 4.766e-04, tol*||rhs|| = 5.100e-04

Anderson update took 63.512 ms, out of which F'*F took 30.238 ms; b-Ax took 209.183 ms, out of which Lap took 186.472 ms
Solving Poisson took 437.607 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.146159 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.118118 
Total time for convolution: 	 convolve: 5.136924 
Total time for convolution: 	 convolve: 5.140296 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.413 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.670 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.981 ms

This SCF took 26737.236 ms, scf error = 1.225e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.133514, lowerbound = -1.056985, upperbound = 267.574682

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1124.974 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.743 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.398 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 14.170 ms
rank =  0, finding HY took 18.730 ms
rank =  0, distributing HY into block cyclic form took 12.736 ms
rank =  0, finding Y'*HY took 2.219 ms
Rank 0, Project_Hamiltonian used 47.893 ms
Total time for projection: 47.907 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -1.056818777460727
    last  calculated eigval = 0.032754527788533
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05681877746073
lambda[   2] =  -0.82809833657085
lambda[   3] =  -0.61877274769568
lambda[   4] =  -0.45431242840823
lambda[   5] =  -0.41422999308427
lambda[   6] =  -0.31731184984916
lambda[   7] =  -0.29605521541053
lambda[   8] =  -0.27200462641148
lambda[   9] =  -0.05847492539402
lambda[  10] =  -0.00169752335897
lambda[  11] =   0.00939087272672
lambda[  12] =   0.02570572455867
lambda[  13] =   0.02729674336541
lambda[  14] =   0.03275452778853
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 3.146 ms
rank =  0, Distributing orbital back into band + domain format took 12.143 ms
rank = 0, Subspace_Rotation used 15.309 ms

Total time for subspace rotation: 15.313 ms
rank = 0, Efermi =  -0.088061279919 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 1.979 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.705 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1191.509 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
rank = 0, D2D took 0.781 ms
rank = 0, Transfering density took 0.790 ms
Etot    =   -33.477351449357
Eband   =    -8.515207950513
E1      =    18.066133012161
E2      =    -8.296965672630
E3      =   -10.690671298947
Exc     =    -9.627523879022
Esc     =   -52.388389603180
Entropy =    -0.000000000381
dE = 1.019e-07, dEband = 5.961e-04
rank = 0, Calculating/Estimating energy took 0.953 ms, Etot = -33.477351449, dEtot = 1.019e-07, dEband = 5.961e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0168944182853, which took 0.052 ms

iter_count = 102, r_2norm = 6.307e-07, tol*||rhs|| = 6.758e-07

Anderson update took 53.860 ms, out of which F'*F took 25.252 ms; b-Ax took 172.992 ms, out of which Lap took 154.348 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 381.577 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001249617, int_rho =  16.00000001249613, int_b + int_rho = -3.092e-14, checking this took 0.102 ms
2-norm of RHS = 509.9728260102312, which took 0.099 ms

iter_count = 138, r_2norm = 4.641e-04, tol*||rhs|| = 5.100e-04

Anderson update took 72.947 ms, out of which F'*F took 34.716 ms; b-Ax took 243.153 ms, out of which Lap took 217.324 ms
Solving Poisson took 504.268 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.123993 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.125994 
Total time for convolution: 	 convolve: 5.146469 
Total time for convolution: 	 convolve: 5.135807 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.365 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.695 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.291 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.002 ms

This SCF took 26704.851 ms, scf error = 6.758e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -1.05681877746073, occ[   1] =   2.00000000000000
lambda[   2] =  -0.82809833657085, occ[   2] =   2.00000000000000
lambda[   3] =  -0.61877274769568, occ[   3] =   2.00000000000000
lambda[   4] =  -0.45431242840823, occ[   4] =   2.00000000000000
lambda[   5] =  -0.41422999308427, occ[   5] =   2.00000000000000
lambda[   6] =  -0.31731184984916, occ[   6] =   2.00000000000000
lambda[   7] =  -0.29605521541053, occ[   7] =   2.00000000000000
lambda[   8] =  -0.27200462641148, occ[   8] =   2.00000000000000
lambda[   9] =  -0.05847492539402, occ[   9] =   0.00000001249612
lambda[  10] =  -0.00169752335897, occ[  10] =   0.00000000000000
lambda[  11] =   0.00939087272672, occ[  11] =   0.00000000000000
lambda[  12] =   0.02570572455867, occ[  12] =   0.00000000000000
lambda[  13] =   0.02729674336541, occ[  13] =   0.00000000000000
lambda[  14] =   0.03275452778853, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.426 ms, time for Allreduce/Reduce: 5.580 ms 
Time for calculating local force components: 13.671 ms
Start Calculating nonlocal forces
force_nloc = 
  0.96168105456273   0.70699280811191   0.00000080512281
 -0.06469394323602   0.03652533819355   0.00000000243777
 -0.04309561696416  -0.27864147803412   0.00000043561966
 -0.06949301790735  -0.98300421772761   0.00000013851251
force_loc = 
 -0.93648373058489  -0.68718325905424   0.00000081894715
  0.06671899087094  -0.03840491694667  -0.00000001424479
  0.04089274641434   0.23710624051520  -0.00000159350996
  0.06875803601494   0.98653988361686   0.00000407420981
Time for calculating nonlocal force components: 24.790 ms
[32mforces_xc: 
[0m[32m -0.02831970883285  -0.02151280908794   0.00000010612328
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00288281567009   0.02541466102331  -0.00000010539778
[0m[32m  0.00112700218542   0.01594058835365   0.00000017855344
[0mTime for calculating XC forces components: 17.052 ms
 Cartesian force = 
 -0.00311604190330  -0.00164646977125   0.00000051859977
  0.00203139058662  -0.00182278849408  -0.00000122340049
  0.00068628807197  -0.01606378623659  -0.00000247488156
  0.00039836324472   0.01953304450192   0.00000317968228
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Time for printing density: 394.127 ms
The program took 655.270 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:55
Job ID:        2266514
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:13:48,vmem=8356K,walltime=00:11:09,mem=8168K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-11-1
---------------------------------------
