---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:28
Job ID:    2266931
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:37
Job ID:    2266931
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 10.370 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 6.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 20.406 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 169.048 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.991 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.095 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.535209	    6.475444	   11.782900	
   10.535209	    6.475444	    8.217100	
   10.726538	   13.524556	   10.000000	
   10.372147	    7.454381	   10.000000	
    9.273462	   12.058735	   10.000000	
    9.978040	    9.851266	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.020 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.187 ms
Set up communicators.

--set up spincomm took 2.284 ms

--set up kptcomm took 0.327 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.121 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.284 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.414 ms

Calculate_SplineDerivRadFun took 0.215 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.249 ms.
time spent on vectorized spline interp: 2.154 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.980 ms.
time spent on vectorized spline interp: 1.597 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.460 ms.
time spent on vectorized spline interp: 1.590 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.463 ms.

Calculating rb for all atom types took 14.517 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.040 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000175864, sum_int_rho = 15.6933612743171
PosCharge = 16.000000017586, NegCharge = -15.693361274317, scal_fac = 1.019539392353
After scaling, int_rho = 16.0000000175864, PosCharge + NegCharge - NetCharge = 7.105e-15
--Calculate Vref took 0.425 ms
--Calculate rho_guess took 2.037 ms

 integral of b = -16.0000000175864,
 int{b} + Nelectron + NetCharge = -1.759e-08,
 Esc = -41.6314803802104,
 MPI_Reduce took 5.183 ms

Calculating b & b_ref took 13.272 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.089 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.100 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 36.514 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758636, int_b + int_rho = -9.641e-14, checking this took 0.103 ms
2-norm of RHS = 584.5444661927812, which took 0.075 ms

iter_count = 420, r_2norm = 5.391e-04, tol*||rhs|| = 5.845e-04

Anderson update took 259.149 ms, out of which F'*F took 108.271 ms; b-Ax took 739.742 ms, out of which Lap took 668.126 ms
Solving Poisson took 1544.351 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.551 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.835 ms
Total time for convolution: 	 convolve: 5.109207 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.491 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
Total time for convolution: 	 convolve: 5.116417 
Total time for convolution: 	 convolve: 5.113141 
Total time for convolution: 	 convolve: 5.226771 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.703 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.019 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.166 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.501 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
rank = 0, XC calculation took 24417.011 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 1.105 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.713 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 2.912 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.144 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.472 ms
    Lanczos iter 53, eigmin  = -0.975636955, eigmax = 264.924953563, err_eigmin = 9.376e-04, err_eigmax = 9.638e-03
rank =   0, Lanczos took 100.208 ms, eigmin = -0.975636954953, eigmax = 267.574203098629

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.249283, lowerbound = -1.075637, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 994.262 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.076 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.620 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.247 ms
rank =  0, Distribute data + matrix mult took 20.966 ms
rank =  0, finding HY took 21.368 ms
rank =  0, distributing HY into block cyclic form took 13.408 ms
rank =  0, finding Y'*HY took 2.195 ms
Rank 0, Project_Hamiltonian used 57.966 ms
Total time for projection: 57.986 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.321 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.132 ms
rank = 0, Solve_Generalized_EigenProblem used 0.860 ms
    first calculated eigval = 2.781253180120224
    last  calculated eigval = 3.188086966673963
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.78125318012022
lambda[   2] =   2.83611051381361
lambda[   3] =   2.86660385555091
lambda[   4] =   2.92661979538718
lambda[   5] =   2.95247195014923
lambda[   6] =   2.99037378841904
lambda[   7] =   3.00227633399902
lambda[   8] =   3.02768222317397
lambda[   9] =   3.07298131652668
lambda[  10] =   3.08288134077229
lambda[  11] =   3.10917143064313
lambda[  12] =   3.12719569987628
lambda[  13] =   3.15882139356036
lambda[  14] =   3.18808696667396
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.879 ms
rank =  0, subspace rotation using ScaLAPACK took 3.826 ms
rank =  0, Distributing orbital back into band + domain format took 12.444 ms
rank = 0, Subspace_Rotation used 16.290 ms

Total time for subspace rotation: 16.294 ms
rank = 0, Efermi =   3.050332515923 calculate fermi energy took 0.047 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.288087, lowerbound = -1.075637, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1162.641 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.090 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.472 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.046 ms
rank =  0, Distribute data + matrix mult took 13.620 ms
rank =  0, finding HY took 20.698 ms
rank =  0, distributing HY into block cyclic form took 12.161 ms
rank =  0, finding Y'*HY took 2.163 ms
Rank 0, Project_Hamiltonian used 48.682 ms
Total time for projection: 48.686 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -0.792956384590220
    last  calculated eigval = 0.462713337326691
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.79295638459022
lambda[   2] =  -0.57643568381530
lambda[   3] =  -0.28095294177604
lambda[   4] =  -0.06959060592037
lambda[   5] =   0.03752145547099
lambda[   6] =   0.10944262419760
lambda[   7] =   0.23560652331063
lambda[   8] =   0.29408426395502
lambda[   9] =   0.30279227944899
lambda[  10] =   0.33349919694506
lambda[  11] =   0.36636486326892
lambda[  12] =   0.37839791367427
lambda[  13] =   0.41634406358282
lambda[  14] =   0.46271333732669
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 2.739 ms
rank =  0, Distributing orbital back into band + domain format took 12.188 ms
rank = 0, Subspace_Rotation used 14.940 ms

Total time for subspace rotation: 14.943 ms
rank = 0, Efermi =   0.298438271783 calculate fermi energy took 0.019 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.562713, lowerbound = -1.075637, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1080.084 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.829 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.353 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 11.223 ms
rank =  0, finding HY took 16.318 ms
rank =  0, distributing HY into block cyclic form took 9.916 ms
rank =  0, finding Y'*HY took 1.986 ms
Rank 0, Project_Hamiltonian used 39.847 ms
Total time for projection: 39.860 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.672 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.735 ms
    first calculated eigval = -0.981735846352137
    last  calculated eigval = 0.122752334832767
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.98173584635214
lambda[   2] =  -0.80634016324456
lambda[   3] =  -0.59768386161102
lambda[   4] =  -0.53845615761104
lambda[   5] =  -0.52268958092483
lambda[   6] =  -0.41299306814079
lambda[   7] =  -0.34394294648794
lambda[   8] =  -0.22778722103347
lambda[   9] =  -0.05452977559125
lambda[  10] =   0.05197695393160
lambda[  11] =   0.08660984752083
lambda[  12] =   0.10251002376952
lambda[  13] =   0.12002317521674
lambda[  14] =   0.12275233483277
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.752 ms
rank =  0, subspace rotation using ScaLAPACK took 2.260 ms
rank =  0, Distributing orbital back into band + domain format took 9.647 ms
rank = 0, Subspace_Rotation used 11.917 ms

Total time for subspace rotation: 11.921 ms
rank = 0, Efermi =  -0.083811540203 calculate fermi energy took 0.046 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.222752, lowerbound = -1.075637, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 940.520 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 9.869 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.348 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.064 ms
rank =  0, Distribute data + matrix mult took 11.290 ms
rank =  0, finding HY took 16.330 ms
rank =  0, distributing HY into block cyclic form took 9.965 ms
rank =  0, finding Y'*HY took 1.972 ms
Rank 0, Project_Hamiltonian used 39.582 ms
Total time for projection: 39.586 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.982151068597709
    last  calculated eigval = 0.063962415847524
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.98215106859771
lambda[   2] =  -0.80705306802663
lambda[   3] =  -0.60549770217839
lambda[   4] =  -0.54268437712624
lambda[   5] =  -0.53339119277972
lambda[   6] =  -0.43093914255916
lambda[   7] =  -0.37527048614301
lambda[   8] =  -0.26845411344732
lambda[   9] =  -0.11553391710327
lambda[  10] =  -0.07206781812625
lambda[  11] =  -0.00141466192487
lambda[  12] =   0.05018372021744
lambda[  13] =   0.05714359368879
lambda[  14] =   0.06396241584752
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 2.242 ms
rank =  0, Distributing orbital back into band + domain format took 9.763 ms
rank = 0, Subspace_Rotation used 12.015 ms

Total time for subspace rotation: 12.019 ms
rank = 0, Efermi =  -0.144815681663 calculate fermi energy took 0.020 ms
rank = 0, --- Calculate rho: sum over local bands took 10.449 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.430 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.057 ms
rank = 0, Calculating density took 4534.333 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.184 ms
rank = 0, D2D took 1.278 ms
rank = 0, Transfering density took 1.284 ms
Etot    =   -24.180855664137
Eband   =    -9.090882303748
E1      =    18.572056409707
E2      =    -7.080116290921
E3      =    -8.844743170532
Exc     =    -7.955408850808
Esc     =   -41.631480380210
Entropy =    -0.000000000530
dE = 4.030e+00, dEband = 1.515e+00
rank = 0, Calculating/Estimating energy took 0.780 ms, Etot = -24.180855664, dEtot = 4.030e+00, dEband = 1.515e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 37.0964252986282, which took 0.046 ms

iter_count = 96, r_2norm = 1.198e-03, tol*||rhs|| = 1.484e-03

Anderson update took 41.704 ms, out of which F'*F took 21.565 ms; b-Ax took 141.720 ms, out of which Lap took 129.714 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 276.817 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758635, int_b + int_rho = -1.055e-13, checking this took 0.088 ms
2-norm of RHS = 581.3077894606823, which took 0.083 ms

iter_count = 282, r_2norm = 5.505e-04, tol*||rhs|| = 5.813e-04

Anderson update took 122.352 ms, out of which F'*F took 63.648 ms; b-Ax took 421.922 ms, out of which Lap took 388.467 ms
Solving Poisson took 804.551 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.235 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Total time for convolution: 	 convolve: 5.089474 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.669 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.090065 
Total time for convolution: 	 convolve: 5.100718 
Total time for convolution: 	 convolve: 5.125434 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.291 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.172 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.679 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.319 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.017 ms

This SCF took 30052.387 ms, scf error = 1.771e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.163962, lowerbound = -0.982151, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 897.747 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 9.705 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.330 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 11.076 ms
rank =  0, finding HY took 16.193 ms
rank =  0, distributing HY into block cyclic form took 9.834 ms
rank =  0, finding Y'*HY took 1.919 ms
Rank 0, Project_Hamiltonian used 39.045 ms
Total time for projection: 39.057 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.957062002139002
    last  calculated eigval = 0.040773122462675
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95706200213900
lambda[   2] =  -0.77543342211856
lambda[   3] =  -0.57393839403219
lambda[   4] =  -0.51885047655207
lambda[   5] =  -0.50496820810494
lambda[   6] =  -0.41133516348278
lambda[   7] =  -0.35630705042654
lambda[   8] =  -0.24487367043126
lambda[   9] =  -0.10255792044737
lambda[  10] =  -0.09779339306196
lambda[  11] =  -0.02447329694499
lambda[  12] =   0.02581101571704
lambda[  13] =   0.03442204102281
lambda[  14] =   0.04077312246268
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 2.217 ms
rank =  0, Distributing orbital back into band + domain format took 9.671 ms
rank = 0, Subspace_Rotation used 11.898 ms

Total time for subspace rotation: 11.903 ms
rank = 0, Efermi =  -0.131842590406 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.602 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.637 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.067 ms
rank = 0, Calculating density took 951.777 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.952 ms
rank = 0, D2D took 1.053 ms
rank = 0, Transfering density took 1.056 ms
Etot    =   -24.147478170309
Eband   =    -8.685536776378
E1      =    18.198649488912
E2      =    -7.061376986568
E3      =    -8.954241164011
Exc     =    -8.044728652681
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 5.563e-03, dEband = 6.756e-02
rank = 0, Calculating/Estimating energy took 0.790 ms, Etot = -24.147478170, dEtot = 5.563e-03, dEband = 6.756e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 11.4049067956923, which took 0.057 ms

iter_count = 102, r_2norm = 4.175e-04, tol*||rhs|| = 4.562e-04

Anderson update took 42.895 ms, out of which F'*F took 22.695 ms; b-Ax took 149.463 ms, out of which Lap took 136.702 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 292.425 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758644, int_b + int_rho = -1.455e-14, checking this took 0.093 ms
2-norm of RHS = 576.2742193611465, which took 0.103 ms

iter_count = 300, r_2norm = 4.835e-04, tol*||rhs|| = 5.763e-04

Anderson update took 124.727 ms, out of which F'*F took 67.258 ms; b-Ax took 445.764 ms, out of which Lap took 405.681 ms
Solving Poisson took 843.462 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.519 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.070529 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 55.965 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.064558 
Total time for convolution: 	 convolve: 5.064498 
Total time for convolution: 	 convolve: 5.063014 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.237 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.154 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.491 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.301 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.993 ms

This SCF took 26366.791 ms, scf error = 1.215e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.140773, lowerbound = -0.957062, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 903.819 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.443 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.621 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.173 ms
rank =  0, Distribute data + matrix mult took 18.248 ms
rank =  0, finding HY took 16.879 ms
rank =  0, distributing HY into block cyclic form took 9.786 ms
rank =  0, finding Y'*HY took 2.007 ms
Rank 0, Project_Hamiltonian used 46.945 ms
Total time for projection: 46.957 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.908036254056926
    last  calculated eigval = 0.032404347023962
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90803625405693
lambda[   2] =  -0.71780998419013
lambda[   3] =  -0.51980618579689
lambda[   4] =  -0.46894629810160
lambda[   5] =  -0.45650071363847
lambda[   6] =  -0.37233521435804
lambda[   7] =  -0.31642563002680
lambda[   8] =  -0.20143284563824
lambda[   9] =  -0.07006308269414
lambda[  10] =  -0.06529506468079
lambda[  11] =  -0.03076755920004
lambda[  12] =   0.01803905740365
lambda[  13] =   0.02540440121807
lambda[  14] =   0.03240434702396
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 2.238 ms
rank =  0, Distributing orbital back into band + domain format took 9.547 ms
rank = 0, Subspace_Rotation used 12.177 ms

Total time for subspace rotation: 12.182 ms
rank = 0, Efermi =  -0.099347739625 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.973 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.389 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.064 ms
rank = 0, Calculating density took 965.638 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.396 ms
rank = 0, D2D took 0.523 ms
rank = 0, Transfering density took 0.525 ms
Etot    =   -24.116383503271
Eband   =    -7.922586252846
E1      =    17.526134095021
E2      =    -6.956657798859
E3      =    -9.189957779699
Exc     =    -8.235066543263
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 5.182e-03, dEband = 1.272e-01
rank = 0, Calculating/Estimating energy took 0.802 ms, Etot = -24.116383503, dEtot = 5.182e-03, dEband = 1.272e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.6594235224607, which took 0.147 ms

iter_count = 102, r_2norm = 1.644e-04, tol*||rhs|| = 1.864e-04

Anderson update took 43.930 ms, out of which F'*F took 22.758 ms; b-Ax took 149.252 ms, out of which Lap took 137.207 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 293.715 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758638, int_b + int_rho = -8.185e-14, checking this took 0.082 ms
2-norm of RHS = 576.1984622148605, which took 0.095 ms

iter_count = 270, r_2norm = 4.809e-04, tol*||rhs|| = 5.762e-04

Anderson update took 115.094 ms, out of which F'*F took 60.830 ms; b-Ax took 399.737 ms, out of which Lap took 366.252 ms
Solving Poisson took 760.095 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.154 ms
Total time for convolution: 	 convolve: 5.115091 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.069943 
Total time for convolution: 	 convolve: 5.065957 
Total time for convolution: 	 convolve: 5.061429 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.167 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.995 ms

This SCF took 26283.023 ms, scf error = 3.496e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.132404, lowerbound = -0.908036, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 922.293 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.097 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.320 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.153 ms
rank =  0, Distribute data + matrix mult took 13.582 ms
rank =  0, finding HY took 16.320 ms
rank =  0, distributing HY into block cyclic form took 9.555 ms
rank =  0, finding Y'*HY took 2.091 ms
Rank 0, Project_Hamiltonian used 41.574 ms
Total time for projection: 41.641 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.897835169557577
    last  calculated eigval = 0.029958569604966
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.89783516955758
lambda[   2] =  -0.70819442702541
lambda[   3] =  -0.51081471136444
lambda[   4] =  -0.45818632494423
lambda[   5] =  -0.44830857290044
lambda[   6] =  -0.36360474385547
lambda[   7] =  -0.30762051774633
lambda[   8] =  -0.19467809456752
lambda[   9] =  -0.06295586017531
lambda[  10] =  -0.05911846996754
lambda[  11] =  -0.03201806261754
lambda[  12] =   0.01507778582531
lambda[  13] =   0.02098721871105
lambda[  14] =   0.02995856960497
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 2.761 ms
rank =  0, Distributing orbital back into band + domain format took 8.910 ms
rank = 0, Subspace_Rotation used 11.684 ms

Total time for subspace rotation: 11.691 ms
rank = 0, Efermi =  -0.092247029281 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.528 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.558 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.068 ms
rank = 0, Calculating density took 978.980 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
rank = 0, D2D took 0.646 ms
rank = 0, Transfering density took 0.654 ms
Etot    =   -24.114102874019
Eband   =    -7.778485125029
E1      =    17.430100326280
E2      =    -6.898735192845
E3      =    -9.239865636944
Exc     =    -8.272838524317
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 3.801e-04, dEband = 2.402e-02
rank = 0, Calculating/Estimating energy took 0.836 ms, Etot = -24.114102874, dEtot = 3.801e-04, dEband = 2.402e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.3814470253549, which took 0.052 ms

iter_count = 108, r_2norm = 6.650e-05, tol*||rhs|| = 9.526e-05

Anderson update took 45.711 ms, out of which F'*F took 24.029 ms; b-Ax took 158.942 ms, out of which Lap took 144.918 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 310.210 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758649, int_b + int_rho = 3.274e-14, checking this took 0.082 ms
2-norm of RHS = 576.6789405469202, which took 0.076 ms

iter_count = 252, r_2norm = 5.211e-04, tol*||rhs|| = 5.767e-04

Anderson update took 107.619 ms, out of which F'*F took 56.822 ms; b-Ax took 371.777 ms, out of which Lap took 341.558 ms
Solving Poisson took 707.567 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Total time for convolution: 	 convolve: 5.059183 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.864 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.060697 
Total time for convolution: 	 convolve: 5.060416 
Total time for convolution: 	 convolve: 5.065501 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.837 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.690 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.292 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.998 ms

This SCF took 26212.280 ms, scf error = 1.496e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.129959, lowerbound = -0.897835, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 956.216 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 9.769 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.346 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 11.158 ms
rank =  0, finding HY took 16.386 ms
rank =  0, distributing HY into block cyclic form took 9.675 ms
rank =  0, finding Y'*HY took 2.276 ms
Rank 0, Project_Hamiltonian used 39.518 ms
Total time for projection: 39.535 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.045 ms
rank = 0, Solve_Generalized_EigenProblem used 0.113 ms
    first calculated eigval = -0.895678993587484
    last  calculated eigval = 0.029038969592344
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.89567899358748
lambda[   2] =  -0.70555151564437
lambda[   3] =  -0.50698579791574
lambda[   4] =  -0.45485639233379
lambda[   5] =  -0.44485064574505
lambda[   6] =  -0.36126770311189
lambda[   7] =  -0.30503668370346
lambda[   8] =  -0.19208398963683
lambda[   9] =  -0.06110700846176
lambda[  10] =  -0.05694213268800
lambda[  11] =  -0.03227864039466
lambda[  12] =   0.01383115369192
lambda[  13] =   0.01862313477486
lambda[  14] =   0.02903896959234
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.240 ms
rank =  0, subspace rotation using ScaLAPACK took 2.763 ms
rank =  0, Distributing orbital back into band + domain format took 8.926 ms
rank = 0, Subspace_Rotation used 11.702 ms

Total time for subspace rotation: 11.708 ms
rank = 0, Efermi =  -0.090395009541 calculate fermi energy took 0.323 ms
rank = 0, --- Calculate rho: sum over local bands took 1.526 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.625 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.067 ms
rank = 0, Calculating density took 1010.957 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.413 ms
rank = 0, D2D took 0.757 ms
rank = 0, Transfering density took 0.764 ms
Etot    =   -24.113488514795
Eband   =    -7.732623444431
E1      =    17.415165226687
E2      =    -6.863663965387
E3      =    -9.254506225561
Exc     =    -8.282720107258
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 1.024e-04, dEband = 7.644e-03
rank = 0, Calculating/Estimating energy took 0.774 ms, Etot = -24.113488515, dEtot = 1.024e-04, dEband = 7.644e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6178526929948, which took 0.112 ms

iter_count = 114, r_2norm = 1.738e-05, tol*||rhs|| = 2.471e-05

Anderson update took 48.965 ms, out of which F'*F took 25.324 ms; b-Ax took 167.351 ms, out of which Lap took 153.361 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 327.707 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758647, int_b + int_rho = 7.276e-15, checking this took 0.079 ms
2-norm of RHS = 577.1052810903939, which took 0.105 ms

iter_count = 246, r_2norm = 5.531e-04, tol*||rhs|| = 5.771e-04

Anderson update took 103.732 ms, out of which F'*F took 54.621 ms; b-Ax took 359.548 ms, out of which Lap took 329.607 ms
Solving Poisson took 689.379 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Total time for convolution: 	 convolve: 5.061272 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 103.173 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.060937 
Total time for convolution: 	 convolve: 5.060397 
Total time for convolution: 	 convolve: 5.061210 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.393 ms
---Transfer Veff_loc: D2D took 0.671 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.289 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.982 ms

This SCF took 26351.040 ms, scf error = 7.288e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.129039, lowerbound = -0.895679, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 926.344 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.753 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.325 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.070 ms
rank =  0, Distribute data + matrix mult took 11.160 ms
rank =  0, finding HY took 16.456 ms
rank =  0, distributing HY into block cyclic form took 9.792 ms
rank =  0, finding Y'*HY took 1.908 ms
Rank 0, Project_Hamiltonian used 39.339 ms
Total time for projection: 39.351 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.717 ms
    first calculated eigval = -0.893784053826637
    last  calculated eigval = 0.028961860902518
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.89378405382664
lambda[   2] =  -0.70321777423756
lambda[   3] =  -0.50386527353218
lambda[   4] =  -0.45236949424441
lambda[   5] =  -0.44195608043174
lambda[   6] =  -0.35916830429494
lambda[   7] =  -0.30287842685143
lambda[   8] =  -0.18961036432363
lambda[   9] =  -0.05944924644346
lambda[  10] =  -0.05494634160777
lambda[  11] =  -0.03208360423608
lambda[  12] =   0.01345417204081
lambda[  13] =   0.01760938032050
lambda[  14] =   0.02896186090252
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.745 ms
rank =  0, subspace rotation using ScaLAPACK took 2.825 ms
rank =  0, Distributing orbital back into band + domain format took 9.274 ms
rank = 0, Subspace_Rotation used 12.111 ms

Total time for subspace rotation: 12.131 ms
rank = 0, Efermi =  -0.088735072955 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.524 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.723 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.068 ms
rank = 0, Calculating density took 980.983 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.429 ms
rank = 0, D2D took 0.628 ms
rank = 0, Transfering density took 0.635 ms
Etot    =   -24.113209775874
Eband   =    -7.693699544530
E1      =    17.403593013745
E2      =    -6.833178455235
E3      =    -9.264056374858
Exc     =    -8.288857694440
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 4.646e-05, dEband = 6.487e-03
rank = 0, Calculating/Estimating energy took 0.871 ms, Etot = -24.113209776, dEtot = 4.646e-05, dEband = 6.487e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2478743139449, which took 0.047 ms

iter_count = 114, r_2norm = 6.998e-06, tol*||rhs|| = 9.915e-06

Anderson update took 48.408 ms, out of which F'*F took 25.500 ms; b-Ax took 167.382 ms, out of which Lap took 153.268 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 327.621 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758642, int_b + int_rho = -3.638e-14, checking this took 0.078 ms
2-norm of RHS = 577.3419390163222, which took 0.080 ms

iter_count = 252, r_2norm = 4.881e-04, tol*||rhs|| = 5.773e-04

Anderson update took 106.765 ms, out of which F'*F took 56.363 ms; b-Ax took 369.200 ms, out of which Lap took 339.344 ms
Solving Poisson took 709.585 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Total time for convolution: 	 convolve: 5.061399 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.210 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.060939 
Total time for convolution: 	 convolve: 5.064767 
Total time for convolution: 	 convolve: 5.109486 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.821 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.261 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.435 ms
---Transfer Veff_loc: D2D took 0.711 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.041 ms

This SCF took 26315.272 ms, scf error = 3.612e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.128962, lowerbound = -0.893784, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 943.347 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 9.892 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.386 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 11.321 ms
rank =  0, finding HY took 16.666 ms
rank =  0, distributing HY into block cyclic form took 10.082 ms
rank =  0, finding Y'*HY took 2.347 ms
Rank 0, Project_Hamiltonian used 40.818 ms
Total time for projection: 40.829 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.889451619915183
    last  calculated eigval = 0.030472620035897
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88945161991518
lambda[   2] =  -0.69896239312914
lambda[   3] =  -0.50013762966359
lambda[   4] =  -0.44866928634796
lambda[   5] =  -0.43827362070918
lambda[   6] =  -0.35499535170500
lambda[   7] =  -0.29913725355174
lambda[   8] =  -0.18555852219196
lambda[   9] =  -0.05599945084424
lambda[  10] =  -0.05148133729409
lambda[  11] =  -0.03066488386888
lambda[  12] =   0.01423676207377
lambda[  13] =   0.01833971279483
lambda[  14] =   0.03047262003590
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 2.412 ms
rank =  0, Distributing orbital back into band + domain format took 9.652 ms
rank = 0, Subspace_Rotation used 12.072 ms

Total time for subspace rotation: 12.075 ms
rank = 0, Efermi =  -0.085285199114 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 1.655 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.513 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.065 ms
rank = 0, Calculating density took 998.740 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.441 ms
rank = 0, D2D took 0.707 ms
rank = 0, Transfering density took 0.710 ms
Etot    =   -24.113130330992
Eband   =    -7.630371355412
E1      =    17.373004480220
E2      =    -6.797118004253
E3      =    -9.275123734030
Exc     =    -8.296524813342
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 1.324e-05, dEband = 1.055e-02
rank = 0, Calculating/Estimating energy took 0.998 ms, Etot = -24.113130331, dEtot = 1.324e-05, dEband = 1.055e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1904401899373, which took 0.047 ms

iter_count = 114, r_2norm = 5.490e-06, tol*||rhs|| = 7.618e-06

Anderson update took 49.169 ms, out of which F'*F took 25.923 ms; b-Ax took 172.192 ms, out of which Lap took 156.124 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 333.883 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758639, int_b + int_rho = -7.276e-14, checking this took 0.082 ms
2-norm of RHS = 577.3369448414267, which took 0.065 ms

iter_count = 216, r_2norm = 5.164e-04, tol*||rhs|| = 5.773e-04

Anderson update took 93.175 ms, out of which F'*F took 48.693 ms; b-Ax took 320.586 ms, out of which Lap took 293.439 ms
Solving Poisson took 615.668 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.091182 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.121987 
Total time for convolution: 	 convolve: 5.068167 
Total time for convolution: 	 convolve: 5.138461 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.833 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.285 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.402 ms
---Transfer Veff_loc: D2D took 0.662 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.292 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.976 ms

This SCF took 26341.436 ms, scf error = 1.604e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.130473, lowerbound = -0.889452, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 923.146 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.682 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.793 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.037 ms
rank =  0, Distribute data + matrix mult took 11.914 ms
rank =  0, finding HY took 16.784 ms
rank =  0, distributing HY into block cyclic form took 9.821 ms
rank =  0, finding Y'*HY took 1.869 ms
Rank 0, Project_Hamiltonian used 40.416 ms
Total time for projection: 40.430 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.888248485291366
    last  calculated eigval = 0.031274538844705
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88824848529137
lambda[   2] =  -0.69778777489012
lambda[   3] =  -0.49904284390008
lambda[   4] =  -0.44753339550312
lambda[   5] =  -0.43720365151781
lambda[   6] =  -0.35379923352856
lambda[   7] =  -0.29800584868099
lambda[   8] =  -0.18439491104237
lambda[   9] =  -0.05486092896937
lambda[  10] =  -0.05038367962436
lambda[  11] =  -0.02943366218487
lambda[  12] =   0.01499281374291
lambda[  13] =   0.01912026865022
lambda[  14] =   0.03127453884470
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 2.305 ms
rank =  0, Distributing orbital back into band + domain format took 9.593 ms
rank = 0, Subspace_Rotation used 11.906 ms

Total time for subspace rotation: 11.910 ms
rank = 0, Efermi =  -0.084146890364 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 1.565 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.666 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.066 ms
rank = 0, Calculating density took 978.036 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.432 ms
rank = 0, D2D took 0.635 ms
rank = 0, Transfering density took 0.637 ms
Etot    =   -24.113193643891
Eband   =    -7.612032289673
E1      =    17.363767347602
E2      =    -6.787352187605
E3      =    -9.277468632331
Exc     =    -8.298269141014
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 1.055e-05, dEband = 3.057e-03
rank = 0, Calculating/Estimating energy took 0.812 ms, Etot = -24.113193644, dEtot = 1.055e-05, dEband = 3.057e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0962749138067, which took 0.050 ms

iter_count = 114, r_2norm = 2.521e-06, tol*||rhs|| = 3.851e-06

Anderson update took 48.521 ms, out of which F'*F took 25.451 ms; b-Ax took 167.461 ms, out of which Lap took 153.206 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 326.925 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758643, int_b + int_rho = -2.365e-14, checking this took 0.082 ms
2-norm of RHS = 577.2904131199680, which took 0.078 ms

iter_count = 222, r_2norm = 5.437e-04, tol*||rhs|| = 5.773e-04

Anderson update took 95.725 ms, out of which F'*F took 49.623 ms; b-Ax took 323.219 ms, out of which Lap took 297.890 ms
Solving Poisson took 623.711 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.074 ms
Total time for convolution: 	 convolve: 5.064476 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 50.605 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.093615 
Total time for convolution: 	 convolve: 5.078045 
Total time for convolution: 	 convolve: 5.108350 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.822 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.166 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.393 ms
---Transfer Veff_loc: D2D took 0.661 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.289 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.972 ms

This SCF took 26285.932 ms, scf error = 1.136e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.131275, lowerbound = -0.888248, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 924.324 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.742 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.323 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.052 ms
rank =  0, Distribute data + matrix mult took 11.130 ms
rank =  0, finding HY took 16.653 ms
rank =  0, distributing HY into block cyclic form took 9.730 ms
rank =  0, finding Y'*HY took 1.895 ms
Rank 0, Project_Hamiltonian used 39.434 ms
Total time for projection: 39.447 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.147 ms
    first calculated eigval = -0.886977747135657
    last  calculated eigval = 0.033464790335128
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88697774713566
lambda[   2] =  -0.69653233869160
lambda[   3] =  -0.49779942836119
lambda[   4] =  -0.44631575726655
lambda[   5] =  -0.43595068679834
lambda[   6] =  -0.35250583859646
lambda[   7] =  -0.29674688552346
lambda[   8] =  -0.18310861001389
lambda[   9] =  -0.05331946243554
lambda[  10] =  -0.04889568397712
lambda[  11] =  -0.02602030178866
lambda[  12] =   0.01792994961401
lambda[  13] =   0.02214022002181
lambda[  14] =   0.03346479033513
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 2.313 ms
rank =  0, Distributing orbital back into band + domain format took 9.427 ms
rank = 0, Subspace_Rotation used 11.749 ms

Total time for subspace rotation: 11.753 ms
rank = 0, Efermi =  -0.082605719584 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.579 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.650 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.065 ms
rank = 0, Calculating density took 978.077 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.031 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.466 ms
rank = 0, D2D took 0.667 ms
rank = 0, Transfering density took 0.669 ms
Etot    =   -24.113237808047
Eband   =    -7.591874585712
E1      =    17.353736610892
E2      =    -6.776920396367
E3      =    -9.279033139156
Exc     =    -8.299572988011
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 7.361e-06, dEband = 3.360e-03
rank = 0, Calculating/Estimating energy took 0.815 ms, Etot = -24.113237808, dEtot = 7.361e-06, dEband = 3.360e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0713488030300, which took 0.046 ms

iter_count = 114, r_2norm = 2.039e-06, tol*||rhs|| = 2.854e-06

Anderson update took 48.361 ms, out of which F'*F took 25.407 ms; b-Ax took 167.418 ms, out of which Lap took 153.061 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 326.550 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758644, int_b + int_rho = -1.455e-14, checking this took 0.079 ms
2-norm of RHS = 577.2999146595838, which took 0.079 ms

iter_count = 192, r_2norm = 4.804e-04, tol*||rhs|| = 5.773e-04

Anderson update took 82.455 ms, out of which F'*F took 42.984 ms; b-Ax took 280.323 ms, out of which Lap took 258.218 ms
Solving Poisson took 540.184 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Total time for convolution: 	 convolve: 5.131086 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.063820 
Total time for convolution: 	 convolve: 5.075919 
Total time for convolution: 	 convolve: 5.064444 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.399 ms
---Transfer Veff_loc: D2D took 0.668 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.448 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.477 ms

This SCF took 26143.845 ms, scf error = 6.014e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.133465, lowerbound = -0.886978, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 922.766 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.729 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.310 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.106 ms
rank =  0, Distribute data + matrix mult took 11.156 ms
rank =  0, finding HY took 16.498 ms
rank =  0, distributing HY into block cyclic form took 9.709 ms
rank =  0, finding Y'*HY took 1.886 ms
Rank 0, Project_Hamiltonian used 39.273 ms
Total time for projection: 39.286 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -0.886219742501300
    last  calculated eigval = 0.033820715064139
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88621974250130
lambda[   2] =  -0.69579693495842
lambda[   3] =  -0.49714267397598
lambda[   4] =  -0.44565300211814
lambda[   5] =  -0.43527228682026
lambda[   6] =  -0.35179505282342
lambda[   7] =  -0.29607366156770
lambda[   8] =  -0.18245733575882
lambda[   9] =  -0.05263579543915
lambda[  10] =  -0.04829314343345
lambda[  11] =  -0.02454702597943
lambda[  12] =   0.01941097192728
lambda[  13] =   0.02381700261125
lambda[  14] =   0.03382071506414
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 2.312 ms
rank =  0, Distributing orbital back into band + domain format took 9.540 ms
rank = 0, Subspace_Rotation used 11.861 ms

Total time for subspace rotation: 11.865 ms
rank = 0, Efermi =  -0.081922540456 calculate fermi energy took 0.037 ms
rank = 0, --- Calculate rho: sum over local bands took 1.573 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.560 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 976.402 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.411 ms
rank = 0, D2D took 0.645 ms
rank = 0, Transfering density took 0.648 ms
Etot    =   -24.113300361646
Eband   =    -7.580821381973
E1      =    17.347783306027
E2      =    -6.771423659502
E3      =    -9.280600523435
Exc     =    -8.300806087895
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 1.043e-05, dEband = 1.842e-03
rank = 0, Calculating/Estimating energy took 0.821 ms, Etot = -24.113300362, dEtot = 1.043e-05, dEband = 1.842e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0699185180195, which took 0.107 ms

iter_count = 108, r_2norm = 1.871e-06, tol*||rhs|| = 2.797e-06

Anderson update took 46.078 ms, out of which F'*F took 24.113 ms; b-Ax took 158.467 ms, out of which Lap took 144.971 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 310.106 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758637, int_b + int_rho = -8.549e-14, checking this took 0.080 ms
2-norm of RHS = 577.3160518561631, which took 0.064 ms

iter_count = 192, r_2norm = 5.289e-04, tol*||rhs|| = 5.773e-04

Anderson update took 82.266 ms, out of which F'*F took 42.729 ms; b-Ax took 279.956 ms, out of which Lap took 257.694 ms
Solving Poisson took 539.468 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Total time for convolution: 	 convolve: 5.127837 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 47.604 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.077501 
Total time for convolution: 	 convolve: 5.066442 
Total time for convolution: 	 convolve: 5.062342 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.182 ms
---Transfer Veff_loc: D2D took 1.445 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.762 ms

This SCF took 26173.437 ms, scf error = 4.326e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.133821, lowerbound = -0.886220, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 924.216 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.702 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.321 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.122 ms
rank =  0, Distribute data + matrix mult took 11.157 ms
rank =  0, finding HY took 16.605 ms
rank =  0, distributing HY into block cyclic form took 9.654 ms
rank =  0, finding Y'*HY took 1.900 ms
Rank 0, Project_Hamiltonian used 39.340 ms
Total time for projection: 39.353 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.069 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.885832635133458
    last  calculated eigval = 0.036267193686770
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88583263513346
lambda[   2] =  -0.69541008356310
lambda[   3] =  -0.49673038924424
lambda[   4] =  -0.44524972189398
lambda[   5] =  -0.43484381145945
lambda[   6] =  -0.35137939442199
lambda[   7] =  -0.29565536247657
lambda[   8] =  -0.18202873370251
lambda[   9] =  -0.05208258018334
lambda[  10] =  -0.04782282649084
lambda[  11] =  -0.02104875778377
lambda[  12] =   0.02239612301071
lambda[  13] =   0.02825359354726
lambda[  14] =   0.03626719368677
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 2.306 ms
rank =  0, Distributing orbital back into band + domain format took 9.587 ms
rank = 0, Subspace_Rotation used 11.902 ms

Total time for subspace rotation: 11.906 ms
rank = 0, Efermi =  -0.081369876652 calculate fermi energy took 0.037 ms
rank = 0, --- Calculate rho: sum over local bands took 1.566 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.602 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.070 ms
rank = 0, Calculating density took 977.951 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.416 ms
rank = 0, D2D took 0.602 ms
rank = 0, Transfering density took 0.605 ms
Etot    =   -24.113353109962
Eband   =    -7.574260264706
E1      =    17.345179870941
E2      =    -6.767441577441
E3      =    -9.280747072685
Exc     =    -8.300980985580
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 8.791e-06, dEband = 1.094e-03
rank = 0, Calculating/Estimating energy took 0.843 ms, Etot = -24.113353110, dEtot = 8.791e-06, dEband = 1.094e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0606157250507, which took 0.105 ms

iter_count = 108, r_2norm = 1.787e-06, tol*||rhs|| = 2.425e-06

Anderson update took 45.629 ms, out of which F'*F took 24.048 ms; b-Ax took 158.996 ms, out of which Lap took 145.252 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 310.637 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758642, int_b + int_rho = -3.638e-14, checking this took 0.080 ms
2-norm of RHS = 577.3160366445635, which took 0.086 ms

iter_count = 138, r_2norm = 4.835e-04, tol*||rhs|| = 5.773e-04

Anderson update took 59.212 ms, out of which F'*F took 30.861 ms; b-Ax took 201.487 ms, out of which Lap took 185.583 ms
Solving Poisson took 388.971 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Total time for convolution: 	 convolve: 5.062689 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.802 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.113187 
Total time for convolution: 	 convolve: 5.066834 
Total time for convolution: 	 convolve: 5.068365 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.164 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.140 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.398 ms
---Transfer Veff_loc: D2D took 0.655 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.291 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.968 ms

This SCF took 25963.221 ms, scf error = 2.941e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.136267, lowerbound = -0.885833, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 930.807 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.793 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.313 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.096 ms
rank =  0, Distribute data + matrix mult took 11.214 ms
rank =  0, finding HY took 16.512 ms
rank =  0, distributing HY into block cyclic form took 9.818 ms
rank =  0, finding Y'*HY took 1.886 ms
Rank 0, Project_Hamiltonian used 39.453 ms
Total time for projection: 39.466 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.885675425369923
    last  calculated eigval = 0.036473331340897
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88567542536992
lambda[   2] =  -0.69525994058163
lambda[   3] =  -0.49660393423099
lambda[   4] =  -0.44511670837653
lambda[   5] =  -0.43471339975640
lambda[   6] =  -0.35123528546948
lambda[   7] =  -0.29551833477233
lambda[   8] =  -0.18190022804452
lambda[   9] =  -0.05195332435112
lambda[  10] =  -0.04771341873223
lambda[  11] =  -0.02046904332873
lambda[  12] =   0.02287283278514
lambda[  13] =   0.02882501317719
lambda[  14] =   0.03647333134090
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 2.304 ms
rank =  0, Distributing orbital back into band + domain format took 9.520 ms
rank = 0, Subspace_Rotation used 11.832 ms

Total time for subspace rotation: 11.837 ms
rank = 0, Efermi =  -0.081240761573 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 1.581 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.537 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.066 ms
rank = 0, Calculating density took 984.598 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.420 ms
rank = 0, D2D took 0.691 ms
rank = 0, Transfering density took 0.693 ms
Etot    =   -24.113369306729
Eband   =    -7.572046514117
E1      =    17.343940301577
E2      =    -6.766395542839
E3      =    -9.281022512466
Exc     =    -8.301200768753
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 2.699e-06, dEband = 3.690e-04
rank = 0, Calculating/Estimating energy took 0.827 ms, Etot = -24.113369307, dEtot = 2.699e-06, dEband = 3.690e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0324431913692, which took 0.100 ms

iter_count = 108, r_2norm = 1.105e-06, tol*||rhs|| = 1.298e-06

Anderson update took 46.559 ms, out of which F'*F took 24.126 ms; b-Ax took 158.824 ms, out of which Lap took 145.432 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.218 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758640, int_b + int_rho = -5.639e-14, checking this took 0.082 ms
2-norm of RHS = 577.3200594113137, which took 0.074 ms

iter_count = 168, r_2norm = 5.679e-04, tol*||rhs|| = 5.773e-04

Anderson update took 72.103 ms, out of which F'*F took 37.494 ms; b-Ax took 244.547 ms, out of which Lap took 225.433 ms
Solving Poisson took 472.289 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Total time for convolution: 	 convolve: 5.093637 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.354 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.081549 
Total time for convolution: 	 convolve: 5.071097 
Total time for convolution: 	 convolve: 5.122509 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.393 ms
---Transfer Veff_loc: D2D took 0.653 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.967 ms

This SCF took 26146.467 ms, scf error = 2.450e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136473, lowerbound = -0.885675, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 925.024 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 9.754 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.330 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 11.121 ms
rank =  0, finding HY took 16.553 ms
rank =  0, distributing HY into block cyclic form took 9.748 ms
rank =  0, finding Y'*HY took 1.973 ms
Rank 0, Project_Hamiltonian used 39.418 ms
Total time for projection: 39.431 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -0.885484409718874
    last  calculated eigval = 0.037510302896368
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88548440971887
lambda[   2] =  -0.69506470453556
lambda[   3] =  -0.49639418978566
lambda[   4] =  -0.44491259751481
lambda[   5] =  -0.43451284678708
lambda[   6] =  -0.35104118199951
lambda[   7] =  -0.29531674436880
lambda[   8] =  -0.18171026664388
lambda[   9] =  -0.05190438035209
lambda[  10] =  -0.04764650456015
lambda[  11] =  -0.01953706176616
lambda[  12] =   0.02422042000802
lambda[  13] =   0.02884798043059
lambda[  14] =   0.03751030289637
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 2.313 ms
rank =  0, Distributing orbital back into band + domain format took 9.492 ms
rank = 0, Subspace_Rotation used 11.813 ms

Total time for subspace rotation: 11.817 ms
rank = 0, Efermi =  -0.081191690240 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.562 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.651 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.064 ms
rank = 0, Calculating density took 978.797 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.427 ms
rank = 0, D2D took 0.661 ms
rank = 0, Transfering density took 1.054 ms
Etot    =   -24.113434912531
Eband   =    -7.568873883621
E1      =    17.342587166886
E2      =    -6.764500054973
E3      =    -9.281082862068
Exc     =    -8.301250732096
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 1.093e-05, dEband = 5.288e-04
rank = 0, Calculating/Estimating energy took 1.367 ms, Etot = -24.113434913, dEtot = 1.093e-05, dEband = 5.288e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0310254241091, which took 0.049 ms

iter_count = 108, r_2norm = 1.054e-06, tol*||rhs|| = 1.241e-06

Anderson update took 45.820 ms, out of which F'*F took 24.131 ms; b-Ax took 159.206 ms, out of which Lap took 145.540 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 310.349 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758641, int_b + int_rho = -5.093e-14, checking this took 0.080 ms
2-norm of RHS = 577.3185174856858, which took 0.077 ms

iter_count = 108, r_2norm = 5.642e-04, tol*||rhs|| = 5.773e-04

Anderson update took 46.955 ms, out of which F'*F took 24.117 ms; b-Ax took 158.276 ms, out of which Lap took 145.535 ms
Solving Poisson took 306.796 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Total time for convolution: 	 convolve: 5.110592 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.703 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.118142 
Total time for convolution: 	 convolve: 5.096724 
Total time for convolution: 	 convolve: 5.135455 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.837 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.391 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.374 ms
---Transfer Veff_loc: D2D took 0.637 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.307 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.970 ms

This SCF took 26140.742 ms, scf error = 1.921e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.137510, lowerbound = -0.885484, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 932.126 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 9.892 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.343 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.043 ms
rank =  0, Distribute data + matrix mult took 11.289 ms
rank =  0, finding HY took 16.804 ms
rank =  0, distributing HY into block cyclic form took 9.983 ms
rank =  0, finding Y'*HY took 1.907 ms
Rank 0, Project_Hamiltonian used 40.013 ms
Total time for projection: 40.027 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.885427981810488
    last  calculated eigval = 0.037736452144555
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88542798181049
lambda[   2] =  -0.69501279384350
lambda[   3] =  -0.49635354718020
lambda[   4] =  -0.44486702317497
lambda[   5] =  -0.43447000348718
lambda[   6] =  -0.35099119172373
lambda[   7] =  -0.29526960267413
lambda[   8] =  -0.18166999677931
lambda[   9] =  -0.05187847917296
lambda[  10] =  -0.04762180152274
lambda[  11] =  -0.01909765369306
lambda[  12] =   0.02442491630409
lambda[  13] =   0.02930264409766
lambda[  14] =   0.03773645214456
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 2.295 ms
rank =  0, Distributing orbital back into band + domain format took 9.680 ms
rank = 0, Subspace_Rotation used 11.985 ms

Total time for subspace rotation: 11.989 ms
rank = 0, Efermi =  -0.081165797435 calculate fermi energy took 0.111 ms
rank = 0, --- Calculate rho: sum over local bands took 1.579 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.543 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.068 ms
rank = 0, Calculating density took 986.648 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.391 ms
rank = 0, D2D took 0.519 ms
rank = 0, Transfering density took 0.521 ms
Etot    =   -24.113441430858
Eband   =    -7.568124282259
E1      =    17.342140011213
E2      =    -6.764181966285
E3      =    -9.281146881031
Exc     =    -8.301305626387
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 1.086e-06, dEband = 1.249e-04
rank = 0, Calculating/Estimating energy took 0.796 ms, Etot = -24.113441431, dEtot = 1.086e-06, dEband = 1.249e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0223551307638, which took 0.051 ms

iter_count = 108, r_2norm = 8.391e-07, tol*||rhs|| = 8.942e-07

Anderson update took 46.336 ms, out of which F'*F took 24.298 ms; b-Ax took 160.428 ms, out of which Lap took 146.151 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 313.111 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758637, int_b + int_rho = -9.459e-14, checking this took 0.079 ms
2-norm of RHS = 577.3172462282662, which took 0.086 ms

iter_count = 138, r_2norm = 5.204e-04, tol*||rhs|| = 5.773e-04

Anderson update took 59.746 ms, out of which F'*F took 30.912 ms; b-Ax took 203.618 ms, out of which Lap took 186.761 ms
Solving Poisson took 392.837 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.095764 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.568 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.108120 
Total time for convolution: 	 convolve: 5.094519 
Total time for convolution: 	 convolve: 5.088445 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.017 ms
======D2D: initiated sending and receiving took 1.065 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
---Transfer Veff_loc: D2D took 0.624 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.937 ms

This SCF took 26049.460 ms, scf error = 1.591e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.137736, lowerbound = -0.885428, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 936.650 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.965 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.346 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.035 ms
rank =  0, Distribute data + matrix mult took 11.357 ms
rank =  0, finding HY took 16.723 ms
rank =  0, distributing HY into block cyclic form took 9.950 ms
rank =  0, finding Y'*HY took 1.874 ms
Rank 0, Project_Hamiltonian used 39.928 ms
Total time for projection: 39.942 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.885408349765682
    last  calculated eigval = 0.037394325465694
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88540834976568
lambda[   2] =  -0.69499751377461
lambda[   3] =  -0.49633307582602
lambda[   4] =  -0.44484440193173
lambda[   5] =  -0.43444697238308
lambda[   6] =  -0.35096796902898
lambda[   7] =  -0.29524699260697
lambda[   8] =  -0.18165629917270
lambda[   9] =  -0.05192482083490
lambda[  10] =  -0.04767483480064
lambda[  11] =  -0.01914272839665
lambda[  12] =   0.02385649794864
lambda[  13] =   0.03004946622802
lambda[  14] =   0.03739432546569
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 2.328 ms
rank =  0, Distributing orbital back into band + domain format took 9.641 ms
rank = 0, Subspace_Rotation used 11.979 ms

Total time for subspace rotation: 11.983 ms
rank = 0, Efermi =  -0.081212186164 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 1.587 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.596 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.069 ms
rank = 0, Calculating density took 991.907 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.425 ms
rank = 0, D2D took 0.634 ms
rank = 0, Transfering density took 0.636 ms
Etot    =   -24.113455219770
Eband   =    -7.567803149892
E1      =    17.342097224053
E2      =    -6.763928687409
E3      =    -9.280988376851
Exc     =    -8.301185977450
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 2.298e-06, dEband = 5.352e-05
rank = 0, Calculating/Estimating energy took 0.812 ms, Etot = -24.113455220, dEtot = 2.298e-06, dEband = 5.352e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0220729682191, which took 0.051 ms

iter_count = 108, r_2norm = 8.264e-07, tol*||rhs|| = 8.829e-07

Anderson update took 46.787 ms, out of which F'*F took 24.231 ms; b-Ax took 160.029 ms, out of which Lap took 145.910 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 313.371 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758636, int_b + int_rho = -1.000e-13, checking this took 0.095 ms
2-norm of RHS = 577.3164854500810, which took 0.090 ms

iter_count = 36, r_2norm = 5.407e-04, tol*||rhs|| = 5.773e-04

Anderson update took 15.564 ms, out of which F'*F took 8.137 ms; b-Ax took 53.123 ms, out of which Lap took 48.566 ms
Solving Poisson took 104.681 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.093922 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.118197 
Total time for convolution: 	 convolve: 5.077422 
Total time for convolution: 	 convolve: 5.089257 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
---Transfer Veff_loc: D2D took 0.630 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.301 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.944 ms

This SCF took 25790.358 ms, scf error = 1.567e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.137394, lowerbound = -0.885408, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 934.243 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.904 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.333 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 11.276 ms
rank =  0, finding HY took 16.669 ms
rank =  0, distributing HY into block cyclic form took 9.967 ms
rank =  0, finding Y'*HY took 1.886 ms
Rank 0, Project_Hamiltonian used 39.823 ms
Total time for projection: 39.835 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.122 ms
    first calculated eigval = -0.885393856330658
    last  calculated eigval = 0.036855974592298
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88539385633066
lambda[   2] =  -0.69498354350749
lambda[   3] =  -0.49632440713673
lambda[   4] =  -0.44483459260838
lambda[   5] =  -0.43443742245741
lambda[   6] =  -0.35095705681525
lambda[   7] =  -0.29523711259047
lambda[   8] =  -0.18164747716008
lambda[   9] =  -0.05191948690540
lambda[  10] =  -0.04766990365355
lambda[  11] =  -0.01917734775813
lambda[  12] =   0.02380526948585
lambda[  13] =   0.02993389142517
lambda[  14] =   0.03685597459230
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.174 ms
rank =  0, subspace rotation using ScaLAPACK took 2.221 ms
rank =  0, Distributing orbital back into band + domain format took 9.017 ms
rank = 0, Subspace_Rotation used 11.255 ms

Total time for subspace rotation: 11.856 ms
rank = 0, Efermi =  -0.081206855263 calculate fermi energy took 0.118 ms
rank = 0, --- Calculate rho: sum over local bands took 1.562 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.612 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.065 ms
rank = 0, Calculating density took 989.377 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.423 ms
rank = 0, D2D took 0.629 ms
rank = 0, Transfering density took 0.635 ms
Etot    =   -24.113452646732
Eband   =    -7.567630938126
E1      =    17.341950986261
E2      =    -6.763895052634
E3      =    -9.281041740644
Exc     =    -8.301229107404
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 4.288e-07, dEband = 2.870e-05
rank = 0, Calculating/Estimating energy took 0.825 ms, Etot = -24.113452647, dEtot = 4.288e-07, dEband = 2.870e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0186774824137, which took 0.051 ms

iter_count = 108, r_2norm = 7.156e-07, tol*||rhs|| = 7.471e-07

Anderson update took 46.647 ms, out of which F'*F took 24.190 ms; b-Ax took 159.816 ms, out of which Lap took 145.838 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 313.375 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758646, int_b + int_rho = 3.638e-15, checking this took 0.078 ms
2-norm of RHS = 577.3144324704998, which took 0.075 ms

iter_count = 126, r_2norm = 5.494e-04, tol*||rhs|| = 5.773e-04

Anderson update took 54.858 ms, out of which F'*F took 28.404 ms; b-Ax took 186.213 ms, out of which Lap took 170.749 ms
Solving Poisson took 359.491 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Total time for convolution: 	 convolve: 5.120302 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.122545 
Total time for convolution: 	 convolve: 5.092566 
Total time for convolution: 	 convolve: 5.087634 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.022 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 0.647 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.294 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.954 ms

This SCF took 26061.239 ms, scf error = 1.416e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.136856, lowerbound = -0.885394, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 935.500 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.855 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.333 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.043 ms
rank =  0, Distribute data + matrix mult took 11.242 ms
rank =  0, finding HY took 16.682 ms
rank =  0, distributing HY into block cyclic form took 9.953 ms
rank =  0, finding Y'*HY took 1.873 ms
Rank 0, Project_Hamiltonian used 39.777 ms
Total time for projection: 39.790 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -0.885250949243994
    last  calculated eigval = 0.036580633913937
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88525094924399
lambda[   2] =  -0.69484817831322
lambda[   3] =  -0.49621970815445
lambda[   4] =  -0.44472882479298
lambda[   5] =  -0.43431781675758
lambda[   6] =  -0.35083978989049
lambda[   7] =  -0.29512193986692
lambda[   8] =  -0.18156043923902
lambda[   9] =  -0.05185014793500
lambda[  10] =  -0.04760530516035
lambda[  11] =  -0.01901292744991
lambda[  12] =   0.02391250021453
lambda[  13] =   0.02987326897493
lambda[  14] =   0.03658063391394
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 2.218 ms
rank =  0, Distributing orbital back into band + domain format took 9.032 ms
rank = 0, Subspace_Rotation used 11.263 ms

Total time for subspace rotation: 11.271 ms
rank = 0, Efermi =  -0.081137549942 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.510 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.390 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.069 ms
rank = 0, Calculating density took 990.471 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.419 ms
rank = 0, D2D took 0.574 ms
rank = 0, Transfering density took 0.579 ms
Etot    =   -24.113463269755
Eband   =    -7.565775293429
E1      =    17.340832686151
E2      =    -6.763095244630
E3      =    -9.281276575123
Exc     =    -8.301412101489
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 1.771e-06, dEband = 3.093e-04
rank = 0, Calculating/Estimating energy took 0.934 ms, Etot = -24.113463270, dEtot = 1.771e-06, dEband = 3.093e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0137150283354, which took 0.057 ms

iter_count = 114, r_2norm = 4.170e-07, tol*||rhs|| = 5.486e-07

Anderson update took 48.857 ms, out of which F'*F took 25.509 ms; b-Ax took 168.746 ms, out of which Lap took 153.877 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 329.497 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758642, int_b + int_rho = -4.184e-14, checking this took 0.081 ms
2-norm of RHS = 577.3147785545934, which took 0.071 ms

iter_count = 60, r_2norm = 5.424e-04, tol*||rhs|| = 5.773e-04

Anderson update took 25.899 ms, out of which F'*F took 13.588 ms; b-Ax took 89.234 ms, out of which Lap took 81.916 ms
Solving Poisson took 172.667 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Total time for convolution: 	 convolve: 5.084599 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.087929 
Total time for convolution: 	 convolve: 5.247929 
Total time for convolution: 	 convolve: 5.080658 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 2.017 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.165 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.660 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.310 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.986 ms

This SCF took 25973.452 ms, scf error = 1.068e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.136581, lowerbound = -0.885251, upperbound = 267.574203

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 932.591 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 9.922 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.341 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 11.302 ms
rank =  0, finding HY took 16.693 ms
rank =  0, distributing HY into block cyclic form took 9.962 ms
rank =  0, finding Y'*HY took 1.878 ms
Rank 0, Project_Hamiltonian used 39.863 ms
Total time for projection: 39.876 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.885228045570356
    last  calculated eigval = 0.036076351129964
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88522804557036
lambda[   2] =  -0.69482621939945
lambda[   3] =  -0.49620393865546
lambda[   4] =  -0.44470688606111
lambda[   5] =  -0.43430225478522
lambda[   6] =  -0.35081909428101
lambda[   7] =  -0.29510143603155
lambda[   8] =  -0.18153956555907
lambda[   9] =  -0.05182323479699
lambda[  10] =  -0.04758514254947
lambda[  11] =  -0.01902173212269
lambda[  12] =   0.02389775220614
lambda[  13] =   0.02983018763497
lambda[  14] =   0.03607635112996
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.566 ms
rank =  0, subspace rotation using ScaLAPACK took 2.354 ms
rank =  0, Distributing orbital back into band + domain format took 9.419 ms
rank = 0, Subspace_Rotation used 11.789 ms

Total time for subspace rotation: 12.312 ms
rank = 0, Efermi =  -0.081110685012 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.622 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.553 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.066 ms
rank = 0, Calculating density took 987.719 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.423 ms
rank = 0, D2D took 0.594 ms
rank = 0, Transfering density took 0.597 ms
Etot    =   -24.113461253773
Eband   =    -7.565454881597
E1      =    17.340650009852
E2      =    -6.762944087723
E3      =    -9.281341920827
Exc     =    -8.301462009837
Esc     =   -41.631480380210
Entropy =    -0.000000000531
dE = 3.360e-07, dEband = 5.340e-05
rank = 0, Calculating/Estimating energy took 0.843 ms, Etot = -24.113461254, dEtot = 3.360e-07, dEband = 5.340e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0111621559446, which took 0.048 ms

iter_count = 108, r_2norm = 4.431e-07, tol*||rhs|| = 4.465e-07

Anderson update took 46.368 ms, out of which F'*F took 24.255 ms; b-Ax took 160.235 ms, out of which Lap took 146.369 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 312.909 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001758646, int_rho =  16.00000001758639, int_b + int_rho = -6.366e-14, checking this took 0.081 ms
2-norm of RHS = 577.3189785942716, which took 0.093 ms

iter_count = 126, r_2norm = 5.734e-04, tol*||rhs|| = 5.773e-04

Anderson update took 55.187 ms, out of which F'*F took 28.254 ms; b-Ax took 185.775 ms, out of which Lap took 170.170 ms
Solving Poisson took 359.346 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Total time for convolution: 	 convolve: 5.091953 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.079436 
Total time for convolution: 	 convolve: 5.107411 
Total time for convolution: 	 convolve: 5.082413 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.778 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.653 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.959 ms

This SCF took 25990.457 ms, scf error = 9.053e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -0.88522804557036, occ[   1] =   2.00000000000000
lambda[   2] =  -0.69482621939945, occ[   2] =   2.00000000000000
lambda[   3] =  -0.49620393865546, occ[   3] =   2.00000000000000
lambda[   4] =  -0.44470688606111, occ[   4] =   2.00000000000000
lambda[   5] =  -0.43430225478522, occ[   5] =   2.00000000000000
lambda[   6] =  -0.35081909428101, occ[   6] =   2.00000000000000
lambda[   7] =  -0.29510143603155, occ[   7] =   2.00000000000000
lambda[   8] =  -0.18153956555907, occ[   8] =   2.00000000000000
lambda[   9] =  -0.05182323479699, occ[   9] =   0.00000001747513
lambda[  10] =  -0.04758514254947, occ[  10] =   0.00000000011128
lambda[  11] =  -0.01902173212269, occ[  11] =   0.00000000000000
lambda[  12] =   0.02389775220614, occ[  12] =   0.00000000000000
lambda[  13] =   0.02983018763497, occ[  13] =   0.00000000000000
lambda[  14] =   0.03607635112996, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.463 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.167 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.444 ms, time for Allreduce/Reduce: 7.095 ms 
Time for calculating local force components: 15.287 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00413433942057   0.02530880017209  -0.04553754961311
 -0.00413430745527   0.02530879254900   0.04553753172536
 -0.03418620060817  -0.03644480983808   0.00000000107795
 -0.02599732100379   0.23200235918540  -0.00000009115246
  0.38112655886626  -0.27696030887636   0.00000029067821
 -0.11903704841924  -0.03339712207806   0.00000002214587
force_loc = 
  0.00461708214481  -0.02796943344680   0.04875325002050
  0.00461676642146  -0.02796967503742  -0.04875311533556
  0.03548146642308   0.03991232347889  -0.00000008091168
  0.02516985627803  -0.22233822480127  -0.00000007304469
 -0.37284751513908   0.26978049407152  -0.00000028747606
  0.11345955343032   0.03172413538528   0.00000001412916
Time for calculating nonlocal force components: 20.492 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00002834734654  -0.00306076063855  -0.00000000706102
[0m[32m -0.00622718922134  -0.00089655241212  -0.00000001334803
[0m[32m  0.00226949110536   0.00500493550596   0.00000000196822
[0mTime for calculating XC forces components: 20.794 ms
 Cartesian force = 
  0.00045799171502  -0.00266145881129   0.00321571810695
  0.00045770795696  -0.00266170802500  -0.00321556591064
  0.00127051480569   0.00346668810423  -0.00000006213417
 -0.00088056308151   0.00660254820900  -0.00000015355862
  0.00202710349662  -0.00807719275354   0.00000000755367
 -0.00333275489278   0.00333112327660   0.00000005594281
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.970 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Time for printing density: 1024.963 ms
The program took 503.159 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:37:01
Job ID:        2266931
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:44:12,vmem=8380K,walltime=00:08:41,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-32-2
---------------------------------------
