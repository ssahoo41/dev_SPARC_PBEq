---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:32
Job ID:    2266431
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:37
Job ID:    2266431
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 7.040 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 10.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 10.535 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 154.595 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.029 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.090 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.668820	    8.932925	   10.000000	
    5.063873	    7.659582	   10.000000	
    5.497297	   10.540893	   11.685615	
    5.497297	   10.540893	    8.314385	
    9.661250	   12.340418	    8.322571	
    9.661250	   12.340418	   11.677429	
    6.042194	    9.466576	   10.000000	
   10.069820	   11.190911	   10.000000	
   12.782777	   10.568078	   10.000000	
   14.936127	   10.139830	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.006 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.183 ms
Set up communicators.

--set up spincomm took 2.293 ms

--set up kptcomm took 0.348 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 21, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.011 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 21 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 21, mbQ = nbQ = 64
rank = 0, nr_Hp = 21, nc_Hp = 21
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.104 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.322 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.727 ms

Calculate_SplineDerivRadFun took 0.308 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.765 ms.
time spent on vectorized spline interp: 3.457 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.707 ms.
time spent on vectorized spline interp: 1.255 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.260 ms.
time spent on vectorized spline interp: 1.567 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.462 ms.
time spent on vectorized spline interp: 1.553 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.473 ms.

Calculating rb for all atom types took 19.536 ms
----------------------
Estimated memory usage
Total: 1.26 GB
orbitals             : 961.30 MB
global sized vectors : 213.62 MB
subspace matrices : 10.34 kB
others : 117.49 MB
----------------------------------------------
Estimated memory usage per processor: 107.70 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.055 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -28.0000000298607, sum_int_rho = 27.4918217102541
PosCharge = 28.000000029861, NegCharge = -27.491821710254, scal_fac = 1.018484708833
After scaling, int_rho = 28.0000000298606, PosCharge + NegCharge - NetCharge = 6.395e-14
--Calculate Vref took 0.604 ms
--Calculate rho_guess took 3.054 ms

 integral of b = -28.0000000298607,
 int{b} + Nelectron + NetCharge = -2.986e-08,
 Esc = -78.9042273124501,
 MPI_Reduce took 10.330 ms

Calculating b & b_ref took 21.287 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.076 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.185 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.089 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.634 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.288 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986046, int_b + int_rho = -1.746e-13, checking this took 0.691 ms
2-norm of RHS = 765.4138584543916, which took 0.501 ms

iter_count = 420, r_2norm = 6.837e-04, tol*||rhs|| = 7.654e-04

Anderson update took 189.765 ms, out of which F'*F took 92.727 ms; b-Ax took 602.223 ms, out of which Lap took 556.368 ms
Solving Poisson took 1138.540 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
Total time for convolution: 	 convolve: 5.143948 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.782 ms
Total time for convolution: 	 convolve: 5.109850 
Total time for convolution: 	 convolve: 5.122828 
Total time for convolution: 	 convolve: 5.136831 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.715 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.490 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.158 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.458 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
rank = 0, XC calculation took 24349.355 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 4.938 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.051 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.118 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.149 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.461 ms
    Lanczos iter 52, eigmin  = -1.014231557, eigmax = 264.921478187, err_eigmin = 1.695e-03, err_eigmax = 1.000e-02
rank =   0, Lanczos took 93.675 ms, eigmin = -1.014231557467, eigmax = 267.570692969189

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.228231, lowerbound = -1.114232, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1283.351 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 37.503 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.814 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 40.334 ms
rank =  0, finding HY took 23.598 ms
rank =  0, distributing HY into block cyclic form took 17.370 ms
rank =  0, finding Y'*HY took 4.648 ms
Rank 0, Project_Hamiltonian used 85.983 ms
Total time for projection: 85.998 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.768 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.870 ms
    first calculated eigval = 2.722229607035452
    last  calculated eigval = 3.274781966153959
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =   2.85591523333901
lambda[   6] =   2.86751718711778
lambda[   7] =   2.89227996137765
lambda[   8] =   2.93609599462225
lambda[   9] =   2.97075957057206
lambda[  10] =   2.98870897383129
lambda[  11] =   2.99730203145545
lambda[  12] =   3.01561078995597
lambda[  13] =   3.02517308677679
lambda[  14] =   3.04514889883694
lambda[  15] =   3.08514503132317
lambda[  16] =   3.11809683381800
lambda[  17] =   3.13452285635769
lambda[  18] =   3.14756412773516
lambda[  19] =   3.17992169840668
lambda[  20] =   3.21324516494573
lambda[  21] =   3.27478196615396
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.885 ms
rank =  0, subspace rotation using ScaLAPACK took 7.086 ms
rank =  0, Distributing orbital back into band + domain format took 15.499 ms
rank = 0, Subspace_Rotation used 22.595 ms

Total time for subspace rotation: 22.599 ms
rank = 0, Efermi =   3.065147124685 calculate fermi energy took 0.123 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.374782, lowerbound = -1.114232, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1286.530 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 15.469 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.385 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 17.867 ms
rank =  0, finding HY took 23.026 ms
rank =  0, distributing HY into block cyclic form took 15.339 ms
rank =  0, finding Y'*HY took 3.946 ms
Rank 0, Project_Hamiltonian used 60.201 ms
Total time for projection: 60.205 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.965 ms
rank = 0, Solve_Generalized_EigenProblem used 1.119 ms
    first calculated eigval = -0.903697188166848
    last  calculated eigval = 0.442049308724946
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.23210421547022
lambda[   6] =  -0.13207163302558
lambda[   7] =  -0.10061592374427
lambda[   8] =  -0.07038358273352
lambda[   9] =   0.02121466996264
lambda[  10] =   0.05408174904087
lambda[  11] =   0.14434600485345
lambda[  12] =   0.18715249839859
lambda[  13] =   0.21462963532344
lambda[  14] =   0.26888939637189
lambda[  15] =   0.30415806343907
lambda[  16] =   0.33272677043511
lambda[  17] =   0.33990725451803
lambda[  18] =   0.36688801200668
lambda[  19] =   0.38794186141020
lambda[  20] =   0.41255546559833
lambda[  21] =   0.44204930872495
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 1.127 ms
rank =  0, subspace rotation using ScaLAPACK took 6.992 ms
rank =  0, Distributing orbital back into band + domain format took 15.349 ms
rank = 0, Subspace_Rotation used 22.352 ms

Total time for subspace rotation: 22.357 ms
rank = 0, Efermi =   0.286523760660 calculate fermi energy took 0.021 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.542049, lowerbound = -1.114232, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1287.821 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 15.375 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.424 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 17.812 ms
rank =  0, finding HY took 23.005 ms
rank =  0, distributing HY into block cyclic form took 15.329 ms
rank =  0, finding Y'*HY took 3.947 ms
Rank 0, Project_Hamiltonian used 60.116 ms
Total time for projection: 60.120 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.104 ms
rank = 0, Solve_Generalized_EigenProblem used 0.231 ms
    first calculated eigval = -1.039544566727548
    last  calculated eigval = 0.143064425148665
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54713683976771
lambda[   6] =  -0.54118293852778
lambda[   7] =  -0.52781006082765
lambda[   8] =  -0.47425300303253
lambda[   9] =  -0.46468372133478
lambda[  10] =  -0.39381865012328
lambda[  11] =  -0.37249701205960
lambda[  12] =  -0.35310140880048
lambda[  13] =  -0.34254244790359
lambda[  14] =  -0.25186900398155
lambda[  15] =   0.01369455768501
lambda[  16] =   0.03289678869834
lambda[  17] =   0.05839481712665
lambda[  18] =   0.07750824264904
lambda[  19] =   0.08397584113532
lambda[  20] =   0.11781020927470
lambda[  21] =   0.14306442514866
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.238 ms
rank =  0, subspace rotation using ScaLAPACK took 7.000 ms
rank =  0, Distributing orbital back into band + domain format took 15.310 ms
rank = 0, Subspace_Rotation used 22.321 ms

Total time for subspace rotation: 22.325 ms
rank = 0, Efermi =  -0.015109295780 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.243064, lowerbound = -1.114232, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1284.414 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 15.467 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.440 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 17.920 ms
rank =  0, finding HY took 23.054 ms
rank =  0, distributing HY into block cyclic form took 15.322 ms
rank =  0, finding Y'*HY took 4.002 ms
Rank 0, Project_Hamiltonian used 60.342 ms
Total time for projection: 60.345 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.221 ms
    first calculated eigval = -1.039720720093010
    last  calculated eigval = 0.060677371024679
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55980631580345
lambda[   6] =  -0.54606442020300
lambda[   7] =  -0.53455428380483
lambda[   8] =  -0.47972081909885
lambda[   9] =  -0.47705859808764
lambda[  10] =  -0.40901964278654
lambda[  11] =  -0.39013535983787
lambda[  12] =  -0.37416086316098
lambda[  13] =  -0.37083278760961
lambda[  14] =  -0.30953357119771
lambda[  15] =  -0.07141780437363
lambda[  16] =  -0.03833761393173
lambda[  17] =  -0.00551887382369
lambda[  18] =   0.02887812567483
lambda[  19] =   0.04276903456363
lambda[  20] =   0.04957528634751
lambda[  21] =   0.06067737102468
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 7.004 ms
rank =  0, Distributing orbital back into band + domain format took 15.431 ms
rank = 0, Subspace_Rotation used 22.447 ms

Total time for subspace rotation: 22.452 ms
rank = 0, Efermi =  -0.100221657881 calculate fermi energy took 0.021 ms
rank = 0, --- Calculate rho: sum over local bands took 6.841 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.583 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.581 ms
rank = 0, Calculating density took 5616.269 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.774 ms
rank = 0, D2D took 1.886 ms
rank = 0, Transfering density took 1.889 ms
Etot    =   -48.027638319264
Eband   =   -15.864103257871
E1      =    32.112987255867
E2      =   -12.922315303083
E3      =   -16.468220755531
Exc     =   -14.762831062537
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 4.803e+00, dEband = 1.586e+00
rank = 0, Calculating/Estimating energy took 0.803 ms, Etot = -48.027638319, dEtot = 4.803e+00, dEband = 1.586e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 67.0235489037643, which took 1.144 ms

iter_count = 90, r_2norm = 2.673e-03, tol*||rhs|| = 2.681e-03

Anderson update took 37.409 ms, out of which F'*F took 19.763 ms; b-Ax took 129.140 ms, out of which Lap took 118.859 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 246.223 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986057, int_b + int_rho = -7.276e-14, checking this took 0.080 ms
2-norm of RHS = 761.0601463768141, which took 0.092 ms

iter_count = 276, r_2norm = 6.365e-04, tol*||rhs|| = 7.611e-04

Anderson update took 111.130 ms, out of which F'*F took 60.750 ms; b-Ax took 396.801 ms, out of which Lap took 364.655 ms
Solving Poisson took 738.687 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.150269 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 73.936 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.251508 
Total time for convolution: 	 convolve: 5.135889 
Total time for convolution: 	 convolve: 5.145923 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.154 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 3.635 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.965 ms

This SCF took 31924.204 ms, scf error = 1.724e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.160677, lowerbound = -1.039721, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1299.241 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.322 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.530 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.866 ms
rank =  0, finding HY took 22.182 ms
rank =  0, distributing HY into block cyclic form took 16.378 ms
rank =  0, finding Y'*HY took 3.841 ms
Rank 0, Project_Hamiltonian used 61.294 ms
Total time for projection: 61.306 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.226 ms
    first calculated eigval = -1.023592157670294
    last  calculated eigval = 0.032851019247564
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54160460871812
lambda[   6] =  -0.52413901745516
lambda[   7] =  -0.51238441187970
lambda[   8] =  -0.45504964418702
lambda[   9] =  -0.45109329989695
lambda[  10] =  -0.37538655314813
lambda[  11] =  -0.36529930621700
lambda[  12] =  -0.34996192147987
lambda[  13] =  -0.34552621670732
lambda[  14] =  -0.29097922793975
lambda[  15] =  -0.07048240648282
lambda[  16] =  -0.04228773443276
lambda[  17] =  -0.02575883895134
lambda[  18] =   0.01591813224571
lambda[  19] =   0.02303014330711
lambda[  20] =   0.02659568134234
lambda[  21] =   0.03285101924756
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.239 ms
rank =  0, subspace rotation using ScaLAPACK took 7.461 ms
rank =  0, Distributing orbital back into band + domain format took 15.136 ms
rank = 0, Subspace_Rotation used 22.608 ms

Total time for subspace rotation: 22.613 ms
rank = 0, Efermi =  -0.099286259992 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 3.610 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.806 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.590 ms
rank = 0, Calculating density took 1397.602 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.835 ms
rank = 0, D2D took 1.975 ms
rank = 0, Transfering density took 1.977 ms
Etot    =   -47.965583182962
Eband   =   -15.169764336713
E1      =    31.484892519863
E2      =   -12.879187205222
E3      =   -16.670276418899
Exc     =   -14.925947676896
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 6.206e-03, dEband = 6.943e-02
rank = 0, Calculating/Estimating energy took 0.779 ms, Etot = -47.965583183, dEtot = 6.206e-03, dEband = 6.943e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 21.3338739184605, which took 0.049 ms

iter_count = 102, r_2norm = 5.849e-04, tol*||rhs|| = 8.534e-04

Anderson update took 41.769 ms, out of which F'*F took 22.373 ms; b-Ax took 146.155 ms, out of which Lap took 134.009 ms
rank = 0, Mixing (+ precond) took 278.673 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986065, int_b + int_rho = 7.276e-15, checking this took 0.081 ms
2-norm of RHS = 755.5599774936499, which took 0.086 ms

iter_count = 294, r_2norm = 6.619e-04, tol*||rhs|| = 7.556e-04

Anderson update took 116.865 ms, out of which F'*F took 65.635 ms; b-Ax took 435.062 ms, out of which Lap took 398.891 ms
Solving Poisson took 793.895 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.958 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Total time for convolution: 	 convolve: 5.141034 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.136259 
Total time for convolution: 	 convolve: 5.148424 
Total time for convolution: 	 convolve: 5.145558 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.168 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.636 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.363 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.048 ms

This SCF took 27080.243 ms, scf error = 1.177e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.132851, lowerbound = -1.023592, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1295.421 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.841 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.165 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.019 ms
rank =  0, finding HY took 22.226 ms
rank =  0, distributing HY into block cyclic form took 16.289 ms
rank =  0, finding Y'*HY took 3.924 ms
Rank 0, Project_Hamiltonian used 62.488 ms
Total time for projection: 62.500 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.228 ms
    first calculated eigval = -0.995269527104622
    last  calculated eigval = 0.028354663726764
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50742213744779
lambda[   6] =  -0.48474210024466
lambda[   7] =  -0.47550531398158
lambda[   8] =  -0.40821360652311
lambda[   9] =  -0.40395355042703
lambda[  10] =  -0.33190991141916
lambda[  11] =  -0.32275530520499
lambda[  12] =  -0.31479908677596
lambda[  13] =  -0.30910291522080
lambda[  14] =  -0.25579050744420
lambda[  15] =  -0.04828859445569
lambda[  16] =  -0.02870006865228
lambda[  17] =  -0.01960935630463
lambda[  18] =   0.01380075846352
lambda[  19] =   0.01695287830568
lambda[  20] =   0.02065552847353
lambda[  21] =   0.02835466372676
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 7.452 ms
rank =  0, Distributing orbital back into band + domain format took 15.194 ms
rank = 0, Subspace_Rotation used 22.659 ms

Total time for subspace rotation: 22.663 ms
rank = 0, Efermi =  -0.077092447894 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 3.576 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.969 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 1395.126 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.817 ms
rank = 0, D2D took 1.956 ms
rank = 0, Transfering density took 1.958 ms
Etot    =   -47.914898885666
Eband   =   -14.020142325666
E1      =    30.489914502748
E2      =   -12.701860050654
E3      =   -17.047440401602
Exc     =   -15.229744201667
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 5.068e-03, dEband = 1.150e-01
rank = 0, Calculating/Estimating energy took 0.797 ms, Etot = -47.914898886, dEtot = 5.068e-03, dEband = 1.150e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.4517042267553, which took 0.050 ms

iter_count = 102, r_2norm = 2.365e-04, tol*||rhs|| = 2.981e-04

Anderson update took 41.616 ms, out of which F'*F took 22.300 ms; b-Ax took 146.241 ms, out of which Lap took 134.492 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 278.379 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986058, int_b + int_rho = -5.821e-14, checking this took 0.893 ms
2-norm of RHS = 755.5535210212304, which took 0.083 ms

iter_count = 264, r_2norm = 7.202e-04, tol*||rhs|| = 7.556e-04

Anderson update took 107.912 ms, out of which F'*F took 58.033 ms; b-Ax took 378.117 ms, out of which Lap took 348.201 ms
Solving Poisson took 702.969 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.179038 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 41.408 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.127784 
Total time for convolution: 	 convolve: 5.140123 
Total time for convolution: 	 convolve: 5.133393 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 3.728 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.153 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.147 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.603 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.344 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.993 ms

This SCF took 27161.564 ms, scf error = 3.730e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.128355, lowerbound = -0.995270, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1300.301 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 16.631 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.460 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.103 ms
rank =  0, finding HY took 22.219 ms
rank =  0, distributing HY into block cyclic form took 16.308 ms
rank =  0, finding Y'*HY took 3.842 ms
Rank 0, Project_Hamiltonian used 61.499 ms
Total time for projection: 61.513 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -0.987106322409456
    last  calculated eigval = 0.025740352884093
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49606460048180
lambda[   6] =  -0.47360535000151
lambda[   7] =  -0.46405605056152
lambda[   8] =  -0.39426089083962
lambda[   9] =  -0.39077804537968
lambda[  10] =  -0.32400498002533
lambda[  11] =  -0.31539735677365
lambda[  12] =  -0.30800247616125
lambda[  13] =  -0.30271859069378
lambda[  14] =  -0.24581240285676
lambda[  15] =  -0.04351127416527
lambda[  16] =  -0.02880331244027
lambda[  17] =  -0.01415429114612
lambda[  18] =   0.01112267145511
lambda[  19] =   0.01441184084668
lambda[  20] =   0.01733628760792
lambda[  21] =   0.02574035288409
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 7.480 ms
rank =  0, Distributing orbital back into band + domain format took 15.307 ms
rank = 0, Subspace_Rotation used 22.798 ms

Total time for subspace rotation: 22.802 ms
rank = 0, Efermi =  -0.072315127664 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.676 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.292 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.921 ms
rank = 0, Calculating density took 1399.918 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.945 ms
rank = 0, D2D took 2.071 ms
rank = 0, Transfering density took 2.073 ms
Etot    =   -47.910169760634
Eband   =   -13.734834075140
E1      =    30.291466192066
E2      =   -12.597261347184
E3      =   -17.149736004646
Exc     =   -15.309571916054
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 4.729e-04, dEband = 2.853e-02
rank = 0, Calculating/Estimating energy took 0.762 ms, Etot = -47.910169761, dEtot = 4.729e-04, dEband = 2.853e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.5048980300390, which took 0.125 ms

iter_count = 108, r_2norm = 8.858e-05, tol*||rhs|| = 1.402e-04

Anderson update took 45.731 ms, out of which F'*F took 23.814 ms; b-Ax took 154.305 ms, out of which Lap took 142.241 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 296.936 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986058, int_b + int_rho = -5.457e-14, checking this took 0.081 ms
2-norm of RHS = 756.1747681935905, which took 0.089 ms

iter_count = 246, r_2norm = 7.127e-04, tol*||rhs|| = 7.562e-04

Anderson update took 102.383 ms, out of which F'*F took 53.691 ms; b-Ax took 350.326 ms, out of which Lap took 322.611 ms
Solving Poisson took 656.899 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.130 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Total time for convolution: 	 convolve: 5.151632 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.873 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.171010 
Total time for convolution: 	 convolve: 5.232455 
Total time for convolution: 	 convolve: 5.135988 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.149 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.151 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 1.729 ms
======D2D: initiated sending and receiving took 2.458 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.681 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.715 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.431 ms

This SCF took 27053.650 ms, scf error = 1.453e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.125740, lowerbound = -0.987106, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1301.409 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 16.223 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.482 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.719 ms
rank =  0, finding HY took 22.158 ms
rank =  0, distributing HY into block cyclic form took 15.815 ms
rank =  0, finding Y'*HY took 3.952 ms
Rank 0, Project_Hamiltonian used 60.674 ms
Total time for projection: 60.691 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -0.983698710766800
    last  calculated eigval = 0.024856414007734
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49299931601846
lambda[   6] =  -0.46985785635842
lambda[   7] =  -0.46023310461719
lambda[   8] =  -0.38931637700748
lambda[   9] =  -0.38608684948036
lambda[  10] =  -0.31927857055321
lambda[  11] =  -0.31161660685059
lambda[  12] =  -0.30493737184886
lambda[  13] =  -0.29973662016549
lambda[  14] =  -0.24215566503394
lambda[  15] =  -0.04153927111169
lambda[  16] =  -0.02825588031124
lambda[  17] =  -0.01185026563853
lambda[  18] =   0.00856960924751
lambda[  19] =   0.01440647581796
lambda[  20] =   0.01609331953576
lambda[  21] =   0.02485641400773
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 7.491 ms
rank =  0, Distributing orbital back into band + domain format took 15.131 ms
rank = 0, Subspace_Rotation used 22.634 ms

Total time for subspace rotation: 22.639 ms
rank = 0, Efermi =  -0.070343124569 calculate fermi energy took 0.958 ms
rank = 0, --- Calculate rho: sum over local bands took 3.586 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.921 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.578 ms
rank = 0, Calculating density took 1400.059 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.827 ms
rank = 0, D2D took 1.948 ms
rank = 0, Transfering density took 1.969 ms
Etot    =   -47.908954271569
Eband   =   -13.629898371517
E1      =    30.245454896716
E2      =   -12.529849724403
E3      =   -17.184629904080
Exc     =   -15.334763111915
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 1.215e-04, dEband = 1.049e-02
rank = 0, Calculating/Estimating energy took 1.204 ms, Etot = -47.908954272, dEtot = 1.215e-04, dEband = 1.049e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0222704684750, which took 0.052 ms

iter_count = 114, r_2norm = 2.788e-05, tol*||rhs|| = 4.089e-05

Anderson update took 46.016 ms, out of which F'*F took 25.170 ms; b-Ax took 164.515 ms, out of which Lap took 151.496 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.287 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986060, int_b + int_rho = -3.638e-14, checking this took 0.080 ms
2-norm of RHS = 756.5850443926910, which took 0.102 ms

iter_count = 228, r_2norm = 7.178e-04, tol*||rhs|| = 7.566e-04

Anderson update took 94.014 ms, out of which F'*F took 49.893 ms; b-Ax took 326.876 ms, out of which Lap took 300.023 ms
Solving Poisson took 608.112 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Total time for convolution: 	 convolve: 5.133514 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 91.444 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.128804 
Total time for convolution: 	 convolve: 5.133462 
Total time for convolution: 	 convolve: 5.167791 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.156 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.173 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.401 ms
---Transfer Veff_loc: D2D took 3.630 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.000 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.664 ms

This SCF took 26953.095 ms, scf error = 6.157e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.124856, lowerbound = -0.983699, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1294.921 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 19.726 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.452 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.191 ms
rank =  0, finding HY took 22.180 ms
rank =  0, distributing HY into block cyclic form took 16.097 ms
rank =  0, finding Y'*HY took 3.834 ms
Rank 0, Project_Hamiltonian used 64.330 ms
Total time for projection: 64.345 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.126 ms
rank = 0, Solve_Generalized_EigenProblem used 0.254 ms
    first calculated eigval = -0.981645605553393
    last  calculated eigval = 0.024516506257051
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49141080522040
lambda[   6] =  -0.46795187290230
lambda[   7] =  -0.45856243525278
lambda[   8] =  -0.38710163424707
lambda[   9] =  -0.38384684777868
lambda[  10] =  -0.31777579296775
lambda[  11] =  -0.31039190165696
lambda[  12] =  -0.30375437811966
lambda[  13] =  -0.29886428002794
lambda[  14] =  -0.24035480312988
lambda[  15] =  -0.04075790098502
lambda[  16] =  -0.02791698144189
lambda[  17] =  -0.01096205033053
lambda[  18] =   0.00750050490892
lambda[  19] =   0.01456117356810
lambda[  20] =   0.01567919881862
lambda[  21] =   0.02451650625705
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.283 ms
rank =  0, subspace rotation using ScaLAPACK took 7.450 ms
rank =  0, Distributing orbital back into band + domain format took 15.126 ms
rank = 0, Subspace_Rotation used 22.589 ms

Total time for subspace rotation: 22.593 ms
rank = 0, Efermi =  -0.069561754539 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 3.644 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.713 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1396.280 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.862 ms
rank = 0, D2D took 1.989 ms
rank = 0, Transfering density took 1.992 ms
Etot    =   -47.908631919295
Eband   =   -13.585224121584
E1      =    30.232956225042
E2      =   -12.494566068727
E3      =   -17.194654765435
Exc     =   -15.341357543579
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 3.224e-05, dEband = 4.467e-03
rank = 0, Calculating/Estimating energy took 0.960 ms, Etot = -47.908631919, dEtot = 3.224e-05, dEband = 4.467e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4321750272452, which took 0.122 ms

iter_count = 114, r_2norm = 1.175e-05, tol*||rhs|| = 1.729e-05

Anderson update took 48.609 ms, out of which F'*F took 25.370 ms; b-Ax took 164.232 ms, out of which Lap took 151.896 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.869 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986057, int_b + int_rho = -7.276e-14, checking this took 0.078 ms
2-norm of RHS = 756.9067427250119, which took 0.080 ms

iter_count = 240, r_2norm = 6.227e-04, tol*||rhs|| = 7.569e-04

Anderson update took 101.163 ms, out of which F'*F took 52.704 ms; b-Ax took 344.523 ms, out of which Lap took 316.626 ms
Solving Poisson took 642.776 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Total time for convolution: 	 convolve: 5.138601 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.347 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.126304 
Total time for convolution: 	 convolve: 5.141117 
Total time for convolution: 	 convolve: 5.132561 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.156 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.445 ms
---Transfer Veff_loc: D2D took 3.690 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.194 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.920 ms

This SCF took 26905.925 ms, scf error = 3.529e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.124517, lowerbound = -0.981646, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1300.473 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 16.653 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.501 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.167 ms
rank =  0, finding HY took 22.098 ms
rank =  0, distributing HY into block cyclic form took 15.830 ms
rank =  0, finding Y'*HY took 3.971 ms
Rank 0, Project_Hamiltonian used 61.091 ms
Total time for projection: 61.105 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.128 ms
rank = 0, Solve_Generalized_EigenProblem used 0.254 ms
    first calculated eigval = -0.977445519039598
    last  calculated eigval = 0.026067726826755
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48837388908352
lambda[   6] =  -0.46394010184801
lambda[   7] =  -0.45573402327598
lambda[   8] =  -0.38290642078861
lambda[   9] =  -0.37931622824420
lambda[  10] =  -0.31412418862544
lambda[  11] =  -0.30712757929648
lambda[  12] =  -0.30060497834227
lambda[  13] =  -0.29626620250751
lambda[  14] =  -0.23673424937796
lambda[  15] =  -0.03898477167426
lambda[  16] =  -0.02622525866896
lambda[  17] =  -0.00893222762488
lambda[  18] =   0.00869143358846
lambda[  19] =   0.01588416332186
lambda[  20] =   0.01666531277388
lambda[  21] =   0.02606772682676
==subpsace eigenproblem: bcast eigvals took 0.062 ms
Total time for solving subspace eigenvalue problem: 0.324 ms
rank =  0, subspace rotation using ScaLAPACK took 7.453 ms
rank =  0, Distributing orbital back into band + domain format took 15.919 ms
rank = 0, Subspace_Rotation used 23.407 ms

Total time for subspace rotation: 23.414 ms
rank = 0, Efermi =  -0.067788625153 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.635 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.675 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 1399.685 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.825 ms
rank = 0, D2D took 1.935 ms
rank = 0, Transfering density took 1.940 ms
Etot    =   -47.908347877411
Eband   =   -13.486640432683
E1      =    30.184868792355
E2      =   -12.439253346059
E3      =   -17.212225129515
Exc     =   -15.353827399320
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 2.840e-05, dEband = 9.858e-03
rank = 0, Calculating/Estimating energy took 0.809 ms, Etot = -47.908347877, dEtot = 2.840e-05, dEband = 9.858e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2396232506512, which took 0.118 ms

iter_count = 114, r_2norm = 6.687e-06, tol*||rhs|| = 9.585e-06

Anderson update took 47.357 ms, out of which F'*F took 25.315 ms; b-Ax took 165.623 ms, out of which Lap took 152.890 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 312.459 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986055, int_b + int_rho = -8.731e-14, checking this took 0.081 ms
2-norm of RHS = 756.9524195058178, which took 0.075 ms

iter_count = 222, r_2norm = 5.982e-04, tol*||rhs|| = 7.570e-04

Anderson update took 93.898 ms, out of which F'*F took 49.463 ms; b-Ax took 319.323 ms, out of which Lap took 294.380 ms
Solving Poisson took 594.890 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Total time for convolution: 	 convolve: 5.134624 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 75.511 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.125698 
Total time for convolution: 	 convolve: 5.129277 
Total time for convolution: 	 convolve: 5.149532 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.478 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.720 ms
---Transfer Veff_loc: D2D took 3.585 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.989 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.605 ms

This SCF took 27325.771 ms, scf error = 1.665e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.126068, lowerbound = -0.977446, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1299.801 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 16.359 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.483 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.856 ms
rank =  0, finding HY took 22.209 ms
rank =  0, distributing HY into block cyclic form took 15.813 ms
rank =  0, finding Y'*HY took 4.251 ms
Rank 0, Project_Hamiltonian used 61.156 ms
Total time for projection: 61.172 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.115 ms
rank = 0, Solve_Generalized_EigenProblem used 0.244 ms
    first calculated eigval = -0.975955169439177
    last  calculated eigval = 0.027710342977913
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48696602407375
lambda[   6] =  -0.46241737945310
lambda[   7] =  -0.45455619411378
lambda[   8] =  -0.38133866121629
lambda[   9] =  -0.37760168604981
lambda[  10] =  -0.31241483178875
lambda[  11] =  -0.30549183855670
lambda[  12] =  -0.29905984383366
lambda[  13] =  -0.29479450455181
lambda[  14] =  -0.23532350920494
lambda[  15] =  -0.03769570841607
lambda[  16] =  -0.02508938570159
lambda[  17] =  -0.00776973771508
lambda[  18] =   0.01086270503078
lambda[  19] =   0.01731128913019
lambda[  20] =   0.01810561885645
lambda[  21] =   0.02771034297791
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.261 ms
rank =  0, subspace rotation using ScaLAPACK took 7.453 ms
rank =  0, Distributing orbital back into band + domain format took 15.010 ms
rank = 0, Subspace_Rotation used 22.474 ms

Total time for subspace rotation: 22.479 ms
rank = 0, Efermi =  -0.066499561949 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.590 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.976 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 1397.978 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.811 ms
rank = 0, D2D took 1.950 ms
rank = 0, Transfering density took 1.952 ms
Etot    =   -47.908292280318
Eband   =   -13.443920918475
E1      =    30.164917859553
E2      =   -12.415452121304
E3      =   -17.215661981113
Exc     =   -15.356176010476
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 5.560e-06, dEband = 4.272e-03
rank = 0, Calculating/Estimating energy took 0.772 ms, Etot = -47.908292280, dEtot = 5.560e-06, dEband = 4.272e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1725997698662, which took 0.126 ms

iter_count = 114, r_2norm = 4.987e-06, tol*||rhs|| = 6.904e-06

Anderson update took 47.151 ms, out of which F'*F took 25.205 ms; b-Ax took 163.826 ms, out of which Lap took 151.093 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.342 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986065, int_b + int_rho = 1.455e-14, checking this took 0.084 ms
2-norm of RHS = 756.9298238052144, which took 0.103 ms

iter_count = 198, r_2norm = 6.944e-04, tol*||rhs|| = 7.569e-04

Anderson update took 82.376 ms, out of which F'*F took 43.456 ms; b-Ax took 283.917 ms, out of which Lap took 261.581 ms
Solving Poisson took 528.267 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Total time for convolution: 	 convolve: 5.138493 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.312 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.197033 
Total time for convolution: 	 convolve: 5.222748 
Total time for convolution: 	 convolve: 5.201968 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.156 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.670 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.992 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.695 ms

This SCF took 27070.843 ms, scf error = 9.540e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.127710, lowerbound = -0.975955, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1300.760 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 16.677 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.452 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.142 ms
rank =  0, finding HY took 22.190 ms
rank =  0, distributing HY into block cyclic form took 15.934 ms
rank =  0, finding Y'*HY took 3.827 ms
Rank 0, Project_Hamiltonian used 61.123 ms
Total time for projection: 61.138 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.122 ms
rank = 0, Solve_Generalized_EigenProblem used 0.251 ms
    first calculated eigval = -0.975067536334016
    last  calculated eigval = 0.028291364580309
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48616185131865
lambda[   6] =  -0.46149871323098
lambda[   7] =  -0.45380400174120
lambda[   8] =  -0.38037030340861
lambda[   9] =  -0.37658210520921
lambda[  10] =  -0.31152192333146
lambda[  11] =  -0.30464488116100
lambda[  12] =  -0.29820439859682
lambda[  13] =  -0.29403070311835
lambda[  14] =  -0.23442958304383
lambda[  15] =  -0.03684427700114
lambda[  16] =  -0.02449260234796
lambda[  17] =  -0.00714589209042
lambda[  18] =   0.01206144202655
lambda[  19] =   0.01824515747253
lambda[  20] =   0.01911843518156
lambda[  21] =   0.02829136458031
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.288 ms
rank =  0, subspace rotation using ScaLAPACK took 7.460 ms
rank =  0, Distributing orbital back into band + domain format took 15.149 ms
rank = 0, Subspace_Rotation used 22.624 ms

Total time for subspace rotation: 22.629 ms
rank = 0, Efermi =  -0.065648130512 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 3.566 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.921 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 1399.015 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.819 ms
rank = 0, D2D took 1.949 ms
rank = 0, Transfering density took 1.954 ms
Etot    =   -47.908333728789
Eband   =   -13.419248609779
E1      =    30.150996494339
E2      =   -12.403908005091
E3      =   -17.219000632364
Exc     =   -15.358762937468
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 4.145e-06, dEband = 2.467e-03
rank = 0, Calculating/Estimating energy took 0.794 ms, Etot = -47.908333729, dEtot = 4.145e-06, dEband = 2.467e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1094007200837, which took 0.121 ms

iter_count = 114, r_2norm = 2.757e-06, tol*||rhs|| = 4.376e-06

Anderson update took 47.056 ms, out of which F'*F took 25.342 ms; b-Ax took 164.519 ms, out of which Lap took 151.804 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.685 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986065, int_b + int_rho = 7.276e-15, checking this took 0.082 ms
2-norm of RHS = 756.9262320736145, which took 0.077 ms

iter_count = 204, r_2norm = 6.132e-04, tol*||rhs|| = 7.569e-04

Anderson update took 86.587 ms, out of which F'*F took 44.777 ms; b-Ax took 291.474 ms, out of which Lap took 269.542 ms
Solving Poisson took 547.126 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.129234 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 32.322 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.155434 
Total time for convolution: 	 convolve: 5.152277 
Total time for convolution: 	 convolve: 5.135208 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 4.215 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 3.577 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.998 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.609 ms

This SCF took 26832.470 ms, scf error = 7.010e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.128291, lowerbound = -0.975068, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1294.097 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.096 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.448 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.558 ms
rank =  0, finding HY took 22.133 ms
rank =  0, distributing HY into block cyclic form took 15.859 ms
rank =  0, finding Y'*HY took 4.999 ms
Rank 0, Project_Hamiltonian used 65.598 ms
Total time for projection: 65.616 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.140 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.117 ms
rank = 0, Solve_Generalized_EigenProblem used 0.260 ms
    first calculated eigval = -0.974009556431814
    last  calculated eigval = 0.030525504649250
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48535682766842
lambda[   6] =  -0.46049216553223
lambda[   7] =  -0.45299535080735
lambda[   8] =  -0.37931108958122
lambda[   9] =  -0.37545273440406
lambda[  10] =  -0.31061503612753
lambda[  11] =  -0.30380843947375
lambda[  12] =  -0.29731783056767
lambda[  13] =  -0.29330010606609
lambda[  14] =  -0.23341578908137
lambda[  15] =  -0.03515637448337
lambda[  16] =  -0.02287212105381
lambda[  17] =  -0.00625098654264
lambda[  18] =   0.01506631321861
lambda[  19] =   0.02092383265090
lambda[  20] =   0.02197488735769
lambda[  21] =   0.03052550464925
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.284 ms
rank =  0, subspace rotation using ScaLAPACK took 7.497 ms
rank =  0, Distributing orbital back into band + domain format took 15.045 ms
rank = 0, Subspace_Rotation used 22.557 ms

Total time for subspace rotation: 22.563 ms
rank = 0, Efermi =  -0.063960228090 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 3.608 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.790 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.592 ms
rank = 0, Calculating density took 1396.738 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.829 ms
rank = 0, D2D took 1.970 ms
rank = 0, Transfering density took 1.976 ms
Etot    =   -47.908381619915
Eband   =   -13.393607521159
E1      =    30.139072904281
E2      =   -12.389893838020
E3      =   -17.220143070317
Exc     =   -15.359656598039
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 4.789e-06, dEband = 2.564e-03
rank = 0, Calculating/Estimating energy took 0.780 ms, Etot = -47.908381620, dEtot = 4.789e-06, dEband = 2.564e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0709728058181, which took 0.052 ms

iter_count = 114, r_2norm = 2.141e-06, tol*||rhs|| = 2.839e-06

Anderson update took 47.069 ms, out of which F'*F took 25.265 ms; b-Ax took 164.723 ms, out of which Lap took 151.981 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 312.200 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986062, int_b + int_rho = -1.819e-14, checking this took 0.082 ms
2-norm of RHS = 756.9244423235606, which took 0.076 ms

iter_count = 168, r_2norm = 6.573e-04, tol*||rhs|| = 7.569e-04

Anderson update took 70.218 ms, out of which F'*F took 36.828 ms; b-Ax took 240.078 ms, out of which Lap took 221.495 ms
Solving Poisson took 448.967 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Total time for convolution: 	 convolve: 5.150799 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 51.432 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.233074 
Total time for convolution: 	 convolve: 5.138849 
Total time for convolution: 	 convolve: 5.192691 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 3.576 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.991 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.600 ms

This SCF took 26914.332 ms, scf error = 4.117e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.130526, lowerbound = -0.974010, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1301.419 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 16.405 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.420 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.838 ms
rank =  0, finding HY took 22.152 ms
rank =  0, distributing HY into block cyclic form took 16.031 ms
rank =  0, finding Y'*HY took 3.791 ms
Rank 0, Project_Hamiltonian used 60.855 ms
Total time for projection: 60.869 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.125 ms
rank = 0, Solve_Generalized_EigenProblem used 0.258 ms
    first calculated eigval = -0.973578719666568
    last  calculated eigval = 0.030595460310556
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48498262349784
lambda[   6] =  -0.46006934561649
lambda[   7] =  -0.45262802802577
lambda[   8] =  -0.37887868157317
lambda[   9] =  -0.37500373294675
lambda[  10] =  -0.31024062048558
lambda[  11] =  -0.30345104636568
lambda[  12] =  -0.29694481125393
lambda[  13] =  -0.29297277365384
lambda[  14] =  -0.23301228618992
lambda[  15] =  -0.03454984582819
lambda[  16] =  -0.02219515928788
lambda[  17] =  -0.00586550425880
lambda[  18] =   0.01545019008912
lambda[  19] =   0.02181248180059
lambda[  20] =   0.02303151255557
lambda[  21] =   0.03059546031056
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.298 ms
rank =  0, subspace rotation using ScaLAPACK took 7.433 ms
rank =  0, Distributing orbital back into band + domain format took 15.128 ms
rank = 0, Subspace_Rotation used 22.573 ms

Total time for subspace rotation: 22.578 ms
rank = 0, Efermi =  -0.063353699344 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.575 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.983 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.581 ms
rank = 0, Calculating density took 1399.478 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.800 ms
rank = 0, D2D took 1.918 ms
rank = 0, Transfering density took 1.920 ms
Etot    =   -47.908434144639
Eband   =   -13.382661682242
E1      =    30.133354783963
E2      =   -12.384449940845
E3      =   -17.221001993160
Exc     =   -15.360351867028
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 5.252e-06, dEband = 1.095e-03
rank = 0, Calculating/Estimating energy took 0.783 ms, Etot = -47.908434145, dEtot = 5.252e-06, dEband = 1.095e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0596627269079, which took 0.078 ms

iter_count = 108, r_2norm = 2.321e-06, tol*||rhs|| = 2.387e-06

Anderson update took 45.082 ms, out of which F'*F took 23.818 ms; b-Ax took 155.304 ms, out of which Lap took 143.505 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.812 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986079, int_b + int_rho = 1.455e-13, checking this took 0.077 ms
2-norm of RHS = 756.9338195667466, which took 0.098 ms

iter_count = 180, r_2norm = 6.517e-04, tol*||rhs|| = 7.569e-04

Anderson update took 75.277 ms, out of which F'*F took 39.574 ms; b-Ax took 257.801 ms, out of which Lap took 237.669 ms
Solving Poisson took 480.942 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Total time for convolution: 	 convolve: 5.173415 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.133205 
Total time for convolution: 	 convolve: 5.143629 
Total time for convolution: 	 convolve: 5.136312 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.591 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.992 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.636 ms

This SCF took 26728.606 ms, scf error = 3.318e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.130595, lowerbound = -0.973579, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1285.057 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 27.859 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.454 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 30.326 ms
rank =  0, finding HY took 22.079 ms
rank =  0, distributing HY into block cyclic form took 15.908 ms
rank =  0, finding Y'*HY took 3.865 ms
Rank 0, Project_Hamiltonian used 72.209 ms
Total time for projection: 72.224 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.131 ms
rank = 0, Solve_Generalized_EigenProblem used 0.260 ms
    first calculated eigval = -0.972919781349589
    last  calculated eigval = 0.031214802959139
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48437795848156
lambda[   6] =  -0.45944381042979
lambda[   7] =  -0.45204102633279
lambda[   8] =  -0.37827154646732
lambda[   9] =  -0.37437961061343
lambda[  10] =  -0.30970528429930
lambda[  11] =  -0.30292050984482
lambda[  12] =  -0.29638539391194
lambda[  13] =  -0.29246458676965
lambda[  14] =  -0.23240856246442
lambda[  15] =  -0.03351712596653
lambda[  16] =  -0.02080285854593
lambda[  17] =  -0.00523042233234
lambda[  18] =   0.01583207668240
lambda[  19] =   0.02319020928206
lambda[  20] =   0.02533914341580
lambda[  21] =   0.03121480295914
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.282 ms
rank =  0, subspace rotation using ScaLAPACK took 7.458 ms
rank =  0, Distributing orbital back into band + domain format took 15.070 ms
rank = 0, Subspace_Rotation used 22.540 ms

Total time for subspace rotation: 22.545 ms
rank = 0, Efermi =  -0.062320979468 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.580 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.994 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.576 ms
rank = 0, Calculating density took 1394.383 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.800 ms
rank = 0, D2D took 1.917 ms
rank = 0, Transfering density took 1.919 ms
Etot    =   -47.908516903356
Eband   =   -13.366299229629
E1      =    30.125116327794
E2      =   -12.376041068252
E3      =   -17.222062457985
Exc     =   -15.361210214421
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 8.276e-06, dEband = 1.636e-03
rank = 0, Calculating/Estimating energy took 0.781 ms, Etot = -47.908516903, dEtot = 8.276e-06, dEband = 1.636e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0446990512214, which took 0.128 ms

iter_count = 114, r_2norm = 1.075e-06, tol*||rhs|| = 1.788e-06

Anderson update took 47.499 ms, out of which F'*F took 25.436 ms; b-Ax took 164.813 ms, out of which Lap took 152.017 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 312.018 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986061, int_b + int_rho = -2.547e-14, checking this took 0.088 ms
2-norm of RHS = 756.9396488648553, which took 0.784 ms

iter_count = 156, r_2norm = 7.389e-04, tol*||rhs|| = 7.569e-04

Anderson update took 64.786 ms, out of which F'*F took 34.252 ms; b-Ax took 228.175 ms, out of which Lap took 210.927 ms
Solving Poisson took 423.612 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.101 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.140845 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 82.173 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.144841 
Total time for convolution: 	 convolve: 5.142064 
Total time for convolution: 	 convolve: 5.173278 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.156 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.613 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.140 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.787 ms

This SCF took 26777.204 ms, scf error = 2.063e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.131215, lowerbound = -0.972920, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1279.568 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 30.557 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.420 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 32.990 ms
rank =  0, finding HY took 22.155 ms
rank =  0, distributing HY into block cyclic form took 15.955 ms
rank =  0, finding Y'*HY took 3.862 ms
Rank 0, Project_Hamiltonian used 74.990 ms
Total time for projection: 75.006 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.122 ms
rank = 0, Solve_Generalized_EigenProblem used 0.250 ms
    first calculated eigval = -0.972593628576292
    last  calculated eigval = 0.032310464185120
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48408149756915
lambda[   6] =  -0.45914777325275
lambda[   7] =  -0.45175467663846
lambda[   8] =  -0.37800194057926
lambda[   9] =  -0.37410190416322
lambda[  10] =  -0.30943896935907
lambda[  11] =  -0.30264440398750
lambda[  12] =  -0.29610083863877
lambda[  13] =  -0.29219130750639
lambda[  14] =  -0.23210582853666
lambda[  15] =  -0.03309807465743
lambda[  16] =  -0.01997193153754
lambda[  17] =  -0.00492601600570
lambda[  18] =   0.01596546724606
lambda[  19] =   0.02339950384742
lambda[  20] =   0.02622426486920
lambda[  21] =   0.03231046418512
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.277 ms
rank =  0, subspace rotation using ScaLAPACK took 7.465 ms
rank =  0, Distributing orbital back into band + domain format took 15.086 ms
rank = 0, Subspace_Rotation used 22.563 ms

Total time for subspace rotation: 22.568 ms
rank = 0, Efermi =  -0.061901928080 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.604 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.884 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.577 ms
rank = 0, Calculating density took 1391.662 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.796 ms
rank = 0, D2D took 1.936 ms
rank = 0, Transfering density took 1.938 ms
Etot    =   -47.908562626472
Eband   =   -13.358267897276
E1      =    30.121122925145
E2      =   -12.371851658036
E3      =   -17.222552900937
Exc     =   -15.361594899978
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 4.572e-06, dEband = 8.031e-04
rank = 0, Calculating/Estimating energy took 0.802 ms, Etot = -47.908562626, dEtot = 4.572e-06, dEband = 8.031e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0306356619296, which took 0.078 ms

iter_count = 114, r_2norm = 7.657e-07, tol*||rhs|| = 1.225e-06

Anderson update took 47.580 ms, out of which F'*F took 25.393 ms; b-Ax took 164.459 ms, out of which Lap took 151.907 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 312.922 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986054, int_b + int_rho = -1.019e-13, checking this took 0.076 ms
2-norm of RHS = 756.9432605032757, which took 0.077 ms

iter_count = 150, r_2norm = 6.503e-04, tol*||rhs|| = 7.569e-04

Anderson update took 62.815 ms, out of which F'*F took 32.970 ms; b-Ax took 215.062 ms, out of which Lap took 198.208 ms
Solving Poisson took 401.425 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Total time for convolution: 	 convolve: 5.118038 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 47.940 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.134463 
Total time for convolution: 	 convolve: 5.160786 
Total time for convolution: 	 convolve: 5.142621 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.032 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 3.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.989 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.705 ms

This SCF took 26672.824 ms, scf error = 1.478e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.132310, lowerbound = -0.972594, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1282.721 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 29.057 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.445 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 31.517 ms
rank =  0, finding HY took 22.148 ms
rank =  0, distributing HY into block cyclic form took 15.811 ms
rank =  0, finding Y'*HY took 3.851 ms
Rank 0, Project_Hamiltonian used 73.356 ms
Total time for projection: 73.370 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.128 ms
rank = 0, Solve_Generalized_EigenProblem used 0.258 ms
    first calculated eigval = -0.972399930341677
    last  calculated eigval = 0.033661286451480
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48388639990141
lambda[   6] =  -0.45896453053247
lambda[   7] =  -0.45156312619801
lambda[   8] =  -0.37783326657467
lambda[   9] =  -0.37393344665359
lambda[  10] =  -0.30925600224937
lambda[  11] =  -0.30245001758641
lambda[  12] =  -0.29590901751209
lambda[  13] =  -0.29199065782542
lambda[  14] =  -0.23191581212015
lambda[  15] =  -0.03289092064937
lambda[  16] =  -0.01937674458885
lambda[  17] =  -0.00472064046670
lambda[  18] =   0.01605155281347
lambda[  19] =   0.02328970411399
lambda[  20] =   0.02642880355859
lambda[  21] =   0.03366128645148
==subpsace eigenproblem: bcast eigvals took 0.056 ms
Total time for solving subspace eigenvalue problem: 0.321 ms
rank =  0, subspace rotation using ScaLAPACK took 7.436 ms
rank =  0, Distributing orbital back into band + domain format took 15.078 ms
rank = 0, Subspace_Rotation used 22.526 ms

Total time for subspace rotation: 22.531 ms
rank = 0, Efermi =  -0.061694774107 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.602 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.882 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.577 ms
rank = 0, Calculating density took 1393.184 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.829 ms
rank = 0, D2D took 1.954 ms
rank = 0, Transfering density took 1.957 ms
Etot    =   -47.908592604051
Eband   =   -13.352973104879
E1      =    30.118552242907
E2      =   -12.369025252178
E3      =   -17.222846044891
Exc     =   -15.361815725812
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 2.998e-06, dEband = 5.295e-04
rank = 0, Calculating/Estimating energy took 0.807 ms, Etot = -47.908592604, dEtot = 2.998e-06, dEband = 5.295e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0184035971604, which took 0.049 ms

iter_count = 114, r_2norm = 4.690e-07, tol*||rhs|| = 7.361e-07

Anderson update took 47.380 ms, out of which F'*F took 25.293 ms; b-Ax took 164.476 ms, out of which Lap took 151.775 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.736 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986077, int_b + int_rho = 1.346e-13, checking this took 0.077 ms
2-norm of RHS = 756.9465404406045, which took 0.094 ms

iter_count = 138, r_2norm = 7.456e-04, tol*||rhs|| = 7.569e-04

Anderson update took 58.016 ms, out of which F'*F took 30.248 ms; b-Ax took 197.776 ms, out of which Lap took 182.533 ms
Solving Poisson took 369.826 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Total time for convolution: 	 convolve: 5.221705 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.130209 
Total time for convolution: 	 convolve: 5.178967 
Total time for convolution: 	 convolve: 5.223195 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.157 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.575 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.997 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.605 ms

This SCF took 26795.059 ms, scf error = 1.044e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.133661, lowerbound = -0.972400, upperbound = 267.570693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1300.640 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 16.444 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.434 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.892 ms
rank =  0, finding HY took 22.184 ms
rank =  0, distributing HY into block cyclic form took 15.993 ms
rank =  0, finding Y'*HY took 3.826 ms
Rank 0, Project_Hamiltonian used 60.925 ms
Total time for projection: 60.941 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.137 ms
rank = 0, Solve_Generalized_EigenProblem used 0.265 ms
    first calculated eigval = -0.972306786161513
    last  calculated eigval = 0.035485278391043
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48375853609275
lambda[   6] =  -0.45885689441260
lambda[   7] =  -0.45142914923727
lambda[   8] =  -0.37772039687062
lambda[   9] =  -0.37383033971490
lambda[  10] =  -0.30914443516960
lambda[  11] =  -0.30233166893801
lambda[  12] =  -0.29579391789394
lambda[  13] =  -0.29185994123718
lambda[  14] =  -0.23181200168358
lambda[  15] =  -0.03263461004937
lambda[  16] =  -0.01870685143933
lambda[  17] =  -0.00456514096153
lambda[  18] =   0.01606888450516
lambda[  19] =   0.02360224045632
lambda[  20] =   0.02679833499161
lambda[  21] =   0.03548527839104
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.304 ms
rank =  0, subspace rotation using ScaLAPACK took 7.469 ms
rank =  0, Distributing orbital back into band + domain format took 15.109 ms
rank = 0, Subspace_Rotation used 22.589 ms

Total time for subspace rotation: 22.594 ms
rank = 0, Efermi =  -0.061438463558 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.558 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.121 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.574 ms
rank = 0, Calculating density took 1398.846 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.827 ms
rank = 0, D2D took 1.991 ms
rank = 0, Transfering density took 1.992 ms
Etot    =   -47.908614016774
Eband   =   -13.349712838295
E1      =    30.117145032013
E2      =   -12.367140346276
E3      =   -17.222878862267
Exc     =   -15.361838105698
Esc     =   -78.904227312450
Entropy =    -0.000000000887
dE = 2.141e-06, dEband = 3.260e-04
rank = 0, Calculating/Estimating energy took 0.755 ms, Etot = -47.908614017, dEtot = 2.141e-06, dEband = 3.260e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0159114436568, which took 0.057 ms

iter_count = 114, r_2norm = 4.279e-07, tol*||rhs|| = 6.365e-07

Anderson update took 48.018 ms, out of which F'*F took 25.077 ms; b-Ax took 163.688 ms, out of which Lap took 151.107 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.960 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002986064, int_rho =  28.00000002986077, int_b + int_rho = 1.310e-13, checking this took 0.076 ms
2-norm of RHS = 756.9468480065372, which took 0.094 ms

iter_count = 90, r_2norm = 7.233e-04, tol*||rhs|| = 7.569e-04

Anderson update took 37.655 ms, out of which F'*F took 19.809 ms; b-Ax took 128.995 ms, out of which Lap took 118.878 ms
Solving Poisson took 241.892 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Total time for convolution: 	 convolve: 5.141374 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.510 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.125166 
Total time for convolution: 	 convolve: 5.183747 
Total time for convolution: 	 convolve: 5.188142 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 3.682 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.223 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.940 ms

This SCF took 26590.391 ms, scf error = 7.934e-05
The last 17 occupations of kpoints #1 are (Nelectron = 28):
lambda[   5] =  -0.48375853609275, occ[   5] =   2.00000000000000
lambda[   6] =  -0.45885689441260, occ[   6] =   2.00000000000000
lambda[   7] =  -0.45142914923727, occ[   7] =   2.00000000000000
lambda[   8] =  -0.37772039687062, occ[   8] =   2.00000000000000
lambda[   9] =  -0.37383033971490, occ[   9] =   2.00000000000000
lambda[  10] =  -0.30914443516960, occ[  10] =   2.00000000000000
lambda[  11] =  -0.30233166893801, occ[  11] =   2.00000000000000
lambda[  12] =  -0.29579391789394, occ[  12] =   2.00000000000000
lambda[  13] =  -0.29185994123718, occ[  13] =   2.00000000000000
lambda[  14] =  -0.23181200168358, occ[  14] =   2.00000000000000
lambda[  15] =  -0.03263461004937, occ[  15] =   0.00000002986063
lambda[  16] =  -0.01870685143933, occ[  16] =   0.00000000000000
lambda[  17] =  -0.00456514096153, occ[  17] =   0.00000000000000
lambda[  18] =   0.01606888450516, occ[  18] =   0.00000000000000
lambda[  19] =   0.02360224045632, occ[  19] =   0.00000000000000
lambda[  20] =   0.02679833499161, occ[  20] =   0.00000000000000
lambda[  21] =   0.03548527839104, occ[  21] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 19 (90%) = 0.000000000000000.
Occupation of state 21 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.660 ms, time for Allreduce/Reduce: 11.998 ms 
Time for calculating local force components: 23.421 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.37746690237725   0.99661518660246   0.00000028752775
  0.02518850705258   0.04573144480668  -0.00000000398615
  0.01400401865478  -0.02555851370600  -0.04079126839443
  0.01400403321282  -0.02555851208064   0.04079124187475
  0.00998542662019  -0.02809405818759   0.04093707557416
  0.00998544061037  -0.02809407520341  -0.04093710502995
  0.17746983686534  -0.02556740473712  -0.00000016958022
  0.06514536783565  -0.16274588138248  -0.00000035041452
 -0.01209978951311   0.01498632550814   0.00000000367974
 -0.91485208456255   0.18401984713052   0.00000071943234
force_loc = 
  0.36544723343662  -0.96839139129013  -0.00000330759146
 -0.02696559170801  -0.04859245808320  -0.00000002698280
 -0.01563655866630   0.02720817014508   0.04356011976278
 -0.01563606213972   0.02720823447692  -0.04356096290839
 -0.01085666947882   0.03143622444550  -0.04451806457085
 -0.01085671612273   0.03143592999804   0.04451736701324
 -0.17173423720728   0.02346314320648   0.00000091661950
 -0.05152140654363   0.15080896849711   0.00000073852934
 -0.00674292824341  -0.00920636310197   0.00000047441841
  0.90013900183166  -0.18114241713085  -0.00000297577304
Time for calculating nonlocal force components: 32.643 ms
[32mforces_xc: 
[0m[32m  0.01262639612395  -0.03273151665970  -0.00000012576878
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00882684105103   0.00122136919736   0.00000007821291
[0m[32m -0.00218128389549   0.00791245169742  -0.00000000695545
[0m[32m  0.01793091273406  -0.00382412623975   0.00000004188643
[0m[32m  0.01343714038819  -0.00270023814474  -0.00000011940322
[0mTime for calculating XC forces components: 35.550 ms
 Cartesian force = 
  0.00060810279763  -0.00449175532379  -0.00000260354970
 -0.00177570904112  -0.00284504725294   0.00000051131384
 -0.00163116439721   0.00166562246267   0.00276939365114
 -0.00163065331258   0.00166568841987  -0.00276917875085
 -0.00086986724432   0.00335813228150  -0.00358044671390
 -0.00086989989805   0.00335782081822   0.00358080426608
 -0.00308986577866  -0.00086692630969   0.00000136753499
  0.01144405301084  -0.00400849516436   0.00000092344216
 -0.00091042940815   0.00197180219000   0.00000106226737
 -0.00127456672839   0.00019315787851  -0.00000183346112
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 0.295 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Time for printing density: 383.728 ms
The program took 436.184 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:26:54
Job ID:        2266431
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:29:36,vmem=8344K,walltime=00:07:28,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-006-2-2
---------------------------------------
