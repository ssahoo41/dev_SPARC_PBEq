---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:34
Job ID:    2266435
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:40
Job ID:    2266435
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 9.386 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 11.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 32.701 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 111.629 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.959 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.127 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.720138	    9.869280	   12.395691	
   12.397863	   13.298065	   10.022989	
   12.850691	    6.701935	   10.022989	
    6.911860	    9.607840	   10.022989	
   10.655626	   12.566369	    7.604309	
   13.088140	    8.576605	    7.604309	
    8.416647	    8.464866	    7.604309	
   10.720138	    9.869280	   10.331140	
   10.720138	   12.508738	    9.524815	
   13.005975	    8.549552	    9.524815	
    8.434300	    8.549552	    9.524815	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.210 ms
Set up communicators.

--set up spincomm took 2.267 ms

--set up kptcomm took 0.351 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.008 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.861 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.943 ms

Calculate_SplineDerivRadFun took 0.207 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.267 ms.
time spent on vectorized spline interp: 2.641 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.995 ms.
time spent on vectorized spline interp: 1.622 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.499 ms.
time spent on vectorized spline interp: 1.595 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.283 ms.

Calculating rb for all atom types took 15.913 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.920 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000459462, sum_int_rho = 25.3076304631558
PosCharge = 26.000000045946, NegCharge = -25.307630463156, scal_fac = 1.027358135476
After scaling, int_rho = 26.0000000459461, PosCharge + NegCharge - NetCharge = 4.619e-14
--Calculate Vref took 0.507 ms
--Calculate rho_guess took 2.753 ms

 integral of b = -26.0000000459462,
 int{b} + Nelectron + NetCharge = -4.595e-08,
 Esc = -70.2371543940027,
 MPI_Reduce took 2.320 ms

Calculating b & b_ref took 12.128 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.046 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.053 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.003 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.023 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.005 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.002 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.738 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594622, int_b + int_rho = 1.746e-13, checking this took 0.103 ms
2-norm of RHS = 805.3059684022624, which took 0.836 ms

iter_count = 414, r_2norm = 7.900e-04, tol*||rhs|| = 8.053e-04

Anderson update took 228.256 ms, out of which F'*F took 105.259 ms; b-Ax took 707.456 ms, out of which Lap took 635.008 ms
Solving Poisson took 1495.779 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.399 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.816 ms
Total time for convolution: 	 convolve: 5.142384 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.008 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
Total time for convolution: 	 convolve: 5.206615 
Total time for convolution: 	 convolve: 5.151437 
Total time for convolution: 	 convolve: 5.161503 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.653 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.305 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
rank = 0, XC calculation took 24533.619 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 2.219 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.226 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.564 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.134 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.684 ms
    Lanczos iter 53, eigmin  = -0.953349348, eigmax = 264.931163773, err_eigmin = 2.758e-04, err_eigmax = 9.919e-03
rank =   0, Lanczos took 121.386 ms, eigmin = -0.953349347550, eigmax = 267.580475410807

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.263563, lowerbound = -1.053349, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1772.911 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.122 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.156 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.247 ms
rank =  0, Distribute data + matrix mult took 24.541 ms
rank =  0, finding HY took 30.137 ms
rank =  0, distributing HY into block cyclic form took 19.306 ms
rank =  0, finding Y'*HY took 5.951 ms
Rank 0, Project_Hamiltonian used 79.983 ms
Total time for projection: 80.379 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.800 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.867 ms
    first calculated eigval = 2.708129242677637
    last  calculated eigval = 3.227980703394747
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.80298902271584
lambda[   5] =   2.86451608081068
lambda[   6] =   2.89108518092721
lambda[   7] =   2.92097197930721
lambda[   8] =   2.93580571411907
lambda[   9] =   2.94290300834559
lambda[  10] =   2.99967970623736
lambda[  11] =   3.00258248183963
lambda[  12] =   3.02053059295598
lambda[  13] =   3.06760379696140
lambda[  14] =   3.09188503452236
lambda[  15] =   3.10200025085192
lambda[  16] =   3.11793117531099
lambda[  17] =   3.15421452243512
lambda[  18] =   3.16813904647467
lambda[  19] =   3.19153904736599
lambda[  20] =   3.22798070339475
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.898 ms
rank =  0, subspace rotation using ScaLAPACK took 5.567 ms
rank =  0, Distributing orbital back into band + domain format took 17.689 ms
rank = 0, Subspace_Rotation used 23.269 ms

Total time for subspace rotation: 23.274 ms
rank = 0, Efermi =   3.079743496575 calculate fermi energy took 0.063 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.327981, lowerbound = -1.053349, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1731.340 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 21.575 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.155 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.756 ms
rank =  0, finding HY took 29.802 ms
rank =  0, distributing HY into block cyclic form took 17.941 ms
rank =  0, finding Y'*HY took 5.480 ms
Rank 0, Project_Hamiltonian used 79.006 ms
Total time for projection: 79.011 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.193 ms
    first calculated eigval = -0.673238854546592
    last  calculated eigval = 0.433419510218016
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.33636030784959
lambda[   5] =  -0.28023358687469
lambda[   6] =  -0.19989712726769
lambda[   7] =  -0.10722141716754
lambda[   8] =   0.00964384300792
lambda[   9] =   0.01779131380624
lambda[  10] =   0.12101128543814
lambda[  11] =   0.16950823502525
lambda[  12] =   0.24111425979784
lambda[  13] =   0.25471462942687
lambda[  14] =   0.32648817304824
lambda[  15] =   0.33752207482723
lambda[  16] =   0.35243996742459
lambda[  17] =   0.36502972191952
lambda[  18] =   0.40070895977492
lambda[  19] =   0.40732389882295
lambda[  20] =   0.43341951021802
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 5.520 ms
rank =  0, Distributing orbital back into band + domain format took 17.650 ms
rank = 0, Subspace_Rotation used 23.185 ms

Total time for subspace rotation: 23.189 ms
rank = 0, Efermi =   0.298078921425 calculate fermi energy took 0.032 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.533420, lowerbound = -1.053349, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1742.615 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.889 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.017 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 24.502 ms
rank =  0, finding HY took 29.182 ms
rank =  0, distributing HY into block cyclic form took 17.838 ms
rank =  0, finding Y'*HY took 5.464 ms
Rank 0, Project_Hamiltonian used 77.012 ms
Total time for projection: 77.017 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.197 ms
    first calculated eigval = -0.954385580835914
    last  calculated eigval = 0.138428259660166
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.65384028021582
lambda[   5] =  -0.54399659746164
lambda[   6] =  -0.52616072039347
lambda[   7] =  -0.52264294745190
lambda[   8] =  -0.47854245341945
lambda[   9] =  -0.46795442235311
lambda[  10] =  -0.39813484861493
lambda[  11] =  -0.30929698968237
lambda[  12] =  -0.30108245133416
lambda[  13] =  -0.28360034669417
lambda[  14] =   0.05574145934540
lambda[  15] =   0.09352920934703
lambda[  16] =   0.09719817344669
lambda[  17] =   0.10047306996759
lambda[  18] =   0.10515650405178
lambda[  19] =   0.13160354599032
lambda[  20] =   0.13842825966017
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 5.498 ms
rank =  0, Distributing orbital back into band + domain format took 17.518 ms
rank = 0, Subspace_Rotation used 23.028 ms

Total time for subspace rotation: 23.032 ms
rank = 0, Efermi =   0.027332208385 calculate fermi energy took 0.031 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.238428, lowerbound = -1.053349, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1742.254 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 17.795 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.080 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.901 ms
rank =  0, finding HY took 29.682 ms
rank =  0, distributing HY into block cyclic form took 18.241 ms
rank =  0, finding Y'*HY took 5.473 ms
Rank 0, Project_Hamiltonian used 75.330 ms
Total time for projection: 75.335 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.140 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -0.955389645680676
    last  calculated eigval = 0.098523684872468
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.65588436579615
lambda[   5] =  -0.54834991320102
lambda[   6] =  -0.52906155876618
lambda[   7] =  -0.52899522733692
lambda[   8] =  -0.48201216656728
lambda[   9] =  -0.48195583985102
lambda[  10] =  -0.41078808315641
lambda[  11] =  -0.32579230522680
lambda[  12] =  -0.32544487628798
lambda[  13] =  -0.30987153423301
lambda[  14] =  -0.00628916484697
lambda[  15] =   0.03462187254351
lambda[  16] =   0.03737243686568
lambda[  17] =   0.05140078181801
lambda[  18] =   0.06898793118901
lambda[  19] =   0.07300039976946
lambda[  20] =   0.09852368487247
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 5.499 ms
rank =  0, Distributing orbital back into band + domain format took 17.523 ms
rank = 0, Subspace_Rotation used 23.034 ms

Total time for subspace rotation: 24.024 ms
rank = 0, Efermi =  -0.034698415810 calculate fermi energy took 0.030 ms
rank = 0, --- Calculate rho: sum over local bands took 4.119 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.820 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.255 ms
rank = 0, Calculating density took 7526.949 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.697 ms
rank = 0, D2D took 1.595 ms
rank = 0, Transfering density took 1.599 ms
Etot    =   -41.436756825488
Eband   =   -14.579477569561
E1      =    29.927393182024
E2      =   -11.677607939696
E3      =   -15.086806242436
Exc     =   -13.311932224735
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 3.767e+00, dEband = 1.325e+00
rank = 0, Calculating/Estimating energy took 1.397 ms, Etot = -41.436756825, dEtot = 3.767e+00, dEband = 1.325e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 61.2679320594588, which took 0.142 ms

iter_count = 96, r_2norm = 1.751e-03, tol*||rhs|| = 2.451e-03

Anderson update took 51.385 ms, out of which F'*F took 24.202 ms; b-Ax took 163.477 ms, out of which Lap took 146.690 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.676 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594619, int_b + int_rho = 1.455e-13, checking this took 0.150 ms
2-norm of RHS = 800.2652769513251, which took 0.107 ms

iter_count = 282, r_2norm = 7.942e-04, tol*||rhs|| = 8.003e-04

Anderson update took 162.944 ms, out of which F'*F took 72.649 ms; b-Ax took 482.876 ms, out of which Lap took 433.374 ms
Solving Poisson took 1025.063 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.854 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.120463 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 30.282 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.127942 
Total time for convolution: 	 convolve: 5.198375 
Total time for convolution: 	 convolve: 5.167039 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.181 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.411 ms
---Transfer Veff_loc: D2D took 1.298 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.656 ms

This SCF took 33590.367 ms, scf error = 1.772e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.198524, lowerbound = -0.955390, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1707.487 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.770 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.175 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.970 ms
rank =  0, finding HY took 30.227 ms
rank =  0, distributing HY into block cyclic form took 17.753 ms
rank =  0, finding Y'*HY took 5.965 ms
Rank 0, Project_Hamiltonian used 75.945 ms
Total time for projection: 75.957 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.925389502161975
    last  calculated eigval = 0.071688213129126
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62835711750774
lambda[   5] =  -0.51983425270434
lambda[   6] =  -0.49774255468384
lambda[   7] =  -0.49770001917321
lambda[   8] =  -0.44959967700619
lambda[   9] =  -0.44955827172165
lambda[  10] =  -0.38698581025531
lambda[  11] =  -0.28584076089987
lambda[  12] =  -0.28570563578139
lambda[  13] =  -0.26875677854468
lambda[  14] =  -0.03116601029312
lambda[  15] =   0.01146637689720
lambda[  16] =   0.01522959020156
lambda[  17] =   0.02384471219413
lambda[  18] =   0.04756689073463
lambda[  19] =   0.05107243528993
lambda[  20] =   0.07168821312913
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.212 ms
rank =  0, subspace rotation using ScaLAPACK took 6.084 ms
rank =  0, Distributing orbital back into band + domain format took 18.798 ms
rank = 0, Subspace_Rotation used 24.898 ms

Total time for subspace rotation: 24.920 ms
rank = 0, Efermi =  -0.059575261277 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 4.483 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.520 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.253 ms
rank = 0, Calculating density took 1817.378 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.845 ms
rank = 0, D2D took 0.939 ms
rank = 0, Transfering density took 0.945 ms
Etot    =   -41.362964862728
Eband   =   -13.713877323338
E1      =    29.193863640692
E2      =   -11.572645868006
E3      =   -15.318087084762
Exc     =   -13.496529737501
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 6.708e-03, dEband = 7.869e-02
rank = 0, Calculating/Estimating energy took 0.956 ms, Etot = -41.362964863, dEtot = 6.708e-03, dEband = 7.869e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 24.6245120441903, which took 0.057 ms

iter_count = 102, r_2norm = 6.698e-04, tol*||rhs|| = 9.850e-04

Anderson update took 54.170 ms, out of which F'*F took 25.771 ms; b-Ax took 172.340 ms, out of which Lap took 154.618 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.203 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594609, int_b + int_rho = 5.093e-14, checking this took 0.135 ms
2-norm of RHS = 795.4946550012060, which took 0.147 ms

iter_count = 294, r_2norm = 6.496e-04, tol*||rhs|| = 7.955e-04

Anderson update took 156.877 ms, out of which F'*F took 74.214 ms; b-Ax took 499.813 ms, out of which Lap took 447.803 ms
Solving Poisson took 1052.549 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.084757 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.137943 
Total time for convolution: 	 convolve: 5.175003 
Total time for convolution: 	 convolve: 5.084421 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 351.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.873 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.258 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.612 ms

This SCF took 28112.877 ms, scf error = 1.137e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.171688, lowerbound = -0.925390, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1738.732 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.337 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.418 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 22.777 ms
rank =  0, finding HY took 30.471 ms
rank =  0, distributing HY into block cyclic form took 19.188 ms
rank =  0, finding Y'*HY took 5.739 ms
Rank 0, Project_Hamiltonian used 78.206 ms
Total time for projection: 78.221 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -0.889103824121122
    last  calculated eigval = 0.059710881683793
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.59102124632915
lambda[   5] =  -0.48487880160840
lambda[   6] =  -0.46023038495676
lambda[   7] =  -0.46020296909534
lambda[   8] =  -0.41133404144491
lambda[   9] =  -0.41128773795957
lambda[  10] =  -0.35347839821370
lambda[  11] =  -0.24155482514700
lambda[  12] =  -0.24145539562482
lambda[  13] =  -0.22227542618955
lambda[  14] =  -0.03610507535778
lambda[  15] =   0.00485631974392
lambda[  16] =   0.01075175786499
lambda[  17] =   0.01544728166311
lambda[  18] =   0.03958659296697
lambda[  19] =   0.04123750715557
lambda[  20] =   0.05971088168379
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 6.476 ms
rank =  0, Distributing orbital back into band + domain format took 18.050 ms
rank = 0, Subspace_Rotation used 24.540 ms

Total time for subspace rotation: 24.548 ms
rank = 0, Efermi =  -0.064514326329 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 4.508 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.455 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.201 ms
rank = 0, Calculating density took 1850.955 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.707 ms
rank = 0, D2D took 0.833 ms
rank = 0, Transfering density took 0.838 ms
Etot    =   -41.327035897692
Eband   =   -12.685779894892
E1      =    28.348643858295
E2      =   -11.363890920180
E3      =   -15.623524545530
Exc     =   -13.740160931455
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 3.266e-03, dEband = 9.346e-02
rank = 0, Calculating/Estimating energy took 0.944 ms, Etot = -41.327035898, dEtot = 3.266e-03, dEband = 9.346e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 4.5826280759328, which took 0.054 ms

iter_count = 108, r_2norm = 1.343e-04, tol*||rhs|| = 1.833e-04

Anderson update took 57.307 ms, out of which F'*F took 27.131 ms; b-Ax took 183.394 ms, out of which Lap took 164.353 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.165 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594617, int_b + int_rho = 1.273e-13, checking this took 0.132 ms
2-norm of RHS = 795.6475477514603, which took 0.129 ms

iter_count = 282, r_2norm = 7.034e-04, tol*||rhs|| = 7.956e-04

Anderson update took 149.140 ms, out of which F'*F took 71.054 ms; b-Ax took 479.360 ms, out of which Lap took 430.231 ms
Solving Poisson took 1007.075 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.098250 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.116409 
Total time for convolution: 	 convolve: 5.094153 
Total time for convolution: 	 convolve: 5.089464 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.846 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.362 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.156 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.419 ms
---Transfer Veff_loc: D2D took 1.286 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.636 ms

This SCF took 27705.052 ms, scf error = 5.321e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.159711, lowerbound = -0.889104, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1693.949 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.073 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.095 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 22.193 ms
rank =  0, finding HY took 28.898 ms
rank =  0, distributing HY into block cyclic form took 17.747 ms
rank =  0, finding Y'*HY took 5.533 ms
Rank 0, Project_Hamiltonian used 74.401 ms
Total time for projection: 74.416 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.668 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.744 ms
    first calculated eigval = -0.874309589741093
    last  calculated eigval = 0.053486973807354
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57107817036410
lambda[   5] =  -0.46944457022890
lambda[   6] =  -0.44533941615411
lambda[   7] =  -0.44531263406947
lambda[   8] =  -0.39698211632508
lambda[   9] =  -0.39693153225338
lambda[  10] =  -0.33370120295925
lambda[  11] =  -0.22965277306532
lambda[  12] =  -0.22960115687430
lambda[  13] =  -0.20951430672723
lambda[  14] =  -0.03640970854317
lambda[  15] =   0.00364656754598
lambda[  16] =   0.00915851137637
lambda[  17] =   0.01370004103064
lambda[  18] =   0.03268280177330
lambda[  19] =   0.03720413874899
lambda[  20] =   0.05348697380735
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 1.173 ms
rank =  0, subspace rotation using ScaLAPACK took 6.571 ms
rank =  0, Distributing orbital back into band + domain format took 18.140 ms
rank = 0, Subspace_Rotation used 24.723 ms

Total time for subspace rotation: 24.729 ms
rank = 0, Efermi =  -0.064818959528 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 4.351 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.009 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.340 ms
rank = 0, Calculating density took 1803.083 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.910 ms
rank = 0, D2D took 1.038 ms
rank = 0, Transfering density took 1.044 ms
Etot    =   -41.320510575346
Eband   =   -12.302415524146
E1      =    28.108592452117
E2      =   -11.198382679508
E3      =   -15.753258057603
Exc     =   -13.841173845079
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 5.932e-04, dEband = 3.485e-02
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -41.320510575, dEtot = 5.932e-04, dEband = 3.485e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.1905213390997, which took 0.105 ms

iter_count = 108, r_2norm = 8.010e-05, tol*||rhs|| = 8.762e-05

Anderson update took 56.790 ms, out of which F'*F took 26.999 ms; b-Ax took 184.328 ms, out of which Lap took 164.693 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.383 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594605, int_b + int_rho = 3.638e-15, checking this took 0.154 ms
2-norm of RHS = 795.7041798484759, which took 0.156 ms

iter_count = 252, r_2norm = 7.809e-04, tol*||rhs|| = 7.957e-04

Anderson update took 133.494 ms, out of which F'*F took 63.190 ms; b-Ax took 428.383 ms, out of which Lap took 383.639 ms
Solving Poisson took 903.459 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.085590 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.478 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.894 ms
Total time for convolution: 	 convolve: 5.085965 
Total time for convolution: 	 convolve: 5.083955 
Total time for convolution: 	 convolve: 5.082524 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.310 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.163 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.505 ms

This SCF took 27570.850 ms, scf error = 1.160e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.153487, lowerbound = -0.874310, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1695.426 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.993 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.120 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 22.143 ms
rank =  0, finding HY took 28.831 ms
rank =  0, distributing HY into block cyclic form took 17.870 ms
rank =  0, finding Y'*HY took 5.470 ms
Rank 0, Project_Hamiltonian used 74.346 ms
Total time for projection: 74.360 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.156 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.213 ms
    first calculated eigval = -0.868786659947643
    last  calculated eigval = 0.047943815106688
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56587302352433
lambda[   5] =  -0.46397672501763
lambda[   6] =  -0.43971453958425
lambda[   7] =  -0.43967526056187
lambda[   8] =  -0.39135885649825
lambda[   9] =  -0.39130509500288
lambda[  10] =  -0.32869434235313
lambda[  11] =  -0.22357494568726
lambda[  12] =  -0.22348300090463
lambda[  13] =  -0.20318952663719
lambda[  14] =  -0.03668335102218
lambda[  15] =   0.00276662381542
lambda[  16] =   0.00814545197342
lambda[  17] =   0.01239328674962
lambda[  18] =   0.02794982832841
lambda[  19] =   0.03331968883681
lambda[  20] =   0.04794381510669
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 6.536 ms
rank =  0, Distributing orbital back into band + domain format took 18.012 ms
rank = 0, Subspace_Rotation used 24.559 ms

Total time for subspace rotation: 24.564 ms
rank = 0, Efermi =  -0.065092601998 calculate fermi energy took 2.636 ms
rank = 0, --- Calculate rho: sum over local bands took 4.611 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.167 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.216 ms
rank = 0, Calculating density took 1804.281 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.846 ms
rank = 0, D2D took 0.971 ms
rank = 0, Transfering density took 0.977 ms
Etot    =   -41.319860215906
Eband   =   -12.152900119966
E1      =    28.019362060453
E2      =   -11.128622996357
E3      =   -15.794913315484
Exc     =   -13.872704072885
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 5.912e-05, dEband = 1.359e-02
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -41.319860216, dEtot = 5.912e-05, dEband = 1.359e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7999053856519, which took 0.071 ms

iter_count = 114, r_2norm = 2.038e-05, tol*||rhs|| = 3.200e-05

Anderson update took 60.280 ms, out of which F'*F took 28.141 ms; b-Ax took 192.451 ms, out of which Lap took 172.227 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.511 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594617, int_b + int_rho = 1.237e-13, checking this took 0.124 ms
2-norm of RHS = 796.1387028754947, which took 0.162 ms

iter_count = 246, r_2norm = 6.447e-04, tol*||rhs|| = 7.961e-04

Anderson update took 130.796 ms, out of which F'*F took 62.355 ms; b-Ax took 419.831 ms, out of which Lap took 376.384 ms
Solving Poisson took 882.939 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.075 ms
Total time for convolution: 	 convolve: 5.075713 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.524 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 6.515218 
Total time for convolution: 	 convolve: 5.076911 
Total time for convolution: 	 convolve: 5.077629 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.572 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.582 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 1.452 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.703 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.186 ms

This SCF took 29292.706 ms, scf error = 7.067e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.147944, lowerbound = -0.868787, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1693.125 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.912 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.187 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.125 ms
rank =  0, finding HY took 28.718 ms
rank =  0, distributing HY into block cyclic form took 17.853 ms
rank =  0, finding Y'*HY took 5.486 ms
Rank 0, Project_Hamiltonian used 74.214 ms
Total time for projection: 74.228 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -0.867318183837144
    last  calculated eigval = 0.042590326896042
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56503404016750
lambda[   5] =  -0.46264560692746
lambda[   6] =  -0.43843962686427
lambda[   7] =  -0.43838798830106
lambda[   8] =  -0.39011002177588
lambda[   9] =  -0.39005318656188
lambda[  10] =  -0.32773116599445
lambda[  11] =  -0.22227753293991
lambda[  12] =  -0.22214826263039
lambda[  13] =  -0.20197392588952
lambda[  14] =  -0.03656414442563
lambda[  15] =   0.00244519344791
lambda[  16] =   0.00778723742728
lambda[  17] =   0.01160592689477
lambda[  18] =   0.02508233558200
lambda[  19] =   0.03069136246263
lambda[  20] =   0.04259032689604
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 6.557 ms
rank =  0, Distributing orbital back into band + domain format took 18.083 ms
rank = 0, Subspace_Rotation used 24.652 ms

Total time for subspace rotation: 24.657 ms
rank = 0, Efermi =  -0.064973395390 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 4.952 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.199 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.249 ms
rank = 0, Calculating density took 1800.732 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.815 ms
rank = 0, D2D took 0.928 ms
rank = 0, Transfering density took 0.935 ms
Etot    =   -41.319719211883
Eband   =   -12.120341052402
E1      =    28.022490596228
E2      =   -11.091942566699
E3      =   -15.793590038007
Exc     =   -13.870246965065
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 1.282e-05, dEband = 2.960e-03
rank = 0, Calculating/Estimating energy took 0.913 ms, Etot = -41.319719212, dEtot = 1.282e-05, dEband = 2.960e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4076373454674, which took 0.065 ms

iter_count = 114, r_2norm = 9.813e-06, tol*||rhs|| = 1.631e-05

Anderson update took 60.344 ms, out of which F'*F took 28.467 ms; b-Ax took 192.790 ms, out of which Lap took 172.786 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.028 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594610, int_b + int_rho = 5.821e-14, checking this took 0.119 ms
2-norm of RHS = 796.2323782410889, which took 0.128 ms

iter_count = 246, r_2norm = 6.883e-04, tol*||rhs|| = 7.962e-04

Anderson update took 129.854 ms, out of which F'*F took 61.446 ms; b-Ax took 416.161 ms, out of which Lap took 374.178 ms
Solving Poisson took 882.489 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.321 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.074978 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 56.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.075930 
Total time for convolution: 	 convolve: 5.080447 
Total time for convolution: 	 convolve: 5.079160 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.592 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.156 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.025 ms
---Transfer Veff_loc: D2D took 2.239 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.713 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.981 ms

This SCF took 27504.675 ms, scf error = 3.200e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.142590, lowerbound = -0.867318, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1706.459 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.839 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.102 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.965 ms
rank =  0, finding HY took 28.879 ms
rank =  0, distributing HY into block cyclic form took 17.801 ms
rank =  0, finding Y'*HY took 5.388 ms
Rank 0, Project_Hamiltonian used 74.062 ms
Total time for projection: 74.073 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.168 ms
    first calculated eigval = -0.863107638721446
    last  calculated eigval = 0.038324387891246
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56102997396761
lambda[   5] =  -0.45885490414527
lambda[   6] =  -0.43460748193030
lambda[   7] =  -0.43454021236525
lambda[   8] =  -0.38628530003209
lambda[   9] =  -0.38622381660608
lambda[  10] =  -0.32400236270626
lambda[  11] =  -0.21830138339965
lambda[  12] =  -0.21812429585698
lambda[  13] =  -0.19797331911541
lambda[  14] =  -0.03578492157753
lambda[  15] =   0.00314199398581
lambda[  16] =   0.00867440725043
lambda[  17] =   0.01206136834714
lambda[  18] =   0.02389078901855
lambda[  19] =   0.02936105823797
lambda[  20] =   0.03832438789125
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 6.524 ms
rank =  0, Distributing orbital back into band + domain format took 18.127 ms
rank = 0, Subspace_Rotation used 24.664 ms

Total time for subspace rotation: 24.669 ms
rank = 0, Efermi =  -0.064194172561 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.400 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.622 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.231 ms
rank = 0, Calculating density took 1813.770 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.823 ms
rank = 0, D2D took 0.929 ms
rank = 0, Transfering density took 0.932 ms
Etot    =   -41.319572196549
Eband   =   -12.018529677422
E1      =    27.970785712216
E2      =   -11.037954923642
E3      =   -15.807885082630
Exc     =   -13.880513842267
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 1.337e-05, dEband = 9.256e-03
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -41.319572197, dEtot = 1.337e-05, dEband = 9.256e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2751742107556, which took 0.051 ms

iter_count = 114, r_2norm = 7.277e-06, tol*||rhs|| = 1.101e-05

Anderson update took 60.768 ms, out of which F'*F took 28.399 ms; b-Ax took 192.159 ms, out of which Lap took 172.005 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.627 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594610, int_b + int_rho = 6.185e-14, checking this took 0.104 ms
2-norm of RHS = 796.2494477202411, which took 0.120 ms

iter_count = 216, r_2norm = 6.456e-04, tol*||rhs|| = 7.962e-04

Anderson update took 114.601 ms, out of which F'*F took 53.688 ms; b-Ax took 364.536 ms, out of which Lap took 327.674 ms
Solving Poisson took 774.792 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.137 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.141845 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 95.677 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.081711 
Total time for convolution: 	 convolve: 5.100613 
Total time for convolution: 	 convolve: 5.108427 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.024 ms
======D2D: initiated sending and receiving took 1.213 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 1.457 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.701 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.188 ms

This SCF took 27584.020 ms, scf error = 1.572e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.138324, lowerbound = -0.863108, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1715.733 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.971 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.122 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.115 ms
rank =  0, finding HY took 28.775 ms
rank =  0, distributing HY into block cyclic form took 17.650 ms
rank =  0, finding Y'*HY took 6.125 ms
Rank 0, Project_Hamiltonian used 74.704 ms
Total time for projection: 74.716 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.862386074838205
    last  calculated eigval = 0.034892543491562
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56038000346012
lambda[   5] =  -0.45812746910168
lambda[   6] =  -0.43388260662211
lambda[   7] =  -0.43381255795556
lambda[   8] =  -0.38556218815920
lambda[   9] =  -0.38549657186858
lambda[  10] =  -0.32336079331652
lambda[  11] =  -0.21749318419285
lambda[  12] =  -0.21730687407106
lambda[  13] =  -0.19715961178737
lambda[  14] =  -0.03530673961303
lambda[  15] =   0.00378883237271
lambda[  16] =   0.00935377582877
lambda[  17] =   0.01226378817660
lambda[  18] =   0.02343635861078
lambda[  19] =   0.02744627491739
lambda[  20] =   0.03489254349156
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 6.545 ms
rank =  0, Distributing orbital back into band + domain format took 18.098 ms
rank = 0, Subspace_Rotation used 24.655 ms

Total time for subspace rotation: 24.661 ms
rank = 0, Efermi =  -0.063715990577 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 4.493 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.504 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.233 ms
rank = 0, Calculating density took 1823.665 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.854 ms
rank = 0, D2D took 0.968 ms
rank = 0, Transfering density took 0.970 ms
Etot    =   -41.319685945799
Eband   =   -11.999325761616
E1      =    27.963665371492
E2      =   -11.025773369971
E3      =   -15.807080933568
Exc     =   -13.879725463865
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 1.034e-05, dEband = 1.746e-03
rank = 0, Calculating/Estimating energy took 1.808 ms, Etot = -41.319685946, dEtot = 1.034e-05, dEband = 1.746e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1400571269046, which took 0.056 ms

iter_count = 114, r_2norm = 3.771e-06, tol*||rhs|| = 5.602e-06

Anderson update took 60.738 ms, out of which F'*F took 28.438 ms; b-Ax took 192.856 ms, out of which Lap took 172.287 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.422 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594611, int_b + int_rho = 6.548e-14, checking this took 0.102 ms
2-norm of RHS = 796.2189669815776, which took 0.102 ms

iter_count = 222, r_2norm = 6.796e-04, tol*||rhs|| = 7.962e-04

Anderson update took 117.962 ms, out of which F'*F took 55.454 ms; b-Ax took 373.899 ms, out of which Lap took 336.338 ms
Solving Poisson took 795.774 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.126 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.078607 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.247 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.125628 
Total time for convolution: 	 convolve: 5.082335 
Total time for convolution: 	 convolve: 5.082292 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 1.458 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.694 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.182 ms

This SCF took 27405.965 ms, scf error = 1.145e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.134893, lowerbound = -0.862386, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1718.557 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.971 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.146 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.142 ms
rank =  0, finding HY took 28.836 ms
rank =  0, distributing HY into block cyclic form took 17.840 ms
rank =  0, finding Y'*HY took 5.372 ms
Rank 0, Project_Hamiltonian used 74.219 ms
Total time for projection: 74.230 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -0.860970479450384
    last  calculated eigval = 0.034556927654081
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55882918628805
lambda[   5] =  -0.45665394170281
lambda[   6] =  -0.43243368990696
lambda[   7] =  -0.43235903382437
lambda[   8] =  -0.38412826509960
lambda[   9] =  -0.38405696303807
lambda[  10] =  -0.32181413685057
lambda[  11] =  -0.21605048523376
lambda[  12] =  -0.21584365708497
lambda[  13] =  -0.19566950788779
lambda[  14] =  -0.03338679436871
lambda[  15] =   0.00646159745351
lambda[  16] =   0.01232090395170
lambda[  17] =   0.01470518867780
lambda[  18] =   0.02436402037790
lambda[  19] =   0.02663439224542
lambda[  20] =   0.03455692765408
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 6.513 ms
rank =  0, Distributing orbital back into band + domain format took 18.094 ms
rank = 0, Subspace_Rotation used 24.619 ms

Total time for subspace rotation: 24.623 ms
rank = 0, Efermi =  -0.061796045345 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.400 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.574 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.224 ms
rank = 0, Calculating density took 1825.926 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.242 ms
rank = 0, D2D took 2.344 ms
rank = 0, Transfering density took 2.348 ms
Etot    =   -41.319747809160
Eband   =   -11.961281788481
E1      =    27.944617959174
E2      =   -11.006118473082
E3      =   -15.809766622604
Exc     =   -13.881814680191
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 5.624e-06, dEband = 3.459e-03
rank = 0, Calculating/Estimating energy took 1.030 ms, Etot = -41.319747809, dEtot = 5.624e-06, dEband = 3.459e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0828020891444, which took 0.113 ms

iter_count = 114, r_2norm = 2.222e-06, tol*||rhs|| = 3.312e-06

Anderson update took 60.606 ms, out of which F'*F took 28.416 ms; b-Ax took 192.179 ms, out of which Lap took 171.868 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.745 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594614, int_b + int_rho = 9.459e-14, checking this took 0.104 ms
2-norm of RHS = 796.2180529996922, which took 0.125 ms

iter_count = 204, r_2norm = 6.399e-04, tol*||rhs|| = 7.962e-04

Anderson update took 108.253 ms, out of which F'*F took 50.351 ms; b-Ax took 344.247 ms, out of which Lap took 309.308 ms
Solving Poisson took 731.966 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.079804 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.079950 
Total time for convolution: 	 convolve: 5.084575 
Total time for convolution: 	 convolve: 5.090295 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.145 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 1.441 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.709 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.185 ms

This SCF took 27303.884 ms, scf error = 6.345e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.134557, lowerbound = -0.860970, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1706.980 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.920 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.122 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.064 ms
rank =  0, finding HY took 28.897 ms
rank =  0, distributing HY into block cyclic form took 17.878 ms
rank =  0, finding Y'*HY took 5.297 ms
Rank 0, Project_Hamiltonian used 74.167 ms
Total time for projection: 74.179 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.859820128087414
    last  calculated eigval = 0.034973754131223
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55780988892264
lambda[   5] =  -0.45559541965566
lambda[   6] =  -0.43137570728281
lambda[   7] =  -0.43129625107394
lambda[   8] =  -0.38305996229712
lambda[   9] =  -0.38298650115397
lambda[  10] =  -0.32080248473329
lambda[  11] =  -0.21501237594736
lambda[  12] =  -0.21478673224781
lambda[  13] =  -0.19463094251682
lambda[  14] =  -0.03106780141135
lambda[  15] =   0.00926519126093
lambda[  16] =   0.01550176569175
lambda[  17] =   0.01685139350493
lambda[  18] =   0.02503140458549
lambda[  19] =   0.02669274685283
lambda[  20] =   0.03497375413122
==subpsace eigenproblem: bcast eigvals took 0.068 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 6.489 ms
rank =  0, Distributing orbital back into band + domain format took 18.067 ms
rank = 0, Subspace_Rotation used 24.568 ms

Total time for subspace rotation: 24.573 ms
rank = 0, Efermi =  -0.059477052380 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 4.374 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.158 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.238 ms
rank = 0, Calculating density took 1814.345 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.845 ms
rank = 0, D2D took 0.963 ms
rank = 0, Transfering density took 0.967 ms
Etot    =   -41.319814178825
Eband   =   -11.933580820358
E1      =    27.930322455179
E2      =   -10.992319221042
E3      =   -15.811510725302
Exc     =   -13.883231364642
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 6.034e-06, dEband = 2.518e-03
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -41.319814179, dEtot = 6.034e-06, dEband = 2.518e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0725564059102, which took 0.090 ms

iter_count = 108, r_2norm = 2.371e-06, tol*||rhs|| = 2.902e-06

Anderson update took 57.430 ms, out of which F'*F took 26.843 ms; b-Ax took 182.583 ms, out of which Lap took 163.039 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.089 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594608, int_b + int_rho = 4.002e-14, checking this took 0.112 ms
2-norm of RHS = 796.2369077422675, which took 0.118 ms

iter_count = 180, r_2norm = 6.538e-04, tol*||rhs|| = 7.962e-04

Anderson update took 95.805 ms, out of which F'*F took 44.708 ms; b-Ax took 303.340 ms, out of which Lap took 273.002 ms
Solving Poisson took 646.077 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.138 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.076903 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.077115 
Total time for convolution: 	 convolve: 5.087894 
Total time for convolution: 	 convolve: 5.078222 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.172 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.443 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.714 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.189 ms

This SCF took 27164.520 ms, scf error = 4.255e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.134974, lowerbound = -0.859820, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1708.606 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.785 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.181 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.993 ms
rank =  0, finding HY took 28.972 ms
rank =  0, distributing HY into block cyclic form took 17.757 ms
rank =  0, finding Y'*HY took 5.439 ms
Rank 0, Project_Hamiltonian used 74.188 ms
Total time for projection: 74.201 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.859460941097921
    last  calculated eigval = 0.035017665625789
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55741902057012
lambda[   5] =  -0.45522306382254
lambda[   6] =  -0.43102546961693
lambda[   7] =  -0.43094334572912
lambda[   8] =  -0.38271536728198
lambda[   9] =  -0.38263856463203
lambda[  10] =  -0.32038958889322
lambda[  11] =  -0.21472677639993
lambda[  12] =  -0.21449589510471
lambda[  13] =  -0.19433846073264
lambda[  14] =  -0.02947610184444
lambda[  15] =   0.01084286189650
lambda[  16] =   0.01692713582471
lambda[  17] =   0.01815226949216
lambda[  18] =   0.02510041864526
lambda[  19] =   0.02715863200322
lambda[  20] =   0.03501766562579
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 7.034 ms
rank =  0, Distributing orbital back into band + domain format took 17.912 ms
rank = 0, Subspace_Rotation used 24.962 ms

Total time for subspace rotation: 24.971 ms
rank = 0, Efermi =  -0.057885352805 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 4.458 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.707 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.170 ms
rank = 0, Calculating density took 1817.286 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.674 ms
rank = 0, D2D took 0.776 ms
rank = 0, Transfering density took 0.781 ms
Etot    =   -41.319872762113
Eband   =   -11.924679457250
E1      =    27.926792403864
E2      =   -10.986899519549
E3      =   -15.811604876362
Exc     =   -13.883335709290
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 5.326e-06, dEband = 8.092e-04
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -41.319872762, dEtot = 5.326e-06, dEband = 8.092e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0457406339013, which took 0.115 ms

iter_count = 108, r_2norm = 1.545e-06, tol*||rhs|| = 1.830e-06

Anderson update took 57.737 ms, out of which F'*F took 26.767 ms; b-Ax took 181.810 ms, out of which Lap took 162.890 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.116 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594621, int_b + int_rho = 1.637e-13, checking this took 0.121 ms
2-norm of RHS = 796.2475540474427, which took 0.120 ms

iter_count = 174, r_2norm = 6.715e-04, tol*||rhs|| = 7.962e-04

Anderson update took 92.240 ms, out of which F'*F took 43.270 ms; b-Ax took 293.470 ms, out of which Lap took 264.089 ms
Solving Poisson took 624.645 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.140 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.080667 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.096806 
Total time for convolution: 	 convolve: 5.080306 
Total time for convolution: 	 convolve: 5.082435 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.705 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 1.451 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.697 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.180 ms

This SCF took 27189.392 ms, scf error = 3.232e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.135018, lowerbound = -0.859461, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1708.959 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 26.855 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.201 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 31.084 ms
rank =  0, finding HY took 28.955 ms
rank =  0, distributing HY into block cyclic form took 17.773 ms
rank =  0, finding Y'*HY took 5.453 ms
Rank 0, Project_Hamiltonian used 83.295 ms
Total time for projection: 83.310 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.164 ms
    first calculated eigval = -0.859020532014259
    last  calculated eigval = 0.035448725550647
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55696531413682
lambda[   5] =  -0.45476889917674
lambda[   6] =  -0.43057871927871
lambda[   7] =  -0.43049342461704
lambda[   8] =  -0.38226851754275
lambda[   9] =  -0.38218774032891
lambda[  10] =  -0.31994836933604
lambda[  11] =  -0.21427137245742
lambda[  12] =  -0.21403660070279
lambda[  13] =  -0.19386881592225
lambda[  14] =  -0.02758878201348
lambda[  15] =   0.01160121713746
lambda[  16] =   0.01829322590335
lambda[  17] =   0.01960697882783
lambda[  18] =   0.02550628642061
lambda[  19] =   0.02929503316233
lambda[  20] =   0.03544872555065
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 6.524 ms
rank =  0, Distributing orbital back into band + domain format took 18.329 ms
rank = 0, Subspace_Rotation used 24.867 ms

Total time for subspace rotation: 24.874 ms
rank = 0, Efermi =  -0.055998033002 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 4.522 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.581 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.175 ms
rank = 0, Calculating density took 1826.640 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.679 ms
rank = 0, D2D took 0.780 ms
rank = 0, Transfering density took 0.786 ms
Etot    =   -41.319955655434
Eband   =   -11.912924365862
E1      =    27.921073330348
E2      =   -10.980640307563
E3      =   -15.812355911311
Exc     =   -13.883946443445
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 7.536e-06, dEband = 1.069e-03
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -41.319955655, dEtot = 7.536e-06, dEband = 1.069e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0419693444328, which took 0.058 ms

iter_count = 108, r_2norm = 1.428e-06, tol*||rhs|| = 1.679e-06

Anderson update took 57.182 ms, out of which F'*F took 26.695 ms; b-Ax took 182.729 ms, out of which Lap took 163.350 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.640 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594621, int_b + int_rho = 1.673e-13, checking this took 0.129 ms
2-norm of RHS = 796.2436098882708, which took 0.122 ms

iter_count = 138, r_2norm = 6.845e-04, tol*||rhs|| = 7.962e-04

Anderson update took 73.428 ms, out of which F'*F took 34.319 ms; b-Ax took 232.930 ms, out of which Lap took 209.581 ms
Solving Poisson took 496.375 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.083143 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.574 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.094950 
Total time for convolution: 	 convolve: 5.210561 
Total time for convolution: 	 convolve: 5.088784 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.334 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.435 ms
---Transfer Veff_loc: D2D took 1.460 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.689 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.182 ms

This SCF took 27196.656 ms, scf error = 2.090e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.135449, lowerbound = -0.859021, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1702.370 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.124 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.958 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.108 ms
rank =  0, finding HY took 28.880 ms
rank =  0, distributing HY into block cyclic form took 17.858 ms
rank =  0, finding Y'*HY took 5.410 ms
Rank 0, Project_Hamiltonian used 74.287 ms
Total time for projection: 74.299 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 1.004 ms
    first calculated eigval = -0.858822185386702
    last  calculated eigval = 0.035204783178567
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55677619700584
lambda[   5] =  -0.45458456062988
lambda[   6] =  -0.43039045745207
lambda[   7] =  -0.43030519092203
lambda[   8] =  -0.38207893928758
lambda[   9] =  -0.38199861386624
lambda[  10] =  -0.31977135949276
lambda[  11] =  -0.21407831188543
lambda[  12] =  -0.21384212082642
lambda[  13] =  -0.19367131277877
lambda[  14] =  -0.02695122893980
lambda[  15] =   0.01164087126890
lambda[  16] =   0.01852336952127
lambda[  17] =   0.01993907819434
lambda[  18] =   0.02585011881284
lambda[  19] =   0.02993856929074
lambda[  20] =   0.03520478317857
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 1.028 ms
rank =  0, subspace rotation using ScaLAPACK took 6.493 ms
rank =  0, Distributing orbital back into band + domain format took 18.686 ms
rank = 0, Subspace_Rotation used 25.194 ms

Total time for subspace rotation: 25.201 ms
rank = 0, Efermi =  -0.055360479909 calculate fermi energy took 0.085 ms
rank = 0, --- Calculate rho: sum over local bands took 4.421 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.475 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.249 ms
rank = 0, Calculating density took 1811.202 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.859 ms
rank = 0, D2D took 0.978 ms
rank = 0, Transfering density took 0.984 ms
Etot    =   -41.319975307374
Eband   =   -11.907956998552
E1      =    27.918157939192
E2      =   -10.978429408239
E3      =   -15.813003604199
Exc     =   -13.884454865104
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 1.787e-06, dEband = 4.516e-04
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -41.319975307, dEtot = 1.787e-06, dEband = 4.516e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0226469013614, which took 0.118 ms

iter_count = 108, r_2norm = 8.852e-07, tol*||rhs|| = 9.059e-07

Anderson update took 57.668 ms, out of which F'*F took 26.673 ms; b-Ax took 182.171 ms, out of which Lap took 163.063 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.477 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594614, int_b + int_rho = 1.019e-13, checking this took 0.132 ms
2-norm of RHS = 796.2457129541622, which took 0.123 ms

iter_count = 138, r_2norm = 7.813e-04, tol*||rhs|| = 7.962e-04

Anderson update took 73.243 ms, out of which F'*F took 34.369 ms; b-Ax took 233.287 ms, out of which Lap took 209.912 ms
Solving Poisson took 496.378 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.078992 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.078518 
Total time for convolution: 	 convolve: 5.081818 
Total time for convolution: 	 convolve: 5.101215 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.599 ms
---Transfer Veff_loc: D2D took 1.476 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.736 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.243 ms

This SCF took 27037.431 ms, scf error = 1.334e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135205, lowerbound = -0.858822, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1712.932 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.913 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.116 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.054 ms
rank =  0, finding HY took 28.642 ms
rank =  0, distributing HY into block cyclic form took 18.196 ms
rank =  0, finding Y'*HY took 5.381 ms
Rank 0, Project_Hamiltonian used 74.317 ms
Total time for projection: 74.329 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.858708314972674
    last  calculated eigval = 0.035100912717887
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55665791706108
lambda[   5] =  -0.45446647158509
lambda[   6] =  -0.43027524693709
lambda[   7] =  -0.43019041490943
lambda[   8] =  -0.38196641877113
lambda[   9] =  -0.38188692977933
lambda[  10] =  -0.31964929055640
lambda[  11] =  -0.21398606804131
lambda[  12] =  -0.21374705262869
lambda[  13] =  -0.19357754211355
lambda[  14] =  -0.02665346824018
lambda[  15] =   0.01116908312753
lambda[  16] =   0.01836103488466
lambda[  17] =   0.01990341504244
lambda[  18] =   0.02690186124885
lambda[  19] =   0.03187665988608
lambda[  20] =   0.03510091271789
==subpsace eigenproblem: bcast eigvals took 0.059 ms
Total time for solving subspace eigenvalue problem: 0.236 ms
rank =  0, subspace rotation using ScaLAPACK took 6.517 ms
rank =  0, Distributing orbital back into band + domain format took 18.024 ms
rank = 0, Subspace_Rotation used 24.555 ms

Total time for subspace rotation: 24.560 ms
rank = 0, Efermi =  -0.055062719199 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 4.383 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.542 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.259 ms
rank = 0, Calculating density took 1820.354 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.843 ms
rank = 0, D2D took 0.968 ms
rank = 0, Transfering density took 0.972 ms
Etot    =   -41.320005951400
Eband   =   -11.905105167894
E1      =    27.917061326180
E2      =   -10.976673150465
E3      =   -15.812834124760
Exc     =   -13.884314989563
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 2.786e-06, dEband = 2.593e-04
rank = 0, Calculating/Estimating energy took 0.973 ms, Etot = -41.320005951, dEtot = 2.786e-06, dEband = 2.593e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0213513935844, which took 0.082 ms

iter_count = 108, r_2norm = 7.048e-07, tol*||rhs|| = 8.541e-07

Anderson update took 57.371 ms, out of which F'*F took 26.702 ms; b-Ax took 182.513 ms, out of which Lap took 162.854 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.072 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594611, int_b + int_rho = 6.548e-14, checking this took 0.116 ms
2-norm of RHS = 796.2445852460314, which took 0.097 ms

iter_count = 120, r_2norm = 7.075e-04, tol*||rhs|| = 7.962e-04

Anderson update took 63.820 ms, out of which F'*F took 29.882 ms; b-Ax took 202.185 ms, out of which Lap took 181.991 ms
Solving Poisson took 431.878 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.084226 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.266 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.079211 
Total time for convolution: 	 convolve: 5.084310 
Total time for convolution: 	 convolve: 5.087055 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.441 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.701 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.172 ms

This SCF took 26993.450 ms, scf error = 1.196e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.135101, lowerbound = -0.858708, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1701.576 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.959 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.162 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 22.145 ms
rank =  0, finding HY took 28.869 ms
rank =  0, distributing HY into block cyclic form took 17.798 ms
rank =  0, finding Y'*HY took 5.391 ms
Rank 0, Project_Hamiltonian used 74.230 ms
Total time for projection: 74.245 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -0.858686864711774
    last  calculated eigval = 0.035219736714974
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55663075165103
lambda[   5] =  -0.45443967792688
lambda[   6] =  -0.43024837770335
lambda[   7] =  -0.43016358252833
lambda[   8] =  -0.38194027949527
lambda[   9] =  -0.38186078150233
lambda[  10] =  -0.31962268124740
lambda[  11] =  -0.21395937610272
lambda[  12] =  -0.21371975507552
lambda[  13] =  -0.19354919603249
lambda[  14] =  -0.02657351647154
lambda[  15] =   0.01087966906263
lambda[  16] =   0.01824658039643
lambda[  17] =   0.01987366719638
lambda[  18] =   0.02794861364852
lambda[  19] =   0.03280001229006
lambda[  20] =   0.03521973671497
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 6.521 ms
rank =  0, Distributing orbital back into band + domain format took 18.083 ms
rank = 0, Subspace_Rotation used 24.616 ms

Total time for subspace rotation: 24.620 ms
rank = 0, Efermi =  -0.054982767433 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.341 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.556 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.243 ms
rank = 0, Calculating density took 1809.299 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.860 ms
rank = 0, D2D took 0.963 ms
rank = 0, Transfering density took 0.966 ms
Etot    =   -41.320011944907
Eband   =   -11.904418203260
E1      =    27.916726988616
E2      =   -10.976316629451
E3      =   -15.812827862568
Exc     =   -13.884310826933
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 5.449e-07, dEband = 6.245e-05
rank = 0, Calculating/Estimating energy took 0.939 ms, Etot = -41.320011945, dEtot = 5.449e-07, dEband = 6.245e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0218055647449, which took 0.053 ms

iter_count = 108, r_2norm = 7.015e-07, tol*||rhs|| = 8.722e-07

Anderson update took 57.481 ms, out of which F'*F took 26.942 ms; b-Ax took 182.316 ms, out of which Lap took 163.189 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.287 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594619, int_b + int_rho = 1.528e-13, checking this took 0.109 ms
2-norm of RHS = 796.2441920468767, which took 0.118 ms

iter_count = 78, r_2norm = 6.951e-04, tol*||rhs|| = 7.962e-04

Anderson update took 41.382 ms, out of which F'*F took 19.258 ms; b-Ax took 131.646 ms, out of which Lap took 118.501 ms
Solving Poisson took 282.029 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.078821 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.079397 
Total time for convolution: 	 convolve: 5.080930 
Total time for convolution: 	 convolve: 5.083355 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.617 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
---Transfer Veff_loc: D2D took 1.457 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.237 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.130 ms

This SCF took 26804.007 ms, scf error = 1.047e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.135220, lowerbound = -0.858687, upperbound = 267.580475

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1710.165 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.964 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.082 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 22.072 ms
rank =  0, finding HY took 28.831 ms
rank =  0, distributing HY into block cyclic form took 17.788 ms
rank =  0, finding Y'*HY took 5.427 ms
Rank 0, Project_Hamiltonian used 74.147 ms
Total time for projection: 74.159 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.858658132141761
    last  calculated eigval = 0.035339975677608
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55660253980935
lambda[   5] =  -0.45441187499741
lambda[   6] =  -0.43022056438596
lambda[   7] =  -0.43013577403157
lambda[   8] =  -0.38191229638259
lambda[   9] =  -0.38183268404818
lambda[  10] =  -0.31959517534155
lambda[  11] =  -0.21393152583165
lambda[  12] =  -0.21369226869330
lambda[  13] =  -0.19352134453575
lambda[  14] =  -0.02642806733833
lambda[  15] =   0.01094766010902
lambda[  16] =   0.01834759397058
lambda[  17] =   0.01996234007340
lambda[  18] =   0.02834098554658
lambda[  19] =   0.03315873186664
lambda[  20] =   0.03533997567761
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 0.228 ms
rank =  0, subspace rotation using ScaLAPACK took 6.531 ms
rank =  0, Distributing orbital back into band + domain format took 18.110 ms
rank = 0, Subspace_Rotation used 24.653 ms

Total time for subspace rotation: 24.658 ms
rank = 0, Efermi =  -0.054837318324 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.418 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.538 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.276 ms
rank = 0, Calculating density took 1817.549 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.903 ms
rank = 0, D2D took 1.017 ms
rank = 0, Transfering density took 1.020 ms
Etot    =   -41.320012563692
Eband   =   -11.903688855005
E1      =    27.916319562939
E2      =   -10.975980228353
E3      =   -15.812899218118
Exc     =   -13.884368322748
Esc     =   -70.237154394003
Entropy =    -0.000000001346
dE = 5.625e-08, dEband = 6.630e-05
rank = 0, Calculating/Estimating energy took 0.970 ms, Etot = -41.320012564, dEtot = 5.625e-08, dEband = 6.630e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0174524219688, which took 0.087 ms

iter_count = 108, r_2norm = 6.030e-07, tol*||rhs|| = 6.981e-07

Anderson update took 57.396 ms, out of which F'*F took 26.806 ms; b-Ax took 182.562 ms, out of which Lap took 163.500 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.553 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004594604, int_rho =  26.00000004594608, int_b + int_rho = 3.638e-14, checking this took 0.077 ms
2-norm of RHS = 796.2453819304682, which took 0.108 ms

iter_count = 102, r_2norm = 7.262e-04, tol*||rhs|| = 7.962e-04

Anderson update took 54.373 ms, out of which F'*F took 25.458 ms; b-Ax took 172.305 ms, out of which Lap took 155.151 ms
Solving Poisson took 367.865 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.139 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.080317 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.125075 
Total time for convolution: 	 convolve: 5.086996 
Total time for convolution: 	 convolve: 5.087593 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.342 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.685 ms
---Transfer Veff_loc: D2D took 1.843 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.441 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.693 ms

This SCF took 26975.829 ms, scf error = 9.288e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.55660253980935, occ[   4] =   2.00000000000000
lambda[   5] =  -0.45441187499741, occ[   5] =   2.00000000000000
lambda[   6] =  -0.43022056438596, occ[   6] =   2.00000000000000
lambda[   7] =  -0.43013577403157, occ[   7] =   2.00000000000000
lambda[   8] =  -0.38191229638259, occ[   8] =   2.00000000000000
lambda[   9] =  -0.38183268404818, occ[   9] =   2.00000000000000
lambda[  10] =  -0.31959517534155, occ[  10] =   2.00000000000000
lambda[  11] =  -0.21393152583165, occ[  11] =   2.00000000000000
lambda[  12] =  -0.21369226869330, occ[  12] =   2.00000000000000
lambda[  13] =  -0.19352134453575, occ[  13] =   2.00000000000000
lambda[  14] =  -0.02642806733833, occ[  14] =   0.00000004594615
lambda[  15] =   0.01094766010902, occ[  15] =   0.00000000000000
lambda[  16] =   0.01834759397058, occ[  16] =   0.00000000000000
lambda[  17] =   0.01996234007340, occ[  17] =   0.00000000000000
lambda[  18] =   0.02834098554658, occ[  18] =   0.00000000000000
lambda[  19] =   0.03315873186664, occ[  19] =   0.00000000000000
lambda[  20] =   0.03533997567761, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.619 ms, time for Allreduce/Reduce: 12.786 ms 
Time for calculating local force components: 23.322 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00006047111454  -0.00006468705868  -0.05203274128239
 -0.05502212735331  -0.02737493754486  -0.01746129221563
  0.00375509062003   0.06142656175846  -0.01744683359322
  0.05125030075351  -0.03399309845890  -0.01745362456656
  0.00362349331224  -0.00352666035627   0.06259876425339
 -0.00503476418533  -0.00135804886082   0.06265292087957
  0.00123152521119   0.00493120726238   0.06260407721296
  0.00043763498039  -0.00003265518938  -0.10211248477360
  0.53272463788164  -0.31280083531868  -0.29104068040494
 -0.53638445266605  -0.30490283210951  -0.29113630347080
  0.00562795483762   0.61756061541500  -0.29103892362842
force_loc = 
 -0.00003737599713   0.00004346290916   0.05694876160638
  0.05747689910212   0.03070617430832   0.01919214201298
 -0.00215245470046  -0.06520723233022   0.01922531835264
 -0.05540909203320   0.03437895672391   0.01918070984599
 -0.00513735232103   0.00544209997027  -0.06607647240637
  0.00732099145127   0.00166821991651  -0.06612698460731
 -0.00216963955684  -0.00717252239079  -0.06609709737933
 -0.00063611957332   0.00011318899695   0.09614706863591
 -0.51840465094398   0.30553886949096   0.28369460881127
  0.52328287974814   0.29615866292119   0.28370766585695
 -0.00634118585451  -0.60150083084655   0.28371864727507
Time for calculating nonlocal force components: 41.291 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00001522760511  -0.00001835371566   0.00633367325711
[0m[32m -0.01379978961250   0.00873918585393   0.00735334294902
[0m[32m  0.01444407289641   0.00758681562307   0.00735442131433
[0m[32m -0.00070507602825  -0.01632623097896   0.00735252018771
[0mTime for calculating XC forces components: 35.028 ms
 Cartesian force = 
  0.00002430934667  -0.00002259651232   0.00491227449465
  0.00245598597808   0.00332986440066   0.00172710396802
  0.00160385014883  -0.00378204293456   0.00177473893009
 -0.00415757705043   0.00038448590221   0.00172333945009
 -0.00151264477952   0.00191406725120  -0.00348145398232
  0.00228744149521   0.00030879869289  -0.00347780955707
 -0.00093690011638  -0.00224268749121  -0.00349676599571
 -0.00021249796878   0.00006080772911   0.00036451129008
  0.00052141155443   0.00147584766341   0.00000352552601
  0.00134371420777  -0.00115872592806  -0.00007796212886
 -0.00141709281588  -0.00026781877332   0.00002849800502
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Time for printing density: 394.998 ms
The program took 473.361 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:34
Job ID:        2266435
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:37:00,vmem=8232K,walltime=00:08:05,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-2-2
---------------------------------------
