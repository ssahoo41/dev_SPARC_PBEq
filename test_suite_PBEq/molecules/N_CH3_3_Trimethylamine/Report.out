---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:39
Job ID:    2266696
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:43
Job ID:    2266696
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.062 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 12.658 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 13.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 44.356 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 81.415 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.942 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.089 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   12.679086	    8.556760	
   12.468409	    8.403675	    8.556760	
    7.531591	    8.403675	    8.556760	
    8.325164	   13.414465	   11.380493	
   11.674836	   13.414465	   11.380493	
   13.942685	    9.486437	   11.380493	
   12.267849	    6.585535	   11.380493	
    7.732151	    6.585535	   11.380493	
    6.057315	    9.486437	   11.380493	
   10.000000	   12.452273	   10.639072	
   12.271984	    8.517081	   10.639072	
    7.728016	    8.517081	   10.639072	
   10.000000	    9.828812	   11.443240	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.174 ms
Set up communicators.

--set up spincomm took 2.237 ms

--set up kptcomm took 0.346 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.007 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.074 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.815 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.745 ms

Calculate_SplineDerivRadFun took 0.199 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.267 ms.
time spent on vectorized spline interp: 2.713 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.014 ms.
time spent on vectorized spline interp: 1.764 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.522 ms.
time spent on vectorized spline interp: 1.696 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.545 ms.

Calculating rb for all atom types took 15.530 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.069 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.011 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000420986, sum_int_rho = 25.1052382146034
PosCharge = 26.000000042099, NegCharge = -25.105238214603, scal_fac = 1.035640443634
After scaling, int_rho = 26.0000000420989, PosCharge + NegCharge - NetCharge = -2.878e-13
--Calculate Vref took 0.424 ms
--Calculate rho_guess took 2.119 ms

 integral of b = -26.0000000420986,
 int{b} + Nelectron + NetCharge = -4.210e-08,
 Esc = -60.7073472752377,
 MPI_Reduce took 14.560 ms

Calculating b & b_ref took 22.818 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.011 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.020 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.645 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209864, int_b + int_rho = 7.276e-14, checking this took 0.090 ms
2-norm of RHS = 846.9877062464495, which took 0.792 ms

iter_count = 414, r_2norm = 8.095e-04, tol*||rhs|| = 8.470e-04

Anderson update took 259.636 ms, out of which F'*F took 117.640 ms; b-Ax took 790.478 ms, out of which Lap took 704.569 ms
Solving Poisson took 1740.862 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.370 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
Total time for convolution: 	 convolve: 5.111016 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 74.698 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
Total time for convolution: 	 convolve: 5.112320 
Total time for convolution: 	 convolve: 5.113611 
Total time for convolution: 	 convolve: 5.113517 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 2.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.368 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
rank = 0, XC calculation took 24366.579 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 2.214 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.150 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.485 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.138 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.865 ms
    Lanczos iter 52, eigmin  = -0.894618222, eigmax = 264.926780646, err_eigmin = 1.703e-03, err_eigmax = 9.953e-03
rank =   0, Lanczos took 131.127 ms, eigmin = -0.894618222252, eigmax = 267.576048452399

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.290715, lowerbound = -0.994618, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1991.943 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 23.676 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.085 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 27.806 ms
rank =  0, finding HY took 34.271 ms
rank =  0, distributing HY into block cyclic form took 21.998 ms
rank =  0, finding Y'*HY took 5.147 ms
Rank 0, Project_Hamiltonian used 90.380 ms
Total time for projection: 90.398 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.477 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.544 ms
    first calculated eigval = 2.723434995999122
    last  calculated eigval = 3.217271715329475
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.82632690387115
lambda[   5] =   2.85338451786315
lambda[   6] =   2.87710576550575
lambda[   7] =   2.91270477881331
lambda[   8] =   2.94243547077426
lambda[   9] =   2.94806123346362
lambda[  10] =   2.98379180222291
lambda[  11] =   2.99559150879920
lambda[  12] =   3.01862224360593
lambda[  13] =   3.05981696208637
lambda[  14] =   3.08930242744131
lambda[  15] =   3.11266289685370
lambda[  16] =   3.12366331746874
lambda[  17] =   3.15799173233924
lambda[  18] =   3.16503978525144
lambda[  19] =   3.17931691426097
lambda[  20] =   3.21727171532947
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.578 ms
rank =  0, subspace rotation using ScaLAPACK took 6.502 ms
rank =  0, Distributing orbital back into band + domain format took 19.823 ms
rank = 0, Subspace_Rotation used 26.345 ms

Total time for subspace rotation: 26.351 ms
rank = 0, Efermi =   3.074559702427 calculate fermi energy took 0.076 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.317272, lowerbound = -0.994618, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2034.570 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.013 ms
rank =  0, Distribute orbital to block cyclic format took 20.723 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.276 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 25.032 ms
rank =  0, finding HY took 33.753 ms
rank =  0, distributing HY into block cyclic form took 20.740 ms
rank =  0, finding Y'*HY took 5.955 ms
Rank 0, Project_Hamiltonian used 85.520 ms
Total time for projection: 85.525 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.600529086378822
    last  calculated eigval = 0.421555667329415
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.27291124829559
lambda[   5] =  -0.13735573251105
lambda[   6] =  -0.10021775687383
lambda[   7] =  -0.06297537693435
lambda[   8] =   0.01727140500378
lambda[   9] =   0.08493532115002
lambda[  10] =   0.11725108035936
lambda[  11] =   0.19421459943436
lambda[  12] =   0.24165525540255
lambda[  13] =   0.29275021953361
lambda[  14] =   0.32031889500421
lambda[  15] =   0.33495344492035
lambda[  16] =   0.35798022281297
lambda[  17] =   0.37592442186583
lambda[  18] =   0.39397707992882
lambda[  19] =   0.39938973672014
lambda[  20] =   0.42155566732942
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 6.465 ms
rank =  0, Distributing orbital back into band + domain format took 20.000 ms
rank = 0, Subspace_Rotation used 26.482 ms

Total time for subspace rotation: 26.488 ms
rank = 0, Efermi =   0.306534556899 calculate fermi energy took 0.036 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.521556, lowerbound = -0.994618, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2030.359 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.305 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.907 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 24.247 ms
rank =  0, finding HY took 33.712 ms
rank =  0, distributing HY into block cyclic form took 20.496 ms
rank =  0, finding Y'*HY took 6.052 ms
Rank 0, Project_Hamiltonian used 84.538 ms
Total time for projection: 84.543 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -0.903508810189034
    last  calculated eigval = 0.151552603791717
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61419082741375
lambda[   5] =  -0.49595959919251
lambda[   6] =  -0.49224286321855
lambda[   7] =  -0.48525881898159
lambda[   8] =  -0.42611808062699
lambda[   9] =  -0.41172609088773
lambda[  10] =  -0.39721314267743
lambda[  11] =  -0.38194301298985
lambda[  12] =  -0.36510055845276
lambda[  13] =  -0.15760815874695
lambda[  14] =   0.07279245428167
lambda[  15] =   0.08120409240538
lambda[  16] =   0.09177433754417
lambda[  17] =   0.10567957575875
lambda[  18] =   0.13223062381487
lambda[  19] =   0.14510309045265
lambda[  20] =   0.15155260379172
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 6.460 ms
rank =  0, Distributing orbital back into band + domain format took 19.880 ms
rank = 0, Subspace_Rotation used 26.356 ms

Total time for subspace rotation: 26.361 ms
rank = 0, Efermi =   0.044302681907 calculate fermi energy took 0.036 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.251553, lowerbound = -0.994618, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2032.946 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 20.828 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.221 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.082 ms
rank =  0, finding HY took 33.795 ms
rank =  0, distributing HY into block cyclic form took 20.529 ms
rank =  0, finding Y'*HY took 6.009 ms
Rank 0, Project_Hamiltonian used 85.440 ms
Total time for projection: 85.445 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.906058560804023
    last  calculated eigval = 0.101243921761955
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62439299523570
lambda[   5] =  -0.50156721948621
lambda[   6] =  -0.50156238611770
lambda[   7] =  -0.49256380436570
lambda[   8] =  -0.43556859428152
lambda[   9] =  -0.43538346252030
lambda[  10] =  -0.41415700080470
lambda[  11] =  -0.40010500164044
lambda[  12] =  -0.39969988770020
lambda[  13] =  -0.23955957942547
lambda[  14] =   0.01734589383422
lambda[  15] =   0.04300777350953
lambda[  16] =   0.05533052546137
lambda[  17] =   0.05668955632725
lambda[  18] =   0.07275204862780
lambda[  19] =   0.09234409260525
lambda[  20] =   0.10124392176195
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 6.459 ms
rank =  0, Distributing orbital back into band + domain format took 19.963 ms
rank = 0, Subspace_Rotation used 27.432 ms

Total time for subspace rotation: 27.440 ms
rank = 0, Efermi =  -0.011143851337 calculate fermi energy took 0.035 ms
rank = 0, --- Calculate rho: sum over local bands took 4.766 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.080 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.299 ms
rank = 0, Calculating density took 8686.253 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.809 ms
rank = 0, D2D took 2.689 ms
rank = 0, Transfering density took 2.698 ms
Etot    =   -33.908005993673
Eband   =   -13.614779505684
E1      =    28.788182108182
E2      =    -9.940518700051
E3      =   -13.800367724164
Exc     =   -12.114947743910
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 2.608e+00, dEband = 1.047e+00
rank = 0, Calculating/Estimating energy took 1.855 ms, Etot = -33.908005994, dEtot = 2.608e+00, dEband = 1.047e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 53.4923765731376, which took 0.054 ms

iter_count = 96, r_2norm = 1.647e-03, tol*||rhs|| = 2.140e-03

Anderson update took 56.633 ms, out of which F'*F took 27.092 ms; b-Ax took 181.095 ms, out of which Lap took 161.747 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 403.979 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209891, int_b + int_rho = 3.383e-13, checking this took 0.095 ms
2-norm of RHS = 842.3090606293974, which took 0.141 ms

iter_count = 282, r_2norm = 7.434e-04, tol*||rhs|| = 8.423e-04

Anderson update took 167.252 ms, out of which F'*F took 80.243 ms; b-Ax took 535.643 ms, out of which Lap took 479.182 ms
Solving Poisson took 1163.789 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.866 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.090793 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 109.872 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.092248 
Total time for convolution: 	 convolve: 5.090000 
Total time for convolution: 	 convolve: 5.091523 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.016 ms
======D2D: initiated sending and receiving took 1.203 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.251 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.475 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.749 ms

This SCF took 34686.882 ms, scf error = 2.021e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.201244, lowerbound = -0.906059, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2020.583 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.053 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.179 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 25.265 ms
rank =  0, finding HY took 33.575 ms
rank =  0, distributing HY into block cyclic form took 21.006 ms
rank =  0, finding Y'*HY took 6.339 ms
Rank 0, Project_Hamiltonian used 86.218 ms
Total time for projection: 86.234 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.889325533518753
    last  calculated eigval = 0.073733006913380
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.59673641177497
lambda[   5] =  -0.47800601527641
lambda[   6] =  -0.47790806506541
lambda[   7] =  -0.46966436542239
lambda[   8] =  -0.40946815105242
lambda[   9] =  -0.40923136388475
lambda[  10] =  -0.38752220477510
lambda[  11] =  -0.37662182471536
lambda[  12] =  -0.37660678467463
lambda[  13] =  -0.22575211255890
lambda[  14] =  -0.01195038277532
lambda[  15] =   0.02389254186106
lambda[  16] =   0.02534778791682
lambda[  17] =   0.03852653832859
lambda[  18] =   0.03912911132886
lambda[  19] =   0.06136884555371
lambda[  20] =   0.07373300691338
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 6.883 ms
rank =  0, Distributing orbital back into band + domain format took 22.400 ms
rank = 0, Subspace_Rotation used 29.301 ms

Total time for subspace rotation: 29.308 ms
rank = 0, Efermi =  -0.040440127959 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.374 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.811 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.180 ms
rank = 0, Calculating density took 2146.806 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.700 ms
rank = 0, D2D took 0.834 ms
rank = 0, Transfering density took 0.840 ms
Etot    =   -33.859233559120
Eband   =   -12.997464994552
E1      =    28.188658665687
E2      =    -9.936672423718
E3      =   -13.994065100867
Exc     =   -12.273817478364
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 3.752e-03, dEband = 4.749e-02
rank = 0, Calculating/Estimating energy took 0.979 ms, Etot = -33.859233559, dEtot = 3.752e-03, dEband = 4.749e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 12.8883108912669, which took 0.136 ms

iter_count = 102, r_2norm = 5.035e-04, tol*||rhs|| = 5.155e-04

Anderson update took 59.020 ms, out of which F'*F took 27.994 ms; b-Ax took 192.905 ms, out of which Lap took 170.133 ms
rank = 0, Mixing (+ precond) took 430.872 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209887, int_b + int_rho = 2.983e-13, checking this took 0.103 ms
2-norm of RHS = 833.8097559054597, which took 0.185 ms

iter_count = 300, r_2norm = 7.298e-04, tol*||rhs|| = 8.338e-04

Anderson update took 176.754 ms, out of which F'*F took 83.836 ms; b-Ax took 565.447 ms, out of which Lap took 505.251 ms
Solving Poisson took 1236.940 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.085607 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 28.702 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.099648 
Total time for convolution: 	 convolve: 5.092508 
Total time for convolution: 	 convolve: 5.090241 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.737 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.405 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.182 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 1.289 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.211 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.525 ms

This SCF took 28186.853 ms, scf error = 1.425e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.173733, lowerbound = -0.889326, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 3104.509 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.679 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.504 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 178.463 ms
rank =  0, Distribute data + matrix mult took 201.661 ms
rank =  0, finding HY took 30.094 ms
rank =  0, distributing HY into block cyclic form took 204.496 ms
rank =  0, finding Y'*HY took 49.385 ms
Rank 0, Project_Hamiltonian used 485.667 ms
Total time for projection: 485.680 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.851975654368464
    last  calculated eigval = 0.061142881781828
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53891305256660
lambda[   5] =  -0.42787586584623
lambda[   6] =  -0.42783214477750
lambda[   7] =  -0.42184862480440
lambda[   8] =  -0.35561788676716
lambda[   9] =  -0.35543025212803
lambda[  10] =  -0.33220068702082
lambda[  11] =  -0.32730950251028
lambda[  12] =  -0.32726692590183
lambda[  13] =  -0.18486477584713
lambda[  14] =  -0.02482630833392
lambda[  15] =   0.01508626818049
lambda[  16] =   0.01895044190296
lambda[  17] =   0.02804115818805
lambda[  18] =   0.02972827510564
lambda[  19] =   0.05002296691955
lambda[  20] =   0.06114288178183
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 36.468 ms
rank =  0, Distributing orbital back into band + domain format took 100.905 ms
rank = 0, Subspace_Rotation used 137.396 ms

Total time for subspace rotation: 137.400 ms
rank = 0, Efermi =  -0.053316053497 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 16.109 ms
rank = 0, --- Calculate rho: reduce over all band groups took 18.379 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.171 ms
rank = 0, Calculating density took 3784.889 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.674 ms
rank = 0, D2D took 0.816 ms
rank = 0, Transfering density took 0.822 ms
Etot    =   -33.808831580148
Eband   =   -11.685282239277
E1      =    26.984585994274
E2      =    -9.789784505523
E3      =   -14.476505182294
Exc     =   -12.667077746487
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 3.877e-03, dEband = 1.009e-01
rank = 0, Calculating/Estimating energy took 0.974 ms, Etot = -33.808831580, dEtot = 3.877e-03, dEband = 1.009e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.0525123975387, which took 57.809 ms

iter_count = 102, r_2norm = 1.912e-04, tol*||rhs|| = 2.421e-04

Anderson update took 177.125 ms, out of which F'*F took 38.377 ms; b-Ax took 336.670 ms, out of which Lap took 317.968 ms
rank = 0, Mixing (+ precond) took 843.968 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209888, int_b + int_rho = 3.056e-13, checking this took 0.114 ms
2-norm of RHS = 833.9015260772935, which took 0.198 ms

iter_count = 252, r_2norm = 7.769e-04, tol*||rhs|| = 8.339e-04

Anderson update took 152.705 ms, out of which F'*F took 71.309 ms; b-Ax took 470.462 ms, out of which Lap took 423.107 ms
Solving Poisson took 1039.821 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.094569 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 44.697 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.086242 
Total time for convolution: 	 convolve: 5.093383 
Total time for convolution: 	 convolve: 5.086361 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.405 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.290 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.485 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.799 ms

This SCF took 30043.730 ms, scf error = 3.916e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.161143, lowerbound = -0.851976, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1991.313 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 30.301 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.411 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 34.745 ms
rank =  0, finding HY took 32.606 ms
rank =  0, distributing HY into block cyclic form took 20.692 ms
rank =  0, finding Y'*HY took 5.864 ms
Rank 0, Project_Hamiltonian used 93.938 ms
Total time for projection: 93.952 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.617 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.719 ms
    first calculated eigval = -0.846943939442011
    last  calculated eigval = 0.053456083920540
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53474595724072
lambda[   5] =  -0.42383096760228
lambda[   6] =  -0.42381169657865
lambda[   7] =  -0.41745358947266
lambda[   8] =  -0.35161287670431
lambda[   9] =  -0.35149073018343
lambda[  10] =  -0.32821690404820
lambda[  11] =  -0.32322748015769
lambda[  12] =  -0.32319546318125
lambda[  13] =  -0.17870205478283
lambda[  14] =  -0.03034702037524
lambda[  15] =   0.01300903025856
lambda[  16] =   0.01523383050715
lambda[  17] =   0.02170606050755
lambda[  18] =   0.02404097859449
lambda[  19] =   0.04197120133207
lambda[  20] =   0.05345608392054
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.421 ms
rank =  0, subspace rotation using ScaLAPACK took 7.587 ms
rank =  0, Distributing orbital back into band + domain format took 21.314 ms
rank = 0, Subspace_Rotation used 28.918 ms

Total time for subspace rotation: 28.924 ms
rank = 0, Efermi =  -0.058836765542 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.341 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.270 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.383 ms
rank = 0, Calculating density took 2125.776 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.014 ms
rank = 0, D2D took 1.142 ms
rank = 0, Transfering density took 1.148 ms
Etot    =   -33.806136666873
Eband   =   -11.576737473155
E1      =    26.933533273317
E2      =    -9.721177171167
E3      =   -14.529754310855
Exc     =   -12.706516672581
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 2.073e-04, dEband = 8.350e-03
rank = 0, Calculating/Estimating energy took 0.996 ms, Etot = -33.806136667, dEtot = 2.073e-04, dEband = 8.350e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 2.1902076805218, which took 0.066 ms

iter_count = 108, r_2norm = 6.931e-05, tol*||rhs|| = 8.761e-05

Anderson update took 63.925 ms, out of which F'*F took 30.145 ms; b-Ax took 205.826 ms, out of which Lap took 182.959 ms
rank = 0, Mixing (+ precond) took 455.398 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209882, int_b + int_rho = 2.474e-13, checking this took 0.103 ms
2-norm of RHS = 833.8850002359820, which took 0.135 ms

iter_count = 252, r_2norm = 7.000e-04, tol*||rhs|| = 8.339e-04

Anderson update took 149.053 ms, out of which F'*F took 69.211 ms; b-Ax took 471.676 ms, out of which Lap took 420.264 ms
Solving Poisson took 1041.575 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.087692 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.665 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.104 ms
Total time for convolution: 	 convolve: 5.088075 
Total time for convolution: 	 convolve: 5.089154 
Total time for convolution: 	 convolve: 5.088322 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.388 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.194 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 1.291 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.266 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.589 ms

This SCF took 27974.588 ms, scf error = 1.548e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.153456, lowerbound = -0.846944, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2012.753 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.316 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.395 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 26.256 ms
rank =  0, finding HY took 32.503 ms
rank =  0, distributing HY into block cyclic form took 20.706 ms
rank =  0, finding Y'*HY took 5.986 ms
Rank 0, Project_Hamiltonian used 85.492 ms
Total time for projection: 85.519 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.842453979122100
    last  calculated eigval = 0.049214404913884
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52913185847751
lambda[   5] =  -0.41860701303226
lambda[   6] =  -0.41860095800403
lambda[   7] =  -0.41210147356385
lambda[   8] =  -0.34589986930945
lambda[   9] =  -0.34582566699762
lambda[  10] =  -0.32242713660304
lambda[  11] =  -0.31799815182729
lambda[  12] =  -0.31797381358751
lambda[  13] =  -0.17427042085942
lambda[  14] =  -0.03192347050185
lambda[  15] =   0.01241889432872
lambda[  16] =   0.01400721304477
lambda[  17] =   0.01862442337236
lambda[  18] =   0.02075494914473
lambda[  19] =   0.03457242986525
lambda[  20] =   0.04921440491388
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 7.629 ms
rank =  0, Distributing orbital back into band + domain format took 21.298 ms
rank = 0, Subspace_Rotation used 28.943 ms

Total time for subspace rotation: 28.948 ms
rank = 0, Efermi =  -0.060413215677 calculate fermi energy took 2.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.332 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.485 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.327 ms
rank = 0, Calculating density took 2137.687 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.023 ms
rank = 0, D2D took 1.222 ms
rank = 0, Transfering density took 1.230 ms
Etot    =   -33.805169136815
Eband   =   -11.439446793290
E1      =    26.847703605321
E2      =    -9.658229112310
E3      =   -14.582014179827
Exc     =   -12.746321964508
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 7.443e-05, dEband = 1.056e-02
rank = 0, Calculating/Estimating energy took 0.998 ms, Etot = -33.805169137, dEtot = 7.443e-05, dEband = 1.056e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8039356641803, which took 0.069 ms

iter_count = 114, r_2norm = 1.926e-05, tol*||rhs|| = 3.216e-05

Anderson update took 71.707 ms, out of which F'*F took 31.988 ms; b-Ax took 214.314 ms, out of which Lap took 190.924 ms
rank = 0, Mixing (+ precond) took 483.978 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209885, int_b + int_rho = 2.801e-13, checking this took 0.101 ms
2-norm of RHS = 834.3092561891968, which took 0.110 ms

iter_count = 240, r_2norm = 6.810e-04, tol*||rhs|| = 8.343e-04

Anderson update took 143.402 ms, out of which F'*F took 67.248 ms; b-Ax took 454.237 ms, out of which Lap took 404.547 ms
Solving Poisson took 996.797 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.155 ms
Total time for convolution: 	 convolve: 5.099668 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.513 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.085610 
Total time for convolution: 	 convolve: 5.089324 
Total time for convolution: 	 convolve: 5.098310 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.620 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.635 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.885 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.555 ms

This SCF took 27993.487 ms, scf error = 6.476e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.149214, lowerbound = -0.842454, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2030.846 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.074 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.414 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.519 ms
rank =  0, finding HY took 32.703 ms
rank =  0, distributing HY into block cyclic form took 20.538 ms
rank =  0, finding Y'*HY took 6.070 ms
Rank 0, Project_Hamiltonian used 84.861 ms
Total time for projection: 84.876 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.839706184426166
    last  calculated eigval = 0.046611698274662
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52631203010227
lambda[   5] =  -0.41570077294505
lambda[   6] =  -0.41569739573632
lambda[   7] =  -0.40911476562913
lambda[   8] =  -0.34277331126451
lambda[   9] =  -0.34272771224917
lambda[  10] =  -0.31935633656636
lambda[  11] =  -0.31511489960988
lambda[  12] =  -0.31509993213636
lambda[  13] =  -0.17238544677799
lambda[  14] =  -0.03212037095972
lambda[  15] =   0.01255591584971
lambda[  16] =   0.01373989583421
lambda[  17] =   0.01727575725620
lambda[  18] =   0.01873796198377
lambda[  19] =   0.02849852250636
lambda[  20] =   0.04661169827466
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.212 ms
rank =  0, subspace rotation using ScaLAPACK took 7.645 ms
rank =  0, Distributing orbital back into band + domain format took 21.312 ms
rank = 0, Subspace_Rotation used 28.970 ms

Total time for subspace rotation: 28.975 ms
rank = 0, Efermi =  -0.060610116146 calculate fermi energy took 0.089 ms
rank = 0, --- Calculate rho: sum over local bands took 5.442 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.945 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.224 ms
rank = 0, Calculating density took 2155.075 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.942 ms
rank = 0, D2D took 1.055 ms
rank = 0, Transfering density took 1.060 ms
Etot    =   -33.804905141152
Eband   =   -11.364247756218
E1      =    26.816723317111
E2      =    -9.609961641150
E3      =   -14.595490350190
Exc     =   -12.755485416910
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 2.031e-05, dEband = 5.785e-03
rank = 0, Calculating/Estimating energy took 0.987 ms, Etot = -33.804905141, dEtot = 2.031e-05, dEband = 5.785e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3066724067795, which took 0.060 ms

iter_count = 114, r_2norm = 8.719e-06, tol*||rhs|| = 1.227e-05

Anderson update took 67.820 ms, out of which F'*F took 31.354 ms; b-Ax took 213.835 ms, out of which Lap took 189.613 ms
rank = 0, Mixing (+ precond) took 479.908 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209882, int_b + int_rho = 2.401e-13, checking this took 0.112 ms
2-norm of RHS = 834.5354225748513, which took 0.457 ms

iter_count = 234, r_2norm = 7.325e-04, tol*||rhs|| = 8.345e-04

Anderson update took 137.118 ms, out of which F'*F took 63.877 ms; b-Ax took 432.355 ms, out of which Lap took 384.122 ms
Solving Poisson took 964.911 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.825 ms
Total time for convolution: 	 convolve: 5.087251 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 43.967 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.085709 
Total time for convolution: 	 convolve: 5.116611 
Total time for convolution: 	 convolve: 5.102977 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.769 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.174 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.013 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 1.675 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.405 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.569 ms

This SCF took 28019.506 ms, scf error = 3.035e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.146612, lowerbound = -0.839706, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2052.668 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.802 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.361 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.191 ms
rank =  0, finding HY took 32.651 ms
rank =  0, distributing HY into block cyclic form took 20.586 ms
rank =  0, finding Y'*HY took 5.930 ms
Rank 0, Project_Hamiltonian used 84.392 ms
Total time for projection: 84.408 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.835750417388230
    last  calculated eigval = 0.045171918732223
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52299688022218
lambda[   5] =  -0.41224950931408
lambda[   6] =  -0.41224512178297
lambda[   7] =  -0.40573402197923
lambda[   8] =  -0.33953191236315
lambda[   9] =  -0.33950206613585
lambda[  10] =  -0.31622976862450
lambda[  11] =  -0.31183152738590
lambda[  12] =  -0.31182245288482
lambda[  13] =  -0.16881538196341
lambda[  14] =  -0.03122374179703
lambda[  15] =   0.01373198417395
lambda[  16] =   0.01451510388613
lambda[  17] =   0.01713911278256
lambda[  18] =   0.01818082936125
lambda[  19] =   0.02570500835710
lambda[  20] =   0.04517191873222
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 7.638 ms
rank =  0, Distributing orbital back into band + domain format took 21.295 ms
rank = 0, Subspace_Rotation used 28.946 ms

Total time for subspace rotation: 28.951 ms
rank = 0, Efermi =  -0.059713486979 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.498 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.835 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.278 ms
rank = 0, Calculating density took 2175.955 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.912 ms
rank = 0, D2D took 1.035 ms
rank = 0, Transfering density took 1.041 ms
Etot    =   -33.804779671936
Eband   =   -11.275852483181
E1      =    26.773127464444
E2      =    -9.561005313021
E3      =   -14.610346997362
Exc     =   -12.766059687107
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 9.651e-06, dEband = 6.800e-03
rank = 0, Calculating/Estimating energy took 0.993 ms, Etot = -33.804779672, dEtot = 9.651e-06, dEband = 6.800e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1850309993002, which took 0.074 ms

iter_count = 114, r_2norm = 5.536e-06, tol*||rhs|| = 7.401e-06

Anderson update took 66.139 ms, out of which F'*F took 31.060 ms; b-Ax took 213.565 ms, out of which Lap took 188.344 ms
rank = 0, Mixing (+ precond) took 477.411 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209884, int_b + int_rho = 2.656e-13, checking this took 0.117 ms
2-norm of RHS = 834.5494586901841, which took 0.080 ms

iter_count = 216, r_2norm = 8.017e-04, tol*||rhs|| = 8.345e-04

Anderson update took 125.294 ms, out of which F'*F took 58.547 ms; b-Ax took 402.853 ms, out of which Lap took 356.535 ms
Solving Poisson took 892.731 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.091607 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 51.928 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.091863 
Total time for convolution: 	 convolve: 5.096388 
Total time for convolution: 	 convolve: 5.092085 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.010 ms
---Transfer Veff_loc: D2D took 2.390 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.938 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.360 ms

This SCF took 27950.419 ms, scf error = 1.610e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.145172, lowerbound = -0.835750, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2022.109 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 25.085 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.428 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 29.546 ms
rank =  0, finding HY took 32.495 ms
rank =  0, distributing HY into block cyclic form took 20.623 ms
rank =  0, finding Y'*HY took 6.648 ms
Rank 0, Project_Hamiltonian used 89.343 ms
Total time for projection: 89.356 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.833546815542489
    last  calculated eigval = 0.044472814690822
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52080115327235
lambda[   5] =  -0.41007061894637
lambda[   6] =  -0.41006796852362
lambda[   7] =  -0.40359612293924
lambda[   8] =  -0.33739232339599
lambda[   9] =  -0.33736309789201
lambda[  10] =  -0.31414299977150
lambda[  11] =  -0.30973706896389
lambda[  12] =  -0.30973097944912
lambda[  13] =  -0.16667740789352
lambda[  14] =  -0.02959335450936
lambda[  15] =   0.01563028728736
lambda[  16] =   0.01622569089543
lambda[  17] =   0.01770317816677
lambda[  18] =   0.01895859346461
lambda[  19] =   0.02548136389552
lambda[  20] =   0.04447281469082
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 7.674 ms
rank =  0, Distributing orbital back into band + domain format took 21.342 ms
rank = 0, Subspace_Rotation used 29.029 ms

Total time for subspace rotation: 29.034 ms
rank = 0, Efermi =  -0.058083099676 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.491 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.829 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.278 ms
rank = 0, Calculating density took 2150.431 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.923 ms
rank = 0, D2D took 1.034 ms
rank = 0, Transfering density took 1.037 ms
Etot    =   -33.804775017822
Eband   =   -11.219667132621
E1      =    26.742994346055
E2      =    -9.533534200306
E3      =   -14.615972954133
Exc     =   -12.770262109220
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 3.580e-07, dEband = 4.322e-03
rank = 0, Calculating/Estimating energy took 0.999 ms, Etot = -33.804775018, dEtot = 3.580e-07, dEband = 4.322e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0943144863816, which took 0.089 ms

iter_count = 114, r_2norm = 2.790e-06, tol*||rhs|| = 3.773e-06

Anderson update took 66.326 ms, out of which F'*F took 30.802 ms; b-Ax took 212.924 ms, out of which Lap took 187.774 ms
rank = 0, Mixing (+ precond) took 477.275 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209888, int_b + int_rho = 3.056e-13, checking this took 0.113 ms
2-norm of RHS = 834.5346467160678, which took 0.110 ms

iter_count = 216, r_2norm = 6.804e-04, tol*||rhs|| = 8.345e-04

Anderson update took 126.771 ms, out of which F'*F took 59.559 ms; b-Ax took 405.085 ms, out of which Lap took 358.581 ms
Solving Poisson took 894.331 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.147 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
Total time for convolution: 	 convolve: 5.088997 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.506 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.091535 
Total time for convolution: 	 convolve: 5.094769 
Total time for convolution: 	 convolve: 5.102582 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.521 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.121 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 1.598 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.897 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.527 ms

This SCF took 27883.352 ms, scf error = 1.364e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.144473, lowerbound = -0.833547, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1986.820 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.674 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.325 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.031 ms
rank =  0, finding HY took 32.524 ms
rank =  0, distributing HY into block cyclic form took 20.499 ms
rank =  0, finding Y'*HY took 6.030 ms
Rank 0, Project_Hamiltonian used 84.114 ms
Total time for projection: 84.131 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.832364513873683
    last  calculated eigval = 0.044206296174968
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51952885096472
lambda[   5] =  -0.40884736327674
lambda[   6] =  -0.40884454823951
lambda[   7] =  -0.40230259470210
lambda[   8] =  -0.33609391541535
lambda[   9] =  -0.33606876334907
lambda[  10] =  -0.31286679641748
lambda[  11] =  -0.30850732165922
lambda[  12] =  -0.30849920573794
lambda[  13] =  -0.16532428052746
lambda[  14] =  -0.02702101965604
lambda[  15] =   0.01844695278909
lambda[  16] =   0.01934700537988
lambda[  17] =   0.01999692851216
lambda[  18] =   0.02097406679720
lambda[  19] =   0.02641264996429
lambda[  20] =   0.04420629617497
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 7.658 ms
rank =  0, Distributing orbital back into band + domain format took 21.357 ms
rank = 0, Subspace_Rotation used 29.028 ms

Total time for subspace rotation: 29.034 ms
rank = 0, Efermi =  -0.055510764831 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.485 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.883 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.259 ms
rank = 0, Calculating density took 2109.953 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.916 ms
rank = 0, D2D took 1.029 ms
rank = 0, Transfering density took 1.035 ms
Etot    =   -33.804749239306
Eband   =   -11.187100139535
E1      =    26.728821272182
E2      =    -9.514482648342
E3      =   -14.618447099414
Exc     =   -12.772052843235
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 1.983e-06, dEband = 2.505e-03
rank = 0, Calculating/Estimating energy took 1.378 ms, Etot = -33.804749239, dEtot = 1.983e-06, dEband = 2.505e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0642579555974, which took 0.058 ms

iter_count = 114, r_2norm = 1.768e-06, tol*||rhs|| = 2.570e-06

Anderson update took 66.787 ms, out of which F'*F took 31.288 ms; b-Ax took 215.069 ms, out of which Lap took 189.531 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 478.009 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209878, int_b + int_rho = 2.110e-13, checking this took 0.109 ms
2-norm of RHS = 834.5286265906476, which took 0.151 ms

iter_count = 192, r_2norm = 7.382e-04, tol*||rhs|| = 8.345e-04

Anderson update took 111.131 ms, out of which F'*F took 56.278 ms; b-Ax took 362.914 ms, out of which Lap took 321.937 ms
Solving Poisson took 797.839 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.091763 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.379 ms
Total time for convolution: 	 convolve: 5.087497 
Total time for convolution: 	 convolve: 5.094615 
Total time for convolution: 	 convolve: 5.096318 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.020 ms
======D2D: initiated sending and receiving took 1.519 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.633 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.878 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.547 ms

This SCF took 27734.892 ms, scf error = 6.364e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.144206, lowerbound = -0.832365, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1979.148 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 25.148 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.371 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 29.546 ms
rank =  0, finding HY took 32.614 ms
rank =  0, distributing HY into block cyclic form took 20.555 ms
rank =  0, finding Y'*HY took 6.625 ms
Rank 0, Project_Hamiltonian used 89.370 ms
Total time for projection: 89.383 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.830906586136045
    last  calculated eigval = 0.042801295137052
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51826373399701
lambda[   5] =  -0.40753840670295
lambda[   6] =  -0.40753468089134
lambda[   7] =  -0.40100154297192
lambda[   8] =  -0.33481996431231
lambda[   9] =  -0.33479444725903
lambda[  10] =  -0.31163346549622
lambda[  11] =  -0.30722942003654
lambda[  12] =  -0.30722087245712
lambda[  13] =  -0.16402197565347
lambda[  14] =  -0.02426839323466
lambda[  15] =   0.02154519487649
lambda[  16] =   0.02229492294554
lambda[  17] =   0.02262333045380
lambda[  18] =   0.02361983014143
lambda[  19] =   0.02834839888894
lambda[  20] =   0.04280129513705
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 7.674 ms
rank =  0, Distributing orbital back into band + domain format took 21.191 ms
rank = 0, Subspace_Rotation used 28.881 ms

Total time for subspace rotation: 28.890 ms
rank = 0, Efermi =  -0.052758138400 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 5.484 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.659 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.407 ms
rank = 0, Calculating density took 2107.316 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.718 ms
rank = 0, D2D took 1.824 ms
rank = 0, Transfering density took 1.830 ms
Etot    =   -33.804774944191
Eband   =   -11.153186560629
E1      =    26.710189519923
E2      =    -9.498463174480
E3      =   -14.622060746352
Exc     =   -12.774954547841
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 1.977e-06, dEband = 2.609e-03
rank = 0, Calculating/Estimating energy took 0.973 ms, Etot = -33.804774944, dEtot = 1.977e-06, dEband = 2.609e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0386723895510, which took 0.058 ms

iter_count = 114, r_2norm = 1.329e-06, tol*||rhs|| = 1.547e-06

Anderson update took 66.489 ms, out of which F'*F took 31.032 ms; b-Ax took 214.411 ms, out of which Lap took 189.121 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 477.743 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209887, int_b + int_rho = 2.983e-13, checking this took 0.111 ms
2-norm of RHS = 834.5398473145326, which took 0.102 ms

iter_count = 162, r_2norm = 7.322e-04, tol*||rhs|| = 8.345e-04

Anderson update took 94.718 ms, out of which F'*F took 44.454 ms; b-Ax took 304.567 ms, out of which Lap took 269.903 ms
Solving Poisson took 671.120 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.087583 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 43.332 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.096479 
Total time for convolution: 	 convolve: 5.098007 
Total time for convolution: 	 convolve: 5.091945 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.484 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 1.634 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.881 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.569 ms

This SCF took 27655.004 ms, scf error = 3.765e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.142801, lowerbound = -0.830907, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2049.996 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.005 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.408 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.442 ms
rank =  0, finding HY took 32.787 ms
rank =  0, distributing HY into block cyclic form took 20.623 ms
rank =  0, finding Y'*HY took 5.823 ms
Rank 0, Project_Hamiltonian used 84.707 ms
Total time for projection: 84.722 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -0.830653357392173
    last  calculated eigval = 0.040003760626109
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51805301609811
lambda[   5] =  -0.40731162095795
lambda[   6] =  -0.40730802931596
lambda[   7] =  -0.40076368114261
lambda[   8] =  -0.33458979052743
lambda[   9] =  -0.33456420384546
lambda[  10] =  -0.31141406212605
lambda[  11] =  -0.30700389232527
lambda[  12] =  -0.30699513156379
lambda[  13] =  -0.16379587614408
lambda[  14] =  -0.02315933025814
lambda[  15] =   0.02272598992116
lambda[  16] =   0.02337464725886
lambda[  17] =   0.02367074671981
lambda[  18] =   0.02457170877835
lambda[  19] =   0.02935145698327
lambda[  20] =   0.04000376062611
==subpsace eigenproblem: bcast eigvals took 0.074 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 7.686 ms
rank =  0, Distributing orbital back into band + domain format took 21.017 ms
rank = 0, Subspace_Rotation used 28.717 ms

Total time for subspace rotation: 28.722 ms
rank = 0, Efermi =  -0.051649075436 calculate fermi energy took 0.651 ms
rank = 0, --- Calculate rho: sum over local bands took 5.384 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.697 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.391 ms
rank = 0, Calculating density took 2173.333 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.993 ms
rank = 0, D2D took 1.121 ms
rank = 0, Transfering density took 1.125 ms
Etot    =   -33.804798072537
Eband   =   -11.147242359869
E1      =    26.707890166099
E2      =    -9.494856370307
E3      =   -14.621835139175
Exc     =   -12.774790111774
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 1.779e-06, dEband = 4.572e-04
rank = 0, Calculating/Estimating energy took 0.994 ms, Etot = -33.804798073, dEtot = 1.779e-06, dEband = 4.572e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0254055306601, which took 0.148 ms

iter_count = 108, r_2norm = 9.798e-07, tol*||rhs|| = 1.016e-06

Anderson update took 63.856 ms, out of which F'*F took 29.454 ms; b-Ax took 202.312 ms, out of which Lap took 178.521 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 453.389 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209884, int_b + int_rho = 2.656e-13, checking this took 0.114 ms
2-norm of RHS = 834.5541668517834, which took 0.139 ms

iter_count = 174, r_2norm = 7.517e-04, tol*||rhs|| = 8.346e-04

Anderson update took 101.187 ms, out of which F'*F took 47.736 ms; b-Ax took 325.763 ms, out of which Lap took 288.408 ms
Solving Poisson took 721.647 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.093955 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 45.698 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.090029 
Total time for convolution: 	 convolve: 5.100437 
Total time for convolution: 	 convolve: 5.087144 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.377 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 1.640 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.885 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.559 ms

This SCF took 27729.252 ms, scf error = 2.623e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.140004, lowerbound = -0.830653, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1994.889 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 25.285 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.388 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 29.702 ms
rank =  0, finding HY took 32.531 ms
rank =  0, distributing HY into block cyclic form took 20.744 ms
rank =  0, finding Y'*HY took 5.831 ms
Rank 0, Project_Hamiltonian used 88.837 ms
Total time for projection: 88.855 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.830359047311219
    last  calculated eigval = 0.037948413742094
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51771444187741
lambda[   5] =  -0.40697976681288
lambda[   6] =  -0.40697646330956
lambda[   7] =  -0.40041149581771
lambda[   8] =  -0.33423552915186
lambda[   9] =  -0.33420463941019
lambda[  10] =  -0.31106659677248
lambda[  11] =  -0.30667802319365
lambda[  12] =  -0.30666931213439
lambda[  13] =  -0.16345693371723
lambda[  14] =  -0.02055526575712
lambda[  15] =   0.02436531554482
lambda[  16] =   0.02499131345131
lambda[  17] =   0.02701782054723
lambda[  18] =   0.02805528508639
lambda[  19] =   0.03221865636819
lambda[  20] =   0.03794841374209
==subpsace eigenproblem: bcast eigvals took 0.063 ms
Total time for solving subspace eigenvalue problem: 0.248 ms
rank =  0, subspace rotation using ScaLAPACK took 8.465 ms
rank =  0, Distributing orbital back into band + domain format took 20.679 ms
rank = 0, Subspace_Rotation used 29.166 ms

Total time for subspace rotation: 29.189 ms
rank = 0, Efermi =  -0.049045010908 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.482 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.818 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.211 ms
rank = 0, Calculating density took 2123.263 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.751 ms
rank = 0, D2D took 0.856 ms
rank = 0, Transfering density took 0.862 ms
Etot    =   -33.804867130012
Eband   =   -11.138509197820
E1      =    26.704217682948
E2      =    -9.489719621377
E3      =   -14.622025423769
Exc     =   -12.774973383810
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 5.312e-06, dEband = 6.718e-04
rank = 0, Calculating/Estimating energy took 0.993 ms, Etot = -33.804867130, dEtot = 5.312e-06, dEband = 6.718e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0213226925978, which took 0.066 ms

iter_count = 114, r_2norm = 6.055e-07, tol*||rhs|| = 8.529e-07

Anderson update took 66.316 ms, out of which F'*F took 30.786 ms; b-Ax took 213.268 ms, out of which Lap took 188.187 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 476.411 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209891, int_b + int_rho = 3.347e-13, checking this took 0.106 ms
2-norm of RHS = 834.5536505406329, which took 0.094 ms

iter_count = 108, r_2norm = 7.653e-04, tol*||rhs|| = 8.346e-04

Anderson update took 63.406 ms, out of which F'*F took 29.629 ms; b-Ax took 202.124 ms, out of which Lap took 179.327 ms
Solving Poisson took 448.049 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.091419 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.769 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.378 ms
Total time for convolution: 	 convolve: 5.105879 
Total time for convolution: 	 convolve: 5.086105 
Total time for convolution: 	 convolve: 5.094345 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.010 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.132 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 1.633 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.888 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.557 ms

This SCF took 27434.394 ms, scf error = 1.611e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.137948, lowerbound = -0.830359, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1993.921 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 25.137 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.320 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 29.489 ms
rank =  0, finding HY took 32.612 ms
rank =  0, distributing HY into block cyclic form took 20.569 ms
rank =  0, finding Y'*HY took 5.900 ms
Rank 0, Project_Hamiltonian used 88.604 ms
Total time for projection: 88.618 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -0.830237707248867
    last  calculated eigval = 0.036055433127173
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51760729469291
lambda[   5] =  -0.40687093310704
lambda[   6] =  -0.40686773259110
lambda[   7] =  -0.40030591655456
lambda[   8] =  -0.33413263155351
lambda[   9] =  -0.33410211478482
lambda[  10] =  -0.31096757314644
lambda[  11] =  -0.30657413187115
lambda[  12] =  -0.30656514096916
lambda[  13] =  -0.16334520393187
lambda[  14] =  -0.01993500790405
lambda[  15] =   0.02474143567226
lambda[  16] =   0.02542684992455
lambda[  17] =   0.02764381362853
lambda[  18] =   0.02885401054281
lambda[  19] =   0.03287842262989
lambda[  20] =   0.03605543312717
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 8.648 ms
rank =  0, Distributing orbital back into band + domain format took 20.177 ms
rank = 0, Subspace_Rotation used 28.847 ms

Total time for subspace rotation: 28.854 ms
rank = 0, Efermi =  -0.048424753058 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 5.470 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.914 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.283 ms
rank = 0, Calculating density took 2121.796 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.885 ms
rank = 0, D2D took 0.991 ms
rank = 0, Transfering density took 0.999 ms
Etot    =   -33.804870569473
Eband   =   -11.135720618136
E1      =    26.702595737941
E2      =    -9.488477416012
E3      =   -14.622391879095
Exc     =   -12.775267707909
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 2.646e-07, dEband = 2.145e-04
rank = 0, Calculating/Estimating energy took 0.985 ms, Etot = -33.804870569, dEtot = 2.646e-07, dEband = 2.145e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0180171185611, which took 0.149 ms

iter_count = 114, r_2norm = 4.937e-07, tol*||rhs|| = 7.207e-07

Anderson update took 66.383 ms, out of which F'*F took 31.148 ms; b-Ax took 214.136 ms, out of which Lap took 188.720 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 476.625 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209883, int_b + int_rho = 2.510e-13, checking this took 0.118 ms
2-norm of RHS = 834.5535137719788, which took 0.162 ms

iter_count = 114, r_2norm = 6.977e-04, tol*||rhs|| = 8.346e-04

Anderson update took 66.401 ms, out of which F'*F took 31.178 ms; b-Ax took 215.869 ms, out of which Lap took 191.753 ms
Solving Poisson took 475.519 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.089566 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.202 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.099246 
Total time for convolution: 	 convolve: 5.087676 
Total time for convolution: 	 convolve: 6.246124 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.347 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.415 ms
---Transfer Veff_loc: D2D took 1.656 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.875 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.569 ms

This SCF took 28603.571 ms, scf error = 1.108e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136055, lowerbound = -0.830238, upperbound = 267.576048

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2014.695 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.830 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.356 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.216 ms
rank =  0, finding HY took 32.580 ms
rank =  0, distributing HY into block cyclic form took 20.580 ms
rank =  0, finding Y'*HY took 5.915 ms
Rank 0, Project_Hamiltonian used 84.321 ms
Total time for projection: 84.335 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.636 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.707 ms
    first calculated eigval = -0.830168360180195
    last  calculated eigval = 0.035124753713823
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51753712283430
lambda[   5] =  -0.40680231655318
lambda[   6] =  -0.40679947081050
lambda[   7] =  -0.40023746230442
lambda[   8] =  -0.33406455070010
lambda[   9] =  -0.33403330594753
lambda[  10] =  -0.31090154853127
lambda[  11] =  -0.30650832823936
lambda[  12] =  -0.30649938228730
lambda[  13] =  -0.16328054196506
lambda[  14] =  -0.01985251114775
lambda[  15] =   0.02457900098360
lambda[  16] =   0.02537809597000
lambda[  17] =   0.02788709684176
lambda[  18] =   0.02883894739131
lambda[  19] =   0.03257925792454
lambda[  20] =   0.03512475371382
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 1.087 ms
rank =  0, subspace rotation using ScaLAPACK took 7.673 ms
rank =  0, Distributing orbital back into band + domain format took 21.088 ms
rank = 0, Subspace_Rotation used 28.772 ms

Total time for subspace rotation: 28.778 ms
rank = 0, Efermi =  -0.048342256298 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.427 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.855 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.347 ms
rank = 0, Calculating density took 2138.644 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.945 ms
rank = 0, D2D took 1.075 ms
rank = 0, Transfering density took 1.080 ms
Etot    =   -33.804887039163
Eband   =   -11.133959176616
E1      =    26.701700715758
E2      =    -9.487578656713
E3      =   -14.622480137975
Exc     =   -12.775340096517
Esc     =   -60.707347275238
Entropy =    -0.000000001237
dE = 1.267e-06, dEband = 1.355e-04
rank = 0, Calculating/Estimating energy took 0.994 ms, Etot = -33.804887039, dEtot = 1.267e-06, dEband = 1.355e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0114988561553, which took 0.065 ms

iter_count = 108, r_2norm = 4.072e-07, tol*||rhs|| = 4.600e-07

Anderson update took 62.718 ms, out of which F'*F took 29.467 ms; b-Ax took 202.070 ms, out of which Lap took 178.164 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 452.085 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000004209857, int_rho =  26.00000004209879, int_b + int_rho = 2.146e-13, checking this took 0.107 ms
2-norm of RHS = 834.5513773617847, which took 0.155 ms

iter_count = 132, r_2norm = 7.876e-04, tol*||rhs|| = 8.346e-04

Anderson update took 76.989 ms, out of which F'*F took 35.968 ms; b-Ax took 247.050 ms, out of which Lap took 218.091 ms
Solving Poisson took 546.829 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.145 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.084314 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 30.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.177 ms
Total time for convolution: 	 convolve: 5.097571 
Total time for convolution: 	 convolve: 5.089373 
Total time for convolution: 	 convolve: 5.096173 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 1.545 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.438 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.006 ms

This SCF took 27497.256 ms, scf error = 8.411e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.51753712283430, occ[   4] =   2.00000000000000
lambda[   5] =  -0.40680231655318, occ[   5] =   2.00000000000000
lambda[   6] =  -0.40679947081050, occ[   6] =   2.00000000000000
lambda[   7] =  -0.40023746230442, occ[   7] =   2.00000000000000
lambda[   8] =  -0.33406455070010, occ[   8] =   2.00000000000000
lambda[   9] =  -0.33403330594753, occ[   9] =   2.00000000000000
lambda[  10] =  -0.31090154853127, occ[  10] =   2.00000000000000
lambda[  11] =  -0.30650832823936, occ[  11] =   2.00000000000000
lambda[  12] =  -0.30649938228730, occ[  12] =   2.00000000000000
lambda[  13] =  -0.16328054196506, occ[  13] =   2.00000000000000
lambda[  14] =  -0.01985251114775, occ[  14] =   0.00000004209886
lambda[  15] =   0.02457900098360, occ[  15] =   0.00000000000000
lambda[  16] =   0.02537809597000, occ[  16] =   0.00000000000000
lambda[  17] =   0.02788709684176, occ[  17] =   0.00000000000000
lambda[  18] =   0.02883894739131, occ[  18] =   0.00000000000000
lambda[  19] =   0.03257925792454, occ[  19] =   0.00000000000000
lambda[  20] =   0.03512475371382, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.426 ms, time for Allreduce/Reduce: 14.114 ms 
Time for calculating local force components: 23.379 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000002854674  -0.00555084117033   0.04654291306466
 -0.00483763448974   0.00274263905558   0.04652466348953
  0.00483753873487   0.00274262344343   0.04652472947509
  0.03996001159546  -0.02354943062525  -0.01781674806823
 -0.03996009921784  -0.02354940815983  -0.01781675993736
 -0.04036052664405  -0.02290839579695  -0.01794316674530
 -0.00052006739007   0.04635908027936  -0.01780521808329
  0.00052001326018   0.04635910767363  -0.01780523569462
  0.04036054584092  -0.02290841704761  -0.01794319998352
 -0.00000144890081  -0.07582281544052   0.02867305922713
 -0.06578322274277   0.03806856202142   0.02862201063332
  0.06578011257854   0.03806898181896   0.02862227449458
 -0.00000272743832   0.00026544184131  -0.62682250471418
force_loc = 
 -0.00000004502412   0.00538468728074  -0.04866383385182
  0.00469223941598  -0.00266858521595  -0.04867301464136
 -0.00469280812989  -0.00266849305511  -0.04867152297570
 -0.04075028727445   0.02415182921250   0.01830716212391
  0.04074974911390   0.02415206204195   0.01830735178148
  0.04117521508246   0.02318744795957   0.01832909281028
  0.00060959734030  -0.04730344794885   0.01829089462879
 -0.00060950094861  -0.04730357613754   0.01829071475277
 -0.04117403728973   0.02318715505732   0.01832824985418
  0.00000057648229   0.07502654334007  -0.02691867578087
  0.06519704069819  -0.03757444646376  -0.02668771685459
 -0.06519851493503  -0.03757270366141  -0.02669009503684
  0.00000337386882  -0.00031849139601   0.60958447589710
Time for calculating nonlocal force components: 49.465 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000004519876   0.00394926562708  -0.00112513637245
[0m[32m  0.00341937589273  -0.00197503855354  -0.00112808103764
[0m[32m -0.00341930541255  -0.00197495677728  -0.00112814253642
[0m[32m  0.00000015285281  -0.00000959874053   0.01851656129898
[0mTime for calculating XC forces components: 34.015 ms
 Cartesian force = 
  0.00000028538518  -0.00016513700210  -0.00210746703467
 -0.00014503611771   0.00007507072714  -0.00213489739934
  0.00014508956102   0.00007514727583  -0.00213333974812
 -0.00078991672295   0.00060341547475   0.00050386780817
  0.00079000885210   0.00060367076963   0.00050404559661
  0.00081504739445   0.00028006905013   0.00039937981747
  0.00008988890627  -0.00094335078198   0.00049913029799
 -0.00008912873240  -0.00094345157641   0.00049893281064
 -0.00081313249276   0.00027975489721   0.00039850362314
 -0.00000046826372   0.00315401041414   0.00064270082630
  0.00283355280419  -0.00147990610838   0.00081966649358
 -0.00283734881301  -0.00147766173222   0.00081749067381
  0.00000115823935  -0.00006163140772   0.00129198623440
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.359 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.431 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.048 ms
Time for printing density: 389.965 ms
The program took 427.412 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:51
Job ID:        2266696
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:30:36,vmem=8280K,walltime=00:07:33,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-20-2
---------------------------------------
