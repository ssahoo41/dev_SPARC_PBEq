---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:49
Job ID:    2266882
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:54
Job ID:    2266882
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 31.308 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 12.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 18.542 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 61.629 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.944 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.087 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   13.213769	    7.633284	   10.000000	
    7.614775	   14.179443	   10.000000	
    6.665619	   11.448953	   11.670348	
    6.665619	   11.448953	    8.329652	
   11.437841	   11.893164	   11.659660	
   11.437841	   11.893164	    8.340340	
    9.639436	    7.537908	   11.675656	
    9.639436	    7.537908	    8.324344	
   13.334381	    5.820557	   10.000000	
    7.693173	   12.113876	   10.000000	
   10.428236	   11.174066	   10.000000	
   10.614409	    8.302614	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.169 ms
Set up communicators.

--set up spincomm took 2.228 ms

--set up kptcomm took 0.349 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.007 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.052 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.449 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.423 ms

Calculate_SplineDerivRadFun took 0.209 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.298 ms.
time spent on vectorized spline interp: 3.229 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.022 ms.
time spent on vectorized spline interp: 1.381 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.334 ms.
time spent on vectorized spline interp: 1.712 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.525 ms.

Calculating rb for all atom types took 15.512 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.817 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.018 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000337706, sum_int_rho = 25.2042300229174
PosCharge = 26.000000033771, NegCharge = -25.204230022917, scal_fac = 1.031572875273
After scaling, int_rho = 26.0000000337706, PosCharge + NegCharge - NetCharge = -1.776e-14
--Calculate Vref took 0.502 ms
--Calculate rho_guess took 2.580 ms

 integral of b = -26.0000000337706,
 int{b} + Nelectron + NetCharge = -3.377e-08,
 Esc = -66.6991683003844,
 MPI_Reduce took 13.798 ms

Calculating b & b_ref took 23.496 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.013 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.026 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.702 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377062, int_b + int_rho = -6.548e-14, checking this took 0.085 ms
2-norm of RHS = 819.4240516451362, which took 0.457 ms

iter_count = 414, r_2norm = 7.864e-04, tol*||rhs|| = 8.194e-04

Anderson update took 256.726 ms, out of which F'*F took 116.193 ms; b-Ax took 784.232 ms, out of which Lap took 700.627 ms
Solving Poisson took 1730.404 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.377 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
Total time for convolution: 	 convolve: 5.159733 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 37.661 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
Total time for convolution: 	 convolve: 5.137722 
Total time for convolution: 	 convolve: 5.159297 
Total time for convolution: 	 convolve: 5.130183 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
rank = 0, XC calculation took 24546.932 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 2.177 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.131 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.423 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.138 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.913 ms
    Lanczos iter 53, eigmin  = -0.929315834, eigmax = 264.927162438, err_eigmin = 2.053e-03, err_eigmax = 9.628e-03
rank =   0, Lanczos took 135.115 ms, eigmin = -0.929315834084, eigmax = 267.576434062154

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.273559, lowerbound = -1.029316, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2015.847 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 23.182 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.347 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.018 ms
rank =  0, Distribute data + matrix mult took 27.567 ms
rank =  0, finding HY took 33.910 ms
rank =  0, distributing HY into block cyclic form took 19.877 ms
rank =  0, finding Y'*HY took 11.391 ms
Rank 0, Project_Hamiltonian used 93.684 ms
Total time for projection: 93.697 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.401 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.468 ms
    first calculated eigval = 2.714837483374913
    last  calculated eigval = 3.239271386787565
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.79988240591510
lambda[   5] =   2.85674836015811
lambda[   6] =   2.89414483455384
lambda[   7] =   2.93401752163542
lambda[   8] =   2.93715939272949
lambda[   9] =   2.94967273951357
lambda[  10] =   2.97431326325700
lambda[  11] =   3.00090547636416
lambda[  12] =   3.02923166539139
lambda[  13] =   3.06472998568106
lambda[  14] =   3.08059643659838
lambda[  15] =   3.10551779941292
lambda[  16] =   3.13433355049991
lambda[  17] =   3.15268437979035
lambda[  18] =   3.17244223139277
lambda[  19] =   3.17987876865327
lambda[  20] =   3.23927138678757
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.483 ms
rank =  0, subspace rotation using ScaLAPACK took 4.857 ms
rank =  0, Distributing orbital back into band + domain format took 21.634 ms
rank = 0, Subspace_Rotation used 26.512 ms

Total time for subspace rotation: 26.519 ms
rank = 0, Efermi =   3.072663211490 calculate fermi energy took 0.080 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.339271, lowerbound = -1.029316, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2031.052 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.803 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.152 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 24.988 ms
rank =  0, finding HY took 33.724 ms
rank =  0, distributing HY into block cyclic form took 20.581 ms
rank =  0, finding Y'*HY took 5.894 ms
Rank 0, Project_Hamiltonian used 85.221 ms
Total time for projection: 85.236 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.700485225584607
    last  calculated eigval = 0.445498370274456
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.22938539906974
lambda[   5] =  -0.17789289669240
lambda[   6] =  -0.12995124193803
lambda[   7] =  -0.05348566057501
lambda[   8] =  -0.03345636257048
lambda[   9] =  -0.01416325253293
lambda[  10] =   0.11369277916661
lambda[  11] =   0.19255957361094
lambda[  12] =   0.23984360079314
lambda[  13] =   0.29090517183306
lambda[  14] =   0.31323222215866
lambda[  15] =   0.34424107979657
lambda[  16] =   0.34991546443357
lambda[  17] =   0.37546383727230
lambda[  18] =   0.38524317305622
lambda[  19] =   0.40529470306642
lambda[  20] =   0.44549837027446
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.211 ms
rank =  0, subspace rotation using ScaLAPACK took 4.281 ms
rank =  0, Distributing orbital back into band + domain format took 22.019 ms
rank = 0, Subspace_Rotation used 26.315 ms

Total time for subspace rotation: 26.322 ms
rank = 0, Efermi =   0.302068698100 calculate fermi energy took 0.059 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.545498, lowerbound = -1.029316, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2072.497 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.148 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.723 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 24.902 ms
rank =  0, finding HY took 33.787 ms
rank =  0, distributing HY into block cyclic form took 20.757 ms
rank =  0, finding Y'*HY took 5.753 ms
Rank 0, Project_Hamiltonian used 85.238 ms
Total time for projection: 85.256 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.969710467786651
    last  calculated eigval = 0.140436093052801
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.63148845708481
lambda[   5] =  -0.51837732829041
lambda[   6] =  -0.51548235921145
lambda[   7] =  -0.48939091952607
lambda[   8] =  -0.45304573080649
lambda[   9] =  -0.43551024658213
lambda[  10] =  -0.40969645957045
lambda[  11] =  -0.37807837265489
lambda[  12] =  -0.27820765645194
lambda[  13] =  -0.14679568363047
lambda[  14] =   0.06161570716948
lambda[  15] =   0.06719645849896
lambda[  16] =   0.08436090229095
lambda[  17] =   0.10081033866625
lambda[  18] =   0.11386338046655
lambda[  19] =   0.13583744821663
lambda[  20] =   0.14043609305280
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 4.103 ms
rank =  0, Distributing orbital back into band + domain format took 22.210 ms
rank = 0, Subspace_Rotation used 26.332 ms

Total time for subspace rotation: 26.337 ms
rank = 0, Efermi =   0.032922855468 calculate fermi energy took 0.065 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.240436, lowerbound = -1.029316, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2053.849 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.015 ms
rank =  0, Distribute orbital to block cyclic format took 20.967 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.069 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.065 ms
rank =  0, finding HY took 33.766 ms
rank =  0, distributing HY into block cyclic form took 20.746 ms
rank =  0, finding Y'*HY took 5.759 ms
Rank 0, Project_Hamiltonian used 85.377 ms
Total time for projection: 85.383 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.970165442798264
    last  calculated eigval = 0.088705806560962
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.63417102368308
lambda[   5] =  -0.52455595188714
lambda[   6] =  -0.51882795649365
lambda[   7] =  -0.49393652801398
lambda[   8] =  -0.45928626520985
lambda[   9] =  -0.44140691250236
lambda[  10] =  -0.41737335512806
lambda[  11] =  -0.39930173565862
lambda[  12] =  -0.34893475302033
lambda[  13] =  -0.27296850923687
lambda[  14] =   0.00502958596760
lambda[  15] =   0.01474723582518
lambda[  16] =   0.03567424775540
lambda[  17] =   0.05098492314102
lambda[  18] =   0.05294862333140
lambda[  19] =   0.07092985433096
lambda[  20] =   0.08870580656096
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 4.260 ms
rank =  0, Distributing orbital back into band + domain format took 21.699 ms
rank = 0, Subspace_Rotation used 26.415 ms

Total time for subspace rotation: 26.421 ms
rank = 0, Efermi =  -0.023662116833 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 4.563 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.606 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.341 ms
rank = 0, Calculating density took 8777.427 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
rank = 0, D2D took 2.418 ms
rank = 0, Transfering density took 2.430 ms
Etot    =   -39.498097945974
Eband   =   -14.053607245495
E1      =    28.776837164056
E2      =   -10.744263729253
E3      =   -14.655143627994
Exc     =   -12.921566920398
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 3.292e+00, dEband = 1.171e+00
rank = 0, Calculating/Estimating energy took 1.537 ms, Etot = -39.498097946, dEtot = 3.292e+00, dEband = 1.171e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 58.4467870393709, which took 0.048 ms

iter_count = 96, r_2norm = 1.869e-03, tol*||rhs|| = 2.338e-03

Anderson update took 56.688 ms, out of which F'*F took 28.099 ms; b-Ax took 190.802 ms, out of which Lap took 170.663 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.390 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377059, int_b + int_rho = -9.823e-14, checking this took 0.124 ms
2-norm of RHS = 815.1540121816005, which took 0.185 ms

iter_count = 288, r_2norm = 6.451e-04, tol*||rhs|| = 8.152e-04

Anderson update took 170.664 ms, out of which F'*F took 98.934 ms; b-Ax took 571.997 ms, out of which Lap took 514.280 ms
Solving Poisson took 1231.900 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.822 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.114600 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 103.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.131813 
Total time for convolution: 	 convolve: 5.113689 
Total time for convolution: 	 convolve: 5.142705 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.015 ms
======D2D: initiated sending and receiving took 1.084 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 1.253 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.488 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.764 ms

This SCF took 35030.311 ms, scf error = 1.761e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.188706, lowerbound = -0.970165, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2010.693 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.911 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.053 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 24.999 ms
rank =  0, finding HY took 33.926 ms
rank =  0, distributing HY into block cyclic form took 20.896 ms
rank =  0, finding Y'*HY took 6.655 ms
Rank 0, Project_Hamiltonian used 86.511 ms
Total time for projection: 86.531 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.959352894444976
    last  calculated eigval = 0.063751519349715
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.60484093535188
lambda[   5] =  -0.50108401446878
lambda[   6] =  -0.49571546352235
lambda[   7] =  -0.46178634161167
lambda[   8] =  -0.43195124920603
lambda[   9] =  -0.40736708963474
lambda[  10] =  -0.39014083203842
lambda[  11] =  -0.37238964305471
lambda[  12] =  -0.33197989336950
lambda[  13] =  -0.26161845711572
lambda[  14] =  -0.02364686001033
lambda[  15] =  -0.00284989590781
lambda[  16] =   0.01805623295936
lambda[  17] =   0.02325071094707
lambda[  18] =   0.02816044378521
lambda[  19] =   0.04886551502270
lambda[  20] =   0.06375151934971
==subpsace eigenproblem: bcast eigvals took 0.039 ms
Total time for solving subspace eigenvalue problem: 0.234 ms
rank =  0, subspace rotation using ScaLAPACK took 4.433 ms
rank =  0, Distributing orbital back into band + domain format took 23.187 ms
rank = 0, Subspace_Rotation used 27.642 ms

Total time for subspace rotation: 27.651 ms
rank = 0, Efermi =  -0.052338558902 calculate fermi energy took 0.118 ms
rank = 0, --- Calculate rho: sum over local bands took 4.996 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.953 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.347 ms
rank = 0, Calculating density took 2134.979 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.012 ms
======D2D: initiated sending and receiving took 1.004 ms
rank = 0, D2D took 1.188 ms
rank = 0, Transfering density took 1.195 ms
Etot    =   -39.447066202523
Eband   =   -13.393025469677
E1      =    28.175691724636
E2      =   -10.701537880599
E3      =   -14.841131355312
Exc     =   -13.073233392010
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 4.253e-03, dEband = 5.505e-02
rank = 0, Calculating/Estimating energy took 1.699 ms, Etot = -39.447066203, dEtot = 4.253e-03, dEband = 5.505e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 18.1211291353138, which took 0.066 ms

iter_count = 102, r_2norm = 6.238e-04, tol*||rhs|| = 7.248e-04

Anderson update took 60.191 ms, out of which F'*F took 29.722 ms; b-Ax took 204.308 ms, out of which Lap took 182.457 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 450.018 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377064, int_b + int_rho = -4.729e-14, checking this took 0.126 ms
2-norm of RHS = 808.0645611265167, which took 0.168 ms

iter_count = 306, r_2norm = 6.793e-04, tol*||rhs|| = 8.081e-04

Anderson update took 181.070 ms, out of which F'*F took 92.880 ms; b-Ax took 621.230 ms, out of which Lap took 557.930 ms
Solving Poisson took 1319.326 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.171503 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.128223 
Total time for convolution: 	 convolve: 5.105232 
Total time for convolution: 	 convolve: 5.107985 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.389 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.229 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.304 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.261 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.593 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.875 ms

This SCF took 28416.592 ms, scf error = 1.229e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.163752, lowerbound = -0.959353, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2043.105 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.838 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.494 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 25.357 ms
rank =  0, finding HY took 34.153 ms
rank =  0, distributing HY into block cyclic form took 22.016 ms
rank =  0, finding Y'*HY took 6.032 ms
Rank 0, Project_Hamiltonian used 87.596 ms
Total time for projection: 87.613 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.934417501432909
    last  calculated eigval = 0.048719004166429
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54520363152645
lambda[   5] =  -0.46790437814562
lambda[   6] =  -0.44164555542439
lambda[   7] =  -0.40150793889085
lambda[   8] =  -0.37727398703566
lambda[   9] =  -0.34093261444983
lambda[  10] =  -0.33666088467756
lambda[  11] =  -0.31558138634740
lambda[  12] =  -0.29083321537516
lambda[  13] =  -0.22842415236795
lambda[  14] =  -0.03168136501157
lambda[  15] =  -0.00530324866362
lambda[  16] =   0.01327891639152
lambda[  17] =   0.01704284266623
lambda[  18] =   0.02196822646273
lambda[  19] =   0.04299612885580
lambda[  20] =   0.04871900416643
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 8.265 ms
rank =  0, Distributing orbital back into band + domain format took 20.427 ms
rank = 0, Subspace_Rotation used 28.713 ms

Total time for subspace rotation: 28.720 ms
rank = 0, Efermi =  -0.060373063903 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.677 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.690 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.373 ms
rank = 0, Calculating density took 2170.673 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.764 ms
rank = 0, D2D took 0.885 ms
rank = 0, Transfering density took 0.891 ms
Etot    =   -39.393037277320
Eband   =   -12.064605449727
E1      =    27.034213521885
E2      =   -10.486581157029
E3      =   -15.274773343615
Exc     =   -13.424831548739
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 4.502e-03, dEband = 1.107e-01
rank = 0, Calculating/Estimating energy took 0.987 ms, Etot = -39.393037277, dEtot = 4.502e-03, dEband = 1.107e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 9.9704456153598, which took 0.115 ms

iter_count = 102, r_2norm = 2.806e-04, tol*||rhs|| = 3.988e-04

Anderson update took 61.042 ms, out of which F'*F took 29.521 ms; b-Ax took 200.396 ms, out of which Lap took 178.539 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 443.898 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377064, int_b + int_rho = -5.093e-14, checking this took 0.146 ms
2-norm of RHS = 808.2731264269675, which took 0.160 ms

iter_count = 264, r_2norm = 7.355e-04, tol*||rhs|| = 8.083e-04

Anderson update took 157.689 ms, out of which F'*F took 78.929 ms; b-Ax took 527.295 ms, out of which Lap took 471.980 ms
Solving Poisson took 1125.408 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.116481 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.120104 
Total time for convolution: 	 convolve: 5.106749 
Total time for convolution: 	 convolve: 5.118059 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.389 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.166 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 1.276 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.476 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.772 ms

This SCF took 28189.195 ms, scf error = 3.849e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.148719, lowerbound = -0.934418, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2008.957 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.794 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.294 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.119 ms
rank =  0, finding HY took 32.628 ms
rank =  0, distributing HY into block cyclic form took 20.824 ms
rank =  0, finding Y'*HY took 5.915 ms
Rank 0, Project_Hamiltonian used 84.850 ms
Total time for projection: 84.865 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.151 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.152 ms
rank = 0, Solve_Generalized_EigenProblem used 0.307 ms
    first calculated eigval = -0.935182460441754
    last  calculated eigval = 0.044856276874195
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53702656566242
lambda[   5] =  -0.46560344176321
lambda[   6] =  -0.43360025323545
lambda[   7] =  -0.39469558665823
lambda[   8] =  -0.36968610121997
lambda[   9] =  -0.33598263647285
lambda[  10] =  -0.33107637966493
lambda[  11] =  -0.30655840093554
lambda[  12] =  -0.28745389872752
lambda[  13] =  -0.22771157752140
lambda[  14] =  -0.03331569527640
lambda[  15] =  -0.00716097841993
lambda[  16] =   0.01074051662684
lambda[  17] =   0.01274867957234
lambda[  18] =   0.01924675911111
lambda[  19] =   0.03378701608056
lambda[  20] =   0.04485627687419
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.321 ms
rank =  0, subspace rotation using ScaLAPACK took 8.209 ms
rank =  0, Distributing orbital back into band + domain format took 16.528 ms
rank = 0, Subspace_Rotation used 24.751 ms

Total time for subspace rotation: 24.756 ms
rank = 0, Efermi =  -0.062007394140 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.074 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.218 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.538 ms
rank = 0, Calculating density took 2127.855 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.133 ms
rank = 0, D2D took 16.231 ms
rank = 0, Transfering density took 16.242 ms
Etot    =   -39.388935403966
Eband   =   -11.926776561361
E1      =    26.963157987891
E2      =   -10.409318611343
E3      =   -15.333134859916
Exc     =   -13.468602000371
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 3.418e-04, dEband = 1.149e-02
rank = 0, Calculating/Estimating energy took 1.454 ms, Etot = -39.388935404, dEtot = 3.418e-04, dEband = 1.149e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.5580920891920, which took 0.059 ms

iter_count = 108, r_2norm = 8.817e-05, tol*||rhs|| = 1.023e-04

Anderson update took 63.989 ms, out of which F'*F took 31.261 ms; b-Ax took 215.441 ms, out of which Lap took 192.871 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.790 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377058, int_b + int_rho = -1.055e-13, checking this took 0.125 ms
2-norm of RHS = 808.3931292117160, which took 0.160 ms

iter_count = 258, r_2norm = 7.309e-04, tol*||rhs|| = 8.084e-04

Anderson update took 153.040 ms, out of which F'*F took 78.968 ms; b-Ax took 512.676 ms, out of which Lap took 459.599 ms
Solving Poisson took 1093.706 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.131287 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.108706 
Total time for convolution: 	 convolve: 5.111759 
Total time for convolution: 	 convolve: 5.097160 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.400 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.320 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 1.281 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.611 ms

This SCF took 28155.684 ms, scf error = 1.640e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.144856, lowerbound = -0.935182, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2050.201 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.049 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.756 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 24.835 ms
rank =  0, finding HY took 32.612 ms
rank =  0, distributing HY into block cyclic form took 20.641 ms
rank =  0, finding Y'*HY took 6.145 ms
Rank 0, Project_Hamiltonian used 85.240 ms
Total time for projection: 85.258 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.196 ms
    first calculated eigval = -0.932808764751063
    last  calculated eigval = 0.044106341804782
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53028000085464
lambda[   5] =  -0.46206763725172
lambda[   6] =  -0.42707457328628
lambda[   7] =  -0.38840925685258
lambda[   8] =  -0.36310618420552
lambda[   9] =  -0.33037085797260
lambda[  10] =  -0.32519782153675
lambda[  11] =  -0.29910196031515
lambda[  12] =  -0.28299643882276
lambda[  13] =  -0.22457384778771
lambda[  14] =  -0.03347012099134
lambda[  15] =  -0.00738483725632
lambda[  16] =   0.00980387947801
lambda[  17] =   0.01106857207945
lambda[  18] =   0.01774190998912
lambda[  19] =   0.02700366497616
lambda[  20] =   0.04410634180478
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 8.299 ms
rank =  0, Distributing orbital back into band + domain format took 20.106 ms
rank = 0, Subspace_Rotation used 28.422 ms

Total time for subspace rotation: 28.427 ms
rank = 0, Efermi =  -0.062161819854 calculate fermi energy took 2.491 ms
rank = 0, --- Calculate rho: sum over local bands took 5.719 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.534 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.337 ms
rank = 0, Calculating density took 2175.255 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.015 ms
rank = 0, D2D took 1.200 ms
rank = 0, Transfering density took 1.209 ms
Etot    =   -39.387219232670
Eband   =   -11.784591471590
E1      =    26.883252673322
E2      =   -10.336119602897
E3      =   -15.383002909207
Exc     =   -13.505834645122
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 1.430e-04, dEband = 1.185e-02
rank = 0, Calculating/Estimating energy took 1.026 ms, Etot = -39.387219233, dEtot = 1.430e-04, dEband = 1.185e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0181752131905, which took 0.058 ms

iter_count = 108, r_2norm = 3.879e-05, tol*||rhs|| = 4.073e-05

Anderson update took 62.781 ms, out of which F'*F took 30.499 ms; b-Ax took 207.281 ms, out of which Lap took 184.283 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.362 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377056, int_b + int_rho = -1.273e-13, checking this took 0.123 ms
2-norm of RHS = 808.6196209747840, which took 0.201 ms

iter_count = 252, r_2norm = 6.882e-04, tol*||rhs|| = 8.086e-04

Anderson update took 147.761 ms, out of which F'*F took 73.824 ms; b-Ax took 488.832 ms, out of which Lap took 436.543 ms
Solving Poisson took 1058.996 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.111533 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.127254 
Total time for convolution: 	 convolve: 5.115873 
Total time for convolution: 	 convolve: 5.111038 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.635 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.423 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 1.694 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.953 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.452 ms

This SCF took 28200.850 ms, scf error = 6.862e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.144106, lowerbound = -0.932809, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2003.962 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.978 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.251 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.263 ms
rank =  0, finding HY took 32.791 ms
rank =  0, distributing HY into block cyclic form took 20.656 ms
rank =  0, finding Y'*HY took 6.045 ms
Rank 0, Project_Hamiltonian used 84.791 ms
Total time for projection: 84.806 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -0.928340701985196
    last  calculated eigval = 0.044485807585328
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52517690343912
lambda[   5] =  -0.45799071746233
lambda[   6] =  -0.42219814474987
lambda[   7] =  -0.38272121629489
lambda[   8] =  -0.35767049989714
lambda[   9] =  -0.32419668777535
lambda[  10] =  -0.31934313836166
lambda[  11] =  -0.29336688024402
lambda[  12] =  -0.27852866542519
lambda[  13] =  -0.22033665765586
lambda[  14] =  -0.03301101931380
lambda[  15] =  -0.00682024619578
lambda[  16] =   0.00971808522362
lambda[  17] =   0.01094043812531
lambda[  18] =   0.01724412367126
lambda[  19] =   0.02362494553961
lambda[  20] =   0.04448580758533
==subpsace eigenproblem: bcast eigvals took 0.078 ms
Total time for solving subspace eigenvalue problem: 0.280 ms
rank =  0, subspace rotation using ScaLAPACK took 8.293 ms
rank =  0, Distributing orbital back into band + domain format took 20.165 ms
rank = 0, Subspace_Rotation used 28.472 ms

Total time for subspace rotation: 28.478 ms
rank = 0, Efermi =  -0.061702718178 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 5.425 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.899 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.445 ms
rank = 0, Calculating density took 2127.433 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.130 ms
rank = 0, D2D took 1.323 ms
rank = 0, Transfering density took 1.328 ms
Etot    =   -39.386444208138
Eband   =   -11.649223624497
E1      =    26.811058801499
E2      =   -10.265731046387
E3      =   -15.411827249720
Exc     =   -13.526669379864
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 6.459e-05, dEband = 1.128e-02
rank = 0, Calculating/Estimating energy took 1.211 ms, Etot = -39.386444208, dEtot = 6.459e-05, dEband = 1.128e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4527918162446, which took 0.075 ms

iter_count = 114, r_2norm = 1.193e-05, tol*||rhs|| = 1.811e-05

Anderson update took 66.081 ms, out of which F'*F took 32.021 ms; b-Ax took 220.039 ms, out of which Lap took 195.188 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.682 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377056, int_b + int_rho = -1.237e-13, checking this took 0.097 ms
2-norm of RHS = 808.9083947079914, which took 0.169 ms

iter_count = 240, r_2norm = 8.057e-04, tol*||rhs|| = 8.089e-04

Anderson update took 139.429 ms, out of which F'*F took 65.877 ms; b-Ax took 451.338 ms, out of which Lap took 401.866 ms
Solving Poisson took 999.871 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.102887 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.117601 
Total time for convolution: 	 convolve: 5.105946 
Total time for convolution: 	 convolve: 5.105764 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.718 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.604 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 2.401 ms
---Transfer Veff_loc: D2D took 3.601 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.920 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.556 ms

This SCF took 28113.204 ms, scf error = 3.642e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.144486, lowerbound = -0.928341, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1999.615 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.907 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.369 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.306 ms
rank =  0, finding HY took 32.930 ms
rank =  0, distributing HY into block cyclic form took 20.806 ms
rank =  0, finding Y'*HY took 5.927 ms
Rank 0, Project_Hamiltonian used 85.006 ms
Total time for projection: 85.023 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.927226335878475
    last  calculated eigval = 0.046590589793022
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52137397878364
lambda[   5] =  -0.45611407666915
lambda[   6] =  -0.41861508045469
lambda[   7] =  -0.37878880230246
lambda[   8] =  -0.35389150005636
lambda[   9] =  -0.32018096811941
lambda[  10] =  -0.31551370800633
lambda[  11] =  -0.28922880154496
lambda[  12] =  -0.27584474452838
lambda[  13] =  -0.21908105224383
lambda[  14] =  -0.03198596846481
lambda[  15] =  -0.00546831641703
lambda[  16] =   0.01077242984710
lambda[  17] =   0.01224974407487
lambda[  18] =   0.01809902131650
lambda[  19] =   0.02346920188191
lambda[  20] =   0.04659058979302
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 8.289 ms
rank =  0, Distributing orbital back into band + domain format took 20.175 ms
rank = 0, Subspace_Rotation used 28.481 ms

Total time for subspace rotation: 28.486 ms
rank = 0, Efermi =  -0.060677667326 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.610 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.720 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.553 ms
rank = 0, Calculating density took 2123.354 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.082 ms
rank = 0, D2D took 1.260 ms
rank = 0, Transfering density took 1.268 ms
Etot    =   -39.386081370260
Eband   =   -11.564675955757
E1      =    26.773991617860
E2      =   -10.215085624295
E3      =   -15.422449533457
Exc     =   -13.533763888732
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 3.024e-05, dEband = 7.046e-03
rank = 0, Calculating/Estimating energy took 1.018 ms, Etot = -39.386081370, dEtot = 3.024e-05, dEband = 7.046e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3290853258331, which took 0.056 ms

iter_count = 108, r_2norm = 1.315e-05, tol*||rhs|| = 1.316e-05

Anderson update took 62.248 ms, out of which F'*F took 30.866 ms; b-Ax took 208.131 ms, out of which Lap took 184.259 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.813 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377068, int_b + int_rho = -1.091e-14, checking this took 0.103 ms
2-norm of RHS = 808.8939500266837, which took 0.116 ms

iter_count = 222, r_2norm = 7.096e-04, tol*||rhs|| = 8.089e-04

Anderson update took 130.152 ms, out of which F'*F took 61.359 ms; b-Ax took 419.594 ms, out of which Lap took 374.978 ms
Solving Poisson took 919.528 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.111032 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.143881 
Total time for convolution: 	 convolve: 5.106246 
Total time for convolution: 	 convolve: 5.111848 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.338 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.670 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.902 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.612 ms

This SCF took 27960.297 ms, scf error = 1.913e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.146591, lowerbound = -0.927226, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2011.023 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 21.022 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.181 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 25.231 ms
rank =  0, finding HY took 33.053 ms
rank =  0, distributing HY into block cyclic form took 20.710 ms
rank =  0, finding Y'*HY took 6.329 ms
Rank 0, Project_Hamiltonian used 85.354 ms
Total time for projection: 85.367 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.926038888623877
    last  calculated eigval = 0.048771767194362
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51904883469830
lambda[   5] =  -0.45470244100955
lambda[   6] =  -0.41654341512658
lambda[   7] =  -0.37639910664176
lambda[   8] =  -0.35162266589769
lambda[   9] =  -0.31774123415967
lambda[  10] =  -0.31299409310143
lambda[  11] =  -0.28676295907793
lambda[  12] =  -0.27396334255427
lambda[  13] =  -0.21776595545702
lambda[  14] =  -0.03080333789835
lambda[  15] =  -0.00369389709625
lambda[  16] =   0.01268867782741
lambda[  17] =   0.01416508863915
lambda[  18] =   0.01929438579222
lambda[  19] =   0.02477197296223
lambda[  20] =   0.04877176719436
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 8.285 ms
rank =  0, Distributing orbital back into band + domain format took 20.103 ms
rank = 0, Subspace_Rotation used 28.403 ms

Total time for subspace rotation: 28.409 ms
rank = 0, Efermi =  -0.059495036755 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.267 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.041 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.451 ms
rank = 0, Calculating density took 2134.909 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.067 ms
rank = 0, D2D took 1.258 ms
rank = 0, Transfering density took 1.262 ms
Etot    =   -39.385930726554
Eband   =   -11.510278931818
E1      =    26.743888608017
E2      =   -10.189321180829
E3      =   -15.429091204465
Exc     =   -13.538784486663
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 1.255e-05, dEband = 4.533e-03
rank = 0, Calculating/Estimating energy took 2.120 ms, Etot = -39.385930727, dEtot = 1.255e-05, dEband = 4.533e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1662537089067, which took 0.059 ms

iter_count = 114, r_2norm = 4.806e-06, tol*||rhs|| = 6.650e-06

Anderson update took 65.906 ms, out of which F'*F took 32.313 ms; b-Ax took 219.186 ms, out of which Lap took 195.158 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.135 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377055, int_b + int_rho = -1.382e-13, checking this took 0.150 ms
2-norm of RHS = 808.8909225596498, which took 0.143 ms

iter_count = 216, r_2norm = 7.684e-04, tol*||rhs|| = 8.089e-04

Anderson update took 125.138 ms, out of which F'*F took 59.134 ms; b-Ax took 406.511 ms, out of which Lap took 362.908 ms
Solving Poisson took 894.608 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.112422 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.108019 
Total time for convolution: 	 convolve: 5.156351 
Total time for convolution: 	 convolve: 5.106773 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 1.694 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.997 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.732 ms

This SCF took 28001.814 ms, scf error = 1.370e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.148772, lowerbound = -0.926039, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1998.723 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.842 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.434 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.309 ms
rank =  0, finding HY took 33.010 ms
rank =  0, distributing HY into block cyclic form took 20.644 ms
rank =  0, finding Y'*HY took 6.003 ms
Rank 0, Project_Hamiltonian used 85.002 ms
Total time for projection: 85.019 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.925408015361865
    last  calculated eigval = 0.050502234031631
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51748222224456
lambda[   5] =  -0.45384741243821
lambda[   6] =  -0.41512513862332
lambda[   7] =  -0.37484496199463
lambda[   8] =  -0.35004456790137
lambda[   9] =  -0.31629276525269
lambda[  10] =  -0.31135813070549
lambda[  11] =  -0.28496489147663
lambda[  12] =  -0.27277894612068
lambda[  13] =  -0.21698253648598
lambda[  14] =  -0.02872864212638
lambda[  15] =  -0.00066096699505
lambda[  16] =   0.01634612522992
lambda[  17] =   0.01699662564982
lambda[  18] =   0.02139996031635
lambda[  19] =   0.02674178564570
lambda[  20] =   0.05050223403163
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 8.266 ms
rank =  0, Distributing orbital back into band + domain format took 20.164 ms
rank = 0, Subspace_Rotation used 28.445 ms

Total time for subspace rotation: 28.451 ms
rank = 0, Efermi =  -0.057420341016 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.519 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.771 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.428 ms
rank = 0, Calculating density took 2122.317 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.896 ms
rank = 0, D2D took 2.002 ms
rank = 0, Transfering density took 2.008 ms
Etot    =   -39.385843129505
Eband   =   -11.475298457046
E1      =    26.728060449069
E2      =   -10.169654312015
E3      =   -15.431288467354
Exc     =   -13.540379599514
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 7.300e-06, dEband = 2.915e-03
rank = 0, Calculating/Estimating energy took 0.982 ms, Etot = -39.385843130, dEtot = 7.300e-06, dEband = 2.915e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1111240234105, which took 0.134 ms

iter_count = 114, r_2norm = 3.280e-06, tol*||rhs|| = 4.445e-06

Anderson update took 67.087 ms, out of which F'*F took 31.880 ms; b-Ax took 218.661 ms, out of which Lap took 193.494 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.229 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377070, int_b + int_rho = 1.455e-14, checking this took 0.115 ms
2-norm of RHS = 808.8749026614998, which took 0.156 ms

iter_count = 198, r_2norm = 8.036e-04, tol*||rhs|| = 8.089e-04

Anderson update took 116.169 ms, out of which F'*F took 54.543 ms; b-Ax took 374.350 ms, out of which Lap took 335.280 ms
Solving Poisson took 821.185 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.113274 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.138704 
Total time for convolution: 	 convolve: 5.150399 
Total time for convolution: 	 convolve: 5.103216 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 4.051 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 1.726 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.922 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.693 ms

This SCF took 27948.273 ms, scf error = 7.893e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.150502, lowerbound = -0.925408, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2012.520 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.779 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.438 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.253 ms
rank =  0, finding HY took 32.997 ms
rank =  0, distributing HY into block cyclic form took 20.891 ms
rank =  0, finding Y'*HY took 5.821 ms
Rank 0, Project_Hamiltonian used 84.999 ms
Total time for projection: 85.014 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.925104715461633
    last  calculated eigval = 0.048547647077574
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51653597503787
lambda[   5] =  -0.45339596233998
lambda[   6] =  -0.41428023501746
lambda[   7] =  -0.37386681682736
lambda[   8] =  -0.34901429694243
lambda[   9] =  -0.31535686645836
lambda[  10] =  -0.31028579734956
lambda[  11] =  -0.28383777991851
lambda[  12] =  -0.27212757284423
lambda[  13] =  -0.21659892857597
lambda[  14] =  -0.02661374303596
lambda[  15] =   0.00126561556177
lambda[  16] =   0.01887491071886
lambda[  17] =   0.01906577637950
lambda[  18] =   0.02305026518460
lambda[  19] =   0.02753767898585
lambda[  20] =   0.04854764707757
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 8.274 ms
rank =  0, Distributing orbital back into band + domain format took 20.162 ms
rank = 0, Subspace_Rotation used 28.451 ms

Total time for subspace rotation: 28.457 ms
rank = 0, Efermi =  -0.055305441909 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 5.916 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.680 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.471 ms
rank = 0, Calculating density took 2136.324 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.068 ms
rank = 0, D2D took 1.310 ms
rank = 0, Transfering density took 1.315 ms
Etot    =   -39.385923368066
Eband   =   -11.453914732934
E1      =    26.717225571681
E2      =   -10.158760595156
E3      =   -15.432846773650
Exc     =   -13.541673274237
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 6.687e-06, dEband = 1.782e-03
rank = 0, Calculating/Estimating energy took 1.223 ms, Etot = -39.385923368, dEtot = 6.687e-06, dEband = 1.782e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0819115023219, which took 0.069 ms

iter_count = 114, r_2norm = 2.747e-06, tol*||rhs|| = 3.276e-06

Anderson update took 66.143 ms, out of which F'*F took 31.972 ms; b-Ax took 219.676 ms, out of which Lap took 195.410 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.191 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377050, int_b + int_rho = -1.855e-13, checking this took 0.147 ms
2-norm of RHS = 808.8780833255876, which took 0.126 ms

iter_count = 168, r_2norm = 8.058e-04, tol*||rhs|| = 8.089e-04

Anderson update took 97.031 ms, out of which F'*F took 45.720 ms; b-Ax took 315.360 ms, out of which Lap took 281.621 ms
Solving Poisson took 696.269 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.106666 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.114579 
Total time for convolution: 	 convolve: 5.116889 
Total time for convolution: 	 convolve: 5.124617 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 3.838 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.386 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.346 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
---Transfer Veff_loc: D2D took 1.625 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.916 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.574 ms

This SCF took 27761.384 ms, scf error = 5.562e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.148548, lowerbound = -0.925105, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2010.514 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.699 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.448 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.179 ms
rank =  0, finding HY took 32.887 ms
rank =  0, distributing HY into block cyclic form took 20.805 ms
rank =  0, finding Y'*HY took 5.938 ms
Rank 0, Project_Hamiltonian used 84.844 ms
Total time for projection: 84.858 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.924843243680308
    last  calculated eigval = 0.046801868155864
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51614462356081
lambda[   5] =  -0.45311405757553
lambda[   6] =  -0.41390006887836
lambda[   7] =  -0.37345880030512
lambda[   8] =  -0.34860392165710
lambda[   9] =  -0.31495403589113
lambda[  10] =  -0.30985623972392
lambda[  11] =  -0.28340158943125
lambda[  12] =  -0.27180111535960
lambda[  13] =  -0.21635741420958
lambda[  14] =  -0.02542799361123
lambda[  15] =   0.00202616398892
lambda[  16] =   0.01991382527775
lambda[  17] =   0.01992716264347
lambda[  18] =   0.02403596290071
lambda[  19] =   0.02789822859688
lambda[  20] =   0.04680186815586
==subpsace eigenproblem: bcast eigvals took 0.043 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 8.752 ms
rank =  0, Distributing orbital back into band + domain format took 20.606 ms
rank = 0, Subspace_Rotation used 29.379 ms

Total time for subspace rotation: 29.387 ms
rank = 0, Efermi =  -0.054119692491 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 6.406 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.529 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.383 ms
rank = 0, Calculating density took 2135.881 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.884 ms
rank = 0, D2D took 0.980 ms
rank = 0, Transfering density took 0.984 ms
Etot    =   -39.385987273977
Eband   =   -11.444284011814
E1      =    26.712424683103
E2      =   -10.153803507169
E3      =   -15.433298645841
Exc     =   -13.542061796892
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 5.325e-06, dEband = 8.026e-04
rank = 0, Calculating/Estimating energy took 0.993 ms, Etot = -39.385987274, dEtot = 5.325e-06, dEband = 8.026e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0495731547065, which took 0.082 ms

iter_count = 114, r_2norm = 1.459e-06, tol*||rhs|| = 1.983e-06

Anderson update took 65.485 ms, out of which F'*F took 31.697 ms; b-Ax took 218.452 ms, out of which Lap took 192.986 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.635 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377061, int_b + int_rho = -8.004e-14, checking this took 0.110 ms
2-norm of RHS = 808.8875264492018, which took 0.125 ms

iter_count = 186, r_2norm = 6.905e-04, tol*||rhs|| = 8.089e-04

Anderson update took 108.409 ms, out of which F'*F took 52.370 ms; b-Ax took 352.817 ms, out of which Lap took 315.671 ms
Solving Poisson took 772.301 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.109906 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.116286 
Total time for convolution: 	 convolve: 5.113888 
Total time for convolution: 	 convolve: 5.134237 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.781 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.729 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.903 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.677 ms

This SCF took 28142.099 ms, scf error = 4.386e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.146802, lowerbound = -0.924843, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2019.323 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.968 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.294 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.296 ms
rank =  0, finding HY took 32.931 ms
rank =  0, distributing HY into block cyclic form took 20.622 ms
rank =  0, finding Y'*HY took 6.037 ms
Rank 0, Project_Hamiltonian used 84.921 ms
Total time for projection: 84.936 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -0.924199181579246
    last  calculated eigval = 0.045199947077136
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51537148992745
lambda[   5] =  -0.45246009730038
lambda[   6] =  -0.41312741242786
lambda[   7] =  -0.37268391832859
lambda[   8] =  -0.34784287027149
lambda[   9] =  -0.31418892162118
lambda[  10] =  -0.30906979635024
lambda[  11] =  -0.28260266523273
lambda[  12] =  -0.27109392633629
lambda[  13] =  -0.21576804228059
lambda[  14] =  -0.02302891319833
lambda[  15] =   0.00321083970158
lambda[  16] =   0.02118897060902
lambda[  17] =   0.02122950770282
lambda[  18] =   0.02597789835424
lambda[  19] =   0.02889096074816
lambda[  20] =   0.04519994707714
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 8.688 ms
rank =  0, Distributing orbital back into band + domain format took 20.573 ms
rank = 0, Subspace_Rotation used 29.279 ms

Total time for subspace rotation: 29.286 ms
rank = 0, Efermi =  -0.051720612071 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.859 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.047 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.419 ms
rank = 0, Calculating density took 2144.603 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.836 ms
rank = 0, D2D took 0.940 ms
rank = 0, Transfering density took 0.946 ms
Etot    =   -39.386103717819
Eband   =   -11.424986070911
E1      =    26.702378378192
E2      =   -10.144117705415
E3      =   -15.434944434549
Exc     =   -13.543389863681
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 9.704e-06, dEband = 1.608e-03
rank = 0, Calculating/Estimating energy took 0.969 ms, Etot = -39.386103718, dEtot = 9.704e-06, dEband = 1.608e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0407176860116, which took 0.065 ms

iter_count = 114, r_2norm = 1.207e-06, tol*||rhs|| = 1.629e-06

Anderson update took 66.038 ms, out of which F'*F took 31.941 ms; b-Ax took 219.771 ms, out of which Lap took 195.227 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.041 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377056, int_b + int_rho = -1.237e-13, checking this took 0.117 ms
2-norm of RHS = 808.8897571629402, which took 0.136 ms

iter_count = 144, r_2norm = 7.730e-04, tol*||rhs|| = 8.089e-04

Anderson update took 83.267 ms, out of which F'*F took 39.413 ms; b-Ax took 270.736 ms, out of which Lap took 241.863 ms
Solving Poisson took 597.807 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.113159 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.134188 
Total time for convolution: 	 convolve: 5.116512 
Total time for convolution: 	 convolve: 5.124690 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.322 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.283 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.721 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.931 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.690 ms

This SCF took 27726.172 ms, scf error = 2.523e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.145200, lowerbound = -0.924199, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1996.640 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.669 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.482 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.183 ms
rank =  0, finding HY took 32.900 ms
rank =  0, distributing HY into block cyclic form took 20.676 ms
rank =  0, finding Y'*HY took 8.590 ms
Rank 0, Project_Hamiltonian used 87.383 ms
Total time for projection: 87.399 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.580 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.659 ms
    first calculated eigval = -0.923984249908449
    last  calculated eigval = 0.043653583874277
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51514498038236
lambda[   5] =  -0.45224538102840
lambda[   6] =  -0.41290106392229
lambda[   7] =  -0.37246522090587
lambda[   8] =  -0.34762867328223
lambda[   9] =  -0.31397135356758
lambda[  10] =  -0.30885105211668
lambda[  11] =  -0.28238490879908
lambda[  12] =  -0.27087519157121
lambda[  13] =  -0.21556094259142
lambda[  14] =  -0.02231247170009
lambda[  15] =   0.00334940185193
lambda[  16] =   0.02114012441270
lambda[  17] =   0.02130623399993
lambda[  18] =   0.02633856822729
lambda[  19] =   0.02948910519529
lambda[  20] =   0.04365358387428
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 1.019 ms
rank =  0, subspace rotation using ScaLAPACK took 8.338 ms
rank =  0, Distributing orbital back into band + domain format took 20.163 ms
rank = 0, Subspace_Rotation used 28.517 ms

Total time for subspace rotation: 28.522 ms
rank = 0, Efermi =  -0.051004170591 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 6.450 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.031 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.450 ms
rank = 0, Calculating density took 2123.656 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.084 ms
rank = 0, D2D took 1.268 ms
rank = 0, Transfering density took 1.271 ms
Etot    =   -39.386143778528
Eband   =   -11.419279426615
E1      =    26.699359642947
E2      =   -10.141265115649
E3      =   -15.435527222467
Exc     =   -13.543848031592
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 3.338e-06, dEband = 4.756e-04
rank = 0, Calculating/Estimating energy took 1.108 ms, Etot = -39.386143779, dEtot = 3.338e-06, dEband = 4.756e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0303305231731, which took 0.077 ms

iter_count = 108, r_2norm = 1.112e-06, tol*||rhs|| = 1.213e-06

Anderson update took 61.701 ms, out of which F'*F took 36.191 ms; b-Ax took 232.013 ms, out of which Lap took 208.555 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.708 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377067, int_b + int_rho = -1.455e-14, checking this took 0.133 ms
2-norm of RHS = 808.8989995451439, which took 0.150 ms

iter_count = 162, r_2norm = 7.892e-04, tol*||rhs|| = 8.089e-04

Anderson update took 102.019 ms, out of which F'*F took 56.147 ms; b-Ax took 317.293 ms, out of which Lap took 285.087 ms
Solving Poisson took 695.209 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.120021 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.162 ms
Total time for convolution: 	 convolve: 5.104439 
Total time for convolution: 	 convolve: 5.114412 
Total time for convolution: 	 convolve: 5.110537 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.757 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.437 ms
---Transfer Veff_loc: D2D took 1.688 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.916 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.638 ms

This SCF took 27867.824 ms, scf error = 2.058e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.143654, lowerbound = -0.923984, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1997.499 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.715 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.369 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.137 ms
rank =  0, Distribute data + matrix mult took 26.190 ms
rank =  0, finding HY took 32.462 ms
rank =  0, distributing HY into block cyclic form took 20.741 ms
rank =  0, finding Y'*HY took 5.961 ms
Rank 0, Project_Hamiltonian used 85.394 ms
Total time for projection: 85.409 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.923706803157046
    last  calculated eigval = 0.043492389332921
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51494201770098
lambda[   5] =  -0.45198037910316
lambda[   6] =  -0.41268120736956
lambda[   7] =  -0.37228410485446
lambda[   8] =  -0.34744286324484
lambda[   9] =  -0.31379785490240
lambda[  10] =  -0.30868769126773
lambda[  11] =  -0.28220866322517
lambda[  12] =  -0.27064690303113
lambda[  13] =  -0.21528194825744
lambda[  14] =  -0.02039576702917
lambda[  15] =   0.00385837280565
lambda[  16] =   0.02195460516846
lambda[  17] =   0.02229104140823
lambda[  18] =   0.02798392667081
lambda[  19] =   0.03120183555456
lambda[  20] =   0.04349238933292
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 8.290 ms
rank =  0, Distributing orbital back into band + domain format took 20.173 ms
rank = 0, Subspace_Rotation used 28.507 ms

Total time for subspace rotation: 28.512 ms
rank = 0, Efermi =  -0.049087465895 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.489 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.950 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.541 ms
rank = 0, Calculating density took 2121.747 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.086 ms
rank = 0, D2D took 1.251 ms
rank = 0, Transfering density took 1.259 ms
Etot    =   -39.386193750710
Eband   =   -11.413865566553
E1      =    26.697319502499
E2      =   -10.137864222306
E3      =   -15.435385729396
Exc     =   -13.543729336975
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 4.164e-06, dEband = 4.512e-04
rank = 0, Calculating/Estimating energy took 1.042 ms, Etot = -39.386193751, dEtot = 4.164e-06, dEband = 4.512e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0212049780282, which took 0.057 ms

iter_count = 114, r_2norm = 5.989e-07, tol*||rhs|| = 8.482e-07

Anderson update took 65.815 ms, out of which F'*F took 31.863 ms; b-Ax took 220.073 ms, out of which Lap took 195.653 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.999 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377065, int_b + int_rho = -3.638e-14, checking this took 0.123 ms
2-norm of RHS = 808.8991371974093, which took 0.139 ms

iter_count = 108, r_2norm = 8.072e-04, tol*||rhs|| = 8.089e-04

Anderson update took 62.374 ms, out of which F'*F took 29.613 ms; b-Ax took 203.272 ms, out of which Lap took 181.603 ms
Solving Poisson took 450.009 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.273 ms
Total time for convolution: 	 convolve: 5.116080 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.109961 
Total time for convolution: 	 convolve: 5.110546 
Total time for convolution: 	 convolve: 5.114301 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.623 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.899 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.556 ms

This SCF took 27527.527 ms, scf error = 1.477e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.143492, lowerbound = -0.923707, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2003.646 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.780 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.358 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.187 ms
rank =  0, finding HY took 32.842 ms
rank =  0, distributing HY into block cyclic form took 20.552 ms
rank =  0, finding Y'*HY took 6.121 ms
Rank 0, Project_Hamiltonian used 84.734 ms
Total time for projection: 84.749 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -0.923623629792336
    last  calculated eigval = 0.042671770434916
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51482557180736
lambda[   5] =  -0.45189214300032
lambda[   6] =  -0.41257139986951
lambda[   7] =  -0.37216750987701
lambda[   8] =  -0.34732978144278
lambda[   9] =  -0.31367958950338
lambda[  10] =  -0.30856504095571
lambda[  11] =  -0.28209290994803
lambda[  12] =  -0.27054479421964
lambda[  13] =  -0.21519800201802
lambda[  14] =  -0.01994485547943
lambda[  15] =   0.00389235328093
lambda[  16] =   0.02190542889917
lambda[  17] =   0.02252695510351
lambda[  18] =   0.02821544869847
lambda[  19] =   0.03150630309155
lambda[  20] =   0.04267177043492
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 8.282 ms
rank =  0, Distributing orbital back into band + domain format took 20.236 ms
rank = 0, Subspace_Rotation used 28.532 ms

Total time for subspace rotation: 28.538 ms
rank = 0, Efermi =  -0.048636554357 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 5.437 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.844 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.469 ms
rank = 0, Calculating density took 2127.057 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.083 ms
rank = 0, D2D took 1.271 ms
rank = 0, Transfering density took 1.274 ms
Etot    =   -39.386200219892
Eband   =   -11.411030795799
E1      =    26.695677141267
E2      =   -10.136595862754
E3      =   -15.435738335137
Exc     =   -13.544012461868
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 5.391e-07, dEband = 2.362e-04
rank = 0, Calculating/Estimating energy took 1.138 ms, Etot = -39.386200220, dEtot = 5.391e-07, dEband = 2.362e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0201800016038, which took 0.056 ms

iter_count = 114, r_2norm = 5.438e-07, tol*||rhs|| = 8.072e-07

Anderson update took 65.860 ms, out of which F'*F took 31.771 ms; b-Ax took 218.695 ms, out of which Lap took 193.590 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.309 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377058, int_b + int_rho = -1.091e-13, checking this took 0.162 ms
2-norm of RHS = 808.8997191384664, which took 0.138 ms

iter_count = 114, r_2norm = 7.151e-04, tol*||rhs|| = 8.089e-04

Anderson update took 66.532 ms, out of which F'*F took 31.477 ms; b-Ax took 215.842 ms, out of which Lap took 192.777 ms
Solving Poisson took 475.669 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.116237 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.102169 
Total time for convolution: 	 convolve: 5.123429 
Total time for convolution: 	 convolve: 5.116073 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.007 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 2.594 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.906 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.531 ms

This SCF took 27533.898 ms, scf error = 1.082e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.142672, lowerbound = -0.923624, upperbound = 267.576434

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2001.872 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.921 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.317 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.273 ms
rank =  0, finding HY took 33.017 ms
rank =  0, distributing HY into block cyclic form took 20.677 ms
rank =  0, finding Y'*HY took 6.043 ms
Rank 0, Project_Hamiltonian used 85.042 ms
Total time for projection: 85.057 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.923535267491336
    last  calculated eigval = 0.042341073447246
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.51472948095474
lambda[   5] =  -0.45180446132723
lambda[   6] =  -0.41247585892049
lambda[   7] =  -0.37207533014404
lambda[   8] =  -0.34723738931512
lambda[   9] =  -0.31358922188057
lambda[  10] =  -0.30847354239308
lambda[  11] =  -0.28199916258190
lambda[  12] =  -0.27045383174046
lambda[  13] =  -0.21510896405890
lambda[  14] =  -0.02013260189336
lambda[  15] =   0.00351508890278
lambda[  16] =   0.02182374276302
lambda[  17] =   0.02256094740261
lambda[  18] =   0.02819843105433
lambda[  19] =   0.03082543384716
lambda[  20] =   0.04234107344725
==subpsace eigenproblem: bcast eigvals took 0.076 ms
Total time for solving subspace eigenvalue problem: 0.272 ms
rank =  0, subspace rotation using ScaLAPACK took 8.274 ms
rank =  0, Distributing orbital back into band + domain format took 20.104 ms
rank = 0, Subspace_Rotation used 28.394 ms

Total time for subspace rotation: 28.400 ms
rank = 0, Efermi =  -0.048824300795 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.389 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.956 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.349 ms
rank = 0, Calculating density took 2125.429 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.266 ms
rank = 0, D2D took 1.462 ms
rank = 0, Transfering density took 1.468 ms
Etot    =   -39.386214978896
Eband   =   -11.408638787984
E1      =    26.694461359741
E2      =   -10.135369958519
E3      =   -15.435902013995
Exc     =   -13.544141221784
Esc     =   -66.699168300384
Entropy =    -0.000000000999
dE = 1.230e-06, dEband = 1.993e-04
rank = 0, Calculating/Estimating energy took 1.184 ms, Etot = -39.386214979, dEtot = 1.230e-06, dEband = 1.993e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0183821861442, which took 0.065 ms

iter_count = 108, r_2norm = 5.168e-07, tol*||rhs|| = 7.353e-07

Anderson update took 63.384 ms, out of which F'*F took 30.737 ms; b-Ax took 208.009 ms, out of which Lap took 185.226 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.881 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003377069, int_rho =  26.00000003377065, int_b + int_rho = -4.002e-14, checking this took 0.109 ms
2-norm of RHS = 808.9014440282158, which took 0.148 ms

iter_count = 138, r_2norm = 7.295e-04, tol*||rhs|| = 8.089e-04

Anderson update took 79.686 ms, out of which F'*F took 37.714 ms; b-Ax took 259.718 ms, out of which Lap took 231.912 ms
Solving Poisson took 573.008 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.136642 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.103382 
Total time for convolution: 	 convolve: 5.122549 
Total time for convolution: 	 convolve: 5.109806 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.568 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.362 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.218 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.180 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 1.506 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.431 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.957 ms

This SCF took 27661.247 ms, scf error = 8.674e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.51472948095474, occ[   4] =   2.00000000000000
lambda[   5] =  -0.45180446132723, occ[   5] =   2.00000000000000
lambda[   6] =  -0.41247585892049, occ[   6] =   2.00000000000000
lambda[   7] =  -0.37207533014404, occ[   7] =   2.00000000000000
lambda[   8] =  -0.34723738931512, occ[   8] =   2.00000000000000
lambda[   9] =  -0.31358922188057, occ[   9] =   2.00000000000000
lambda[  10] =  -0.30847354239308, occ[  10] =   2.00000000000000
lambda[  11] =  -0.28199916258190, occ[  11] =   2.00000000000000
lambda[  12] =  -0.27045383174046, occ[  12] =   2.00000000000000
lambda[  13] =  -0.21510896405890, occ[  13] =   2.00000000000000
lambda[  14] =  -0.02013260189336, occ[  14] =   0.00000003377059
lambda[  15] =   0.00351508890278, occ[  15] =   0.00000000000000
lambda[  16] =   0.02182374276302, occ[  16] =   0.00000000000000
lambda[  17] =   0.02256094740261, occ[  17] =   0.00000000000000
lambda[  18] =   0.02819843105433, occ[  18] =   0.00000000000000
lambda[  19] =   0.03082543384716, occ[  19] =   0.00000000000000
lambda[  20] =   0.04234107344725, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.540 ms, time for Allreduce/Reduce: 13.670 ms 
Time for calculating local force components: 24.183 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.77057099065023  -0.71779260613225  -0.00000038705314
  0.00219500605098  -0.04891439363324  -0.00000001749621
  0.02455156513301   0.01535648820391  -0.03931652976843
  0.02455154708484   0.01535649783772   0.03931649244695
 -0.02451976536453  -0.01706698543722  -0.03909118514318
 -0.02451977733794  -0.01706698795172   0.03909119937784
  0.02310586424031   0.01779634401388  -0.03928737754802
  0.02310585184365   0.01779633998059   0.03928736828830
 -0.00756399183715   0.07434965266441  -0.00000000137994
  0.00790138976107  -0.00474329276523  -0.00000015179160
 -0.02488941709491  -0.00803992560803  -0.00000001180543
  0.16168367735104  -0.04915440747136  -0.00000024787323
force_loc = 
  0.75291021770924   0.69514642570350  -0.00000104551909
 -0.00227325226881   0.05014304988075  -0.00000032223466
 -0.02517045845121  -0.01549718734885   0.04007858045994
 -0.02517008685417  -0.01549666667781  -0.04007822340943
  0.02505233324306   0.01772811516885   0.04031845331233
  0.02505223982723   0.01772803097237  -0.04031843862219
 -0.02301414961492  -0.01840989194029   0.04068121657059
 -0.02301357787826  -0.01840975567130  -0.04068059237657
  0.00848152482378  -0.07670538625165   0.00000000076125
 -0.00588492488898   0.00352782154956  -0.00000190855621
  0.02127477776547   0.00748603899625  -0.00000054597346
 -0.16033461867909   0.05101256413139  -0.00000201047936
Time for calculating nonlocal force components: 50.131 ms
[32mforces_xc: 
[0m[32m  0.02477577713716   0.02098447414722  -0.00000010725892
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00181884217668   0.00069200167455  -0.00000009850404
[0m[32m  0.00263101817017   0.00066561018728   0.00000002398463
[0m[32m -0.00849865725080   0.00156049578939  -0.00000007397771
[0mTime for calculating XC forces components: 37.558 ms
 Cartesian force = 
  0.00711248088005  -0.00166441161591  -0.00000104470040
 -0.00008076953394   0.00122595091312   0.00000015539988
 -0.00062141663431  -0.00014340447933   0.00076254582226
 -0.00062106308544  -0.00014287417448  -0.00076123583173
  0.00053004456241   0.00065842439725   0.00122776329990
  0.00052993917319   0.00065833768626  -0.00122674411360
  0.00008919130928  -0.00061625326080   0.00139433415332
  0.00008975064928  -0.00061612102510  -0.00139272895752
  0.00091500967052  -0.00235843892163   0.00000049451207
  0.00019509937930  -0.00052617487551  -0.00000166372110
 -0.00098614447538   0.00010901824110  -0.00000003866351
 -0.00715212189496   0.00341594711503  -0.00000183719956
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.143 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.094 ms
Time for printing density: 387.102 ms
The program took 482.396 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:35:58
Job ID:        2266882
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:38:36,vmem=8352K,walltime=00:08:13,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-12-2
---------------------------------------
