---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:45
Job ID:    2266863
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:50
Job ID:    2266863
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 6.326 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 8.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 18.101 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 87.138 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.979 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.259 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   11.961798	   10.000000	
   10.000000	    8.038202	   10.000000	
    6.975697	   10.000000	   11.705952	
   13.024303	   10.000000	   11.705952	
    6.975697	   10.000000	    8.294048	
   13.024303	   10.000000	    8.294048	
    8.144879	   10.000000	   10.000000	
   11.855121	   10.000000	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.335 ms
Set up communicators.

--set up spincomm took 2.118 ms

--set up kptcomm took 0.353 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 19, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 19 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 19, mbQ = nbQ = 64
rank = 0, nr_Hp = 19, nc_Hp = 19
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.056 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.384 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.419 ms

Calculate_SplineDerivRadFun took 0.209 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.793 ms.
time spent on vectorized spline interp: 3.151 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.733 ms.
time spent on vectorized spline interp: 1.354 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.404 ms.
time spent on vectorized spline interp: 1.704 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.519 ms.

Calculating rb for all atom types took 15.666 ms
----------------------
Estimated memory usage
Total: 1.16 GB
orbitals             : 869.75 MB
global sized vectors : 213.62 MB
subspace matrices : 8.46 kB
others : 108.34 MB
----------------------------------------------
Estimated memory usage per processor: 99.31 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.068 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -24.0000000120035, sum_int_rho = 23.5970056187844
PosCharge = 24.000000012004, NegCharge = -23.597005618784, scal_fac = 1.017078200503
After scaling, int_rho = 24.0000000120035, PosCharge + NegCharge - NetCharge = 2.487e-14
--Calculate Vref took 0.454 ms
--Calculate rho_guess took 2.594 ms

 integral of b = -24.0000000120035,
 int{b} + Nelectron + NetCharge = -1.200e-08,
 Esc = -74.5477851888350,
 MPI_Reduce took 6.850 ms

Calculating b & b_ref took 16.308 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.105 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.114 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.091 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.592 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.927 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200325, int_b + int_rho = -3.129e-13, checking this took 0.533 ms
2-norm of RHS = 699.6201709761604, which took 0.459 ms

iter_count = 420, r_2norm = 5.940e-04, tol*||rhs|| = 6.996e-04

Anderson update took 233.605 ms, out of which F'*F took 106.588 ms; b-Ax took 724.181 ms, out of which Lap took 652.336 ms
Solving Poisson took 1523.551 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.420 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
Total time for convolution: 	 convolve: 5.156440 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.517 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
Total time for convolution: 	 convolve: 5.139239 
Total time for convolution: 	 convolve: 5.226979 
Total time for convolution: 	 convolve: 5.129814 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.736 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.499 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
rank = 0, XC calculation took 24542.433 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 4.891 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.164 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.186 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.151 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.657 ms
    Lanczos iter 53, eigmin  = -1.094092731, eigmax = 264.930303051, err_eigmin = 4.447e-04, err_eigmax = 9.758e-03
rank =   0, Lanczos took 125.357 ms, eigmin = -1.094092730945, eigmax = 267.579606081069

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.192757, lowerbound = -1.194093, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1456.935 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.399 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.731 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.150 ms
rank =  0, finding HY took 24.030 ms
rank =  0, distributing HY into block cyclic form took 21.760 ms
rank =  0, finding Y'*HY took 3.934 ms
Rank 0, Project_Hamiltonian used 71.902 ms
Total time for projection: 71.936 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.797 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.726 ms
rank = 0, Solve_Generalized_EigenProblem used 1.529 ms
    first calculated eigval = 2.761776456901125
    last  calculated eigval = 3.251978262753932
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =   2.80135568309718
lambda[   4] =   2.83898083092396
lambda[   5] =   2.84848365936011
lambda[   6] =   2.90711334015727
lambda[   7] =   2.92797750484495
lambda[   8] =   2.95890772213702
lambda[   9] =   2.98303430314599
lambda[  10] =   3.00929878208533
lambda[  11] =   3.01898076076757
lambda[  12] =   3.03514775337473
lambda[  13] =   3.08459886467721
lambda[  14] =   3.13014808350590
lambda[  15] =   3.14365843559827
lambda[  16] =   3.16292798822190
lambda[  17] =   3.18595837385596
lambda[  18] =   3.22379579170543
lambda[  19] =   3.25197826275393
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.546 ms
rank =  0, subspace rotation using ScaLAPACK took 7.223 ms
rank =  0, Distributing orbital back into band + domain format took 30.650 ms
rank = 0, Subspace_Rotation used 37.891 ms

Total time for subspace rotation: 37.895 ms
rank = 0, Efermi =   3.059876522964 calculate fermi energy took 0.050 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.351978, lowerbound = -1.194093, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1387.149 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 74.945 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.595 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 77.554 ms
rank =  0, finding HY took 23.112 ms
rank =  0, distributing HY into block cyclic form took 17.441 ms
rank =  0, finding Y'*HY took 3.586 ms
Rank 0, Project_Hamiltonian used 121.722 ms
Total time for projection: 121.740 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -0.944945975290173
    last  calculated eigval = 0.434178616818826
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.45844035354807
lambda[   4] =  -0.23128030583270
lambda[   5] =  -0.16482108692247
lambda[   6] =  -0.08689991143639
lambda[   7] =  -0.06329632858756
lambda[   8] =   0.07432042257291
lambda[   9] =   0.13294110753525
lambda[  10] =   0.19032681288535
lambda[  11] =   0.22330188942304
lambda[  12] =   0.25951937803808
lambda[  13] =   0.29432933587319
lambda[  14] =   0.32705854249696
lambda[  15] =   0.34324937995363
lambda[  16] =   0.37279344280427
lambda[  17] =   0.38904753242109
lambda[  18] =   0.41380662441903
lambda[  19] =   0.43417861681883
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 7.177 ms
rank =  0, Distributing orbital back into band + domain format took 16.993 ms
rank = 0, Subspace_Rotation used 24.183 ms

Total time for subspace rotation: 24.187 ms
rank = 0, Efermi =   0.276924367610 calculate fermi energy took 0.020 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.534179, lowerbound = -1.194093, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1386.353 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 73.638 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.093 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 76.766 ms
rank =  0, finding HY took 22.953 ms
rank =  0, distributing HY into block cyclic form took 17.313 ms
rank =  0, finding Y'*HY took 3.594 ms
Rank 0, Project_Hamiltonian used 120.650 ms
Total time for projection: 120.654 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.205 ms
    first calculated eigval = -1.096179048607904
    last  calculated eigval = 0.144195260533591
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.73353252702841
lambda[   4] =  -0.61320499028300
lambda[   5] =  -0.53951836358323
lambda[   6] =  -0.51490405880954
lambda[   7] =  -0.51402811199502
lambda[   8] =  -0.45406889142495
lambda[   9] =  -0.40986130118188
lambda[  10] =  -0.34235248246425
lambda[  11] =  -0.31694918410633
lambda[  12] =  -0.26461496673832
lambda[  13] =   0.01319745043514
lambda[  14] =   0.05315069400932
lambda[  15] =   0.07291738851358
lambda[  16] =   0.10277667647983
lambda[  17] =   0.11771327219140
lambda[  18] =   0.13941748188080
lambda[  19] =   0.14419526053359
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 7.177 ms
rank =  0, Distributing orbital back into band + domain format took 17.071 ms
rank = 0, Subspace_Rotation used 24.261 ms

Total time for subspace rotation: 24.265 ms
rank = 0, Efermi =  -0.016424558852 calculate fermi energy took 0.020 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.244195, lowerbound = -1.194093, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1382.346 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 73.579 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.538 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 76.132 ms
rank =  0, finding HY took 23.105 ms
rank =  0, distributing HY into block cyclic form took 17.454 ms
rank =  0, finding Y'*HY took 3.552 ms
Rank 0, Project_Hamiltonian used 120.266 ms
Total time for projection: 120.271 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -1.096257133735707
    last  calculated eigval = 0.087302417220109
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.73437158614245
lambda[   4] =  -0.62225587950068
lambda[   5] =  -0.54305899698677
lambda[   6] =  -0.52277652398532
lambda[   7] =  -0.51944919945739
lambda[   8] =  -0.45911016597141
lambda[   9] =  -0.42832074601443
lambda[  10] =  -0.36228932454122
lambda[  11] =  -0.33304568471779
lambda[  12] =  -0.28517779513401
lambda[  13] =  -0.04681288873783
lambda[  14] =   0.00422476221607
lambda[  15] =   0.02736639069223
lambda[  16] =   0.04591937811056
lambda[  17] =   0.06882842073866
lambda[  18] =   0.07749540206557
lambda[  19] =   0.08730241722011
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 7.185 ms
rank =  0, Distributing orbital back into band + domain format took 16.949 ms
rank = 0, Subspace_Rotation used 24.146 ms

Total time for subspace rotation: 24.170 ms
rank = 0, Efermi =  -0.076434897959 calculate fermi energy took 0.023 ms
rank = 0, --- Calculate rho: sum over local bands took 5.058 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.854 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.568 ms
rank = 0, Calculating density took 6304.443 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.828 ms
rank = 0, D2D took 1.928 ms
rank = 0, Transfering density took 1.935 ms
Etot    =   -47.498328327482
Eband   =   -13.705780456960
E1      =    27.226167939450
E2      =   -11.891918694601
E3      =   -15.268728101784
Exc     =   -13.631577417155
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 5.937e+00, dEband = 1.713e+00
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -47.498328327, dEtot = 5.937e+00, dEband = 1.713e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 70.4359478098273, which took 0.656 ms

iter_count = 90, r_2norm = 1.941e-03, tol*||rhs|| = 2.817e-03

Anderson update took 48.685 ms, out of which F'*F took 22.452 ms; b-Ax took 152.148 ms, out of which Lap took 136.107 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 329.625 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200353, int_b + int_rho = -4.002e-14, checking this took 0.114 ms
2-norm of RHS = 695.8533992006434, which took 0.171 ms

iter_count = 276, r_2norm = 6.080e-04, tol*||rhs|| = 6.959e-04

Anderson update took 148.804 ms, out of which F'*F took 75.277 ms; b-Ax took 470.030 ms, out of which Lap took 421.496 ms
Solving Poisson took 992.194 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.429 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.225610 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.587 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.210932 
Total time for convolution: 	 convolve: 5.267216 
Total time for convolution: 	 convolve: 5.253003 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.466 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 3.594 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.922 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.549 ms

This SCF took 32670.773 ms, scf error = 1.465e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.187302, lowerbound = -1.096257, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1441.213 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.121 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.556 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.694 ms
rank =  0, finding HY took 23.691 ms
rank =  0, distributing HY into block cyclic form took 19.793 ms
rank =  0, finding Y'*HY took 3.490 ms
Rank 0, Project_Hamiltonian used 66.697 ms
Total time for projection: 66.708 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -1.082383305298752
    last  calculated eigval = 0.062108669901921
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.71661795563348
lambda[   4] =  -0.59966635041780
lambda[   5] =  -0.52599791447884
lambda[   6] =  -0.50598820027897
lambda[   7] =  -0.49602166635969
lambda[   8] =  -0.44119605333655
lambda[   9] =  -0.40953726846467
lambda[  10] =  -0.33753608138304
lambda[  11] =  -0.30943332672468
lambda[  12] =  -0.26273104729366
lambda[  13] =  -0.04431962944918
lambda[  14] =  -0.02104249909858
lambda[  15] =   0.00946199214088
lambda[  16] =   0.02096155518396
lambda[  17] =   0.04238913761684
lambda[  18] =   0.05674809423626
lambda[  19] =   0.06210866990192
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.232 ms
rank =  0, subspace rotation using ScaLAPACK took 6.949 ms
rank =  0, Distributing orbital back into band + domain format took 18.486 ms
rank = 0, Subspace_Rotation used 25.454 ms

Total time for subspace rotation: 25.459 ms
rank = 0, Efermi =  -0.073941638717 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.309 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.132 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.615 ms
rank = 0, Calculating density took 1550.182 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.899 ms
rank = 0, D2D took 2.007 ms
rank = 0, Transfering density took 2.013 ms
Etot    =   -47.467709124033
Eband   =   -13.226956855698
E1      =    26.795835805526
E2      =   -11.842306852146
E3      =   -15.424927791691
Exc     =   -13.756037528496
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 3.827e-03, dEband = 5.985e-02
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -47.467709124, dEtot = 3.827e-03, dEband = 5.985e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 18.4214647375221, which took 0.051 ms

iter_count = 96, r_2norm = 6.786e-04, tol*||rhs|| = 7.369e-04

Anderson update took 51.107 ms, out of which F'*F took 23.883 ms; b-Ax took 163.003 ms, out of which Lap took 145.370 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.885 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200344, int_b + int_rho = -1.273e-13, checking this took 0.112 ms
2-norm of RHS = 691.1388821212446, which took 0.167 ms

iter_count = 294, r_2norm = 6.165e-04, tol*||rhs|| = 6.911e-04

Anderson update took 155.972 ms, out of which F'*F took 74.362 ms; b-Ax took 501.040 ms, out of which Lap took 443.929 ms
Solving Poisson took 1055.628 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.253055 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.276567 
Total time for convolution: 	 convolve: 5.299945 
Total time for convolution: 	 convolve: 5.257967 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.347 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.161 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.510 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.187 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.732 ms

This SCF took 28135.513 ms, scf error = 1.013e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.162109, lowerbound = -1.082383, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1436.732 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.230 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.860 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.103 ms
rank =  0, finding HY took 24.855 ms
rank =  0, distributing HY into block cyclic form took 17.441 ms
rank =  0, finding Y'*HY took 3.719 ms
Rank 0, Project_Hamiltonian used 66.148 ms
Total time for projection: 66.162 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.205 ms
    first calculated eigval = -1.058439610523531
    last  calculated eigval = 0.055442941449890
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.67845431615028
lambda[   4] =  -0.55110086576419
lambda[   5] =  -0.48949038008407
lambda[   6] =  -0.47639383445044
lambda[   7] =  -0.45627909810261
lambda[   8] =  -0.39904563126725
lambda[   9] =  -0.37284327505808
lambda[  10] =  -0.29667902113113
lambda[  11] =  -0.27146465439586
lambda[  12] =  -0.22162803289024
lambda[  13] =  -0.02853938424681
lambda[  14] =  -0.02342609666953
lambda[  15] =   0.00553527273183
lambda[  16] =   0.01314137039998
lambda[  17] =   0.02700234104207
lambda[  18] =   0.04730223474209
lambda[  19] =   0.05544294144989
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 6.917 ms
rank =  0, Distributing orbital back into band + domain format took 18.312 ms
rank = 0, Subspace_Rotation used 25.248 ms

Total time for subspace rotation: 25.252 ms
rank = 0, Efermi =  -0.058163112765 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.274 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.050 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.637 ms
rank = 0, Calculating density took 1544.514 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.927 ms
rank = 0, D2D took 2.024 ms
rank = 0, Transfering density took 2.030 ms
Etot    =   -47.438211819244
Eband   =   -12.332104038854
E1      =    26.038772188377
E2      =   -11.667964948478
E3      =   -15.750814793120
Exc     =   -14.015874521164
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 3.687e-03, dEband = 1.119e-01
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -47.438211819, dEtot = 3.687e-03, dEband = 1.119e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.6583993984940, which took 0.556 ms

iter_count = 102, r_2norm = 1.676e-04, tol*||rhs|| = 1.863e-04

Anderson update took 53.792 ms, out of which F'*F took 26.188 ms; b-Ax took 174.757 ms, out of which Lap took 155.086 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 377.064 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200347, int_b + int_rho = -9.095e-14, checking this took 0.124 ms
2-norm of RHS = 692.2812216317808, which took 0.110 ms

iter_count = 258, r_2norm = 6.699e-04, tol*||rhs|| = 6.923e-04

Anderson update took 138.549 ms, out of which F'*F took 68.300 ms; b-Ax took 446.775 ms, out of which Lap took 401.151 ms
Solving Poisson took 932.386 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.253151 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.444 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.257815 
Total time for convolution: 	 convolve: 5.250481 
Total time for convolution: 	 convolve: 5.228070 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.508 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.963 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.502 ms

This SCF took 27926.750 ms, scf error = 2.531e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.155443, lowerbound = -1.058440, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1412.654 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.323 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.611 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.948 ms
rank =  0, finding HY took 24.511 ms
rank =  0, distributing HY into block cyclic form took 17.347 ms
rank =  0, finding Y'*HY took 3.637 ms
Rank 0, Project_Hamiltonian used 65.471 ms
Total time for projection: 65.483 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.329 ms
rank = 0, Solve_Generalized_EigenProblem used 0.449 ms
    first calculated eigval = -1.055206307429559
    last  calculated eigval = 0.051849377349542
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.67021204080442
lambda[   4] =  -0.54101331116296
lambda[   5] =  -0.48155015738946
lambda[   6] =  -0.47336233861488
lambda[   7] =  -0.45407947909039
lambda[   8] =  -0.38807481077800
lambda[   9] =  -0.36690642208741
lambda[  10] =  -0.29532631794697
lambda[  11] =  -0.27033734634407
lambda[  12] =  -0.21682537602795
lambda[  13] =  -0.02992659562392
lambda[  14] =  -0.02006266171185
lambda[  15] =   0.00464586953712
lambda[  16] =   0.01194324581704
lambda[  17] =   0.02008778809856
lambda[  18] =   0.03802846224568
lambda[  19] =   0.05184937734954
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.481 ms
rank =  0, subspace rotation using ScaLAPACK took 6.942 ms
rank =  0, Distributing orbital back into band + domain format took 17.652 ms
rank = 0, Subspace_Rotation used 24.607 ms

Total time for subspace rotation: 24.611 ms
rank = 0, Efermi =  -0.059548607080 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 5.413 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.317 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.609 ms
rank = 0, Calculating density took 1520.685 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.998 ms
rank = 0, D2D took 2.103 ms
rank = 0, Transfering density took 2.110 ms
Etot    =   -47.436162776412
Eband   =   -12.211884933725
E1      =    25.980851302723
E2      =   -11.597229181627
E3      =   -15.792484392302
Exc     =   -14.047057530138
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 2.561e-04, dEband = 1.503e-02
rank = 0, Calculating/Estimating energy took 0.891 ms, Etot = -47.436162776, dEtot = 2.561e-04, dEband = 1.503e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.4787895940924, which took 0.059 ms

iter_count = 102, r_2norm = 9.425e-05, tol*||rhs|| = 9.915e-05

Anderson update took 53.507 ms, out of which F'*F took 25.079 ms; b-Ax took 177.469 ms, out of which Lap took 158.998 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 377.273 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200343, int_b + int_rho = -1.310e-13, checking this took 0.108 ms
2-norm of RHS = 692.7799642535801, which took 0.149 ms

iter_count = 246, r_2norm = 6.541e-04, tol*||rhs|| = 6.928e-04

Anderson update took 130.903 ms, out of which F'*F took 61.205 ms; b-Ax took 437.591 ms, out of which Lap took 393.266 ms
Solving Poisson took 908.071 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.276522 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.275172 
Total time for convolution: 	 convolve: 5.249836 
Total time for convolution: 	 convolve: 5.236401 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.369 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.515 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.579 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.129 ms

This SCF took 27905.700 ms, scf error = 9.037e-03
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.151849, lowerbound = -1.055206, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1410.499 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.112 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.494 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.619 ms
rank =  0, finding HY took 23.634 ms
rank =  0, distributing HY into block cyclic form took 18.074 ms
rank =  0, finding Y'*HY took 3.884 ms
Rank 0, Project_Hamiltonian used 65.239 ms
Total time for projection: 65.247 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.196 ms
    first calculated eigval = -1.050636347583634
    last  calculated eigval = 0.050236814723344
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66616795652169
lambda[   4] =  -0.53684222739325
lambda[   5] =  -0.47722254218882
lambda[   6] =  -0.46954707978695
lambda[   7] =  -0.45012536562644
lambda[   8] =  -0.38369483240166
lambda[   9] =  -0.36284587861168
lambda[  10] =  -0.29130875991681
lambda[  11] =  -0.26611256931846
lambda[  12] =  -0.21242599312545
lambda[  13] =  -0.03044756157722
lambda[  14] =  -0.01822751197813
lambda[  15] =   0.00436760458984
lambda[  16] =   0.01166576257591
lambda[  17] =   0.01694070464452
lambda[  18] =   0.03274692420705
lambda[  19] =   0.05023681472334
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 6.874 ms
rank =  0, Distributing orbital back into band + domain format took 17.043 ms
rank = 0, Subspace_Rotation used 23.929 ms

Total time for subspace rotation: 23.933 ms
rank = 0, Efermi =  -0.060069570842 calculate fermi energy took 0.588 ms
rank = 0, --- Calculate rho: sum over local bands took 5.249 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.503 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1516.891 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.839 ms
rank = 0, D2D took 1.942 ms
rank = 0, Transfering density took 1.948 ms
Etot    =   -47.435594153085
Eband   =   -12.111110265607
E1      =    25.931157781196
E2      =   -11.539548185986
E3      =   -15.818601330750
Exc     =   -14.066005996208
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 7.108e-05, dEband = 1.260e-02
rank = 0, Calculating/Estimating energy took 0.916 ms, Etot = -47.435594153, dEtot = 7.108e-05, dEband = 1.260e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6515477389687, which took 0.061 ms

iter_count = 114, r_2norm = 1.671e-05, tol*||rhs|| = 2.606e-05

Anderson update took 64.225 ms, out of which F'*F took 28.526 ms; b-Ax took 194.312 ms, out of which Lap took 174.270 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.126 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200355, int_b + int_rho = -1.091e-14, checking this took 0.113 ms
2-norm of RHS = 693.1163610835889, which took 0.170 ms

iter_count = 234, r_2norm = 6.101e-04, tol*||rhs|| = 6.931e-04

Anderson update took 128.825 ms, out of which F'*F took 58.248 ms; b-Ax took 398.654 ms, out of which Lap took 357.756 ms
Solving Poisson took 842.337 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.275361 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.305680 
Total time for convolution: 	 convolve: 5.202628 
Total time for convolution: 	 convolve: 5.174492 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.165 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 3.508 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.054 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.596 ms

This SCF took 27742.605 ms, scf error = 4.131e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.150237, lowerbound = -1.050636, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1413.068 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.091 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.605 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.711 ms
rank =  0, finding HY took 23.505 ms
rank =  0, distributing HY into block cyclic form took 17.116 ms
rank =  0, finding Y'*HY took 3.556 ms
Rank 0, Project_Hamiltonian used 63.915 ms
Total time for projection: 63.929 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -1.047753665601556
    last  calculated eigval = 0.049255230805792
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66430004731150
lambda[   4] =  -0.53535940367711
lambda[   5] =  -0.47519579725103
lambda[   6] =  -0.46717549972246
lambda[   7] =  -0.44776206286133
lambda[   8] =  -0.38207044496225
lambda[   9] =  -0.36083025927662
lambda[  10] =  -0.28887724957073
lambda[  11] =  -0.26358480203535
lambda[  12] =  -0.21026090083434
lambda[  13] =  -0.03044483743904
lambda[  14] =  -0.01729266387151
lambda[  15] =   0.00439868135221
lambda[  16] =   0.01178978449669
lambda[  17] =   0.01574170450832
lambda[  18] =   0.02958733989946
lambda[  19] =   0.04925523080579
==subpsace eigenproblem: bcast eigvals took 0.040 ms
Total time for solving subspace eigenvalue problem: 0.265 ms
rank =  0, subspace rotation using ScaLAPACK took 6.846 ms
rank =  0, Distributing orbital back into band + domain format took 17.024 ms
rank = 0, Subspace_Rotation used 23.882 ms

Total time for subspace rotation: 23.887 ms
rank = 0, Efermi =  -0.060066846703 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.281 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.407 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.639 ms
rank = 0, Calculating density took 1517.629 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.863 ms
rank = 0, D2D took 1.960 ms
rank = 0, Transfering density took 1.963 ms
Etot    =   -47.435429211763
Eband   =   -12.057998068658
E1      =    25.910781517428
E2      =   -11.504304690200
E3      =   -15.825969770689
Exc     =   -14.070701932220
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 2.062e-05, dEband = 6.639e-03
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -47.435429212, dEtot = 2.062e-05, dEband = 6.639e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3231627201656, which took 0.057 ms

iter_count = 108, r_2norm = 1.261e-05, tol*||rhs|| = 1.293e-05

Anderson update took 57.791 ms, out of which F'*F took 27.104 ms; b-Ax took 184.002 ms, out of which Lap took 164.430 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.195 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200355, int_b + int_rho = -1.455e-14, checking this took 0.110 ms
2-norm of RHS = 693.3207871913962, which took 0.144 ms

iter_count = 240, r_2norm = 5.855e-04, tol*||rhs|| = 6.933e-04

Anderson update took 128.859 ms, out of which F'*F took 60.686 ms; b-Ax took 406.711 ms, out of which Lap took 364.634 ms
Solving Poisson took 861.374 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.184864 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.799 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.163084 
Total time for convolution: 	 convolve: 5.178868 
Total time for convolution: 	 convolve: 5.169823 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 3.601 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.738 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.377 ms

This SCF took 27456.328 ms, scf error = 2.186e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.149255, lowerbound = -1.047754, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1420.047 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.121 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.569 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.703 ms
rank =  0, finding HY took 23.422 ms
rank =  0, distributing HY into block cyclic form took 17.180 ms
rank =  0, finding Y'*HY took 3.517 ms
Rank 0, Project_Hamiltonian used 63.848 ms
Total time for projection: 63.856 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.205 ms
    first calculated eigval = -1.044101321683064
    last  calculated eigval = 0.049903172024760
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66091977817373
lambda[   4] =  -0.53228668301149
lambda[   5] =  -0.47193995808944
lambda[   6] =  -0.46350319793034
lambda[   7] =  -0.44390025230061
lambda[   8] =  -0.37909995941544
lambda[   9] =  -0.35755792478895
lambda[  10] =  -0.28504945208752
lambda[  11] =  -0.26004023339051
lambda[  12] =  -0.20708720668977
lambda[  13] =  -0.02923027532206
lambda[  14] =  -0.01473039519032
lambda[  15] =   0.00604178864115
lambda[  16] =   0.01323658067809
lambda[  17] =   0.01613861500893
lambda[  18] =   0.02753864058968
lambda[  19] =   0.04990317202476
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 6.841 ms
rank =  0, Distributing orbital back into band + domain format took 17.150 ms
rank = 0, Subspace_Rotation used 24.003 ms

Total time for subspace rotation: 24.008 ms
rank = 0, Efermi =  -0.058852284528 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.292 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.469 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.610 ms
rank = 0, Calculating density took 1524.633 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.019 ms
rank = 0, D2D took 2.114 ms
rank = 0, Transfering density took 2.116 ms
Etot    =   -47.435385601369
Eband   =   -11.975266170782
E1      =    25.870215170727
E2      =   -11.459163841156
E3      =   -15.836332356715
Exc     =   -14.078045609984
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 5.451e-06, dEband = 1.034e-02
rank = 0, Calculating/Estimating energy took 1.109 ms, Etot = -47.435385601, dEtot = 5.451e-06, dEband = 1.034e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3239835592699, which took 0.059 ms

iter_count = 102, r_2norm = 1.176e-05, tol*||rhs|| = 1.296e-05

Anderson update took 54.760 ms, out of which F'*F took 25.634 ms; b-Ax took 173.146 ms, out of which Lap took 155.614 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.499 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200345, int_b + int_rho = -1.164e-13, checking this took 0.116 ms
2-norm of RHS = 693.3119240595092, which took 0.114 ms

iter_count = 216, r_2norm = 6.657e-04, tol*||rhs|| = 6.933e-04

Anderson update took 115.747 ms, out of which F'*F took 54.903 ms; b-Ax took 366.977 ms, out of which Lap took 329.927 ms
Solving Poisson took 775.871 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.130 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.172947 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.387111 
Total time for convolution: 	 convolve: 5.158690 
Total time for convolution: 	 convolve: 5.190499 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.416 ms
---Transfer Veff_loc: D2D took 3.517 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.054 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.606 ms

This SCF took 27580.769 ms, scf error = 9.902e-04
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.149903, lowerbound = -1.044101, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1417.412 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.048 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.575 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.635 ms
rank =  0, finding HY took 23.450 ms
rank =  0, distributing HY into block cyclic form took 17.094 ms
rank =  0, finding Y'*HY took 3.525 ms
Rank 0, Project_Hamiltonian used 63.727 ms
Total time for projection: 63.736 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.080 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -1.042451733094822
    last  calculated eigval = 0.050904373041003
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65955514207874
lambda[   4] =  -0.53101092031611
lambda[   5] =  -0.47052996641583
lambda[   6] =  -0.46188200100434
lambda[   7] =  -0.44210913581875
lambda[   8] =  -0.37787493365260
lambda[   9] =  -0.35610790939118
lambda[  10] =  -0.28323166731044
lambda[  11] =  -0.25822362306195
lambda[  12] =  -0.20550560159605
lambda[  13] =  -0.02736554770652
lambda[  14] =  -0.01284550813373
lambda[  15] =   0.00869799651457
lambda[  16] =   0.01551162475695
lambda[  17] =   0.01722051409849
lambda[  18] =   0.02746820787323
lambda[  19] =   0.05090437304100
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.239 ms
rank =  0, subspace rotation using ScaLAPACK took 6.831 ms
rank =  0, Distributing orbital back into band + domain format took 17.093 ms
rank = 0, Subspace_Rotation used 23.936 ms

Total time for subspace rotation: 23.941 ms
rank = 0, Efermi =  -0.056987556933 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.255 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.535 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1521.812 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.817 ms
rank = 0, D2D took 1.913 ms
rank = 0, Transfering density took 1.915 ms
Etot    =   -47.435462644898
Eband   =   -11.937690694398
E1      =    25.852008758817
E2      =   -11.439014136383
E3      =   -15.839100211946
Exc     =   -14.080109868445
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 9.630e-06, dEband = 4.697e-03
rank = 0, Calculating/Estimating energy took 0.943 ms, Etot = -47.435462645, dEtot = 9.630e-06, dEband = 4.697e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1392157248521, which took 0.073 ms

iter_count = 108, r_2norm = 4.336e-06, tol*||rhs|| = 5.569e-06

Anderson update took 58.123 ms, out of which F'*F took 27.107 ms; b-Ax took 182.388 ms, out of which Lap took 163.977 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.351 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200359, int_b + int_rho = 2.183e-14, checking this took 0.110 ms
2-norm of RHS = 693.3143781648579, which took 0.105 ms

iter_count = 204, r_2norm = 6.557e-04, tol*||rhs|| = 6.933e-04

Anderson update took 108.517 ms, out of which F'*F took 51.391 ms; b-Ax took 346.875 ms, out of which Lap took 311.206 ms
Solving Poisson took 732.972 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.210525 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.190106 
Total time for convolution: 	 convolve: 5.178727 
Total time for convolution: 	 convolve: 5.181591 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.375 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.301 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.887 ms
---Transfer Veff_loc: D2D took 3.508 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.059 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.603 ms

This SCF took 27404.857 ms, scf error = 7.145e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.150904, lowerbound = -1.042452, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1409.608 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.144 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.570 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.727 ms
rank =  0, finding HY took 23.535 ms
rank =  0, distributing HY into block cyclic form took 17.177 ms
rank =  0, finding Y'*HY took 3.533 ms
Rank 0, Project_Hamiltonian used 63.997 ms
Total time for projection: 64.007 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -1.041679891397816
    last  calculated eigval = 0.051038524826240
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65860361546028
lambda[   4] =  -0.53003649588845
lambda[   5] =  -0.46960561073356
lambda[   6] =  -0.46108023186069
lambda[   7] =  -0.44132468016454
lambda[   8] =  -0.37687896069286
lambda[   9] =  -0.35526153381975
lambda[  10] =  -0.28249308078472
lambda[  11] =  -0.25750283681465
lambda[  12] =  -0.20470736980378
lambda[  13] =  -0.02514432254675
lambda[  14] =  -0.01110686153058
lambda[  15] =   0.01168946257788
lambda[  16] =   0.01821491653466
lambda[  17] =   0.01917619999058
lambda[  18] =   0.02812811848856
lambda[  19] =   0.05103852482624
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.239 ms
rank =  0, subspace rotation using ScaLAPACK took 6.829 ms
rank =  0, Distributing orbital back into band + domain format took 17.139 ms
rank = 0, Subspace_Rotation used 23.979 ms

Total time for subspace rotation: 23.985 ms
rank = 0, Efermi =  -0.054766331789 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.080 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.573 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 1514.196 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.852 ms
rank = 0, D2D took 1.947 ms
rank = 0, Transfering density took 1.949 ms
Etot    =   -47.435484405953
Eband   =   -11.917666034143
E1      =    25.842610775775
E2      =   -11.428254918418
E3      =   -15.839909783258
Exc     =   -14.080808660060
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 2.720e-06, dEband = 2.503e-03
rank = 0, Calculating/Estimating energy took 1.080 ms, Etot = -47.435484406, dEtot = 2.720e-06, dEband = 2.503e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0675182820722, which took 0.375 ms

iter_count = 108, r_2norm = 2.500e-06, tol*||rhs|| = 2.701e-06

Anderson update took 58.103 ms, out of which F'*F took 27.316 ms; b-Ax took 184.348 ms, out of which Lap took 166.132 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.343 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200346, int_b + int_rho = -9.823e-14, checking this took 0.110 ms
2-norm of RHS = 693.3127728738687, which took 0.121 ms

iter_count = 198, r_2norm = 6.100e-04, tol*||rhs|| = 6.933e-04

Anderson update took 105.853 ms, out of which F'*F took 49.953 ms; b-Ax took 337.508 ms, out of which Lap took 301.970 ms
Solving Poisson took 709.046 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.194277 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.748 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.188591 
Total time for convolution: 	 convolve: 5.174387 
Total time for convolution: 	 convolve: 5.182375 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.870 ms
---Transfer Veff_loc: D2D took 3.544 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.044 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.620 ms

This SCF took 27361.393 ms, scf error = 4.381e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.151039, lowerbound = -1.041680, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1417.976 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.086 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.542 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.652 ms
rank =  0, finding HY took 23.596 ms
rank =  0, distributing HY into block cyclic form took 17.185 ms
rank =  0, finding Y'*HY took 3.549 ms
Rank 0, Project_Hamiltonian used 64.010 ms
Total time for projection: 64.021 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -1.040462827259483
    last  calculated eigval = 0.049554343780386
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65751418377628
lambda[   4] =  -0.52902346423283
lambda[   5] =  -0.46851878940159
lambda[   6] =  -0.45992024916884
lambda[   7] =  -0.44020067622759
lambda[   8] =  -0.37586320016809
lambda[   9] =  -0.35418025454783
lambda[  10] =  -0.28136500395921
lambda[  11] =  -0.25634865841345
lambda[  12] =  -0.20363126787172
lambda[  13] =  -0.02159724523229
lambda[  14] =  -0.00957280059097
lambda[  15] =   0.01546037620483
lambda[  16] =   0.02244885514740
lambda[  17] =   0.02371427624333
lambda[  18] =   0.02928619353996
lambda[  19] =   0.04955434378039
==subpsace eigenproblem: bcast eigvals took 0.074 ms
Total time for solving subspace eigenvalue problem: 0.298 ms
rank =  0, subspace rotation using ScaLAPACK took 6.838 ms
rank =  0, Distributing orbital back into band + domain format took 17.143 ms
rank = 0, Subspace_Rotation used 23.993 ms

Total time for subspace rotation: 23.998 ms
rank = 0, Efermi =  -0.051219254669 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.057 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.906 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.574 ms
rank = 0, Calculating density took 1522.951 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.826 ms
rank = 0, D2D took 1.926 ms
rank = 0, Transfering density took 1.929 ms
Etot    =   -47.435522761541
Eband   =   -11.890972852046
E1      =    25.828758958185
E2      =   -11.414968264167
E3      =   -15.842001511464
Exc     =   -14.082493454110
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 4.794e-06, dEband = 3.337e-03
rank = 0, Calculating/Estimating energy took 0.927 ms, Etot = -47.435522762, dEtot = 4.794e-06, dEband = 3.337e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0655663859877, which took 0.053 ms

iter_count = 108, r_2norm = 1.900e-06, tol*||rhs|| = 2.623e-06

Anderson update took 58.350 ms, out of which F'*F took 27.273 ms; b-Ax took 184.803 ms, out of which Lap took 166.532 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.412 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200349, int_b + int_rho = -7.640e-14, checking this took 0.258 ms
2-norm of RHS = 693.3244546470337, which took 0.116 ms

iter_count = 168, r_2norm = 6.865e-04, tol*||rhs|| = 6.933e-04

Anderson update took 89.570 ms, out of which F'*F took 42.618 ms; b-Ax took 285.534 ms, out of which Lap took 256.626 ms
Solving Poisson took 603.226 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Total time for convolution: 	 convolve: 5.214278 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.168 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.174448 
Total time for convolution: 	 convolve: 5.158322 
Total time for convolution: 	 convolve: 5.160909 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.740 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.473 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.508 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.050 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.592 ms

This SCF took 27228.964 ms, scf error = 2.385e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.149554, lowerbound = -1.040463, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1420.597 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.093 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.509 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.616 ms
rank =  0, finding HY took 23.448 ms
rank =  0, distributing HY into block cyclic form took 17.196 ms
rank =  0, finding Y'*HY took 3.625 ms
Rank 0, Project_Hamiltonian used 63.906 ms
Total time for projection: 63.915 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -1.040158852134952
    last  calculated eigval = 0.046797181079532
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65717994935615
lambda[   4] =  -0.52868681827581
lambda[   5] =  -0.46818259909908
lambda[   6] =  -0.45960313254499
lambda[   7] =  -0.43989513442467
lambda[   8] =  -0.37551569599422
lambda[   9] =  -0.35386307399874
lambda[  10] =  -0.28106847491039
lambda[  11] =  -0.25604517855267
lambda[  12] =  -0.20331051722492
lambda[  13] =  -0.02006510658480
lambda[  14] =  -0.00977214766877
lambda[  15] =   0.01638531707762
lambda[  16] =   0.02360909385150
lambda[  17] =   0.02567514443557
lambda[  18] =   0.02984167168795
lambda[  19] =   0.04679718107953
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.252 ms
rank =  0, subspace rotation using ScaLAPACK took 6.815 ms
rank =  0, Distributing orbital back into band + domain format took 17.468 ms
rank = 0, Subspace_Rotation used 24.296 ms

Total time for subspace rotation: 24.301 ms
rank = 0, Efermi =  -0.049687116996 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 5.268 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.420 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.574 ms
rank = 0, Calculating density took 1525.508 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.814 ms
rank = 0, D2D took 1.915 ms
rank = 0, Transfering density took 1.918 ms
Etot    =   -47.435587563785
Eband   =   -11.883331044006
E1      =    25.825422690055
E2      =   -11.410598522817
E3      =   -15.842113513480
Exc     =   -14.082606056930
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 8.100e-06, dEband = 9.552e-04
rank = 0, Calculating/Estimating energy took 0.914 ms, Etot = -47.435587564, dEtot = 8.100e-06, dEband = 9.552e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0543520391195, which took 0.087 ms

iter_count = 108, r_2norm = 1.718e-06, tol*||rhs|| = 2.174e-06

Anderson update took 57.652 ms, out of which F'*F took 27.335 ms; b-Ax took 184.726 ms, out of which Lap took 165.648 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.741 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200346, int_b + int_rho = -1.055e-13, checking this took 0.104 ms
2-norm of RHS = 693.3226601606019, which took 0.112 ms

iter_count = 150, r_2norm = 6.830e-04, tol*||rhs|| = 6.933e-04

Anderson update took 80.378 ms, out of which F'*F took 37.981 ms; b-Ax took 255.829 ms, out of which Lap took 229.427 ms
Solving Poisson took 539.651 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.338775 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.165777 
Total time for convolution: 	 convolve: 5.158704 
Total time for convolution: 	 convolve: 5.204094 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.524 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.489 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.065 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.586 ms

This SCF took 27321.102 ms, scf error = 2.110e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.146797, lowerbound = -1.040159, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1418.656 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 16.982 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.493 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.487 ms
rank =  0, finding HY took 23.581 ms
rank =  0, distributing HY into block cyclic form took 17.128 ms
rank =  0, finding Y'*HY took 3.600 ms
Rank 0, Project_Hamiltonian used 63.819 ms
Total time for projection: 63.828 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.212 ms
    first calculated eigval = -1.039935027470267
    last  calculated eigval = 0.045064765694602
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65697984462119
lambda[   4] =  -0.52849692593187
lambda[   5] =  -0.46798280684112
lambda[   6] =  -0.45937582675046
lambda[   7] =  -0.43966192322900
lambda[   8] =  -0.37533478913425
lambda[   9] =  -0.35365653322070
lambda[  10] =  -0.28083170033186
lambda[  11] =  -0.25580803920928
lambda[  12] =  -0.20309679804612
lambda[  13] =  -0.01895079309631
lambda[  14] =  -0.00979240944644
lambda[  15] =   0.01682832373077
lambda[  16] =   0.02423821086457
lambda[  17] =   0.02675733914818
lambda[  18] =   0.03082593354573
lambda[  19] =   0.04506476569460
==subpsace eigenproblem: bcast eigvals took 0.044 ms
Total time for solving subspace eigenvalue problem: 0.262 ms
rank =  0, subspace rotation using ScaLAPACK took 6.855 ms
rank =  0, Distributing orbital back into band + domain format took 17.388 ms
rank = 0, Subspace_Rotation used 24.255 ms

Total time for subspace rotation: 24.259 ms
rank = 0, Efermi =  -0.048572808630 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 5.212 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.475 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.586 ms
rank = 0, Calculating density took 1523.391 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.815 ms
rank = 0, D2D took 1.911 ms
rank = 0, Transfering density took 1.913 ms
Etot    =   -47.435616109244
Eband   =   -11.878152818356
E1      =    25.822600314437
E2      =   -11.408126065071
E3      =   -15.842566346526
Exc     =   -14.082970827721
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 3.568e-06, dEband = 6.473e-04
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -47.435616109, dEtot = 3.568e-06, dEband = 6.473e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0352827080715, which took 0.091 ms

iter_count = 108, r_2norm = 1.362e-06, tol*||rhs|| = 1.411e-06

Anderson update took 58.062 ms, out of which F'*F took 27.281 ms; b-Ax took 183.957 ms, out of which Lap took 165.436 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.524 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200338, int_b + int_rho = -1.855e-13, checking this took 0.099 ms
2-norm of RHS = 693.3264366640501, which took 0.098 ms

iter_count = 144, r_2norm = 5.698e-04, tol*||rhs|| = 6.933e-04

Anderson update took 77.153 ms, out of which F'*F took 36.164 ms; b-Ax took 245.009 ms, out of which Lap took 219.522 ms
Solving Poisson took 517.264 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.180362 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.943 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.588483 
Total time for convolution: 	 convolve: 5.190965 
Total time for convolution: 	 convolve: 5.193321 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
---Transfer Veff_loc: D2D took 3.537 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.904 ms

This SCF took 27617.441 ms, scf error = 1.394e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.145065, lowerbound = -1.039935, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1411.389 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.038 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.485 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.536 ms
rank =  0, finding HY took 23.510 ms
rank =  0, distributing HY into block cyclic form took 17.250 ms
rank =  0, finding Y'*HY took 3.690 ms
Rank 0, Project_Hamiltonian used 64.010 ms
Total time for projection: 64.019 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.431 ms
rank = 0, Solve_Generalized_EigenProblem used 0.571 ms
    first calculated eigval = -1.039742548168921
    last  calculated eigval = 0.043821948665947
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65679652194713
lambda[   4] =  -0.52832047263672
lambda[   5] =  -0.46780004971654
lambda[   6] =  -0.45919060849750
lambda[   7] =  -0.43947753952817
lambda[   8] =  -0.37515856868088
lambda[   9] =  -0.35347804475219
lambda[  10] =  -0.28064991612048
lambda[  11] =  -0.25562438243400
lambda[  12] =  -0.20291982429781
lambda[  13] =  -0.01860686404470
lambda[  14] =  -0.00994040989122
lambda[  15] =   0.01651200380277
lambda[  16] =   0.02411428184721
lambda[  17] =   0.02691567337498
lambda[  18] =   0.03147199815720
lambda[  19] =   0.04382194866595
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.587 ms
rank =  0, subspace rotation using ScaLAPACK took 6.897 ms
rank =  0, Distributing orbital back into band + domain format took 17.081 ms
rank = 0, Subspace_Rotation used 23.995 ms

Total time for subspace rotation: 23.999 ms
rank = 0, Efermi =  -0.048228886130 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.401 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.176 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.639 ms
rank = 0, Calculating density took 1516.717 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.841 ms
rank = 0, D2D took 1.947 ms
rank = 0, Transfering density took 1.954 ms
Etot    =   -47.435640747981
Eband   =   -11.873772101230
E1      =    25.820398344167
E2      =   -11.405837276122
E3      =   -15.842918165116
Exc     =   -14.083237242955
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 3.080e-06, dEband = 5.476e-04
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -47.435640748, dEtot = 3.080e-06, dEband = 5.476e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0240511498328, which took 0.171 ms

iter_count = 114, r_2norm = 6.216e-07, tol*||rhs|| = 9.620e-07

Anderson update took 64.541 ms, out of which F'*F took 28.578 ms; b-Ax took 193.293 ms, out of which Lap took 173.747 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.334 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200351, int_b + int_rho = -5.093e-14, checking this took 0.112 ms
2-norm of RHS = 693.3299615802761, which took 0.104 ms

iter_count = 132, r_2norm = 6.808e-04, tol*||rhs|| = 6.933e-04

Anderson update took 72.224 ms, out of which F'*F took 32.753 ms; b-Ax took 221.832 ms, out of which Lap took 199.029 ms
Solving Poisson took 476.193 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.161969 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.840 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.240036 
Total time for convolution: 	 convolve: 5.230574 
Total time for convolution: 	 convolve: 5.279099 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.516 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.488 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.039 ms

This SCF took 27358.997 ms, scf error = 1.081e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.143822, lowerbound = -1.039743, upperbound = 267.579606

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1415.979 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.158 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.485 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.655 ms
rank =  0, finding HY took 23.679 ms
rank =  0, distributing HY into block cyclic form took 17.352 ms
rank =  0, finding Y'*HY took 3.597 ms
Rank 0, Project_Hamiltonian used 64.330 ms
Total time for projection: 64.340 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -1.039589279140070
    last  calculated eigval = 0.043948264889584
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65666162194753
lambda[   4] =  -0.52819511866514
lambda[   5] =  -0.46766396904244
lambda[   6] =  -0.45905090697562
lambda[   7] =  -0.43934299224462
lambda[   8] =  -0.37503070174019
lambda[   9] =  -0.35334491837044
lambda[  10] =  -0.28051709674143
lambda[  11] =  -0.25548603412639
lambda[  12] =  -0.20278858526653
lambda[  13] =  -0.01806120888923
lambda[  14] =  -0.00994640106642
lambda[  15] =   0.01645985101093
lambda[  16] =   0.02433426959935
lambda[  17] =   0.02753057248631
lambda[  18] =   0.03150875108933
lambda[  19] =   0.04394826488958
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.249 ms
rank =  0, subspace rotation using ScaLAPACK took 6.882 ms
rank =  0, Distributing orbital back into band + domain format took 17.127 ms
rank = 0, Subspace_Rotation used 24.020 ms

Total time for subspace rotation: 24.025 ms
rank = 0, Efermi =  -0.047683246400 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.298 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.395 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.578 ms
rank = 0, Calculating density took 1521.022 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.822 ms
rank = 0, D2D took 1.916 ms
rank = 0, Transfering density took 1.919 ms
Etot    =   -47.435659533109
Eband   =   -11.870506401726
E1      =    25.818836387293
E2      =   -11.404063298031
E3      =   -15.843097130774
Exc     =   -14.083364758280
Esc     =   -74.547785188835
Entropy =    -0.000000000366
dE = 2.348e-06, dEband = 4.082e-04
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -47.435659533, dEtot = 2.348e-06, dEband = 4.082e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0214436913846, which took 0.098 ms

iter_count = 108, r_2norm = 6.000e-07, tol*||rhs|| = 8.577e-07

Anderson update took 57.909 ms, out of which F'*F took 27.124 ms; b-Ax took 183.739 ms, out of which Lap took 164.697 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.325 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000001200356, int_rho =  24.00000001200351, int_b + int_rho = -5.457e-14, checking this took 0.109 ms
2-norm of RHS = 693.3312136168485, which took 0.132 ms

iter_count = 138, r_2norm = 6.497e-04, tol*||rhs|| = 6.933e-04

Anderson update took 73.970 ms, out of which F'*F took 34.741 ms; b-Ax took 235.009 ms, out of which Lap took 210.304 ms
Solving Poisson took 496.966 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.182174 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.895 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.250913 
Total time for convolution: 	 convolve: 5.213588 
Total time for convolution: 	 convolve: 5.288195 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
---Transfer Veff_loc: D2D took 3.551 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.346 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.933 ms

This SCF took 27789.404 ms, scf error = 8.258e-05
The last 17 occupations of kpoints #1 are (Nelectron = 24):
lambda[   3] =  -0.65666162194753, occ[   3] =   2.00000000000000
lambda[   4] =  -0.52819511866514, occ[   4] =   2.00000000000000
lambda[   5] =  -0.46766396904244, occ[   5] =   2.00000000000000
lambda[   6] =  -0.45905090697562, occ[   6] =   2.00000000000000
lambda[   7] =  -0.43934299224462, occ[   7] =   2.00000000000000
lambda[   8] =  -0.37503070174019, occ[   8] =   2.00000000000000
lambda[   9] =  -0.35334491837044, occ[   9] =   2.00000000000000
lambda[  10] =  -0.28051709674143, occ[  10] =   2.00000000000000
lambda[  11] =  -0.25548603412639, occ[  11] =   2.00000000000000
lambda[  12] =  -0.20278858526653, occ[  12] =   2.00000000000000
lambda[  13] =  -0.01806120888923, occ[  13] =   0.00000001200314
lambda[  14] =  -0.00994640106642, occ[  14] =   0.00000000000038
lambda[  15] =   0.01645985101093, occ[  15] =   0.00000000000000
lambda[  16] =   0.02433426959935, occ[  16] =   0.00000000000000
lambda[  17] =   0.02753057248631, occ[  17] =   0.00000000000000
lambda[  18] =   0.03150875108933, occ[  18] =   0.00000000000000
lambda[  19] =   0.04394826488958, occ[  19] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 17 (90%) = 0.000000000000000.
Occupation of state 19 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.574 ms, time for Allreduce/Reduce: 8.949 ms 
Time for calculating local force components: 19.303 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000229146858  -1.09984131825708   0.00000019614398
 -0.00000318874455   1.09983827741481  -0.00000014574796
  0.02934987127741  -0.00000002656212  -0.04275252047168
 -0.02934997572297  -0.00000003716702  -0.04275252779406
  0.02934987635656  -0.00000004385751   0.04275252300322
 -0.02934999469034  -0.00000002618422   0.04275253632941
  0.23284375687111  -0.00000162612068   0.00000005935996
 -0.23284672116401  -0.00000156982237   0.00000007806358
force_loc = 
  0.00000082427369   1.07509547475076   0.00000035691979
 -0.00000113480135  -1.07509619687931  -0.00000234276434
 -0.03291552517219   0.00000056852098   0.04749867341836
  0.03291571256260   0.00000010386271   0.04749965590718
 -0.03291545431366  -0.00000008829970  -0.04749890501147
  0.03291511229011   0.00000022589206  -0.04749934915706
 -0.22201098741532   0.00000083341878   0.00000025191643
  0.22201326809080   0.00000180344273  -0.00000178118666
Time for calculating nonlocal force components: 37.914 ms
[32mforces_xc: 
[0m[32m  0.00000016246070   0.03318813948545  -0.00000004165351
[0m[32m  0.00000016039459  -0.03318809869206  -0.00000014016786
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.01074314662934  -0.00000000600617   0.00000001922797
[0m[32m  0.01074326056241   0.00000005306330  -0.00000009585313
[0mTime for calculating XC forces components: 25.821 ms
 Cartesian force = 
 -0.00000050286139   0.00844274072872   0.00000094884999
 -0.00000336127852  -0.00844557340698  -0.00000219124042
 -0.00356485202199   0.00000098670845   0.00474659038641
  0.00356653871241   0.00000051144527   0.00474756555285
 -0.00356477608431   0.00000031259237  -0.00474594456851
  0.00356591947256   0.00000064445742  -0.00474637538792
  0.00009042469924  -0.00000035395849   0.00000076794410
 -0.00008939063801   0.00000073143325  -0.00000136153649
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.435 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.398 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.393 ms
Time for printing density: 383.996 ms
The program took 419.447 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:34:50
Job ID:        2266863
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:25:48,vmem=8348K,walltime=00:07:09,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-16-1
---------------------------------------
