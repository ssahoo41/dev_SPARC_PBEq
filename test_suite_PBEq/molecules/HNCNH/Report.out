---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:37
Job ID:    2266449
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:44
Job ID:    2266449
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.062 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 11.490 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 50.948 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 77.010 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.961 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.090 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.201002	   13.272208	   10.570302	
    8.798998	    6.727792	   10.570302	
   10.000000	   10.000000	    9.621168	
   10.000000	   12.316464	    9.429698	
   10.000000	    7.683536	    9.429698	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.164 ms
Set up communicators.

--set up spincomm took 2.288 ms

--set up kptcomm took 0.355 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.088 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.368 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.406 ms

Calculate_SplineDerivRadFun took 0.199 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.303 ms.
time spent on vectorized spline interp: 2.226 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.006 ms.
time spent on vectorized spline interp: 1.689 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.518 ms.
time spent on vectorized spline interp: 1.669 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.513 ms.

Calculating rb for all atom types took 14.932 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.912 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000154273, sum_int_rho = 15.7942154455866
PosCharge = 16.000000015427, NegCharge = -15.794215445587, scal_fac = 1.013029109964
After scaling, int_rho = 16.0000000154273, PosCharge + NegCharge - NetCharge = 0.000e+00
--Calculate Vref took 0.345 ms
--Calculate rho_guess took 2.113 ms

 integral of b = -16.0000000154273,
 int{b} + Nelectron + NetCharge = -1.543e-08,
 Esc = -46.3965769321678,
 MPI_Reduce took 5.207 ms

Calculating b & b_ref took 13.087 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.021 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.103 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 26.913 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542721, int_b + int_rho = -6.185e-14, checking this took 0.089 ms
2-norm of RHS = 554.6168418064912, which took 0.495 ms

iter_count = 420, r_2norm = 5.291e-04, tol*||rhs|| = 5.546e-04

Anderson update took 237.343 ms, out of which F'*F took 107.667 ms; b-Ax took 715.364 ms, out of which Lap took 641.843 ms
Solving Poisson took 1523.724 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.451 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.784 ms
Total time for convolution: 	 convolve: 5.186048 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
Total time for convolution: 	 convolve: 5.171787 
Total time for convolution: 	 convolve: 5.141551 
Total time for convolution: 	 convolve: 5.123693 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.730 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.506 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
rank = 0, XC calculation took 24455.533 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 1.101 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.777 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 2.990 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.134 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.655 ms
    Lanczos iter 53, eigmin  = -0.995311479, eigmax = 264.924937842, err_eigmin = 3.240e-04, err_eigmax = 9.758e-03
rank =   0, Lanczos took 123.963 ms, eigmin = -0.995311478789, eigmax = 267.574187220182

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.239438, lowerbound = -1.095311, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1147.731 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.991 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.538 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.244 ms
rank =  0, Distribute data + matrix mult took 20.791 ms
rank =  0, finding HY took 18.815 ms
rank =  0, distributing HY into block cyclic form took 13.452 ms
rank =  0, finding Y'*HY took 2.077 ms
Rank 0, Project_Hamiltonian used 55.162 ms
Total time for projection: 55.173 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.419 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 1.263 ms
    first calculated eigval = 2.793956958116214
    last  calculated eigval = 3.181728087114757
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.79395695811621
lambda[   2] =   2.84241213835471
lambda[   3] =   2.85509722793206
lambda[   4] =   2.91093371431316
lambda[   5] =   2.93768862846228
lambda[   6] =   2.99097376578681
lambda[   7] =   3.01559365822603
lambda[   8] =   3.03539112754127
lambda[   9] =   3.07279927098762
lambda[  10] =   3.08773009581686
lambda[  11] =   3.11885132974375
lambda[  12] =   3.13107832526037
lambda[  13] =   3.16716933342020
lambda[  14] =   3.18172808711476
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.280 ms
rank =  0, subspace rotation using ScaLAPACK took 3.221 ms
rank =  0, Distributing orbital back into band + domain format took 12.046 ms
rank = 0, Subspace_Rotation used 15.279 ms

Total time for subspace rotation: 15.283 ms
rank = 0, Efermi =   3.054095231690 calculate fermi energy took 0.044 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.281728, lowerbound = -1.095311, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1157.697 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.615 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.417 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.046 ms
rank =  0, Distribute data + matrix mult took 14.093 ms
rank =  0, finding HY took 18.095 ms
rank =  0, distributing HY into block cyclic form took 12.520 ms
rank =  0, finding Y'*HY took 2.126 ms
Rank 0, Project_Hamiltonian used 46.861 ms
Total time for projection: 46.867 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.727672169487124
    last  calculated eigval = 0.470874732839680
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.72767216948712
lambda[   2] =  -0.67428374106870
lambda[   3] =  -0.35228655524398
lambda[   4] =  -0.25748679738013
lambda[   5] =   0.01174474883810
lambda[   6] =   0.05837212897814
lambda[   7] =   0.20983301603884
lambda[   8] =   0.21467982790097
lambda[   9] =   0.29628674469944
lambda[  10] =   0.34912716804191
lambda[  11] =   0.35778511756281
lambda[  12] =   0.38953835124052
lambda[  13] =   0.43156237571251
lambda[  14] =   0.47087473283968
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 3.258 ms
rank =  0, Distributing orbital back into band + domain format took 12.051 ms
rank = 0, Subspace_Rotation used 15.324 ms

Total time for subspace rotation: 15.327 ms
rank = 0, Efermi =   0.266887866403 calculate fermi energy took 0.020 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.570875, lowerbound = -1.095311, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1124.035 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 15.675 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.431 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 17.126 ms
rank =  0, finding HY took 17.893 ms
rank =  0, distributing HY into block cyclic form took 12.712 ms
rank =  0, finding Y'*HY took 2.039 ms
Rank 0, Project_Hamiltonian used 49.793 ms
Total time for projection: 50.720 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.068 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.997746025715861
    last  calculated eigval = 0.154140069867091
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.99774602571586
lambda[   2] =  -0.95046112674688
lambda[   3] =  -0.63803208030494
lambda[   4] =  -0.60548400668059
lambda[   5] =  -0.45495592646948
lambda[   6] =  -0.45029689635282
lambda[   7] =  -0.34231370163791
lambda[   8] =  -0.31977812256685
lambda[   9] =  -0.02247337926435
lambda[  10] =  -0.00093267286765
lambda[  11] =   0.09161286715699
lambda[  12] =   0.11215356253515
lambda[  13] =   0.12340397720303
lambda[  14] =   0.15414006986709
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.132 ms
rank =  0, subspace rotation using ScaLAPACK took 3.266 ms
rank =  0, Distributing orbital back into band + domain format took 12.054 ms
rank = 0, Subspace_Rotation used 15.333 ms

Total time for subspace rotation: 15.337 ms
rank = 0, Efermi =  -0.051872257614 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.254140, lowerbound = -1.095311, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1094.948 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 22.259 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.443 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 23.749 ms
rank =  0, finding HY took 17.948 ms
rank =  0, distributing HY into block cyclic form took 12.568 ms
rank =  0, finding Y'*HY took 2.165 ms
Rank 0, Project_Hamiltonian used 56.453 ms
Total time for projection: 56.458 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.045 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.998220241610138
    last  calculated eigval = 0.091563102668723
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.99822024161014
lambda[   2] =  -0.95138083558054
lambda[   3] =  -0.64218267792444
lambda[   4] =  -0.60672709145412
lambda[   5] =  -0.46375771694000
lambda[   6] =  -0.45818743082732
lambda[   7] =  -0.36544514611672
lambda[   8] =  -0.36441237473530
lambda[   9] =  -0.08782529627279
lambda[  10] =  -0.06311977216826
lambda[  11] =   0.02857351988828
lambda[  12] =   0.05590754829576
lambda[  13] =   0.05830387962391
lambda[  14] =   0.09156310266872
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.134 ms
rank =  0, subspace rotation using ScaLAPACK took 3.257 ms
rank =  0, Distributing orbital back into band + domain format took 12.064 ms
rank = 0, Subspace_Rotation used 15.334 ms

Total time for subspace rotation: 15.337 ms
rank = 0, Efermi =  -0.117224174554 calculate fermi energy took 0.019 ms
rank = 0, --- Calculate rho: sum over local bands took 5.166 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.715 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 4929.029 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.943 ms
rank = 0, D2D took 1.077 ms
rank = 0, Transfering density took 1.082 ms
Etot    =   -28.023438205395
Eband   =    -9.700627031732
E1      =    19.176005321222
E2      =    -7.965374999599
E3      =    -9.484071642868
Exc     =    -8.551686204717
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 5.605e+00, dEband = 1.940e+00
rank = 0, Calculating/Estimating energy took 0.908 ms, Etot = -28.023438205, dEtot = 5.605e+00, dEband = 1.940e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 44.4473770423769, which took 0.087 ms

iter_count = 96, r_2norm = 1.317e-03, tol*||rhs|| = 1.778e-03

Anderson update took 52.367 ms, out of which F'*F took 24.090 ms; b-Ax took 163.444 ms, out of which Lap took 146.208 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 352.126 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542733, int_b + int_rho = 5.639e-14, checking this took 0.112 ms
2-norm of RHS = 550.5096225330590, which took 0.126 ms

iter_count = 288, r_2norm = 4.725e-04, tol*||rhs|| = 5.505e-04

Anderson update took 154.176 ms, out of which F'*F took 72.915 ms; b-Ax took 493.520 ms, out of which Lap took 443.939 ms
Solving Poisson took 1037.217 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.198 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.102473 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.085536 
Total time for convolution: 	 convolve: 5.112498 
Total time for convolution: 	 convolve: 5.088538 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.342 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.345 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.564 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
---Transfer Veff_loc: D2D took 0.698 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.015 ms

This SCF took 30717.197 ms, scf error = 1.765e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.191563, lowerbound = -0.998220, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1155.038 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.542 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.454 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.015 ms
rank =  0, finding HY took 17.988 ms
rank =  0, distributing HY into block cyclic form took 12.665 ms
rank =  0, finding Y'*HY took 2.039 ms
Rank 0, Project_Hamiltonian used 46.735 ms
Total time for projection: 46.752 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -0.961988095490806
    last  calculated eigval = 0.049256576866800
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.96198809549081
lambda[   2] =  -0.90841548338580
lambda[   3] =  -0.60733500537166
lambda[   4] =  -0.56900163393587
lambda[   5] =  -0.43366535489239
lambda[   6] =  -0.42645662664965
lambda[   7] =  -0.32338803183961
lambda[   8] =  -0.32319047784568
lambda[   9] =  -0.07392570213224
lambda[  10] =  -0.06400793142801
lambda[  11] =   0.00894373386251
lambda[  12] =   0.02890087587489
lambda[  13] =   0.03858491407754
lambda[  14] =   0.04925657686680
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.261 ms
rank =  0, Distributing orbital back into band + domain format took 12.045 ms
rank = 0, Subspace_Rotation used 15.318 ms

Total time for subspace rotation: 15.322 ms
rank = 0, Efermi =  -0.103324582662 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.146 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.657 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.088 ms
rank = 0, Calculating density took 1221.217 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.419 ms
rank = 0, D2D took 0.526 ms
rank = 0, Transfering density took 0.528 ms
Etot    =   -27.965151007561
Eband   =    -9.106881419963
E1      =    18.685589724927
E2      =    -7.889473707643
E3      =    -9.633027926694
Exc     =    -8.669784014227
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 1.166e-02, dEband = 1.187e-01
rank = 0, Calculating/Estimating energy took 0.883 ms, Etot = -27.965151008, dEtot = 1.166e-02, dEband = 1.187e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 17.5130205168642, which took 0.129 ms

iter_count = 102, r_2norm = 5.594e-04, tol*||rhs|| = 7.005e-04

Anderson update took 54.489 ms, out of which F'*F took 25.483 ms; b-Ax took 172.223 ms, out of which Lap took 153.962 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.458 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542717, int_b + int_rho = -1.055e-13, checking this took 0.104 ms
2-norm of RHS = 547.8394926622594, which took 0.132 ms

iter_count = 288, r_2norm = 5.409e-04, tol*||rhs|| = 5.478e-04

Anderson update took 161.737 ms, out of which F'*F took 71.275 ms; b-Ax took 492.961 ms, out of which Lap took 444.115 ms
Solving Poisson took 1056.239 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.527 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.098406 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 113.834 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.086519 
Total time for convolution: 	 convolve: 5.080476 
Total time for convolution: 	 convolve: 5.075495 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.483 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.086 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.427 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.686 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.019 ms

This SCF took 27087.740 ms, scf error = 1.017e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.149257, lowerbound = -0.961988, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1091.322 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.529 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.664 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.004 ms
rank =  0, Distribute data + matrix mult took 19.208 ms
rank =  0, finding HY took 19.374 ms
rank =  0, distributing HY into block cyclic form took 12.680 ms
rank =  0, finding Y'*HY took 2.038 ms
Rank 0, Project_Hamiltonian used 53.326 ms
Total time for projection: 53.339 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.921291695854780
    last  calculated eigval = 0.033784547253972
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.92129169585478
lambda[   2] =  -0.86351885776572
lambda[   3] =  -0.57253611422262
lambda[   4] =  -0.53083727903435
lambda[   5] =  -0.40163998624665
lambda[   6] =  -0.39318673778092
lambda[   7] =  -0.28557514297707
lambda[   8] =  -0.28540449921847
lambda[   9] =  -0.04871622652756
lambda[  10] =  -0.04545354002116
lambda[  11] =  -0.00875893653578
lambda[  12] =   0.00591988835998
lambda[  13] =   0.02969066382967
lambda[  14] =   0.03378454725397
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 3.281 ms
rank =  0, Distributing orbital back into band + domain format took 11.950 ms
rank = 0, Subspace_Rotation used 15.790 ms

Total time for subspace rotation: 15.796 ms
rank = 0, Efermi =  -0.078133880381 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 2.050 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.825 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.092 ms
rank = 0, Calculating density took 1164.251 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.517 ms
rank = 0, D2D took 0.700 ms
rank = 0, Transfering density took 0.708 ms
Etot    =   -27.940551131489
Eband   =    -8.507980626952
E1      =    18.207083472754
E2      =    -7.761253118181
E3      =    -9.787468895960
Exc     =    -8.791799058796
Esc     =   -46.396576932168
Entropy =    -0.000000000468
dE = 4.920e-03, dEband = 1.198e-01
rank = 0, Calculating/Estimating energy took 0.944 ms, Etot = -27.940551131, dEtot = 4.920e-03, dEband = 1.198e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.6078493855829, which took 0.076 ms

iter_count = 102, r_2norm = 2.073e-04, tol*||rhs|| = 2.243e-04

Anderson update took 54.191 ms, out of which F'*F took 25.250 ms; b-Ax took 172.967 ms, out of which Lap took 154.601 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.433 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542733, int_b + int_rho = 5.821e-14, checking this took 0.128 ms
2-norm of RHS = 548.1840403184800, which took 0.118 ms

iter_count = 288, r_2norm = 4.511e-04, tol*||rhs|| = 5.482e-04

Anderson update took 152.578 ms, out of which F'*F took 71.599 ms; b-Ax took 488.228 ms, out of which Lap took 435.554 ms
Solving Poisson took 1039.863 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.188 ms
Total time for convolution: 	 convolve: 5.089356 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.450 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.100971 
Total time for convolution: 	 convolve: 5.090058 
Total time for convolution: 	 convolve: 5.079970 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.294 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.981 ms

This SCF took 26935.427 ms, scf error = 5.065e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.133785, lowerbound = -0.921292, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1160.705 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.570 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.453 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 14.072 ms
rank =  0, finding HY took 17.911 ms
rank =  0, distributing HY into block cyclic form took 12.300 ms
rank =  0, finding Y'*HY took 2.474 ms
Rank 0, Project_Hamiltonian used 46.793 ms
Total time for projection: 46.810 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.893250447958392
    last  calculated eigval = 0.032660229981653
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.89325044795839
lambda[   2] =  -0.83581447289163
lambda[   3] =  -0.55029492346435
lambda[   4] =  -0.50619291740073
lambda[   5] =  -0.37941305456940
lambda[   6] =  -0.37058165267884
lambda[   7] =  -0.26718712482526
lambda[   8] =  -0.26694212749388
lambda[   9] =  -0.03489841325819
lambda[  10] =  -0.02866619524108
lambda[  11] =  -0.02528490741545
lambda[  12] =   0.00687001865428
lambda[  13] =   0.02438531323693
lambda[  14] =   0.03266022998165
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.214 ms
rank =  0, Distributing orbital back into band + domain format took 11.944 ms
rank = 0, Subspace_Rotation used 15.175 ms

Total time for subspace rotation: 15.179 ms
rank = 0, Efermi =  -0.064297704865 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 1.996 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.977 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.093 ms
rank = 0, Calculating density took 1226.336 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
rank = 0, D2D took 0.706 ms
rank = 0, Transfering density took 0.713 ms
Etot    =   -27.934524595987
Eband   =    -8.139353443103
E1      =    17.955688359183
E2      =    -7.628961643270
E3      =    -9.880151598127
Exc     =    -8.863395820828
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 1.205e-03, dEband = 7.373e-02
rank = 0, Calculating/Estimating energy took 0.976 ms, Etot = -27.934524596, dEtot = 1.205e-03, dEband = 7.373e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.9500411840375, which took 0.087 ms

iter_count = 108, r_2norm = 7.864e-05, tol*||rhs|| = 1.180e-04

Anderson update took 57.732 ms, out of which F'*F took 26.988 ms; b-Ax took 181.902 ms, out of which Lap took 163.782 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.002 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542716, int_b + int_rho = -1.128e-13, checking this took 0.138 ms
2-norm of RHS = 548.7254022586277, which took 0.126 ms

iter_count = 258, r_2norm = 4.762e-04, tol*||rhs|| = 5.487e-04

Anderson update took 137.344 ms, out of which F'*F took 64.770 ms; b-Ax took 439.851 ms, out of which Lap took 393.306 ms
Solving Poisson took 926.041 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.083995 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.620 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.122781 
Total time for convolution: 	 convolve: 5.083915 
Total time for convolution: 	 convolve: 5.083139 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.549 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.373 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.185 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.662 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 27326.270 ms, scf error = 1.540e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.132660, lowerbound = -0.893250, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1155.861 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.543 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.460 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.021 ms
rank =  0, finding HY took 18.152 ms
rank =  0, distributing HY into block cyclic form took 12.557 ms
rank =  0, finding Y'*HY took 2.212 ms
Rank 0, Project_Hamiltonian used 46.970 ms
Total time for projection: 46.982 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.042 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.889602229780041
    last  calculated eigval = 0.031953837415513
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88960222978004
lambda[   2] =  -0.83168480879787
lambda[   3] =  -0.54583247738042
lambda[   4] =  -0.50181832899019
lambda[   5] =  -0.37609088370096
lambda[   6] =  -0.36715365565423
lambda[   7] =  -0.26307215539504
lambda[   8] =  -0.26278327269470
lambda[   9] =  -0.03914394789506
lambda[  10] =  -0.02612904743643
lambda[  11] =  -0.02547078897151
lambda[  12] =   0.00694883998928
lambda[  13] =   0.02141712674755
lambda[  14] =   0.03195383741551
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.140 ms
rank =  0, subspace rotation using ScaLAPACK took 3.280 ms
rank =  0, Distributing orbital back into band + domain format took 11.250 ms
rank = 0, Subspace_Rotation used 14.551 ms

Total time for subspace rotation: 14.560 ms
rank = 0, Efermi =  -0.068542826218 calculate fermi energy took 0.315 ms
rank = 0, --- Calculate rho: sum over local bands took 2.024 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.789 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1222.086 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.577 ms
rank = 0, D2D took 0.746 ms
rank = 0, Transfering density took 0.752 ms
Etot    =   -27.933784067697
Eband   =    -8.076075625391
E1      =    17.929390045075
E2      =    -7.588080810015
E3      =    -9.895644116884
Exc     =    -8.874246481645
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 1.481e-04, dEband = 1.266e-02
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -27.933784068, dEtot = 1.481e-04, dEband = 1.266e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7274958790322, which took 0.049 ms

iter_count = 114, r_2norm = 2.018e-05, tol*||rhs|| = 2.910e-05

Anderson update took 60.519 ms, out of which F'*F took 28.869 ms; b-Ax took 194.767 ms, out of which Lap took 174.211 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.277 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542724, int_b + int_rho = -2.910e-14, checking this took 0.118 ms
2-norm of RHS = 549.3921535607159, which took 0.133 ms

iter_count = 258, r_2norm = 4.604e-04, tol*||rhs|| = 5.494e-04

Anderson update took 137.219 ms, out of which F'*F took 64.206 ms; b-Ax took 433.786 ms, out of which Lap took 389.804 ms
Solving Poisson took 930.471 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.079381 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.307 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.312770 
Total time for convolution: 	 convolve: 5.296568 
Total time for convolution: 	 convolve: 5.076206 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 211.229 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.598 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.672 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.002 ms

This SCF took 27535.435 ms, scf error = 8.741e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.131954, lowerbound = -0.889602, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1160.263 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.533 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.418 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 13.970 ms
rank =  0, finding HY took 18.106 ms
rank =  0, distributing HY into block cyclic form took 12.691 ms
rank =  0, finding Y'*HY took 2.023 ms
Rank 0, Project_Hamiltonian used 46.818 ms
Total time for projection: 46.831 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.699 ms
    first calculated eigval = -0.888150265337051
    last  calculated eigval = 0.032261686415537
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88815026533705
lambda[   2] =  -0.82999228707212
lambda[   3] =  -0.54330057077631
lambda[   4] =  -0.49962300911966
lambda[   5] =  -0.37428891999321
lambda[   6] =  -0.36533281568488
lambda[   7] =  -0.26067935183819
lambda[   8] =  -0.26036082419657
lambda[   9] =  -0.04014073671263
lambda[  10] =  -0.02500825540650
lambda[  11] =  -0.02421245805644
lambda[  12] =   0.00705653317841
lambda[  13] =   0.01946778057654
lambda[  14] =   0.03226168641554
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.728 ms
rank =  0, subspace rotation using ScaLAPACK took 3.284 ms
rank =  0, Distributing orbital back into band + domain format took 11.816 ms
rank = 0, Subspace_Rotation used 15.117 ms

Total time for subspace rotation: 15.127 ms
rank = 0, Efermi =  -0.069539614990 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.125 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.790 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1226.619 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.592 ms
rank = 0, D2D took 0.778 ms
rank = 0, Transfering density took 0.785 ms
Etot    =   -27.933341692472
Eband   =    -8.043456088655
E1      =    17.930421677024
E2      =    -7.552192614077
E3      =    -9.900915028521
Exc     =    -8.876837990804
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 8.848e-05, dEband = 6.524e-03
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -27.933341692, dEtot = 8.848e-05, dEband = 6.524e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3550090271729, which took 0.050 ms

iter_count = 108, r_2norm = 1.286e-05, tol*||rhs|| = 1.420e-05

Anderson update took 57.025 ms, out of which F'*F took 26.709 ms; b-Ax took 182.443 ms, out of which Lap took 163.521 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.047 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542724, int_b + int_rho = -3.638e-14, checking this took 0.107 ms
2-norm of RHS = 549.5227024673401, which took 0.099 ms

iter_count = 258, r_2norm = 4.868e-04, tol*||rhs|| = 5.495e-04

Anderson update took 138.149 ms, out of which F'*F took 64.343 ms; b-Ax took 436.505 ms, out of which Lap took 393.305 ms
Solving Poisson took 927.829 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.086745 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.097574 
Total time for convolution: 	 convolve: 5.092258 
Total time for convolution: 	 convolve: 5.083064 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.822 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.587 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.660 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.989 ms

This SCF took 26893.880 ms, scf error = 3.758e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.132262, lowerbound = -0.888150, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1111.173 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.525 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.427 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 20.972 ms
rank =  0, finding HY took 18.365 ms
rank =  0, distributing HY into block cyclic form took 12.760 ms
rank =  0, finding Y'*HY took 2.257 ms
Rank 0, Project_Hamiltonian used 55.041 ms
Total time for projection: 55.053 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.883227983964036
    last  calculated eigval = 0.034141269298646
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88322798396404
lambda[   2] =  -0.82518655609384
lambda[   3] =  -0.53924309167371
lambda[   4] =  -0.49546879513643
lambda[   5] =  -0.36949693239271
lambda[   6] =  -0.36052823030109
lambda[   7] =  -0.25606931270227
lambda[   8] =  -0.25569701714394
lambda[   9] =  -0.03951983395522
lambda[  10] =  -0.02209568884344
lambda[  11] =  -0.02029986906587
lambda[  12] =   0.00830285295507
lambda[  13] =   0.01800437421898
lambda[  14] =   0.03414126929865
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.168 ms
rank =  0, subspace rotation using ScaLAPACK took 3.247 ms
rank =  0, Distributing orbital back into band + domain format took 12.146 ms
rank = 0, Subspace_Rotation used 15.406 ms

Total time for subspace rotation: 15.410 ms
rank = 0, Efermi =  -0.068918712235 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.153 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.739 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.086 ms
rank = 0, Calculating density took 1184.931 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
rank = 0, D2D took 0.769 ms
rank = 0, Transfering density took 0.775 ms
Etot    =   -27.933163841423
Eband   =    -7.969835839426
E1      =    17.894323360670
E2      =    -7.511516779554
E3      =    -9.912063149169
Exc     =    -8.884654358754
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 3.557e-05, dEband = 1.472e-02
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -27.933163841, dEtot = 3.557e-05, dEband = 1.472e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2205307241869, which took 0.093 ms

iter_count = 114, r_2norm = 6.122e-06, tol*||rhs|| = 8.821e-06

Anderson update took 60.477 ms, out of which F'*F took 28.283 ms; b-Ax took 195.534 ms, out of which Lap took 175.462 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.382 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542726, int_b + int_rho = -5.457e-15, checking this took 0.141 ms
2-norm of RHS = 549.5126392662146, which took 0.084 ms

iter_count = 216, r_2norm = 4.917e-04, tol*||rhs|| = 5.495e-04

Anderson update took 115.424 ms, out of which F'*F took 54.207 ms; b-Ax took 366.409 ms, out of which Lap took 328.923 ms
Solving Poisson took 778.318 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.085134 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.002 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.844 ms
Total time for convolution: 	 convolve: 5.081897 
Total time for convolution: 	 convolve: 5.100599 
Total time for convolution: 	 convolve: 5.087854 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.976 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.426 ms
---Transfer Veff_loc: D2D took 0.681 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.313 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.017 ms

This SCF took 26722.934 ms, scf error = 1.631e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.134141, lowerbound = -0.883228, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1159.291 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.568 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.924 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.890 ms
rank =  0, finding HY took 18.969 ms
rank =  0, distributing HY into block cyclic form took 12.609 ms
rank =  0, finding Y'*HY took 2.044 ms
Rank 0, Project_Hamiltonian used 48.543 ms
Total time for projection: 48.558 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.132 ms
    first calculated eigval = -0.882717974733246
    last  calculated eigval = 0.033837300491047
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88271797473325
lambda[   2] =  -0.82467917092877
lambda[   3] =  -0.53868194805271
lambda[   4] =  -0.49494582274398
lambda[   5] =  -0.36890536321087
lambda[   6] =  -0.35994543821342
lambda[   7] =  -0.25544244779190
lambda[   8] =  -0.25505864838891
lambda[   9] =  -0.03891684851798
lambda[  10] =  -0.02148639796764
lambda[  11] =  -0.01988010613166
lambda[  12] =   0.00886544579305
lambda[  13] =   0.01697674327307
lambda[  14] =   0.03383730049105
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 3.263 ms
rank =  0, Distributing orbital back into band + domain format took 12.086 ms
rank = 0, Subspace_Rotation used 15.360 ms

Total time for subspace rotation: 15.363 ms
rank = 0, Efermi =  -0.068315726777 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.143 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.729 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.086 ms
rank = 0, Calculating density took 1226.473 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.565 ms
rank = 0, D2D took 0.752 ms
rank = 0, Transfering density took 0.755 ms
Etot    =   -27.933288041024
Eband   =    -7.960753628728
E1      =    17.890882470085
E2      =    -7.505762551453
E3      =    -9.911955150740
Exc     =    -8.884557651939
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 2.484e-05, dEband = 1.816e-03
rank = 0, Calculating/Estimating energy took 0.964 ms, Etot = -27.933288041, dEtot = 2.484e-05, dEband = 1.816e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1610277197387, which took 0.070 ms

iter_count = 108, r_2norm = 5.559e-06, tol*||rhs|| = 6.441e-06

Anderson update took 57.036 ms, out of which F'*F took 26.642 ms; b-Ax took 182.338 ms, out of which Lap took 163.176 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.641 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542733, int_b + int_rho = 5.457e-14, checking this took 0.149 ms
2-norm of RHS = 549.4830390039285, which took 0.120 ms

iter_count = 228, r_2norm = 4.987e-04, tol*||rhs|| = 5.495e-04

Anderson update took 121.678 ms, out of which F'*F took 57.301 ms; b-Ax took 387.424 ms, out of which Lap took 348.050 ms
Solving Poisson took 822.036 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.097 ms
Total time for convolution: 	 convolve: 5.087721 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.076596 
Total time for convolution: 	 convolve: 5.109106 
Total time for convolution: 	 convolve: 5.102509 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.281 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.407 ms
---Transfer Veff_loc: D2D took 0.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.984 ms

This SCF took 26797.396 ms, scf error = 1.219e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.133837, lowerbound = -0.882718, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1109.027 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.519 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.422 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 13.958 ms
rank =  0, finding HY took 18.455 ms
rank =  0, distributing HY into block cyclic form took 12.719 ms
rank =  0, finding Y'*HY took 2.003 ms
Rank 0, Project_Hamiltonian used 47.163 ms
Total time for projection: 47.180 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.881277808278522
    last  calculated eigval = 0.035254586416434
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88127780827852
lambda[   2] =  -0.82328219419508
lambda[   3] =  -0.53732741960375
lambda[   4] =  -0.49358687644263
lambda[   5] =  -0.36747302718484
lambda[   6] =  -0.35851797623845
lambda[   7] =  -0.25409361565318
lambda[   8] =  -0.25368492475038
lambda[   9] =  -0.03523634166627
lambda[  10] =  -0.01892530505237
lambda[  11] =  -0.01834863486986
lambda[  12] =   0.01244768405298
lambda[  13] =   0.01757106445046
lambda[  14] =   0.03525458641643
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.256 ms
rank =  0, Distributing orbital back into band + domain format took 12.101 ms
rank = 0, Subspace_Rotation used 15.368 ms

Total time for subspace rotation: 15.372 ms
rank = 0, Efermi =  -0.064635219960 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.121 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.722 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.086 ms
rank = 0, Calculating density took 1174.824 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
rank = 0, D2D took 0.721 ms
rank = 0, Transfering density took 0.724 ms
Etot    =   -27.933347254166
Eband   =    -7.938487685237
E1      =    17.879620283348
E2      =    -7.494417622133
E3      =    -9.913618625759
Exc     =    -8.885939167533
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 1.184e-05, dEband = 4.453e-03
rank = 0, Calculating/Estimating energy took 0.968 ms, Etot = -27.933347254, dEtot = 1.184e-05, dEband = 4.453e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1224446427422, which took 0.055 ms

iter_count = 108, r_2norm = 4.694e-06, tol*||rhs|| = 4.898e-06

Anderson update took 57.363 ms, out of which F'*F took 26.796 ms; b-Ax took 182.317 ms, out of which Lap took 162.827 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.653 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542726, int_b + int_rho = -9.095e-15, checking this took 0.142 ms
2-norm of RHS = 549.4777681060824, which took 0.094 ms

iter_count = 186, r_2norm = 4.510e-04, tol*||rhs|| = 5.495e-04

Anderson update took 99.293 ms, out of which F'*F took 46.734 ms; b-Ax took 315.970 ms, out of which Lap took 283.561 ms
Solving Poisson took 669.461 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.082779 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 61.157 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.080801 
Total time for convolution: 	 convolve: 5.082206 
Total time for convolution: 	 convolve: 5.084458 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.070 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.772 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.795 ms

This SCF took 26603.405 ms, scf error = 7.624e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.135255, lowerbound = -0.881278, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1116.599 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.395 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.411 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 18.826 ms
rank =  0, finding HY took 18.345 ms
rank =  0, distributing HY into block cyclic form took 12.720 ms
rank =  0, finding Y'*HY took 2.013 ms
Rank 0, Project_Hamiltonian used 51.931 ms
Total time for projection: 51.941 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.880677040533004
    last  calculated eigval = 0.034645135968248
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88067704053300
lambda[   2] =  -0.82267251785328
lambda[   3] =  -0.53678649585985
lambda[   4] =  -0.49303394557961
lambda[   5] =  -0.36691868484069
lambda[   6] =  -0.35795808184070
lambda[   7] =  -0.25352458473916
lambda[   8] =  -0.25311099349513
lambda[   9] =  -0.03436588258617
lambda[  10] =  -0.01818482835029
lambda[  11] =  -0.01793440502326
lambda[  12] =   0.01352229787282
lambda[  13] =   0.01696367554850
lambda[  14] =   0.03464513596825
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.260 ms
rank =  0, Distributing orbital back into band + domain format took 12.077 ms
rank = 0, Subspace_Rotation used 15.350 ms

Total time for subspace rotation: 15.353 ms
rank = 0, Efermi =  -0.063764760922 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.126 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.782 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1187.117 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
rank = 0, D2D took 0.748 ms
rank = 0, Transfering density took 0.752 ms
Etot    =   -27.933397138745
Eband   =    -7.929364690013
E1      =    17.874354758968
E2      =    -7.490231026543
E3      =    -9.914926669757
Exc     =    -8.886967971365
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 9.977e-06, dEband = 1.825e-03
rank = 0, Calculating/Estimating energy took 0.966 ms, Etot = -27.933397139, dEtot = 9.977e-06, dEband = 1.825e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0643087223618, which took 0.048 ms

iter_count = 108, r_2norm = 2.327e-06, tol*||rhs|| = 2.572e-06

Anderson update took 56.802 ms, out of which F'*F took 29.331 ms; b-Ax took 185.374 ms, out of which Lap took 165.959 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.386 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542726, int_b + int_rho = -7.276e-15, checking this took 0.110 ms
2-norm of RHS = 549.5141759414564, which took 0.062 ms

iter_count = 210, r_2norm = 4.536e-04, tol*||rhs|| = 5.495e-04

Anderson update took 112.245 ms, out of which F'*F took 52.763 ms; b-Ax took 356.573 ms, out of which Lap took 320.410 ms
Solving Poisson took 755.333 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.083158 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.258 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.081866 
Total time for convolution: 	 convolve: 5.078402 
Total time for convolution: 	 convolve: 5.084563 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.217 ms
---Transfer Veff_loc: D2D took 1.479 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.830 ms

This SCF took 26651.803 ms, scf error = 5.879e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.134645, lowerbound = -0.880677, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1158.605 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.582 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.433 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.032 ms
rank =  0, finding HY took 18.301 ms
rank =  0, distributing HY into block cyclic form took 12.579 ms
rank =  0, finding Y'*HY took 2.149 ms
Rank 0, Project_Hamiltonian used 47.091 ms
Total time for projection: 47.107 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.879625516858735
    last  calculated eigval = 0.035917191285203
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87962551685873
lambda[   2] =  -0.82164238781873
lambda[   3] =  -0.53576594365471
lambda[   4] =  -0.49202665064596
lambda[   5] =  -0.36590553623108
lambda[   6] =  -0.35694713267227
lambda[   7] =  -0.25255638119548
lambda[   8] =  -0.25213753087815
lambda[   9] =  -0.03017711706581
lambda[  10] =  -0.01693646332253
lambda[  11] =  -0.01618263310469
lambda[  12] =   0.01701280590009
lambda[  13] =   0.01958540725767
lambda[  14] =   0.03591719128520
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.338 ms
rank =  0, subspace rotation using ScaLAPACK took 3.272 ms
rank =  0, Distributing orbital back into band + domain format took 12.152 ms
rank = 0, Subspace_Rotation used 15.435 ms

Total time for subspace rotation: 15.439 ms
rank = 0, Efermi =  -0.059575995415 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.295 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.571 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.066 ms
rank = 0, Calculating density took 1224.560 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 2.611 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 3.187 ms
rank = 0, D2D took 3.490 ms
rank = 0, Transfering density took 3.495 ms
Etot    =   -27.933497782163
Eband   =    -7.913214160376
E1      =    17.866796809824
E2      =    -7.481270686059
E3      =    -9.916256460284
Exc     =    -8.888030645320
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 2.013e-05, dEband = 3.230e-03
rank = 0, Calculating/Estimating energy took 1.007 ms, Etot = -27.933497782, dEtot = 2.013e-05, dEband = 3.230e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0538314645504, which took 0.055 ms

iter_count = 108, r_2norm = 1.932e-06, tol*||rhs|| = 2.153e-06

Anderson update took 57.007 ms, out of which F'*F took 26.800 ms; b-Ax took 182.814 ms, out of which Lap took 163.035 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.165 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542728, int_b + int_rho = 1.273e-14, checking this took 0.120 ms
2-norm of RHS = 549.5181004144240, which took 0.103 ms

iter_count = 156, r_2norm = 5.368e-04, tol*||rhs|| = 5.495e-04

Anderson update took 83.473 ms, out of which F'*F took 39.273 ms; b-Ax took 264.628 ms, out of which Lap took 237.672 ms
Solving Poisson took 561.681 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.078749 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.199 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.081159 
Total time for convolution: 	 convolve: 5.081049 
Total time for convolution: 	 convolve: 5.081113 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.163 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.412 ms
---Transfer Veff_loc: D2D took 0.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.990 ms

This SCF took 26474.265 ms, scf error = 3.600e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.135917, lowerbound = -0.879626, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1160.738 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.557 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.408 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 13.982 ms
rank =  0, finding HY took 18.240 ms
rank =  0, distributing HY into block cyclic form took 12.522 ms
rank =  0, finding Y'*HY took 2.064 ms
Rank 0, Project_Hamiltonian used 46.835 ms
Total time for projection: 46.847 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.879351633230840
    last  calculated eigval = 0.036358619802321
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87935163323084
lambda[   2] =  -0.82136892024381
lambda[   3] =  -0.53550536376596
lambda[   4] =  -0.49176477746633
lambda[   5] =  -0.36564104967797
lambda[   6] =  -0.35668372294735
lambda[   7] =  -0.25229356041539
lambda[   8] =  -0.25187177953031
lambda[   9] =  -0.02895345825826
lambda[  10] =  -0.01669964676698
lambda[  11] =  -0.01576661262521
lambda[  12] =   0.01689489338402
lambda[  13] =   0.02102306506323
lambda[  14] =   0.03635861980232
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 3.236 ms
rank =  0, Distributing orbital back into band + domain format took 12.095 ms
rank = 0, Subspace_Rotation used 15.342 ms

Total time for subspace rotation: 15.346 ms
rank = 0, Efermi =  -0.058352336625 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.134 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.790 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1226.173 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.601 ms
rank = 0, D2D took 0.787 ms
rank = 0, Transfering density took 0.790 ms
Etot    =   -27.933522191235
Eband   =    -7.908961615003
E1      =    17.864661345141
E2      =    -7.479050820803
E3      =    -9.916639913243
Exc     =    -8.888335722785
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 4.882e-06, dEband = 8.505e-04
rank = 0, Calculating/Estimating energy took 1.827 ms, Etot = -27.933522191, dEtot = 4.882e-06, dEband = 8.505e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0529128593602, which took 0.085 ms

iter_count = 108, r_2norm = 1.632e-06, tol*||rhs|| = 2.117e-06

Anderson update took 57.468 ms, out of which F'*F took 26.762 ms; b-Ax took 182.839 ms, out of which Lap took 163.352 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.741 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542727, int_b + int_rho = -3.638e-15, checking this took 0.132 ms
2-norm of RHS = 549.5226553153905, which took 0.105 ms

iter_count = 168, r_2norm = 4.411e-04, tol*||rhs|| = 5.495e-04

Anderson update took 89.946 ms, out of which F'*F took 42.179 ms; b-Ax took 285.003 ms, out of which Lap took 255.897 ms
Solving Poisson took 604.645 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.091880 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.078250 
Total time for convolution: 	 convolve: 5.096803 
Total time for convolution: 	 convolve: 5.088032 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.390 ms
---Transfer Veff_loc: D2D took 0.645 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.976 ms

This SCF took 26552.503 ms, scf error = 2.920e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136359, lowerbound = -0.879352, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1160.569 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.538 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.425 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 13.980 ms
rank =  0, finding HY took 18.521 ms
rank =  0, distributing HY into block cyclic form took 12.663 ms
rank =  0, finding Y'*HY took 2.030 ms
Rank 0, Project_Hamiltonian used 47.224 ms
Total time for projection: 47.238 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.879128030729801
    last  calculated eigval = 0.036632908825994
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87912803072980
lambda[   2] =  -0.82114793155979
lambda[   3] =  -0.53528531967323
lambda[   4] =  -0.49154670503069
lambda[   5] =  -0.36541150020533
lambda[   6] =  -0.35645644720139
lambda[   7] =  -0.25206680326782
lambda[   8] =  -0.25164196635736
lambda[   9] =  -0.02868877212633
lambda[  10] =  -0.01660719813414
lambda[  11] =  -0.01575875326355
lambda[  12] =   0.01663095879307
lambda[  13] =   0.02130921175966
lambda[  14] =   0.03663290882599
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.235 ms
rank =  0, Distributing orbital back into band + domain format took 12.139 ms
rank = 0, Subspace_Rotation used 15.386 ms

Total time for subspace rotation: 15.389 ms
rank = 0, Efermi =  -0.058087650549 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.133 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.806 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1226.456 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.546 ms
rank = 0, D2D took 0.763 ms
rank = 0, Transfering density took 0.766 ms
Etot    =   -27.933576694888
Eband   =    -7.905369408493
E1      =    17.863095577729
E2      =    -7.476962095879
E3      =    -9.916714625718
Exc     =    -8.888402653085
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 1.090e-05, dEband = 7.184e-04
rank = 0, Calculating/Estimating energy took 1.938 ms, Etot = -27.933576695, dEtot = 1.090e-05, dEband = 7.184e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0513129981582, which took 0.045 ms

iter_count = 108, r_2norm = 1.550e-06, tol*||rhs|| = 2.053e-06

Anderson update took 57.099 ms, out of which F'*F took 26.817 ms; b-Ax took 182.696 ms, out of which Lap took 163.104 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.555 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542730, int_b + int_rho = 2.910e-14, checking this took 0.104 ms
2-norm of RHS = 549.5231573603280, which took 0.111 ms

iter_count = 138, r_2norm = 4.730e-04, tol*||rhs|| = 5.495e-04

Anderson update took 73.614 ms, out of which F'*F took 34.729 ms; b-Ax took 235.955 ms, out of which Lap took 212.570 ms
Solving Poisson took 498.127 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.087493 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.462 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.080436 
Total time for convolution: 	 convolve: 5.078053 
Total time for convolution: 	 convolve: 5.079514 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.782 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.423 ms
---Transfer Veff_loc: D2D took 0.690 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.023 ms

This SCF took 26439.945 ms, scf error = 2.505e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136633, lowerbound = -0.879128, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1150.752 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.521 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.436 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 13.974 ms
rank =  0, finding HY took 18.261 ms
rank =  0, distributing HY into block cyclic form took 12.574 ms
rank =  0, finding Y'*HY took 2.075 ms
Rank 0, Project_Hamiltonian used 46.911 ms
Total time for projection: 46.923 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -0.879073082752125
    last  calculated eigval = 0.036870004693411
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87907308275213
lambda[   2] =  -0.82109238845920
lambda[   3] =  -0.53522663490323
lambda[   4] =  -0.49148918467576
lambda[   5] =  -0.36535147690039
lambda[   6] =  -0.35639701702432
lambda[   7] =  -0.25200424161533
lambda[   8] =  -0.25157884210090
lambda[   9] =  -0.02825979008039
lambda[  10] =  -0.01658722376029
lambda[  11] =  -0.01568678389325
lambda[  12] =   0.01658117044331
lambda[  13] =   0.02169635236495
lambda[  14] =   0.03687000469341
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 3.231 ms
rank =  0, Distributing orbital back into band + domain format took 12.035 ms
rank = 0, Subspace_Rotation used 15.278 ms

Total time for subspace rotation: 15.282 ms
rank = 0, Efermi =  -0.057658668576 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.153 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.750 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1216.176 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.425 ms
rank = 0, D2D took 0.564 ms
rank = 0, Transfering density took 0.566 ms
Etot    =   -27.933591972644
Eband   =    -7.904425737298
E1      =    17.862718167164
E2      =    -7.476391673173
E3      =    -9.916683844392
Exc     =    -8.888382987439
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 3.056e-06, dEband = 1.887e-04
rank = 0, Calculating/Estimating energy took 0.873 ms, Etot = -27.933591973, dEtot = 3.056e-06, dEband = 1.887e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0464093914760, which took 0.056 ms

iter_count = 108, r_2norm = 1.533e-06, tol*||rhs|| = 1.856e-06

Anderson update took 57.206 ms, out of which F'*F took 26.630 ms; b-Ax took 182.936 ms, out of which Lap took 163.450 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.667 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542727, int_b + int_rho = -3.638e-15, checking this took 0.114 ms
2-norm of RHS = 549.5229044966442, which took 0.103 ms

iter_count = 84, r_2norm = 5.208e-04, tol*||rhs|| = 5.495e-04

Anderson update took 44.860 ms, out of which F'*F took 21.220 ms; b-Ax took 142.726 ms, out of which Lap took 128.289 ms
Solving Poisson took 304.316 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.078793 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.079250 
Total time for convolution: 	 convolve: 5.083201 
Total time for convolution: 	 convolve: 5.079548 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.017 ms
======D2D: initiated sending and receiving took 1.159 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.648 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.975 ms

This SCF took 26310.999 ms, scf error = 2.415e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136870, lowerbound = -0.879073, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1159.268 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.543 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.443 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.004 ms
rank =  0, finding HY took 18.301 ms
rank =  0, distributing HY into block cyclic form took 12.690 ms
rank =  0, finding Y'*HY took 1.991 ms
Rank 0, Project_Hamiltonian used 47.010 ms
Total time for projection: 47.025 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -0.879045342131279
    last  calculated eigval = 0.036841750497546
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87904534213128
lambda[   2] =  -0.82106368439347
lambda[   3] =  -0.53519778765263
lambda[   4] =  -0.49146053336574
lambda[   5] =  -0.36532591410719
lambda[   6] =  -0.35637141242238
lambda[   7] =  -0.25197826175067
lambda[   8] =  -0.25155241065466
lambda[   9] =  -0.02810753140110
lambda[  10] =  -0.01657387949772
lambda[  11] =  -0.01562742168811
lambda[  12] =   0.01645573825617
lambda[  13] =   0.02184899154032
lambda[  14] =   0.03684175049755
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 3.242 ms
rank =  0, Distributing orbital back into band + domain format took 12.088 ms
rank = 0, Subspace_Rotation used 15.341 ms

Total time for subspace rotation: 15.345 ms
rank = 0, Efermi =  -0.057506409893 calculate fermi energy took 0.622 ms
rank = 0, --- Calculate rho: sum over local bands took 2.013 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.774 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.074 ms
rank = 0, Calculating density took 1225.910 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.422 ms
rank = 0, D2D took 0.771 ms
rank = 0, Transfering density took 0.779 ms
Etot    =   -27.933592049299
Eband   =    -7.903990693390
E1      =    17.862479277736
E2      =    -7.476185868898
E3      =    -9.916731647273
Exc     =    -8.888421217182
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 1.533e-08, dEband = 8.701e-05
rank = 0, Calculating/Estimating energy took 1.656 ms, Etot = -27.933592049, dEtot = 1.533e-08, dEband = 8.701e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0443495313484, which took 0.087 ms

iter_count = 108, r_2norm = 1.263e-06, tol*||rhs|| = 1.774e-06

Anderson update took 57.086 ms, out of which F'*F took 26.813 ms; b-Ax took 183.228 ms, out of which Lap took 163.830 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.017 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542727, int_b + int_rho = 0.000e+00, checking this took 0.098 ms
2-norm of RHS = 549.5228367672892, which took 0.082 ms

iter_count = 150, r_2norm = 4.780e-04, tol*||rhs|| = 5.495e-04

Anderson update took 80.090 ms, out of which F'*F took 37.949 ms; b-Ax took 254.461 ms, out of which Lap took 228.698 ms
Solving Poisson took 540.259 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.108305 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.782 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.081958 
Total time for convolution: 	 convolve: 5.092449 
Total time for convolution: 	 convolve: 5.079255 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.834 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.572 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
---Transfer Veff_loc: D2D took 0.692 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.310 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.027 ms

This SCF took 26520.139 ms, scf error = 2.312e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136842, lowerbound = -0.879045, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1160.905 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.071 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 13.301 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 25.390 ms
rank =  0, finding HY took 19.495 ms
rank =  0, distributing HY into block cyclic form took 12.576 ms
rank =  0, finding Y'*HY took 2.083 ms
Rank 0, Project_Hamiltonian used 59.569 ms
Total time for projection: 59.582 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.879014753877582
    last  calculated eigval = 0.036111649621962
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87901475387758
lambda[   2] =  -0.82103335415361
lambda[   3] =  -0.53515306369471
lambda[   4] =  -0.49142029129214
lambda[   5] =  -0.36529354371117
lambda[   6] =  -0.35633959089772
lambda[   7] =  -0.25195138668149
lambda[   8] =  -0.25152466506459
lambda[   9] =  -0.02988314293552
lambda[  10] =  -0.01672952213072
lambda[  11] =  -0.01610228109818
lambda[  12] =   0.01709168560558
lambda[  13] =   0.01973085210939
lambda[  14] =   0.03611164962196
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 3.817 ms
rank =  0, Distributing orbital back into band + domain format took 11.101 ms
rank = 0, Subspace_Rotation used 14.936 ms

Total time for subspace rotation: 14.944 ms
rank = 0, Efermi =  -0.059282021217 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.003 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.695 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.086 ms
rank = 0, Calculating density took 1239.506 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.548 ms
rank = 0, D2D took 0.736 ms
rank = 0, Transfering density took 0.743 ms
Etot    =   -27.933622334816
Eband   =    -7.903461299207
E1      =    17.862312628296
E2      =    -7.475828913710
E3      =    -9.916569849992
Exc     =    -8.888295494973
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 6.057e-06, dEband = 1.059e-04
rank = 0, Calculating/Estimating energy took 0.957 ms, Etot = -27.933622335, dEtot = 6.057e-06, dEband = 1.059e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0602425237622, which took 0.047 ms

iter_count = 102, r_2norm = 1.951e-06, tol*||rhs|| = 2.410e-06

Anderson update took 53.993 ms, out of which F'*F took 25.193 ms; b-Ax took 172.437 ms, out of which Lap took 153.922 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.001 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542725, int_b + int_rho = -2.365e-14, checking this took 0.114 ms
2-norm of RHS = 549.5254124767778, which took 0.106 ms

iter_count = 132, r_2norm = 5.112e-04, tol*||rhs|| = 5.495e-04

Anderson update took 70.370 ms, out of which F'*F took 33.271 ms; b-Ax took 223.749 ms, out of which Lap took 201.264 ms
Solving Poisson took 476.608 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.082147 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.809 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.079432 
Total time for convolution: 	 convolve: 5.099839 
Total time for convolution: 	 convolve: 5.466098 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.552 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.170 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.696 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.034 ms

This SCF took 26792.406 ms, scf error = 2.368e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.136112, lowerbound = -0.879015, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1160.701 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.564 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.433 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.014 ms
rank =  0, finding HY took 18.239 ms
rank =  0, distributing HY into block cyclic form took 12.511 ms
rank =  0, finding Y'*HY took 2.059 ms
Rank 0, Project_Hamiltonian used 46.851 ms
Total time for projection: 46.863 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.878977455295467
    last  calculated eigval = 0.037027787915669
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87897745529547
lambda[   2] =  -0.82099779287734
lambda[   3] =  -0.53510245696678
lambda[   4] =  -0.49137486361392
lambda[   5] =  -0.36524386275835
lambda[   6] =  -0.35629052642419
lambda[   7] =  -0.25190112228069
lambda[   8] =  -0.25147431509751
lambda[   9] =  -0.02974297576668
lambda[  10] =  -0.01673159825609
lambda[  11] =  -0.01612804186712
lambda[  12] =   0.01895295853704
lambda[  13] =   0.01985054885540
lambda[  14] =   0.03702778791567
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.916 ms
rank =  0, Distributing orbital back into band + domain format took 11.079 ms
rank = 0, Subspace_Rotation used 15.012 ms

Total time for subspace rotation: 15.020 ms
rank = 0, Efermi =  -0.059141854036 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.213 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.640 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.071 ms
rank = 0, Calculating density took 1226.575 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.608 ms
rank = 0, D2D took 0.791 ms
rank = 0, Transfering density took 0.797 ms
Etot    =   -27.933630235047
Eband   =    -7.902724791087
E1      =    17.862172102730
E2      =    -7.475259326006
E3      =    -9.916430045201
Exc     =    -8.888189985262
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 1.580e-06, dEband = 1.473e-04
rank = 0, Calculating/Estimating energy took 0.940 ms, Etot = -27.933630235, dEtot = 1.580e-06, dEband = 1.473e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0411998609439, which took 0.051 ms

iter_count = 108, r_2norm = 1.264e-06, tol*||rhs|| = 1.648e-06

Anderson update took 58.251 ms, out of which F'*F took 26.896 ms; b-Ax took 182.382 ms, out of which Lap took 162.862 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.703 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542730, int_b + int_rho = 3.092e-14, checking this took 0.123 ms
2-norm of RHS = 549.5210721206698, which took 0.104 ms

iter_count = 138, r_2norm = 5.353e-04, tol*||rhs|| = 5.495e-04

Anderson update took 74.058 ms, out of which F'*F took 34.680 ms; b-Ax took 233.258 ms, out of which Lap took 209.787 ms
Solving Poisson took 496.704 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.080079 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 107.249 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.076221 
Total time for convolution: 	 convolve: 5.078552 
Total time for convolution: 	 convolve: 5.090137 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.652 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.670 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.995 ms

This SCF took 26531.276 ms, scf error = 2.766e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.137028, lowerbound = -0.878977, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1134.973 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.092 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.436 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 16.546 ms
rank =  0, finding HY took 18.275 ms
rank =  0, distributing HY into block cyclic form took 12.647 ms
rank =  0, finding Y'*HY took 2.023 ms
Rank 0, Project_Hamiltonian used 49.521 ms
Total time for projection: 49.537 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.692 ms
    first calculated eigval = -0.878919017743945
    last  calculated eigval = 0.036123943362556
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87891901774394
lambda[   2] =  -0.82093630026762
lambda[   3] =  -0.53506727669594
lambda[   4] =  -0.49133153257489
lambda[   5] =  -0.36521006970687
lambda[   6] =  -0.35625552016153
lambda[   7] =  -0.25186957754621
lambda[   8] =  -0.25144157688520
lambda[   9] =  -0.02978859240697
lambda[  10] =  -0.01666934423389
lambda[  11] =  -0.01605639718475
lambda[  12] =   0.01713469903369
lambda[  13] =   0.01978524690294
lambda[  14] =   0.03612394336256
==subpsace eigenproblem: bcast eigvals took 0.529 ms
Total time for solving subspace eigenvalue problem: 1.233 ms
rank =  0, subspace rotation using ScaLAPACK took 3.499 ms
rank =  0, Distributing orbital back into band + domain format took 11.948 ms
rank = 0, Subspace_Rotation used 15.467 ms

Total time for subspace rotation: 15.472 ms
rank = 0, Efermi =  -0.059187470691 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.098 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.747 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.074 ms
rank = 0, Calculating density took 1204.284 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.537 ms
rank = 0, D2D took 0.748 ms
rank = 0, Transfering density took 0.755 ms
Etot    =   -27.933630126545
Eband   =    -7.902061743624
E1      =    17.861434698409
E2      =    -7.475253220351
E3      =    -9.916781560192
Exc     =    -8.888460929239
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 2.170e-08, dEband = 1.326e-04
rank = 0, Calculating/Estimating energy took 0.966 ms, Etot = -27.933630127, dEtot = 2.170e-08, dEband = 1.326e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0569117589066, which took 0.051 ms

iter_count = 102, r_2norm = 1.664e-06, tol*||rhs|| = 2.276e-06

Anderson update took 54.514 ms, out of which F'*F took 24.998 ms; b-Ax took 171.900 ms, out of which Lap took 153.439 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.875 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542727, int_b + int_rho = -3.638e-15, checking this took 0.118 ms
2-norm of RHS = 549.5235690355751, which took 0.098 ms

iter_count = 162, r_2norm = 4.836e-04, tol*||rhs|| = 5.495e-04

Anderson update took 86.479 ms, out of which F'*F took 40.765 ms; b-Ax took 274.363 ms, out of which Lap took 246.764 ms
Solving Poisson took 582.930 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.085227 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.243 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.078941 
Total time for convolution: 	 convolve: 5.079263 
Total time for convolution: 	 convolve: 5.081041 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.647 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.317 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.983 ms

This SCF took 26466.141 ms, scf error = 1.897e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.136124, lowerbound = -0.878919, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1157.627 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.521 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.446 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 13.984 ms
rank =  0, finding HY took 18.249 ms
rank =  0, distributing HY into block cyclic form took 12.419 ms
rank =  0, finding Y'*HY took 2.099 ms
Rank 0, Project_Hamiltonian used 47.361 ms
Total time for projection: 47.378 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.592 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.671 ms
    first calculated eigval = -0.879028709977500
    last  calculated eigval = 0.037201043226443
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87902870997750
lambda[   2] =  -0.82104909722899
lambda[   3] =  -0.53514362124353
lambda[   4] =  -0.49141597329964
lambda[   5] =  -0.36529686996506
lambda[   6] =  -0.35634497774943
lambda[   7] =  -0.25195985262844
lambda[   8] =  -0.25153478428523
lambda[   9] =  -0.03026089347574
lambda[  10] =  -0.01682572518529
lambda[  11] =  -0.01635852225731
lambda[  12] =   0.01919415274608
lambda[  13] =   0.02006348123117
lambda[  14] =   0.03720104322644
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.683 ms
rank =  0, subspace rotation using ScaLAPACK took 3.212 ms
rank =  0, Distributing orbital back into band + domain format took 12.140 ms
rank = 0, Subspace_Rotation used 15.364 ms

Total time for subspace rotation: 15.368 ms
rank = 0, Efermi =  -0.059659771744 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.118 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.803 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1224.158 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.015 ms
======D2D: initiated sending and receiving took 0.554 ms
rank = 0, D2D took 0.744 ms
rank = 0, Transfering density took 0.753 ms
Etot    =   -27.933634787198
Eband   =    -7.903547773223
E1      =    17.862569031700
E2      =    -7.475717021095
E3      =    -9.916265755394
Exc     =    -8.888061889530
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 9.321e-07, dEband = 2.972e-04
rank = 0, Calculating/Estimating energy took 0.973 ms, Etot = -27.933634787, dEtot = 9.321e-07, dEband = 2.972e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0427617357880, which took 0.077 ms

iter_count = 102, r_2norm = 1.653e-06, tol*||rhs|| = 1.710e-06

Anderson update took 56.747 ms, out of which F'*F took 25.316 ms; b-Ax took 172.674 ms, out of which Lap took 154.069 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 378.302 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542725, int_b + int_rho = -2.547e-14, checking this took 0.125 ms
2-norm of RHS = 549.5228838727228, which took 0.093 ms

iter_count = 78, r_2norm = 4.788e-04, tol*||rhs|| = 5.495e-04

Anderson update took 41.712 ms, out of which F'*F took 19.635 ms; b-Ax took 132.119 ms, out of which Lap took 118.806 ms
Solving Poisson took 282.368 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.078461 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.577 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.081110 
Total time for convolution: 	 convolve: 5.085971 
Total time for convolution: 	 convolve: 5.081976 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.679 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.997 ms

This SCF took 26417.481 ms, scf error = 2.838e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.137201, lowerbound = -0.879029, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1112.672 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 39.280 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.004 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 41.309 ms
rank =  0, finding HY took 18.796 ms
rank =  0, distributing HY into block cyclic form took 12.661 ms
rank =  0, finding Y'*HY took 2.031 ms
Rank 0, Project_Hamiltonian used 74.826 ms
Total time for projection: 74.847 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.878974944334046
    last  calculated eigval = 0.037008457762433
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87897494433405
lambda[   2] =  -0.82099497777746
lambda[   3] =  -0.53510025543555
lambda[   4] =  -0.49137016005195
lambda[   5] =  -0.36524996308191
lambda[   6] =  -0.35629736708829
lambda[   7] =  -0.25191317868817
lambda[   8] =  -0.25148780380667
lambda[   9] =  -0.03006744281383
lambda[  10] =  -0.01677571380641
lambda[  11] =  -0.01628305539304
lambda[  12] =   0.01941583440079
lambda[  13] =   0.01948896479845
lambda[  14] =   0.03700845776243
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 3.186 ms
rank =  0, Distributing orbital back into band + domain format took 12.152 ms
rank = 0, Subspace_Rotation used 15.351 ms

Total time for subspace rotation: 15.354 ms
rank = 0, Efermi =  -0.059466321118 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.106 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.831 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1206.129 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.576 ms
rank = 0, D2D took 0.771 ms
rank = 0, Transfering density took 0.778 ms
Etot    =   -27.933638088884
Eband   =    -7.902777300992
E1      =    17.862077724903
E2      =    -7.475398540032
E3      =    -9.916419505592
Exc     =    -8.888179625785
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 6.603e-07, dEband = 1.541e-04
rank = 0, Calculating/Estimating energy took 0.956 ms, Etot = -27.933638089, dEtot = 6.603e-07, dEband = 1.541e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0450591034285, which took 0.051 ms

iter_count = 102, r_2norm = 1.686e-06, tol*||rhs|| = 1.802e-06

Anderson update took 54.110 ms, out of which F'*F took 24.996 ms; b-Ax took 173.839 ms, out of which Lap took 155.240 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 378.400 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542723, int_b + int_rho = -4.366e-14, checking this took 0.109 ms
2-norm of RHS = 549.5232920348174, which took 0.100 ms

iter_count = 24, r_2norm = 4.972e-04, tol*||rhs|| = 5.495e-04

Anderson update took 12.804 ms, out of which F'*F took 5.988 ms; b-Ax took 40.678 ms, out of which Lap took 36.577 ms
Solving Poisson took 89.157 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.138 ms
Total time for convolution: 	 convolve: 5.074502 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.316 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.082417 
Total time for convolution: 	 convolve: 5.078284 
Total time for convolution: 	 convolve: 5.080824 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.469 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.663 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.985 ms

This SCF took 25964.140 ms, scf error = 2.486e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.137008, lowerbound = -0.878975, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1149.163 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.594 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.434 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.045 ms
rank =  0, finding HY took 18.239 ms
rank =  0, distributing HY into block cyclic form took 12.624 ms
rank =  0, finding Y'*HY took 2.029 ms
Rank 0, Project_Hamiltonian used 46.962 ms
Total time for projection: 46.974 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.878982346787779
    last  calculated eigval = 0.037032490758629
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87898234678778
lambda[   2] =  -0.82100274442767
lambda[   3] =  -0.53510600152227
lambda[   4] =  -0.49137645229339
lambda[   5] =  -0.36525583184715
lambda[   6] =  -0.35630341139475
lambda[   7] =  -0.25191938211926
lambda[   8] =  -0.25149407801429
lambda[   9] =  -0.02994797919191
lambda[  10] =  -0.01677489661405
lambda[  11] =  -0.01626596799537
lambda[  12] =   0.01948382937038
lambda[  13] =   0.01953671159783
lambda[  14] =   0.03703249075863
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 3.233 ms
rank =  0, Distributing orbital back into band + domain format took 12.093 ms
rank = 0, Subspace_Rotation used 15.337 ms

Total time for subspace rotation: 15.342 ms
rank = 0, Efermi =  -0.059346857550 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.123 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.786 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1215.046 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.573 ms
rank = 0, D2D took 0.766 ms
rank = 0, Transfering density took 0.768 ms
Etot    =   -27.933637617029
Eband   =    -7.902880497275
E1      =    17.862157999875
E2      =    -7.475428906114
E3      =    -9.916390794164
Exc     =    -8.888157887272
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 9.437e-08, dEband = 2.064e-05
rank = 0, Calculating/Estimating energy took 0.953 ms, Etot = -27.933637617, dEtot = 9.437e-08, dEband = 2.064e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0420510125080, which took 0.064 ms

iter_count = 102, r_2norm = 1.475e-06, tol*||rhs|| = 1.682e-06

Anderson update took 54.013 ms, out of which F'*F took 25.362 ms; b-Ax took 171.999 ms, out of which Lap took 153.555 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.403 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542728, int_b + int_rho = 7.276e-15, checking this took 0.096 ms
2-norm of RHS = 549.5172941718404, which took 0.098 ms

iter_count = 114, r_2norm = 5.315e-04, tol*||rhs|| = 5.495e-04

Anderson update took 60.895 ms, out of which F'*F took 28.804 ms; b-Ax took 193.438 ms, out of which Lap took 173.895 ms
Solving Poisson took 411.661 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.079832 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.083777 
Total time for convolution: 	 convolve: 5.078275 
Total time for convolution: 	 convolve: 5.081182 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.658 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.796 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.985 ms

This SCF took 26302.683 ms, scf error = 2.564e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.137032, lowerbound = -0.878982, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1161.127 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.550 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.416 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 13.985 ms
rank =  0, finding HY took 18.260 ms
rank =  0, distributing HY into block cyclic form took 12.645 ms
rank =  0, finding Y'*HY took 2.004 ms
Rank 0, Project_Hamiltonian used 46.921 ms
Total time for projection: 46.934 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -0.878814184184963
    last  calculated eigval = 0.035876992881246
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87881418418496
lambda[   2] =  -0.82083384428095
lambda[   3] =  -0.53497570072389
lambda[   4] =  -0.49123622899659
lambda[   5] =  -0.36511604842913
lambda[   6] =  -0.35616167009712
lambda[   7] =  -0.25178471617963
lambda[   8] =  -0.25135816170754
lambda[   9] =  -0.03075944947978
lambda[  10] =  -0.01668257040516
lambda[  11] =  -0.01626905841913
lambda[  12] =   0.01864708612019
lambda[  13] =   0.01868008366580
lambda[  14] =   0.03587699288125
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 3.251 ms
rank =  0, Distributing orbital back into band + domain format took 12.045 ms
rank = 0, Subspace_Rotation used 15.308 ms

Total time for subspace rotation: 15.312 ms
rank = 0, Efermi =  -0.060158327823 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.107 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.783 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1226.636 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.527 ms
rank = 0, D2D took 0.723 ms
rank = 0, Transfering density took 0.726 ms
Etot    =   -27.933635062751
Eband   =    -7.900561109674
E1      =    17.860506281766
E2      =    -7.474631536331
E3      =    -9.916938679006
Exc     =    -8.888573517546
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 5.109e-07, dEband = 4.639e-04
rank = 0, Calculating/Estimating energy took 1.073 ms, Etot = -27.933635063, dEtot = 5.109e-07, dEband = 4.639e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0330819921104, which took 0.049 ms

iter_count = 102, r_2norm = 1.287e-06, tol*||rhs|| = 1.323e-06

Anderson update took 53.916 ms, out of which F'*F took 25.101 ms; b-Ax took 171.961 ms, out of which Lap took 153.490 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.631 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542722, int_b + int_rho = -5.093e-14, checking this took 0.094 ms
2-norm of RHS = 549.5183657513360, which took 0.097 ms

iter_count = 114, r_2norm = 5.181e-04, tol*||rhs|| = 5.495e-04

Anderson update took 61.345 ms, out of which F'*F took 42.579 ms; b-Ax took 222.384 ms, out of which Lap took 199.337 ms
Solving Poisson took 444.708 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.109134 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.091535 
Total time for convolution: 	 convolve: 5.086083 
Total time for convolution: 	 convolve: 5.081725 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.169 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 1.169 ms
---Transfer Veff_loc: D2D took 1.606 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.320 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.944 ms

This SCF took 26408.789 ms, scf error = 1.387e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.135877, lowerbound = -0.878814, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1158.964 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.586 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.437 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.041 ms
rank =  0, finding HY took 18.198 ms
rank =  0, distributing HY into block cyclic form took 12.607 ms
rank =  0, finding Y'*HY took 2.025 ms
Rank 0, Project_Hamiltonian used 46.896 ms
Total time for projection: 46.909 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -0.878715073859689
    last  calculated eigval = 0.036290285582381
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87871507385969
lambda[   2] =  -0.82073452979643
lambda[   3] =  -0.53488109595912
lambda[   4] =  -0.49114149194447
lambda[   5] =  -0.36502491340125
lambda[   6] =  -0.35607007052407
lambda[   7] =  -0.25169469301993
lambda[   8] =  -0.25126934924651
lambda[   9] =  -0.03066427969893
lambda[  10] =  -0.01659704965652
lambda[  11] =  -0.01617329200058
lambda[  12] =   0.01878363919995
lambda[  13] =   0.01967838601571
lambda[  14] =   0.03629028558238
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 3.237 ms
rank =  0, Distributing orbital back into band + domain format took 12.067 ms
rank = 0, Subspace_Rotation used 15.315 ms

Total time for subspace rotation: 15.319 ms
rank = 0, Efermi =  -0.060063158031 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.109 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.833 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1224.453 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.566 ms
rank = 0, D2D took 0.753 ms
rank = 0, Transfering density took 0.757 ms
Etot    =   -27.933635338335
Eband   =    -7.899062435976
E1      =    17.859701921810
E2      =    -7.473889167158
E3      =    -9.917147757471
Exc     =    -8.888734816163
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 5.512e-08, dEband = 2.997e-04
rank = 0, Calculating/Estimating energy took 0.970 ms, Etot = -27.933635338, dEtot = 5.512e-08, dEband = 2.997e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0659765823520, which took 0.051 ms

iter_count = 96, r_2norm = 1.688e-06, tol*||rhs|| = 2.639e-06

Anderson update took 50.680 ms, out of which F'*F took 23.844 ms; b-Ax took 161.998 ms, out of which Lap took 144.472 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 353.664 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542736, int_b + int_rho = 9.095e-14, checking this took 0.105 ms
2-norm of RHS = 549.5210165540985, which took 0.091 ms

iter_count = 138, r_2norm = 5.252e-04, tol*||rhs|| = 5.495e-04

Anderson update took 73.491 ms, out of which F'*F took 34.864 ms; b-Ax took 234.118 ms, out of which Lap took 210.371 ms
Solving Poisson took 497.669 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.080304 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.078664 
Total time for convolution: 	 convolve: 5.078431 
Total time for convolution: 	 convolve: 5.080345 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.020 ms
======D2D: initiated sending and receiving took 1.222 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.658 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.310 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.988 ms

This SCF took 26391.083 ms, scf error = 1.146e-04
-------------
SCF iter 24  
-------------

 Chebfilt 27, in Chebyshev filtering, lambda_cutoff = 0.136290, lowerbound = -0.878715, upperbound = 267.574187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1164.978 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.545 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.420 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 13.989 ms
rank =  0, finding HY took 18.315 ms
rank =  0, distributing HY into block cyclic form took 12.712 ms
rank =  0, finding Y'*HY took 1.999 ms
Rank 0, Project_Hamiltonian used 47.045 ms
Total time for projection: 47.117 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.878562804305583
    last  calculated eigval = 0.036268996685928
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87856280430558
lambda[   2] =  -0.82058251495132
lambda[   3] =  -0.53473717169477
lambda[   4] =  -0.49099664659398
lambda[   5] =  -0.36488555811224
lambda[   6] =  -0.35593143394053
lambda[   7] =  -0.25155988615322
lambda[   8] =  -0.25113543757043
lambda[   9] =  -0.03063083059217
lambda[  10] =  -0.01644622092752
lambda[  11] =  -0.01605055361483
lambda[  12] =   0.01875390985977
lambda[  13] =   0.01950006662224
lambda[  14] =   0.03626899668593
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.232 ms
rank =  0, Distributing orbital back into band + domain format took 12.086 ms
rank = 0, Subspace_Rotation used 15.329 ms

Total time for subspace rotation: 15.334 ms
rank = 0, Efermi =  -0.060029708874 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.122 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.784 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1230.652 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.573 ms
rank = 0, D2D took 0.773 ms
rank = 0, Transfering density took 0.776 ms
Etot    =   -27.933637183258
Eband   =    -7.896782907117
E1      =    17.858492398144
E2      =    -7.472739012133
E3      =    -9.917463211545
Exc     =    -8.888971965328
Esc     =   -46.396576932168
Entropy =    -0.000000000467
dE = 3.690e-07, dEband = 4.559e-04
rank = 0, Calculating/Estimating energy took 0.949 ms, Etot = -27.933637183, dEtot = 3.690e-07, dEband = 4.559e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0442354684852, which took 0.049 ms

iter_count = 96, r_2norm = 1.349e-06, tol*||rhs|| = 1.769e-06

Anderson update took 51.045 ms, out of which F'*F took 23.767 ms; b-Ax took 164.516 ms, out of which Lap took 147.297 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 354.607 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001542727, int_rho =  16.00000001542726, int_b + int_rho = -1.455e-14, checking this took 0.109 ms
2-norm of RHS = 549.5216043977257, which took 0.099 ms

iter_count = 108, r_2norm = 5.375e-04, tol*||rhs|| = 5.495e-04

Anderson update took 57.739 ms, out of which F'*F took 27.206 ms; b-Ax took 182.631 ms, out of which Lap took 164.144 ms
Solving Poisson took 389.837 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.075611 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.665 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.077556 
Total time for convolution: 	 convolve: 5.089769 
Total time for convolution: 	 convolve: 5.079600 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 0.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.006 ms

This SCF took 26289.144 ms, scf error = 7.860e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -0.87856280430558, occ[   1] =   2.00000000000000
lambda[   2] =  -0.82058251495132, occ[   2] =   2.00000000000000
lambda[   3] =  -0.53473717169477, occ[   3] =   2.00000000000000
lambda[   4] =  -0.49099664659398, occ[   4] =   2.00000000000000
lambda[   5] =  -0.36488555811224, occ[   5] =   2.00000000000000
lambda[   6] =  -0.35593143394053, occ[   6] =   2.00000000000000
lambda[   7] =  -0.25155988615322, occ[   7] =   2.00000000000000
lambda[   8] =  -0.25113543757043, occ[   8] =   2.00000000000000
lambda[   9] =  -0.03063083059217, occ[   9] =   0.00000001542727
lambda[  10] =  -0.01644622092752, occ[  10] =   0.00000000000000
lambda[  11] =  -0.01605055361483, occ[  11] =   0.00000000000000
lambda[  12] =   0.01875390985977, occ[  12] =   0.00000000000000
lambda[  13] =   0.01950006662224, occ[  13] =   0.00000000000000
lambda[  14] =   0.03626899668593, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.158 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.472 ms, time for Allreduce/Reduce: 6.703 ms 
Time for calculating local force components: 15.081 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.03979444995880  -0.03367061681938  -0.03747061354445
  0.03979449079252   0.03367067543934  -0.03747065893241
 -0.00000080554828  -0.00000138048897  -0.08542043344186
  0.37133196302672  -0.55008419712762   0.42821100753639
 -0.37133476445662   0.55008701872867   0.42821437190988
force_loc = 
  0.04132911154734   0.03862276924934   0.03875563782979
 -0.04132944019948  -0.03862334573400   0.03875635527541
 -0.00000085729580  -0.00000112408583   0.08151286219236
 -0.36170335226062   0.53839907999221  -0.41819094857221
  0.36169922116371  -0.53839624695567  -0.41819169328449
Time for calculating nonlocal force components: 25.239 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000006665964  -0.00000009221808   0.00190427326254
[0m[32m -0.00919337678053   0.00865146212324  -0.01030553210641
[0m[32m  0.00919321211579  -0.00865144703274  -0.01030558082732
[0mTime for calculating XC forces components: 19.158 ms
 Cartesian force = 
  0.00153648449128   0.00495164141585   0.00128521482589
 -0.00153312650423  -0.00495318130877   0.00128588688356
  0.00000009339902  -0.00000310780697  -0.00200310744640
  0.00043705688831  -0.00303416602627  -0.00028528260167
 -0.00044050827438   0.00303881372616  -0.00028271166137
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Time for printing density: 395.776 ms
The program took 670.953 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:56
Job ID:        2266449
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:16:48,vmem=8508K,walltime=00:11:24,mem=8168K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-7-2
---------------------------------------
