---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:02
Job ID:    2266536
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:06
Job ID:    2266536
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.053 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 6.604 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 7.
[32m
Time for finding element is 0.008 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 1.098 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 78.057 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.024 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.098 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    9.731947	   12.282559	    7.944396	
    9.731947	   12.282559	   12.055604	
   11.456672	    7.717441	   10.000000	
    8.543328	    7.821919	   11.714256	
    8.543328	    7.821919	    8.285744	
    9.513550	    8.409465	   10.000000	
    9.653431	   11.240344	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.177 ms
Set up communicators.

--set up spincomm took 7.071 ms

--set up kptcomm took 0.360 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.007 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 19, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 19 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 19, mbQ = nbQ = 64
rank = 0, nr_Hp = 19, nc_Hp = 19
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.090 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.370 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 11.200 ms

Calculate_SplineDerivRadFun took 0.297 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.801 ms.
time spent on vectorized spline interp: 3.171 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.694 ms.
time spent on vectorized spline interp: 1.401 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.292 ms.
time spent on vectorized spline interp: 1.673 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.524 ms.
time spent on vectorized spline interp: 1.675 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.485 ms.

Calculating rb for all atom types took 19.727 ms
----------------------
Estimated memory usage
Total: 1.16 GB
orbitals             : 869.75 MB
global sized vectors : 213.62 MB
subspace matrices : 8.46 kB
others : 108.34 MB
----------------------------------------------
Estimated memory usage per processor: 99.31 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.056 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -24.0000000270755, sum_int_rho = 23.6983667338764
PosCharge = 24.000000027075, NegCharge = -23.698366733876, scal_fac = 1.012728020314
After scaling, int_rho = 24.0000000270754, PosCharge + NegCharge - NetCharge = 7.816e-14
--Calculate Vref took 0.424 ms
--Calculate rho_guess took 2.452 ms

 integral of b = -24.0000000270755,
 int{b} + Nelectron + NetCharge = -2.708e-08,
 Esc = -79.3104725361204,
 MPI_Reduce took 7.688 ms

Calculating b & b_ref took 16.585 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.081 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.162 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.092 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.581 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.005 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.636 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707543, int_b + int_rho = -2.219e-13, checking this took 0.380 ms
2-norm of RHS = 673.4617951421194, which took 0.673 ms

iter_count = 420, r_2norm = 5.786e-04, tol*||rhs|| = 6.735e-04

Anderson update took 234.971 ms, out of which F'*F took 105.920 ms; b-Ax took 722.831 ms, out of which Lap took 648.270 ms
Solving Poisson took 1523.539 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.831 ms
Total time for convolution: 	 convolve: 5.162157 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
Total time for convolution: 	 convolve: 5.145092 
Total time for convolution: 	 convolve: 5.133099 
Total time for convolution: 	 convolve: 5.223281 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 172.487 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.735 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.449 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
rank = 0, XC calculation took 24777.770 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 4.951 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.092 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.177 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.160 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.670 ms
    Lanczos iter 54, eigmin  = -1.134533975, eigmax = 264.935325559, err_eigmin = 8.203e-04, err_eigmax = 9.593e-03
rank =   0, Lanczos took 128.361 ms, eigmin = -1.134533974891, eigmax = 267.584678814591

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.175072, lowerbound = -1.234534, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1453.805 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.120 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.691 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.842 ms
rank =  0, finding HY took 24.245 ms
rank =  0, distributing HY into block cyclic form took 21.211 ms
rank =  0, finding Y'*HY took 6.589 ms
Rank 0, Project_Hamiltonian used 74.934 ms
Total time for projection: 74.948 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.777 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.109 ms
rank = 0, Solve_Generalized_EigenProblem used 0.893 ms
    first calculated eigval = 2.737935963330133
    last  calculated eigval = 3.245925597926525
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =   2.79512987757695
lambda[   4] =   2.85445745650224
lambda[   5] =   2.87277051365520
lambda[   6] =   2.91518405614090
lambda[   7] =   2.93844885015317
lambda[   8] =   2.97740298283323
lambda[   9] =   2.98278694229005
lambda[  10] =   2.99715551804502
lambda[  11] =   3.01284364885982
lambda[  12] =   3.04432408945295
lambda[  13] =   3.09494829461454
lambda[  14] =   3.12658105181143
lambda[  15] =   3.14271738810846
lambda[  16] =   3.16163797962741
lambda[  17] =   3.18919249128048
lambda[  18] =   3.20102087029141
lambda[  19] =   3.24592559792652
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.906 ms
rank =  0, subspace rotation using ScaLAPACK took 7.080 ms
rank =  0, Distributing orbital back into band + domain format took 17.567 ms
rank = 0, Subspace_Rotation used 24.669 ms

Total time for subspace rotation: 24.672 ms
rank = 0, Efermi =   3.069648672979 calculate fermi energy took 0.056 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.345926, lowerbound = -1.234534, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1443.134 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 19.067 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.476 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.563 ms
rank =  0, finding HY took 23.631 ms
rank =  0, distributing HY into block cyclic form took 17.301 ms
rank =  0, finding Y'*HY took 3.564 ms
Rank 0, Project_Hamiltonian used 66.092 ms
Total time for projection: 66.096 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.237 ms
    first calculated eigval = -0.971617241728963
    last  calculated eigval = 0.470731870798320
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.59230104742552
lambda[   4] =  -0.31288618726584
lambda[   5] =  -0.22974766673618
lambda[   6] =  -0.18291643046733
lambda[   7] =  -0.03043233195716
lambda[   8] =   0.01053577667578
lambda[   9] =   0.04688982925184
lambda[  10] =   0.14771951239475
lambda[  11] =   0.26834293737296
lambda[  12] =   0.29840622873475
lambda[  13] =   0.32011397554118
lambda[  14] =   0.33979395071217
lambda[  15] =   0.36940327377756
lambda[  16] =   0.37382989825337
lambda[  17] =   0.39792961781732
lambda[  18] =   0.43693534588771
lambda[  19] =   0.47073187079832
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.247 ms
rank =  0, subspace rotation using ScaLAPACK took 7.105 ms
rank =  0, Distributing orbital back into band + domain format took 17.839 ms
rank = 0, Subspace_Rotation used 24.969 ms

Total time for subspace rotation: 24.973 ms
rank = 0, Efermi =   0.309260102797 calculate fermi energy took 0.024 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.570732, lowerbound = -1.234534, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1456.795 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.530 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.517 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.078 ms
rank =  0, finding HY took 23.604 ms
rank =  0, distributing HY into block cyclic form took 17.393 ms
rank =  0, finding Y'*HY took 3.533 ms
Rank 0, Project_Hamiltonian used 64.650 ms
Total time for projection: 64.655 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -1.139945235331846
    last  calculated eigval = 0.174107613979868
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.81595926396420
lambda[   4] =  -0.62513016321743
lambda[   5] =  -0.53121241599825
lambda[   6] =  -0.52600361410959
lambda[   7] =  -0.52193749037378
lambda[   8] =  -0.47330051774420
lambda[   9] =  -0.43586101398407
lambda[  10] =  -0.30441640098910
lambda[  11] =  -0.27497206035536
lambda[  12] =  -0.24312926003800
lambda[  13] =  -0.01776625323956
lambda[  14] =   0.07823226347310
lambda[  15] =   0.09407058178020
lambda[  16] =   0.10682489857374
lambda[  17] =   0.11481901093284
lambda[  18] =   0.13491945099661
lambda[  19] =   0.17410761397987
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 7.073 ms
rank =  0, Distributing orbital back into band + domain format took 17.314 ms
rank = 0, Subspace_Rotation used 24.410 ms

Total time for subspace rotation: 24.414 ms
rank = 0, Efermi =  -0.046659059171 calculate fermi energy took 0.024 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.274108, lowerbound = -1.234534, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1458.290 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.019 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.484 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.528 ms
rank =  0, finding HY took 23.646 ms
rank =  0, distributing HY into block cyclic form took 18.011 ms
rank =  0, finding Y'*HY took 3.542 ms
Rank 0, Project_Hamiltonian used 65.781 ms
Total time for projection: 65.786 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -1.140048507971078
    last  calculated eigval = 0.098797023514388
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.81672016061589
lambda[   4] =  -0.62844058847007
lambda[   5] =  -0.53439671590330
lambda[   6] =  -0.53329636081210
lambda[   7] =  -0.53145348408999
lambda[   8] =  -0.48748866689700
lambda[   9] =  -0.44722376314970
lambda[  10] =  -0.31947132026567
lambda[  11] =  -0.31676119544360
lambda[  12] =  -0.30211328980684
lambda[  13] =  -0.09896766487501
lambda[  14] =   0.00197874587748
lambda[  15] =   0.03198760629703
lambda[  16] =   0.05230479467000
lambda[  17] =   0.06056051167863
lambda[  18] =   0.06867455709944
lambda[  19] =   0.09879702351439
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 7.034 ms
rank =  0, Distributing orbital back into band + domain format took 17.272 ms
rank = 0, Subspace_Rotation used 24.326 ms

Total time for subspace rotation: 24.331 ms
rank = 0, Efermi =  -0.127860470731 calculate fermi energy took 0.023 ms
rank = 0, --- Calculate rho: sum over local bands took 5.171 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.692 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.624 ms
rank = 0, Calculating density took 6330.996 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.875 ms
rank = 0, D2D took 1.978 ms
rank = 0, Transfering density took 1.981 ms
Etot    =   -51.260901284464
Eband   =   -14.109686393022
E1      =    27.812799190577
E2      =   -12.684561954050
E3      =   -15.840421521745
Exc     =   -14.178525020887
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 7.323e+00, dEband = 2.016e+00
rank = 0, Calculating/Estimating energy took 0.939 ms, Etot = -51.260901284, dEtot = 7.323e+00, dEband = 2.016e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 69.1640742057455, which took 0.713 ms

iter_count = 90, r_2norm = 2.088e-03, tol*||rhs|| = 2.767e-03

Anderson update took 48.415 ms, out of which F'*F took 22.774 ms; b-Ax took 153.139 ms, out of which Lap took 137.596 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 329.437 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707546, int_b + int_rho = -1.855e-13, checking this took 0.100 ms
2-norm of RHS = 670.5149835819342, which took 0.250 ms

iter_count = 270, r_2norm = 6.351e-04, tol*||rhs|| = 6.705e-04

Anderson update took 147.012 ms, out of which F'*F took 67.827 ms; b-Ax took 451.308 ms, out of which Lap took 406.840 ms
Solving Poisson took 969.175 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.458 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.298728 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.196091 
Total time for convolution: 	 convolve: 5.253666 
Total time for convolution: 	 convolve: 5.205404 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.321 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.833 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.191 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
---Transfer Veff_loc: D2D took 3.558 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.093 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.694 ms

This SCF took 32740.163 ms, scf error = 1.475e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.198797, lowerbound = -1.140049, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1434.630 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.677 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.531 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.235 ms
rank =  0, finding HY took 23.122 ms
rank =  0, distributing HY into block cyclic form took 20.532 ms
rank =  0, finding Y'*HY took 3.548 ms
Rank 0, Project_Hamiltonian used 68.479 ms
Total time for projection: 68.499 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -1.149543452733057
    last  calculated eigval = 0.073200668897242
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.79369113179545
lambda[   4] =  -0.61043523108157
lambda[   5] =  -0.52177104494337
lambda[   6] =  -0.51913424674787
lambda[   7] =  -0.50729450161034
lambda[   8] =  -0.46339480619380
lambda[   9] =  -0.43758988252601
lambda[  10] =  -0.30137996248377
lambda[  11] =  -0.29473895627234
lambda[  12] =  -0.27835617120116
lambda[  13] =  -0.11821404874880
lambda[  14] =  -0.02634627037903
lambda[  15] =   0.01724777557916
lambda[  16] =   0.02746784594937
lambda[  17] =   0.03864126636112
lambda[  18] =   0.04395293797281
lambda[  19] =   0.07320066889724
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 7.427 ms
rank =  0, Distributing orbital back into band + domain format took 17.057 ms
rank = 0, Subspace_Rotation used 24.503 ms

Total time for subspace rotation: 24.507 ms
rank = 0, Efermi =  -0.147106854647 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.346 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.371 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 1544.379 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.821 ms
rank = 0, D2D took 1.922 ms
rank = 0, Transfering density took 1.928 ms
Etot    =   -51.197149021306
Eband   =   -13.740880301637
E1      =    27.483139106133
E2      =   -12.680412102786
E3      =   -15.978354662419
Exc     =   -14.287702054080
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 9.107e-03, dEband = 5.269e-02
rank = 0, Calculating/Estimating energy took 0.935 ms, Etot = -51.197149021, dEtot = 9.107e-03, dEband = 5.269e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 39.3046580389489, which took 0.075 ms

iter_count = 90, r_2norm = 1.534e-03, tol*||rhs|| = 1.572e-03

Anderson update took 48.128 ms, out of which F'*F took 22.593 ms; b-Ax took 152.820 ms, out of which Lap took 136.962 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 331.948 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707533, int_b + int_rho = -3.129e-13, checking this took 0.101 ms
2-norm of RHS = 668.4838076792744, which took 0.163 ms

iter_count = 276, r_2norm = 6.579e-04, tol*||rhs|| = 6.685e-04

Anderson update took 148.057 ms, out of which F'*F took 89.039 ms; b-Ax took 486.483 ms, out of which Lap took 440.623 ms
Solving Poisson took 1009.943 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.218932 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 42.883 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.237124 
Total time for convolution: 	 convolve: 5.222927 
Total time for convolution: 	 convolve: 5.183444 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.302 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.546 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.120 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.726 ms

This SCF took 27901.512 ms, scf error = 9.030e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.173201, lowerbound = -1.149543, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1411.762 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.161 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.778 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.957 ms
rank =  0, finding HY took 23.809 ms
rank =  0, distributing HY into block cyclic form took 22.589 ms
rank =  0, finding Y'*HY took 3.750 ms
Rank 0, Project_Hamiltonian used 71.145 ms
Total time for projection: 71.162 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.080 ms
rank = 0, Solve_Generalized_EigenProblem used 0.198 ms
    first calculated eigval = -1.153849073533192
    last  calculated eigval = 0.058575202761610
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.76887842490256
lambda[   4] =  -0.58687419690254
lambda[   5] =  -0.51430758870564
lambda[   6] =  -0.50521102529430
lambda[   7] =  -0.48615031506021
lambda[   8] =  -0.43401196644534
lambda[   9] =  -0.41463647544583
lambda[  10] =  -0.29211234245359
lambda[  11] =  -0.27790771742732
lambda[  12] =  -0.26218645348317
lambda[  13] =  -0.11909057670684
lambda[  14] =  -0.03140357626639
lambda[  15] =   0.01602257067064
lambda[  16] =   0.02214994321055
lambda[  17] =   0.02916934551479
lambda[  18] =   0.03761009603899
lambda[  19] =   0.05857520276161
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 7.414 ms
rank =  0, Distributing orbital back into band + domain format took 16.974 ms
rank = 0, Subspace_Rotation used 24.416 ms

Total time for subspace rotation: 24.420 ms
rank = 0, Efermi =  -0.147983382646 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.272 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.280 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.564 ms
rank = 0, Calculating density took 1525.795 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.796 ms
rank = 0, D2D took 9.723 ms
rank = 0, Transfering density took 9.726 ms
Etot    =   -51.171944456825
Eband   =   -13.373812384986
E1      =    27.153788130945
E2      =   -12.637112599919
E3      =   -16.126762581457
Exc     =   -14.405322847234
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 3.601e-03, dEband = 5.244e-02
rank = 0, Calculating/Estimating energy took 0.964 ms, Etot = -51.171944457, dEtot = 3.601e-03, dEband = 5.244e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 6.8875162833838, which took 6.191 ms

iter_count = 102, r_2norm = 1.879e-04, tol*||rhs|| = 2.755e-04

Anderson update took 56.089 ms, out of which F'*F took 25.918 ms; b-Ax took 173.080 ms, out of which Lap took 156.204 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 384.506 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707531, int_b + int_rho = -3.383e-13, checking this took 0.113 ms
2-norm of RHS = 667.9328048616276, which took 0.791 ms

iter_count = 276, r_2norm = 6.335e-04, tol*||rhs|| = 6.679e-04

Anderson update took 153.594 ms, out of which F'*F took 68.983 ms; b-Ax took 467.084 ms, out of which Lap took 418.520 ms
Solving Poisson took 994.698 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.260052 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.236626 
Total time for convolution: 	 convolve: 5.190921 
Total time for convolution: 	 convolve: 5.193649 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
---Transfer Veff_loc: D2D took 3.599 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.082 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.721 ms

This SCF took 28012.983 ms, scf error = 4.750e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.158575, lowerbound = -1.153849, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1418.659 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.780 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.554 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.358 ms
rank =  0, finding HY took 22.993 ms
rank =  0, distributing HY into block cyclic form took 17.590 ms
rank =  0, finding Y'*HY took 3.566 ms
Rank 0, Project_Hamiltonian used 64.545 ms
Total time for projection: 64.558 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.221 ms
    first calculated eigval = -1.149522649293524
    last  calculated eigval = 0.047317861206224
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.74763131072522
lambda[   4] =  -0.56720449564032
lambda[   5] =  -0.50548887860128
lambda[   6] =  -0.49214066904747
lambda[   7] =  -0.47453933158720
lambda[   8] =  -0.40846394150442
lambda[   9] =  -0.39169095954396
lambda[  10] =  -0.29216242358270
lambda[  11] =  -0.26956504703435
lambda[  12] =  -0.25557678403230
lambda[  13] =  -0.11387397186262
lambda[  14] =  -0.03252283806639
lambda[  15] =   0.01713860212821
lambda[  16] =   0.01920214918993
lambda[  17] =   0.02673009060342
lambda[  18] =   0.03220403287062
lambda[  19] =   0.04731786120622
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 7.420 ms
rank =  0, Distributing orbital back into band + domain format took 17.017 ms
rank = 0, Subspace_Rotation used 24.462 ms

Total time for subspace rotation: 24.468 ms
rank = 0, Efermi =  -0.142766777786 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.332 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.335 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.658 ms
rank = 0, Calculating density took 1525.383 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.012 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.963 ms
rank = 0, D2D took 2.071 ms
rank = 0, Transfering density took 2.075 ms
Etot    =   -51.164559384457
Eband   =   -13.083098621317
E1      =    26.914195249700
E2      =   -12.566681571074
E3      =   -16.251584881464
Exc     =   -14.503449928452
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 1.055e-03, dEband = 4.153e-02
rank = 0, Calculating/Estimating energy took 0.939 ms, Etot = -51.164559384, dEtot = 1.055e-03, dEband = 4.153e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.5790415577430, which took 0.073 ms

iter_count = 102, r_2norm = 1.076e-04, tol*||rhs|| = 1.432e-04

Anderson update took 54.458 ms, out of which F'*F took 25.784 ms; b-Ax took 178.380 ms, out of which Lap took 161.012 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 379.126 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707529, int_b + int_rho = -3.565e-13, checking this took 0.113 ms
2-norm of RHS = 668.0858875687092, which took 0.143 ms

iter_count = 234, r_2norm = 6.437e-04, tol*||rhs|| = 6.681e-04

Anderson update took 125.888 ms, out of which F'*F took 58.178 ms; b-Ax took 395.619 ms, out of which Lap took 354.416 ms
Solving Poisson took 838.937 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.238309 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 6.735994 
Total time for convolution: 	 convolve: 5.230557 
Total time for convolution: 	 convolve: 5.217820 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.348 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.035 ms
---Transfer Veff_loc: D2D took 3.625 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.524 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.188 ms

This SCF took 29321.531 ms, scf error = 1.105e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.147318, lowerbound = -1.149523, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1404.345 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.396 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.506 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.921 ms
rank =  0, finding HY took 23.325 ms
rank =  0, distributing HY into block cyclic form took 17.323 ms
rank =  0, finding Y'*HY took 3.871 ms
Rank 0, Project_Hamiltonian used 64.481 ms
Total time for projection: 64.493 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -1.147731867736960
    last  calculated eigval = 0.039996681878615
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.74583657668626
lambda[   4] =  -0.56456826794895
lambda[   5] =  -0.50431792298661
lambda[   6] =  -0.48978823318626
lambda[   7] =  -0.47179389017097
lambda[   8] =  -0.40543222452620
lambda[   9] =  -0.38918444576158
lambda[  10] =  -0.28984235147069
lambda[  11] =  -0.26688004384196
lambda[  12] =  -0.25245856850751
lambda[  13] =  -0.11226255011920
lambda[  14] =  -0.03307548328365
lambda[  15] =   0.01585069253026
lambda[  16] =   0.01758539714194
lambda[  17] =   0.02274902872949
lambda[  18] =   0.02778197141872
lambda[  19] =   0.03999668187862
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 7.493 ms
rank =  0, Distributing orbital back into band + domain format took 17.074 ms
rank = 0, Subspace_Rotation used 24.586 ms

Total time for subspace rotation: 24.590 ms
rank = 0, Efermi =  -0.141155356060 calculate fermi energy took 0.621 ms
rank = 0, --- Calculate rho: sum over local bands took 5.408 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.247 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.554 ms
rank = 0, Calculating density took 1510.557 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.878 ms
rank = 0, D2D took 1.972 ms
rank = 0, Transfering density took 1.975 ms
Etot    =   -51.164039088791
Eband   =   -13.025830732465
E1      =    26.879373999428
E2      =   -12.539140371590
E3      =   -16.273825769223
Exc     =   -14.520075959641
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 7.433e-05, dEband = 8.181e-03
rank = 0, Calculating/Estimating energy took 0.955 ms, Etot = -51.164039089, dEtot = 7.433e-05, dEband = 8.181e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0249554962318, which took 0.057 ms

iter_count = 108, r_2norm = 3.762e-05, tol*||rhs|| = 4.100e-05

Anderson update took 61.521 ms, out of which F'*F took 26.689 ms; b-Ax took 182.705 ms, out of which Lap took 163.928 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 402.170 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707540, int_b + int_rho = -2.474e-13, checking this took 0.101 ms
2-norm of RHS = 668.3901227904005, which took 0.140 ms

iter_count = 234, r_2norm = 5.338e-04, tol*||rhs|| = 6.684e-04

Anderson update took 125.052 ms, out of which F'*F took 58.851 ms; b-Ax took 403.405 ms, out of which Lap took 360.913 ms
Solving Poisson took 844.417 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.280451 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.287869 
Total time for convolution: 	 convolve: 5.234967 
Total time for convolution: 	 convolve: 5.219529 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.377 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.578 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.093 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.710 ms

This SCF took 27941.456 ms, scf error = 5.709e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.139997, lowerbound = -1.147732, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1402.584 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.313 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.481 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.814 ms
rank =  0, finding HY took 23.143 ms
rank =  0, distributing HY into block cyclic form took 17.462 ms
rank =  0, finding Y'*HY took 3.570 ms
Rank 0, Project_Hamiltonian used 64.024 ms
Total time for projection: 64.036 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -1.145935082162862
    last  calculated eigval = 0.035086024729510
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.74484468977419
lambda[   4] =  -0.56326289281479
lambda[   5] =  -0.50316711474422
lambda[   6] =  -0.48835102049906
lambda[   7] =  -0.47013242707114
lambda[   8] =  -0.40406429360065
lambda[   9] =  -0.38814115311620
lambda[  10] =  -0.28821715229899
lambda[  11] =  -0.26522082525329
lambda[  12] =  -0.25054403993483
lambda[  13] =  -0.11088940959414
lambda[  14] =  -0.03327558378326
lambda[  15] =   0.01490011296617
lambda[  16] =   0.01658333975116
lambda[  17] =   0.02038165105321
lambda[  18] =   0.02532441021399
lambda[  19] =   0.03508602472951
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 7.568 ms
rank =  0, Distributing orbital back into band + domain format took 17.024 ms
rank = 0, Subspace_Rotation used 24.609 ms

Total time for subspace rotation: 24.614 ms
rank = 0, Efermi =  -0.139782215545 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.350 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.970 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.625 ms
rank = 0, Calculating density took 1508.532 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.920 ms
rank = 0, D2D took 2.020 ms
rank = 0, Transfering density took 2.023 ms
Etot    =   -51.163877131717
Eband   =   -12.989841899805
E1      =    26.865094679164
E2      =   -12.514536036650
E3      =   -16.283826827711
Exc     =   -14.527020238511
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 2.314e-05, dEband = 5.141e-03
rank = 0, Calculating/Estimating energy took 1.033 ms, Etot = -51.163877132, dEtot = 2.314e-05, dEband = 5.141e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5359724824986, which took 0.053 ms

iter_count = 108, r_2norm = 1.691e-05, tol*||rhs|| = 2.144e-05

Anderson update took 84.740 ms, out of which F'*F took 26.779 ms; b-Ax took 186.785 ms, out of which Lap took 167.499 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 425.089 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707540, int_b + int_rho = -2.474e-13, checking this took 0.106 ms
2-norm of RHS = 668.7058851931961, which took 0.104 ms

iter_count = 234, r_2norm = 5.666e-04, tol*||rhs|| = 6.687e-04

Anderson update took 124.796 ms, out of which F'*F took 57.968 ms; b-Ax took 399.740 ms, out of which Lap took 357.235 ms
Solving Poisson took 843.517 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.224975 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Total time for convolution: 	 convolve: 5.257244 
Total time for convolution: 	 convolve: 5.228063 
Total time for convolution: 	 convolve: 5.239104 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.350 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.567 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.092 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.700 ms

This SCF took 27966.083 ms, scf error = 2.712e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.135086, lowerbound = -1.145935, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1404.104 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.339 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.505 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.864 ms
rank =  0, finding HY took 23.133 ms
rank =  0, distributing HY into block cyclic form took 17.983 ms
rank =  0, finding Y'*HY took 3.664 ms
Rank 0, Project_Hamiltonian used 64.679 ms
Total time for projection: 64.693 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -1.144365178448640
    last  calculated eigval = 0.032336505753404
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.74247312338912
lambda[   4] =  -0.56130512751746
lambda[   5] =  -0.50171001195304
lambda[   6] =  -0.48651348963085
lambda[   7] =  -0.46842460681822
lambda[   8] =  -0.40162401430491
lambda[   9] =  -0.38605532480207
lambda[  10] =  -0.28695816454035
lambda[  11] =  -0.26351738183001
lambda[  12] =  -0.24898954643358
lambda[  13] =  -0.10958990741197
lambda[  14] =  -0.03290237841665
lambda[  15] =   0.01448146970681
lambda[  16] =   0.01635082042029
lambda[  17] =   0.02009595295309
lambda[  18] =   0.02352741246302
lambda[  19] =   0.03233650575340
==subpsace eigenproblem: bcast eigvals took 0.040 ms
Total time for solving subspace eigenvalue problem: 0.267 ms
rank =  0, subspace rotation using ScaLAPACK took 7.420 ms
rank =  0, Distributing orbital back into band + domain format took 17.105 ms
rank = 0, Subspace_Rotation used 24.556 ms

Total time for subspace rotation: 24.561 ms
rank = 0, Efermi =  -0.138482713350 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.358 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.204 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.581 ms
rank = 0, Calculating density took 1510.895 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.804 ms
rank = 0, D2D took 1.903 ms
rank = 0, Transfering density took 1.911 ms
Etot    =   -51.163813956645
Eband   =   -12.946869285421
E1      =    26.846716987877
E2      =   -12.487638278425
E3      =   -16.291423673463
Exc     =   -14.532251074062
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 9.025e-06, dEband = 6.139e-03
rank = 0, Calculating/Estimating energy took 1.307 ms, Etot = -51.163813957, dEtot = 9.025e-06, dEband = 6.139e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3017266861006, which took 0.056 ms

iter_count = 108, r_2norm = 1.132e-05, tol*||rhs|| = 1.207e-05

Anderson update took 57.068 ms, out of which F'*F took 27.889 ms; b-Ax took 192.729 ms, out of which Lap took 173.389 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 408.242 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707537, int_b + int_rho = -2.801e-13, checking this took 0.101 ms
2-norm of RHS = 668.7441725157936, which took 0.131 ms

iter_count = 204, r_2norm = 6.358e-04, tol*||rhs|| = 6.687e-04

Anderson update took 110.725 ms, out of which F'*F took 51.553 ms; b-Ax took 349.048 ms, out of which Lap took 313.034 ms
Solving Poisson took 736.579 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.223353 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.227909 
Total time for convolution: 	 convolve: 5.246003 
Total time for convolution: 	 convolve: 5.215711 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.007 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.411 ms
---Transfer Veff_loc: D2D took 3.534 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.054 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.627 ms

This SCF took 27691.660 ms, scf error = 1.221e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.132337, lowerbound = -1.144365, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1403.645 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.405 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.525 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.948 ms
rank =  0, finding HY took 23.142 ms
rank =  0, distributing HY into block cyclic form took 17.425 ms
rank =  0, finding Y'*HY took 3.532 ms
Rank 0, Project_Hamiltonian used 64.082 ms
Total time for projection: 64.096 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.200 ms
    first calculated eigval = -1.143522443455912
    last  calculated eigval = 0.030859289571992
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.74165931643292
lambda[   4] =  -0.56042442746823
lambda[   5] =  -0.50101067441534
lambda[   6] =  -0.48561214802878
lambda[   7] =  -0.46743331101414
lambda[   8] =  -0.40080487110070
lambda[   9] =  -0.38534781706537
lambda[  10] =  -0.28605616200180
lambda[  11] =  -0.26256347128533
lambda[  12] =  -0.24799302388350
lambda[  13] =  -0.10880898754908
lambda[  14] =  -0.03244104273393
lambda[  15] =   0.01400607140192
lambda[  16] =   0.01654635758621
lambda[  17] =   0.02030137278193
lambda[  18] =   0.02286891405844
lambda[  19] =   0.03085928957199
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 7.485 ms
rank =  0, Distributing orbital back into band + domain format took 17.863 ms
rank = 0, Subspace_Rotation used 25.372 ms

Total time for subspace rotation: 25.377 ms
rank = 0, Efermi =  -0.137701793546 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 5.115 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.713 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1509.930 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.912 ms
rank = 0, D2D took 2.010 ms
rank = 0, Transfering density took 2.018 ms
Etot    =   -51.163848560499
Eband   =   -12.926009880592
E1      =    26.835985346139
E2      =   -12.476584740326
E3      =   -16.294652225249
Exc     =   -14.534588454695
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 4.943e-06, dEband = 2.980e-03
rank = 0, Calculating/Estimating energy took 0.933 ms, Etot = -51.163848560, dEtot = 4.943e-06, dEband = 2.980e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1572440435133, which took 0.059 ms

iter_count = 108, r_2norm = 5.964e-06, tol*||rhs|| = 6.290e-06

Anderson update took 57.799 ms, out of which F'*F took 27.175 ms; b-Ax took 184.550 ms, out of which Lap took 165.655 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.702 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707537, int_b + int_rho = -2.838e-13, checking this took 0.113 ms
2-norm of RHS = 668.7493505077737, which took 0.111 ms

iter_count = 210, r_2norm = 6.665e-04, tol*||rhs|| = 6.687e-04

Anderson update took 111.625 ms, out of which F'*F took 52.915 ms; b-Ax took 358.731 ms, out of which Lap took 320.563 ms
Solving Poisson took 756.085 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.237870 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.262756 
Total time for convolution: 	 convolve: 5.192071 
Total time for convolution: 	 convolve: 5.207293 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.008 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.192 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.196 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.039 ms
---Transfer Veff_loc: D2D took 3.558 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.015 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.608 ms

This SCF took 27623.662 ms, scf error = 8.839e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.130859, lowerbound = -1.143522, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1410.169 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.928 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.500 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.448 ms
rank =  0, finding HY took 23.060 ms
rank =  0, distributing HY into block cyclic form took 17.604 ms
rank =  0, finding Y'*HY took 3.577 ms
Rank 0, Project_Hamiltonian used 64.722 ms
Total time for projection: 64.736 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -1.142176921674526
    last  calculated eigval = 0.031018818079041
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.74048553687044
lambda[   4] =  -0.55918885766709
lambda[   5] =  -0.49982211068888
lambda[   6] =  -0.48429266235032
lambda[   7] =  -0.46603437765585
lambda[   8] =  -0.39976346115008
lambda[   9] =  -0.38440788332730
lambda[  10] =  -0.28482307883797
lambda[  11] =  -0.26126126994436
lambda[  12] =  -0.24666033317532
lambda[  13] =  -0.10754345480771
lambda[  14] =  -0.03102753801575
lambda[  15] =   0.01481142943617
lambda[  16] =   0.01796252479693
lambda[  17] =   0.02195881763426
lambda[  18] =   0.02276741793025
lambda[  19] =   0.03101881807904
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 7.405 ms
rank =  0, Distributing orbital back into band + domain format took 17.503 ms
rank = 0, Subspace_Rotation used 24.924 ms

Total time for subspace rotation: 24.930 ms
rank = 0, Efermi =  -0.136436260673 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.196 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.368 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.559 ms
rank = 0, Calculating density took 1516.311 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.827 ms
rank = 0, D2D took 1.932 ms
rank = 0, Transfering density took 1.935 ms
Etot    =   -51.163926303221
Eband   =   -12.896321392380
E1      =    26.820530374179
E2      =   -12.461472769697
E3      =   -16.297793584520
Exc     =   -14.536929102312
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 1.111e-05, dEband = 4.241e-03
rank = 0, Calculating/Estimating energy took 0.945 ms, Etot = -51.163926303, dEtot = 1.111e-05, dEband = 4.241e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2175461011713, which took 0.087 ms

iter_count = 102, r_2norm = 5.771e-06, tol*||rhs|| = 8.702e-06

Anderson update took 54.643 ms, out of which F'*F took 25.853 ms; b-Ax took 173.184 ms, out of which Lap took 155.979 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.934 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707538, int_b + int_rho = -2.728e-13, checking this took 0.098 ms
2-norm of RHS = 668.7527224293570, which took 0.128 ms

iter_count = 210, r_2norm = 5.326e-04, tol*||rhs|| = 6.688e-04

Anderson update took 112.458 ms, out of which F'*F took 53.177 ms; b-Ax took 369.608 ms, out of which Lap took 332.929 ms
Solving Poisson took 783.365 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.235924 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.198381 
Total time for convolution: 	 convolve: 5.193082 
Total time for convolution: 	 convolve: 5.227458 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.880 ms
---Transfer Veff_loc: D2D took 3.551 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.033 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.620 ms

This SCF took 27568.940 ms, scf error = 5.228e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.131019, lowerbound = -1.142177, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1407.407 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.487 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.500 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.006 ms
rank =  0, finding HY took 22.950 ms
rank =  0, distributing HY into block cyclic form took 17.674 ms
rank =  0, finding Y'*HY took 3.590 ms
Rank 0, Project_Hamiltonian used 64.272 ms
Total time for projection: 64.286 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.511 ms
rank = 0, Solve_Generalized_EigenProblem used 1.632 ms
    first calculated eigval = -1.140978262852833
    last  calculated eigval = 0.032024897706603
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.73954851609790
lambda[   4] =  -0.55818078067727
lambda[   5] =  -0.49875688058487
lambda[   6] =  -0.48320094934221
lambda[   7] =  -0.46487340052456
lambda[   8] =  -0.39888930721445
lambda[   9] =  -0.38357670943268
lambda[  10] =  -0.28365084011937
lambda[  11] =  -0.26011069476275
lambda[  12] =  -0.24545588597286
lambda[  13] =  -0.10640717226819
lambda[  14] =  -0.02814270790669
lambda[  15] =   0.01748636960256
lambda[  16] =   0.02154987134593
lambda[  17] =   0.02376277118874
lambda[  18] =   0.02505872846095
lambda[  19] =   0.03202489770660
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 1.658 ms
rank =  0, subspace rotation using ScaLAPACK took 7.442 ms
rank =  0, Distributing orbital back into band + domain format took 17.033 ms
rank = 0, Subspace_Rotation used 24.494 ms

Total time for subspace rotation: 24.499 ms
rank = 0, Efermi =  -0.135299978187 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.256 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.388 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.590 ms
rank = 0, Calculating density took 1514.199 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.823 ms
rank = 0, D2D took 1.925 ms
rank = 0, Transfering density took 1.931 ms
Etot    =   -51.163994779398
Eband   =   -12.870513718650
E1      =    26.808055792003
E2      =   -12.447674516583
E3      =   -16.299509999180
Exc     =   -14.538248831587
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 9.782e-06, dEband = 3.687e-03
rank = 0, Calculating/Estimating energy took 0.952 ms, Etot = -51.163994779, dEtot = 9.782e-06, dEband = 3.687e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1074622354939, which took 0.054 ms

iter_count = 102, r_2norm = 4.036e-06, tol*||rhs|| = 4.298e-06

Anderson update took 54.599 ms, out of which F'*F took 25.596 ms; b-Ax took 173.951 ms, out of which Lap took 157.044 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.618 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707542, int_b + int_rho = -2.256e-13, checking this took 0.112 ms
2-norm of RHS = 668.7625614961229, which took 0.116 ms

iter_count = 180, r_2norm = 5.600e-04, tol*||rhs|| = 6.688e-04

Anderson update took 97.453 ms, out of which F'*F took 45.559 ms; b-Ax took 305.278 ms, out of which Lap took 274.920 ms
Solving Poisson took 649.177 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 5.209857 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 145.007 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.210168 
Total time for convolution: 	 convolve: 5.263372 
Total time for convolution: 	 convolve: 5.250840 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.752 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.007 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 3.596 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.016 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.652 ms

This SCF took 27669.531 ms, scf error = 2.995e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.132025, lowerbound = -1.140978, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1413.862 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.217 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.532 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.774 ms
rank =  0, finding HY took 23.225 ms
rank =  0, distributing HY into block cyclic form took 17.263 ms
rank =  0, finding Y'*HY took 3.559 ms
Rank 0, Project_Hamiltonian used 64.873 ms
Total time for projection: 64.891 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.213 ms
    first calculated eigval = -1.140551019248017
    last  calculated eigval = 0.032618943819881
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.73910172195574
lambda[   4] =  -0.55778822677580
lambda[   5] =  -0.49833661892638
lambda[   6] =  -0.48280096717551
lambda[   7] =  -0.46448840631537
lambda[   8] =  -0.39848197359066
lambda[   9] =  -0.38317442265784
lambda[  10] =  -0.28326184932422
lambda[  11] =  -0.25971121264579
lambda[  12] =  -0.24506865087677
lambda[  13] =  -0.10600760069969
lambda[  14] =  -0.02658714215704
lambda[  15] =   0.01900208933856
lambda[  16] =   0.02285226876380
lambda[  17] =   0.02488724305357
lambda[  18] =   0.02647282448224
lambda[  19] =   0.03261894381988
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 7.556 ms
rank =  0, Distributing orbital back into band + domain format took 17.048 ms
rank = 0, Subspace_Rotation used 24.622 ms

Total time for subspace rotation: 24.627 ms
rank = 0, Efermi =  -0.134900406647 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 5.419 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.392 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.566 ms
rank = 0, Calculating density took 1520.116 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.812 ms
rank = 0, D2D took 1.914 ms
rank = 0, Transfering density took 1.921 ms
Etot    =   -51.164025724673
Eband   =   -12.860782033850
E1      =    26.803356290965
E2      =   -12.442508893421
E3      =   -16.300044923912
Exc     =   -14.538681262195
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 4.421e-06, dEband = 1.390e-03
rank = 0, Calculating/Estimating energy took 0.937 ms, Etot = -51.164025725, dEtot = 4.421e-06, dEband = 1.390e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0516765880084, which took 0.055 ms

iter_count = 108, r_2norm = 1.468e-06, tol*||rhs|| = 2.067e-06

Anderson update took 58.127 ms, out of which F'*F took 27.277 ms; b-Ax took 182.479 ms, out of which Lap took 164.366 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.286 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707539, int_b + int_rho = -2.619e-13, checking this took 0.111 ms
2-norm of RHS = 668.7660789650308, which took 0.125 ms

iter_count = 174, r_2norm = 6.470e-04, tol*||rhs|| = 6.688e-04

Anderson update took 92.698 ms, out of which F'*F took 45.044 ms; b-Ax took 296.257 ms, out of which Lap took 265.780 ms
Solving Poisson took 626.559 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Total time for convolution: 	 convolve: 5.236603 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 67.221 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.270294 
Total time for convolution: 	 convolve: 5.258082 
Total time for convolution: 	 convolve: 5.247379 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.727 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.546 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.031 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.633 ms

This SCF took 27745.767 ms, scf error = 2.168e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132619, lowerbound = -1.140551, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1402.823 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.300 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.567 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.888 ms
rank =  0, finding HY took 23.209 ms
rank =  0, distributing HY into block cyclic form took 17.505 ms
rank =  0, finding Y'*HY took 3.530 ms
Rank 0, Project_Hamiltonian used 64.168 ms
Total time for projection: 64.182 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -1.139970001247142
    last  calculated eigval = 0.034750387361588
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.73859947058663
lambda[   4] =  -0.55730762353247
lambda[   5] =  -0.49778584556834
lambda[   6] =  -0.48229034860778
lambda[   7] =  -0.46396264591679
lambda[   8] =  -0.39804577188661
lambda[   9] =  -0.38273179635836
lambda[  10] =  -0.28270479515381
lambda[  11] =  -0.25918598465649
lambda[  12] =  -0.24453436012959
lambda[  13] =  -0.10545342865238
lambda[  14] =  -0.02411130384009
lambda[  15] =   0.02194113921785
lambda[  16] =   0.02361861042148
lambda[  17] =   0.02787854339993
lambda[  18] =   0.02864007247390
lambda[  19] =   0.03475038736159
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 7.490 ms
rank =  0, Distributing orbital back into band + domain format took 17.118 ms
rank = 0, Subspace_Rotation used 24.627 ms

Total time for subspace rotation: 24.632 ms
rank = 0, Efermi =  -0.134346234582 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.420 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.373 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.559 ms
rank = 0, Calculating density took 1508.329 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.799 ms
rank = 0, D2D took 1.902 ms
rank = 0, Transfering density took 1.904 ms
Etot    =   -51.164060044601
Eband   =   -12.848342966354
E1      =    26.797123868724
E2      =   -12.436114445441
E3      =   -16.300825966689
Exc     =   -14.539308822175
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 4.903e-06, dEband = 1.777e-03
rank = 0, Calculating/Estimating energy took 0.936 ms, Etot = -51.164060045, dEtot = 4.903e-06, dEband = 1.777e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0446627956558, which took 0.051 ms

iter_count = 108, r_2norm = 1.188e-06, tol*||rhs|| = 1.787e-06

Anderson update took 57.884 ms, out of which F'*F took 27.090 ms; b-Ax took 184.183 ms, out of which Lap took 164.626 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.025 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707533, int_b + int_rho = -3.129e-13, checking this took 0.104 ms
2-norm of RHS = 668.7681865339134, which took 0.152 ms

iter_count = 150, r_2norm = 5.404e-04, tol*||rhs|| = 6.688e-04

Anderson update took 80.361 ms, out of which F'*F took 37.618 ms; b-Ax took 254.724 ms, out of which Lap took 227.780 ms
Solving Poisson took 541.732 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.263908 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.304987 
Total time for convolution: 	 convolve: 5.298096 
Total time for convolution: 	 convolve: 5.244719 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
---Transfer Veff_loc: D2D took 3.551 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.741 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.348 ms

This SCF took 27691.246 ms, scf error = 1.288e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134750, lowerbound = -1.139970, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1422.870 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.422 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.530 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.971 ms
rank =  0, finding HY took 23.218 ms
rank =  0, distributing HY into block cyclic form took 17.344 ms
rank =  0, finding Y'*HY took 3.632 ms
Rank 0, Project_Hamiltonian used 64.203 ms
Total time for projection: 64.219 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.210 ms
    first calculated eigval = -1.139799115594291
    last  calculated eigval = 0.036031491456035
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.73844154278867
lambda[   4] =  -0.55714426910522
lambda[   5] =  -0.49761196783815
lambda[   6] =  -0.48212232356525
lambda[   7] =  -0.46378509189546
lambda[   8] =  -0.39789986989737
lambda[   9] =  -0.38258401908176
lambda[  10] =  -0.28252467590443
lambda[  11] =  -0.25901708383665
lambda[  12] =  -0.24436158821887
lambda[  13] =  -0.10527632530662
lambda[  14] =  -0.02286015758729
lambda[  15] =   0.02299344446192
lambda[  16] =   0.02394160215059
lambda[  17] =   0.02950742893026
lambda[  18] =   0.02998689100977
lambda[  19] =   0.03603149145603
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.228 ms
rank =  0, subspace rotation using ScaLAPACK took 7.401 ms
rank =  0, Distributing orbital back into band + domain format took 17.087 ms
rank = 0, Subspace_Rotation used 24.506 ms

Total time for subspace rotation: 24.511 ms
rank = 0, Efermi =  -0.134169131236 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.515 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.233 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 1528.306 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.825 ms
rank = 0, D2D took 1.917 ms
rank = 0, Transfering density took 1.920 ms
Etot    =   -51.164083058654
Eband   =   -12.844349083746
E1      =    26.795238552118
E2      =   -12.433961690510
E3      =   -16.300963835370
Exc     =   -14.539425515979
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 3.288e-06, dEband = 5.706e-04
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -51.164083059, dEtot = 3.288e-06, dEband = 5.706e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0348811458597, which took 0.054 ms

iter_count = 108, r_2norm = 1.035e-06, tol*||rhs|| = 1.395e-06

Anderson update took 57.843 ms, out of which F'*F took 27.217 ms; b-Ax took 182.558 ms, out of which Lap took 163.713 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.677 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707533, int_b + int_rho = -3.129e-13, checking this took 0.106 ms
2-norm of RHS = 668.7695612915114, which took 0.074 ms

iter_count = 138, r_2norm = 6.279e-04, tol*||rhs|| = 6.688e-04

Anderson update took 74.046 ms, out of which F'*F took 34.748 ms; b-Ax took 235.350 ms, out of which Lap took 210.535 ms
Solving Poisson took 497.235 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.255270 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.257132 
Total time for convolution: 	 convolve: 5.300083 
Total time for convolution: 	 convolve: 5.263876 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.019 ms
---Transfer Veff_loc: D2D took 4.355 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.102 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.494 ms

This SCF took 27598.669 ms, scf error = 1.016e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136031, lowerbound = -1.139799, upperbound = 267.584679

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1407.764 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.322 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.554 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.898 ms
rank =  0, finding HY took 23.180 ms
rank =  0, distributing HY into block cyclic form took 17.614 ms
rank =  0, finding Y'*HY took 3.510 ms
Rank 0, Project_Hamiltonian used 64.236 ms
Total time for projection: 64.250 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -1.139702735418840
    last  calculated eigval = 0.036872994826113
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.73834178098843
lambda[   4] =  -0.55703664657453
lambda[   5] =  -0.49750800474920
lambda[   6] =  -0.48201593357906
lambda[   7] =  -0.46367339596639
lambda[   8] =  -0.39780012673914
lambda[   9] =  -0.38248338507603
lambda[  10] =  -0.28241683267108
lambda[  11] =  -0.25891356788869
lambda[  12] =  -0.24425525240260
lambda[  13] =  -0.10517786217462
lambda[  14] =  -0.02230908288570
lambda[  15] =   0.02317235791503
lambda[  16] =   0.02412601006566
lambda[  17] =   0.03030777433793
lambda[  18] =   0.03040898617624
lambda[  19] =   0.03687299482611
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 7.523 ms
rank =  0, Distributing orbital back into band + domain format took 17.167 ms
rank = 0, Subspace_Rotation used 24.709 ms

Total time for subspace rotation: 24.714 ms
rank = 0, Efermi =  -0.134070668096 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.490 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.277 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.574 ms
rank = 0, Calculating density took 1513.449 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.802 ms
rank = 0, D2D took 1.899 ms
rank = 0, Transfering density took 1.901 ms
Etot    =   -51.164104076907
Eband   =   -12.841867489640
E1      =    26.794087192443
E2      =   -12.432605562024
E3      =   -16.301016293992
Exc     =   -14.539473098800
Esc     =   -79.310472536120
Entropy =    -0.000000000806
dE = 3.003e-06, dEband = 3.545e-04
rank = 0, Calculating/Estimating energy took 0.964 ms, Etot = -51.164104077, dEtot = 3.003e-06, dEband = 3.545e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0299564029521, which took 0.051 ms

iter_count = 102, r_2norm = 1.163e-06, tol*||rhs|| = 1.198e-06

Anderson update took 54.891 ms, out of which F'*F took 25.481 ms; b-Ax took 172.494 ms, out of which Lap took 154.537 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.134 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002707565, int_rho =  24.00000002707542, int_b + int_rho = -2.328e-13, checking this took 0.106 ms
2-norm of RHS = 668.7708008952404, which took 0.106 ms

iter_count = 138, r_2norm = 5.638e-04, tol*||rhs|| = 6.688e-04

Anderson update took 73.437 ms, out of which F'*F took 34.430 ms; b-Ax took 235.213 ms, out of which Lap took 210.054 ms
Solving Poisson took 498.523 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.273581 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.211576 
Total time for convolution: 	 convolve: 5.216963 
Total time for convolution: 	 convolve: 5.255113 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.821 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.514 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.030 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.578 ms

This SCF took 27485.869 ms, scf error = 8.437e-05
The last 17 occupations of kpoints #1 are (Nelectron = 24):
lambda[   3] =  -0.73834178098843, occ[   3] =   2.00000000000000
lambda[   4] =  -0.55703664657453, occ[   4] =   2.00000000000000
lambda[   5] =  -0.49750800474920, occ[   5] =   2.00000000000000
lambda[   6] =  -0.48201593357906, occ[   6] =   2.00000000000000
lambda[   7] =  -0.46367339596639, occ[   7] =   2.00000000000000
lambda[   8] =  -0.39780012673914, occ[   8] =   2.00000000000000
lambda[   9] =  -0.38248338507603, occ[   9] =   2.00000000000000
lambda[  10] =  -0.28241683267108, occ[  10] =   2.00000000000000
lambda[  11] =  -0.25891356788869, occ[  11] =   2.00000000000000
lambda[  12] =  -0.24425525240260, occ[  12] =   2.00000000000000
lambda[  13] =  -0.10517786217462, occ[  13] =   0.00000002707539
lambda[  14] =  -0.02230908288570, occ[  14] =   0.00000000000000
lambda[  15] =   0.02317235791503, occ[  15] =   0.00000000000000
lambda[  16] =   0.02412601006566, occ[  16] =   0.00000000000000
lambda[  17] =   0.03030777433793, occ[  17] =   0.00000000000000
lambda[  18] =   0.03040898617624, occ[  18] =   0.00000000000000
lambda[  19] =   0.03687299482611, occ[  19] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 17 (90%) = 0.000000000000000.
Occupation of state 19 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.528 ms, time for Allreduce/Reduce: 9.599 ms 
Time for calculating local force components: 19.289 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.04079289455601  -0.58576317216380   1.15116918576809
 -0.04079263970447  -0.58576193879065  -1.15116788572237
 -0.04793921423407   0.01791922508123   0.00000003257909
  0.02462984414730   0.01523721783958  -0.04364970271274
  0.02462983980526   0.01523725388819   0.04364976861563
  0.02616354335878   0.14260610263679   0.00000105427027
  0.02538058027528   0.23769511085767   0.00000026626426
force_loc = 
  0.04021111534610   0.57926163896512  -1.13354993968565
  0.04021093775116   0.57926031118942   1.13354931848541
  0.04906688511095  -0.01853812023070  -0.00000002779948
 -0.02500376434662  -0.01644839160467   0.04451544287780
 -0.02500370821856  -0.01644822680957  -0.04451559107919
 -0.02656998518376  -0.14014384194210  -0.00000066649443
 -0.02508045398672  -0.24520410853174   0.00000004540934
Time for calculating nonlocal force components: 38.227 ms
[32mforces_xc: 
[0m[32m  0.00110034758922   0.01549815895061  -0.03131331861422
[0m[32m  0.00110037665815   0.01549809674705   0.03131326765410
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00097887508582  -0.00645943723131  -0.00000004663641
[0m[32m -0.00036420284616  -0.00325352001917  -0.00000000048094
[0mTime for calculating XC forces components: 25.203 ms
 Cartesian force = 
  0.00052317811074   0.00896914591879  -0.01369424434586
  0.00052328443627   0.00896898931268   0.01369452860306
  0.00113228060830  -0.00064637498260  -0.00000016703447
 -0.00036931046789  -0.00123865359822   0.00086556835098
 -0.00036925868187  -0.00123845275452  -0.00086599427764
 -0.00138070717937  -0.00402465636975   0.00000016932535
 -0.00005946682617  -0.01078999752638   0.00000013937858
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Time for printing density: 388.939 ms
The program took 423.103 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:10
Job ID:        2266536
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:28:00,vmem=8244K,walltime=00:07:20,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-18-1
---------------------------------------
