---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:47
Job ID:    2266479
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:52
Job ID:    2266479
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.084 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.019 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 8.926 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 7.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 6.118 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 93.952 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.971 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.084 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   13.035467	   10.071909	   10.000000	
    8.975271	   12.901169	   10.000000	
   11.100873	    9.453012	   10.000000	
    9.085216	   11.004566	   10.000000	
    6.964533	    9.581565	   10.000000	
    7.714057	    7.256049	   10.000000	
   10.300737	    7.098831	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.160 ms
Set up communicators.

--set up spincomm took 2.295 ms

--set up kptcomm took 0.355 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.007 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.093 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.080 ms

Calculate_SplineDerivRadFun took 0.200 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.314 ms.
time spent on vectorized spline interp: 2.666 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.015 ms.
time spent on vectorized spline interp: 1.634 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.486 ms.
time spent on vectorized spline interp: 1.631 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.478 ms.

Calculating rb for all atom types took 16.073 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.900 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000224638, sum_int_rho = 25.7889711770146
PosCharge = 26.000000022464, NegCharge = -25.788971177015, scal_fac = 1.008182910594
After scaling, int_rho = 26.0000000224638, PosCharge + NegCharge - NetCharge = 3.553e-15
--Calculate Vref took 0.642 ms
--Calculate rho_guess took 3.736 ms

 integral of b = -26.0000000224638,
 int{b} + Nelectron + NetCharge = -2.246e-08,
 Esc = -79.5345575146883,
 MPI_Reduce took 8.937 ms

Calculating b & b_ref took 21.700 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.009 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.077 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.922 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246377, int_b + int_rho = -2.401e-13, checking this took 5.995 ms
2-norm of RHS = 678.2395641687756, which took 0.817 ms

iter_count = 420, r_2norm = 6.564e-04, tol*||rhs|| = 6.782e-04

Anderson update took 230.467 ms, out of which F'*F took 106.155 ms; b-Ax took 715.555 ms, out of which Lap took 640.967 ms
Solving Poisson took 1515.916 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.489 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
Total time for convolution: 	 convolve: 5.185678 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
Total time for convolution: 	 convolve: 5.178395 
Total time for convolution: 	 convolve: 5.185811 
Total time for convolution: 	 convolve: 5.178554 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.581 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.518 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.132 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.432 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
rank = 0, XC calculation took 24666.813 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 2.217 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.090 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.441 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.133 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.660 ms
    Lanczos iter 53, eigmin  = -1.113628590, eigmax = 264.931964842, err_eigmin = 3.556e-04, err_eigmax = 9.544e-03
rank =   0, Lanczos took 121.749 ms, eigmin = -1.113628589607, eigmax = 267.581284490039

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.183828, lowerbound = -1.213629, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1721.861 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.139 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.992 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 24.166 ms
rank =  0, finding HY took 30.637 ms
rank =  0, distributing HY into block cyclic form took 18.889 ms
rank =  0, finding Y'*HY took 5.897 ms
Rank 0, Project_Hamiltonian used 79.620 ms
Total time for projection: 79.631 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.436 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.612 ms
rank = 0, Solve_Generalized_EigenProblem used 1.468 ms
    first calculated eigval = 2.706404512881355
    last  calculated eigval = 3.205181495181033
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.82785054975005
lambda[   5] =   2.86775564404883
lambda[   6] =   2.88017255313311
lambda[   7] =   2.93015085910914
lambda[   8] =   2.94701576250763
lambda[   9] =   2.95568680065948
lambda[  10] =   2.99511471460318
lambda[  11] =   3.00311969265470
lambda[  12] =   3.03060020296287
lambda[  13] =   3.06490521058514
lambda[  14] =   3.07073571099646
lambda[  15] =   3.10811719978076
lambda[  16] =   3.12504503743487
lambda[  17] =   3.14371777088679
lambda[  18] =   3.15504223646343
lambda[  19] =   3.18011953531684
lambda[  20] =   3.20518149518103
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 1.486 ms
rank =  0, subspace rotation using ScaLAPACK took 4.898 ms
rank =  0, Distributing orbital back into band + domain format took 18.247 ms
rank = 0, Subspace_Rotation used 23.159 ms

Total time for subspace rotation: 23.165 ms
rank = 0, Efermi =   3.067820460876 calculate fermi energy took 0.057 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.305181, lowerbound = -1.213629, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1775.630 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 21.978 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.107 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 26.115 ms
rank =  0, finding HY took 30.254 ms
rank =  0, distributing HY into block cyclic form took 17.730 ms
rank =  0, finding Y'*HY took 5.455 ms
Rank 0, Project_Hamiltonian used 79.582 ms
Total time for projection: 79.594 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.167 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.247 ms
    first calculated eigval = -0.867987819518183
    last  calculated eigval = 0.434366784809646
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.42263300432527
lambda[   5] =  -0.32640410648497
lambda[   6] =  -0.21338923971427
lambda[   7] =  -0.14486057530653
lambda[   8] =  -0.01435193603731
lambda[   9] =   0.04171936399805
lambda[  10] =   0.12401583884443
lambda[  11] =   0.21896100455656
lambda[  12] =   0.23198045231540
lambda[  13] =   0.25609871256503
lambda[  14] =   0.29825131672670
lambda[  15] =   0.33491224518605
lambda[  16] =   0.36253707099625
lambda[  17] =   0.38459123688149
lambda[  18] =   0.40071240760393
lambda[  19] =   0.41009703109560
lambda[  20] =   0.43436678480965
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.256 ms
rank =  0, subspace rotation using ScaLAPACK took 3.863 ms
rank =  0, Distributing orbital back into band + domain format took 18.579 ms
rank = 0, Subspace_Rotation used 22.456 ms

Total time for subspace rotation: 22.460 ms
rank = 0, Efermi =   0.277175287217 calculate fermi energy took 0.030 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.534367, lowerbound = -1.213629, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1788.186 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.000 ms
rank =  0, Distribute orbital to block cyclic format took 17.698 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.922 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 22.113 ms
rank =  0, finding HY took 30.001 ms
rank =  0, distributing HY into block cyclic form took 17.619 ms
rank =  0, finding Y'*HY took 5.512 ms
Rank 0, Project_Hamiltonian used 75.279 ms
Total time for projection: 75.284 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.164 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.241 ms
    first calculated eigval = -1.116146878111479
    last  calculated eigval = 0.167272697804945
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.68854692487622
lambda[   5] =  -0.68104219582285
lambda[   6] =  -0.61553834401490
lambda[   7] =  -0.52617787530466
lambda[   8] =  -0.49539714784297
lambda[   9] =  -0.39996199947521
lambda[  10] =  -0.34850634939735
lambda[  11] =  -0.31658217431245
lambda[  12] =  -0.31071651421454
lambda[  13] =  -0.29160992098697
lambda[  14] =  -0.04601293639585
lambda[  15] =   0.03060786116128
lambda[  16] =   0.07277042768651
lambda[  17] =   0.10824013745226
lambda[  18] =   0.12560310748746
lambda[  19] =   0.13622957683086
lambda[  20] =   0.16727269780495
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 4.820 ms
rank =  0, Distributing orbital back into band + domain format took 18.378 ms
rank = 0, Subspace_Rotation used 23.210 ms

Total time for subspace rotation: 23.214 ms
rank = 0, Efermi =  -0.075074656908 calculate fermi energy took 0.030 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.267273, lowerbound = -1.213629, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1786.413 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.711 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.964 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.701 ms
rank =  0, finding HY took 30.362 ms
rank =  0, distributing HY into block cyclic form took 17.715 ms
rank =  0, finding Y'*HY took 5.471 ms
Rank 0, Project_Hamiltonian used 75.276 ms
Total time for projection: 75.281 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.150 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.223 ms
    first calculated eigval = -1.116322995188600
    last  calculated eigval = 0.089690664607946
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.69261806596733
lambda[   5] =  -0.68409901443911
lambda[   6] =  -0.61958157434106
lambda[   7] =  -0.53161017711261
lambda[   8] =  -0.50289353213538
lambda[   9] =  -0.41589276561950
lambda[  10] =  -0.36043815529049
lambda[  11] =  -0.35124076537438
lambda[  12] =  -0.34482465490808
lambda[  13] =  -0.34161824326512
lambda[  14] =  -0.10699866981665
lambda[  15] =  -0.07648490048631
lambda[  16] =   0.01488739822540
lambda[  17] =   0.04419611359290
lambda[  18] =   0.08032817371596
lambda[  19] =   0.08779330658148
lambda[  20] =   0.08969066460795
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 4.091 ms
rank =  0, Distributing orbital back into band + domain format took 19.157 ms
rank = 0, Subspace_Rotation used 23.260 ms

Total time for subspace rotation: 23.264 ms
rank = 0, Efermi =  -0.136060390391 calculate fermi energy took 0.029 ms
rank = 0, --- Calculate rho: sum over local bands took 3.874 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.861 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.243 ms
rank = 0, Calculating density took 7608.432 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.715 ms
rank = 0, D2D took 1.559 ms
rank = 0, Transfering density took 1.568 ms
Etot    =   -48.703149940515
Eband   =   -15.596304655656
E1      =    31.321332651520
E2      =   -13.533904072551
E3      =   -16.085122283189
Exc     =   -14.512646776757
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 6.958e+00, dEband = 2.228e+00
rank = 0, Calculating/Estimating energy took 1.431 ms, Etot = -48.703149941, dEtot = 6.958e+00, dEband = 2.228e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 57.0604984279450, which took 0.046 ms

iter_count = 96, r_2norm = 1.455e-03, tol*||rhs|| = 2.282e-03

Anderson update took 51.607 ms, out of which F'*F took 24.299 ms; b-Ax took 163.520 ms, out of which Lap took 147.503 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.156 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246382, int_b + int_rho = -1.928e-13, checking this took 0.126 ms
2-norm of RHS = 674.8230051307615, which took 0.118 ms

iter_count = 282, r_2norm = 6.348e-04, tol*||rhs|| = 6.748e-04

Anderson update took 149.788 ms, out of which F'*F took 70.307 ms; b-Ax took 477.633 ms, out of which Lap took 427.568 ms
Solving Poisson took 1011.068 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.838 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.099888 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 64.758 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.146541 
Total time for convolution: 	 convolve: 5.086486 
Total time for convolution: 	 convolve: 5.204959 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.153 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.405 ms
---Transfer Veff_loc: D2D took 1.264 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.601 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.887 ms

This SCF took 33572.348 ms, scf error = 1.472e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.189691, lowerbound = -1.116323, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1734.108 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.625 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.019 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.668 ms
rank =  0, finding HY took 30.018 ms
rank =  0, distributing HY into block cyclic form took 18.040 ms
rank =  0, finding Y'*HY took 5.974 ms
Rank 0, Project_Hamiltonian used 75.731 ms
Total time for projection: 75.742 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.145 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -1.101578190966306
    last  calculated eigval = 0.069664354839758
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.67104635242235
lambda[   5] =  -0.66270594843879
lambda[   6] =  -0.59777609327985
lambda[   7] =  -0.50822927764446
lambda[   8] =  -0.48875292814265
lambda[   9] =  -0.39254213170668
lambda[  10] =  -0.34186800378654
lambda[  11] =  -0.32657082544115
lambda[  12] =  -0.32515772150595
lambda[  13] =  -0.31938270219106
lambda[  14] =  -0.10329371245047
lambda[  15] =  -0.07516978825444
lambda[  16] =  -0.01926875218250
lambda[  17] =   0.01663462281863
lambda[  18] =   0.04557415261502
lambda[  19] =   0.05485093897881
lambda[  20] =   0.06966435483976
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.225 ms
rank =  0, subspace rotation using ScaLAPACK took 4.673 ms
rank =  0, Distributing orbital back into band + domain format took 20.062 ms
rank = 0, Subspace_Rotation used 24.751 ms

Total time for subspace rotation: 24.756 ms
rank = 0, Efermi =  -0.132355433126 calculate fermi energy took 0.099 ms
rank = 0, --- Calculate rho: sum over local bands took 4.473 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.398 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.221 ms
rank = 0, Calculating density took 1843.507 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.882 ms
rank = 0, D2D took 0.988 ms
rank = 0, Transfering density took 0.991 ms
Etot    =   -48.667114993653
Eband   =   -15.058795538225
E1      =    30.836737605666
E2      =   -13.486275985516
E3      =   -16.237354717206
Exc     =   -14.634130248455
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 5.148e-03, dEband = 7.679e-02
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -48.667114994, dEtot = 5.148e-03, dEband = 7.679e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 19.4825551963401, which took 0.061 ms

iter_count = 102, r_2norm = 5.549e-04, tol*||rhs|| = 7.793e-04

Anderson update took 54.639 ms, out of which F'*F took 25.846 ms; b-Ax took 173.335 ms, out of which Lap took 155.832 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.940 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246389, int_b + int_rho = -1.164e-13, checking this took 0.103 ms
2-norm of RHS = 670.5919215486410, which took 0.123 ms

iter_count = 300, r_2norm = 5.567e-04, tol*||rhs|| = 6.706e-04

Anderson update took 160.294 ms, out of which F'*F took 75.444 ms; b-Ax took 507.424 ms, out of which Lap took 454.219 ms
Solving Poisson took 1075.967 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.081630 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.592 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.101302 
Total time for convolution: 	 convolve: 5.099156 
Total time for convolution: 	 convolve: 5.091299 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.760 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.394 ms
---Transfer Veff_loc: D2D took 1.264 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.333 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.618 ms

This SCF took 27825.454 ms, scf error = 9.966e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.169664, lowerbound = -1.101578, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1726.427 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.439 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.932 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 22.390 ms
rank =  0, finding HY took 30.494 ms
rank =  0, distributing HY into block cyclic form took 18.705 ms
rank =  0, finding Y'*HY took 6.046 ms
Rank 0, Project_Hamiltonian used 77.666 ms
Total time for projection: 77.679 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.166 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.228 ms
    first calculated eigval = -1.072151911248392
    last  calculated eigval = 0.054200637050778
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.63308672411986
lambda[   5] =  -0.62272270757865
lambda[   6] =  -0.55652896753977
lambda[   7] =  -0.46587094989594
lambda[   8] =  -0.46217361188233
lambda[   9] =  -0.35034887245621
lambda[  10] =  -0.31059379804699
lambda[  11] =  -0.29547246180266
lambda[  12] =  -0.27974085455564
lambda[  13] =  -0.26773061318922
lambda[  14] =  -0.07429381696827
lambda[  15] =  -0.04229085552859
lambda[  16] =  -0.03055448373114
lambda[  17] =   0.00587322870166
lambda[  18] =   0.03243954444237
lambda[  19] =   0.04209413899359
lambda[  20] =   0.05420063705078
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 7.923 ms
rank =  0, Distributing orbital back into band + domain format took 17.127 ms
rank = 0, Subspace_Rotation used 25.069 ms

Total time for subspace rotation: 25.076 ms
rank = 0, Efermi =  -0.103355537632 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 4.483 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.359 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.296 ms
rank = 0, Calculating density took 1838.094 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
rank = 0, D2D took 0.922 ms
rank = 0, Transfering density took 0.929 ms
Etot    =   -48.631620937537
Eband   =   -14.067130814346
E1      =    30.000320186542
E2      =   -13.305263508170
E3      =   -16.535992420212
Exc     =   -14.871508722753
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 5.071e-03, dEband = 1.417e-01
rank = 0, Calculating/Estimating energy took 0.905 ms, Etot = -48.631620938, dEtot = 5.071e-03, dEband = 1.417e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.3015520264428, which took 0.058 ms

iter_count = 102, r_2norm = 2.758e-04, tol*||rhs|| = 2.921e-04

Anderson update took 54.679 ms, out of which F'*F took 25.482 ms; b-Ax took 172.843 ms, out of which Lap took 154.725 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.829 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246379, int_b + int_rho = -2.146e-13, checking this took 0.117 ms
2-norm of RHS = 671.3032400111476, which took 0.116 ms

iter_count = 264, r_2norm = 6.232e-04, tol*||rhs|| = 6.713e-04

Anderson update took 140.779 ms, out of which F'*F took 66.034 ms; b-Ax took 460.525 ms, out of which Lap took 414.337 ms
Solving Poisson took 959.036 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.082615 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.087399 
Total time for convolution: 	 convolve: 5.142724 
Total time for convolution: 	 convolve: 5.086017 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.864 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.342 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.411 ms
---Transfer Veff_loc: D2D took 1.288 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.336 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.648 ms

This SCF took 27599.800 ms, scf error = 2.757e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.154201, lowerbound = -1.072152, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1701.250 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.632 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.182 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.837 ms
rank =  0, finding HY took 28.922 ms
rank =  0, distributing HY into block cyclic form took 17.761 ms
rank =  0, finding Y'*HY took 5.424 ms
Rank 0, Project_Hamiltonian used 73.975 ms
Total time for projection: 73.987 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.566 ms
    first calculated eigval = -1.066841300330432
    last  calculated eigval = 0.039163304241101
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62813752842208
lambda[   5] =  -0.61722989578943
lambda[   6] =  -0.55084975314268
lambda[   7] =  -0.45891438724764
lambda[   8] =  -0.45818194460286
lambda[   9] =  -0.34269970070039
lambda[  10] =  -0.30761720976794
lambda[  11] =  -0.29032943612065
lambda[  12] =  -0.27237219704201
lambda[  13] =  -0.26075106375512
lambda[  14] =  -0.06908266663348
lambda[  15] =  -0.03896883384399
lambda[  16] =  -0.03360560631073
lambda[  17] =   0.00261592308098
lambda[  18] =   0.02693440463845
lambda[  19] =   0.03512041588145
lambda[  20] =   0.03916330424110
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.605 ms
rank =  0, subspace rotation using ScaLAPACK took 7.236 ms
rank =  0, Distributing orbital back into band + domain format took 17.682 ms
rank = 0, Subspace_Rotation used 24.930 ms

Total time for subspace rotation: 24.937 ms
rank = 0, Efermi =  -0.098144387247 calculate fermi energy took 0.098 ms
rank = 0, --- Calculate rho: sum over local bands took 4.421 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.801 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.259 ms
rank = 0, Calculating density took 1809.924 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.961 ms
rank = 0, D2D took 1.056 ms
rank = 0, Transfering density took 1.061 ms
Etot    =   -48.629296885832
Eband   =   -13.921862536863
E1      =    29.915505865720
E2      =   -13.236755196012
E3      =   -16.577981310236
Exc     =   -14.903119205576
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 3.320e-04, dEband = 2.075e-02
rank = 0, Calculating/Estimating energy took 0.907 ms, Etot = -48.629296886, dEtot = 3.320e-04, dEband = 2.075e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.8867625682697, which took 0.143 ms

iter_count = 108, r_2norm = 9.119e-05, tol*||rhs|| = 1.155e-04

Anderson update took 57.373 ms, out of which F'*F took 26.930 ms; b-Ax took 183.236 ms, out of which Lap took 163.447 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.085 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246379, int_b + int_rho = -2.146e-13, checking this took 0.107 ms
2-norm of RHS = 672.5166536399374, which took 0.085 ms

iter_count = 264, r_2norm = 6.027e-04, tol*||rhs|| = 6.725e-04

Anderson update took 140.458 ms, out of which F'*F took 66.837 ms; b-Ax took 448.183 ms, out of which Lap took 401.294 ms
Solving Poisson took 947.349 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.084613 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.678 ms
Total time for convolution: 	 convolve: 5.085243 
Total time for convolution: 	 convolve: 5.078171 
Total time for convolution: 	 convolve: 5.074459 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.667 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 1.288 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.114 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.431 ms

This SCF took 27506.503 ms, scf error = 1.569e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.139163, lowerbound = -1.066841, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1685.456 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.834 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.076 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 21.939 ms
rank =  0, finding HY took 29.537 ms
rank =  0, distributing HY into block cyclic form took 17.829 ms
rank =  0, finding Y'*HY took 5.375 ms
Rank 0, Project_Hamiltonian used 74.731 ms
Total time for projection: 74.746 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -1.063415497023553
    last  calculated eigval = 0.032346357951650
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62520296126829
lambda[   5] =  -0.61434663223208
lambda[   6] =  -0.54766737460294
lambda[   7] =  -0.45577434568248
lambda[   8] =  -0.45482201685515
lambda[   9] =  -0.33801598228045
lambda[  10] =  -0.30570649479904
lambda[  11] =  -0.28742315083012
lambda[  12] =  -0.26791566501486
lambda[  13] =  -0.25609215516074
lambda[  14] =  -0.06623978819269
lambda[  15] =  -0.03689910030233
lambda[  16] =  -0.03532622105972
lambda[  17] =   0.00119543825589
lambda[  18] =   0.02214631842369
lambda[  19] =   0.02713695729596
lambda[  20] =   0.03234635795165
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 7.233 ms
rank =  0, Distributing orbital back into band + domain format took 17.426 ms
rank = 0, Subspace_Rotation used 24.671 ms

Total time for subspace rotation: 24.677 ms
rank = 0, Efermi =  -0.095301508869 calculate fermi energy took 2.319 ms
rank = 0, --- Calculate rho: sum over local bands took 4.611 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.150 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.246 ms
rank = 0, Calculating density took 1794.482 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.835 ms
rank = 0, D2D took 0.973 ms
rank = 0, Transfering density took 0.990 ms
Etot    =   -48.627809010260
Eband   =   -13.834855688955
E1      =    29.890501586615
E2      =   -13.169255160061
E3      =   -16.599982183260
Exc     =   -14.918134735882
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 2.126e-04, dEband = 1.243e-02
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -48.627809010, dEtot = 2.126e-04, dEband = 1.243e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7756720072560, which took 0.062 ms

iter_count = 114, r_2norm = 2.549e-05, tol*||rhs|| = 3.103e-05

Anderson update took 61.996 ms, out of which F'*F took 28.499 ms; b-Ax took 193.548 ms, out of which Lap took 173.266 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.595 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246373, int_b + int_rho = -2.801e-13, checking this took 0.140 ms
2-norm of RHS = 673.1894574503648, which took 0.159 ms

iter_count = 252, r_2norm = 6.363e-04, tol*||rhs|| = 6.732e-04

Anderson update took 135.026 ms, out of which F'*F took 63.175 ms; b-Ax took 428.418 ms, out of which Lap took 384.422 ms
Solving Poisson took 904.450 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.312 ms
Total time for convolution: 	 convolve: 5.120517 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.085364 
Total time for convolution: 	 convolve: 5.076475 
Total time for convolution: 	 convolve: 5.078396 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.606 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
---Transfer Veff_loc: D2D took 1.534 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.694 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.257 ms

This SCF took 27478.947 ms, scf error = 6.981e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.132346, lowerbound = -1.063415, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1670.639 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 67.000 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.021 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 71.047 ms
rank =  0, finding HY took 29.075 ms
rank =  0, distributing HY into block cyclic form took 17.902 ms
rank =  0, finding Y'*HY took 5.299 ms
Rank 0, Project_Hamiltonian used 123.358 ms
Total time for projection: 123.373 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.148 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -1.061242955159676
    last  calculated eigval = 0.029620044898060
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62328913093573
lambda[   5] =  -0.61263692137535
lambda[   6] =  -0.54588768587505
lambda[   7] =  -0.45403853974637
lambda[   8] =  -0.45296658686754
lambda[   9] =  -0.33559319222730
lambda[  10] =  -0.30364407143457
lambda[  11] =  -0.28575485352799
lambda[  12] =  -0.26530320247606
lambda[  13] =  -0.25286694887640
lambda[  14] =  -0.06486177831732
lambda[  15] =  -0.03683607583592
lambda[  16] =  -0.03510920151110
lambda[  17] =   0.00027581399065
lambda[  18] =   0.01769263972922
lambda[  19] =   0.02218875047422
lambda[  20] =   0.02962004489806
==subpsace eigenproblem: bcast eigvals took 0.052 ms
Total time for solving subspace eigenvalue problem: 0.275 ms
rank =  0, subspace rotation using ScaLAPACK took 7.169 ms
rank =  0, Distributing orbital back into band + domain format took 17.522 ms
rank = 0, Subspace_Rotation used 24.705 ms

Total time for subspace rotation: 24.710 ms
rank = 0, Efermi =  -0.093923498909 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 4.455 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.431 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.221 ms
rank = 0, Calculating density took 1827.588 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.825 ms
rank = 0, D2D took 0.973 ms
rank = 0, Transfering density took 0.980 ms
Etot    =   -48.627142393016
Eband   =   -13.780120169509
E1      =    29.877803134089
E2      =   -13.124209889279
E3      =   -16.609659130609
Exc     =   -14.924136862124
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 9.523e-05, dEband = 7.819e-03
rank = 0, Calculating/Estimating energy took 0.914 ms, Etot = -48.627142393, dEtot = 9.523e-05, dEband = 7.819e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4499187565019, which took 0.067 ms

iter_count = 114, r_2norm = 1.206e-05, tol*||rhs|| = 1.800e-05

Anderson update took 60.978 ms, out of which F'*F took 28.261 ms; b-Ax took 193.435 ms, out of which Lap took 172.815 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.675 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246385, int_b + int_rho = -1.528e-13, checking this took 0.111 ms
2-norm of RHS = 673.3676269309680, which took 0.113 ms

iter_count = 258, r_2norm = 5.800e-04, tol*||rhs|| = 6.734e-04

Anderson update took 137.908 ms, out of which F'*F took 63.727 ms; b-Ax took 435.664 ms, out of which Lap took 389.478 ms
Solving Poisson took 927.161 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.095162 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.085821 
Total time for convolution: 	 convolve: 5.087470 
Total time for convolution: 	 convolve: 5.085085 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.725 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.214 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
---Transfer Veff_loc: D2D took 1.444 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.224 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.085 ms

This SCF took 27532.278 ms, scf error = 3.503e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.129620, lowerbound = -1.061243, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1694.128 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.654 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.107 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.786 ms
rank =  0, finding HY took 29.255 ms
rank =  0, distributing HY into block cyclic form took 17.703 ms
rank =  0, finding Y'*HY took 5.415 ms
Rank 0, Project_Hamiltonian used 74.193 ms
Total time for projection: 74.207 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -1.057937498979989
    last  calculated eigval = 0.027820302479983
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62109542279138
lambda[   5] =  -0.60984721984453
lambda[   6] =  -0.54369740336082
lambda[   7] =  -0.45119542397124
lambda[   8] =  -0.45095037159102
lambda[   9] =  -0.33207894908596
lambda[  10] =  -0.30082831979706
lambda[  11] =  -0.28265696560281
lambda[  12] =  -0.26152315910680
lambda[  13] =  -0.24879056592712
lambda[  14] =  -0.06208376436701
lambda[  15] =  -0.03885806984463
lambda[  16] =  -0.03248162945364
lambda[  17] =  -0.00026915271125
lambda[  18] =   0.01493270509967
lambda[  19] =   0.01956304714739
lambda[  20] =   0.02782030247998
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 7.197 ms
rank =  0, Distributing orbital back into band + domain format took 17.431 ms
rank = 0, Subspace_Rotation used 24.639 ms

Total time for subspace rotation: 24.645 ms
rank = 0, Efermi =  -0.091145485062 calculate fermi energy took 0.089 ms
rank = 0, --- Calculate rho: sum over local bands took 4.413 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.492 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.225 ms
rank = 0, Calculating density took 1801.506 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.851 ms
rank = 0, D2D took 0.987 ms
rank = 0, Transfering density took 0.993 ms
Etot    =   -48.626840414464
Eband   =   -13.702825773432
E1      =    29.843802987858
E2      =   -13.078306082064
E3      =   -16.618194175165
Exc     =   -14.929760370758
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 4.314e-05, dEband = 1.104e-02
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -48.626840414, dEtot = 4.314e-05, dEband = 1.104e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3455647532643, which took 0.082 ms

iter_count = 114, r_2norm = 9.068e-06, tol*||rhs|| = 1.382e-05

Anderson update took 60.488 ms, out of which F'*F took 28.346 ms; b-Ax took 193.074 ms, out of which Lap took 172.836 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.318 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246380, int_b + int_rho = -2.110e-13, checking this took 0.078 ms
2-norm of RHS = 673.2611194567284, which took 0.110 ms

iter_count = 222, r_2norm = 6.084e-04, tol*||rhs|| = 6.733e-04

Anderson update took 117.488 ms, out of which F'*F took 54.770 ms; b-Ax took 373.940 ms, out of which Lap took 333.759 ms
Solving Poisson took 795.346 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.083946 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 152.946 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.090603 
Total time for convolution: 	 convolve: 5.102051 
Total time for convolution: 	 convolve: 5.090176 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.821 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.346 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 1.498 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.720 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.577 ms

This SCF took 27548.551 ms, scf error = 1.810e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.127820, lowerbound = -1.057937, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1704.147 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.742 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.065 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.832 ms
rank =  0, finding HY took 29.135 ms
rank =  0, distributing HY into block cyclic form took 17.878 ms
rank =  0, finding Y'*HY took 6.034 ms
Rank 0, Project_Hamiltonian used 74.907 ms
Total time for projection: 74.922 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -1.056497398845296
    last  calculated eigval = 0.027227067111398
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61985164192832
lambda[   5] =  -0.60841399372017
lambda[   6] =  -0.54240090709046
lambda[   7] =  -0.44987420212822
lambda[   8] =  -0.44969333098778
lambda[   9] =  -0.33044777127566
lambda[  10] =  -0.29947606765005
lambda[  11] =  -0.28117654869007
lambda[  12] =  -0.25978318229844
lambda[  13] =  -0.24691417949770
lambda[  14] =  -0.06072307455765
lambda[  15] =  -0.03906980800105
lambda[  16] =  -0.03110365026652
lambda[  17] =   0.00006067732693
lambda[  18] =   0.01368993229697
lambda[  19] =   0.01850142905204
lambda[  20] =   0.02722706711140
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 7.240 ms
rank =  0, Distributing orbital back into band + domain format took 17.529 ms
rank = 0, Subspace_Rotation used 24.780 ms

Total time for subspace rotation: 24.785 ms
rank = 0, Efermi =  -0.089784795188 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 4.417 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.383 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.273 ms
rank = 0, Calculating density took 1812.271 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.829 ms
rank = 0, D2D took 0.975 ms
rank = 0, Transfering density took 0.982 ms
Etot    =   -48.626945463137
Eband   =   -13.664753051014
E1      =    29.819880223896
E2      =   -13.062840514098
E3      =   -16.623659771482
Exc     =   -14.934015406238
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 1.501e-05, dEband = 5.439e-03
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -48.626945463, dEtot = 1.501e-05, dEband = 5.439e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1976467014595, which took 0.087 ms

iter_count = 108, r_2norm = 7.676e-06, tol*||rhs|| = 7.906e-06

Anderson update took 56.850 ms, out of which F'*F took 26.555 ms; b-Ax took 184.037 ms, out of which Lap took 164.525 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.152 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246375, int_b + int_rho = -2.583e-13, checking this took 0.114 ms
2-norm of RHS = 673.2734870024942, which took 0.123 ms

iter_count = 228, r_2norm = 6.704e-04, tol*||rhs|| = 6.733e-04

Anderson update took 120.575 ms, out of which F'*F took 56.117 ms; b-Ax took 384.274 ms, out of which Lap took 343.521 ms
Solving Poisson took 816.575 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.083910 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 66.232 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.091538 
Total time for convolution: 	 convolve: 5.080478 
Total time for convolution: 	 convolve: 5.081152 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.523 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.450 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.679 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.156 ms

This SCF took 27441.078 ms, scf error = 1.311e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.127227, lowerbound = -1.056497, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1700.024 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.639 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.135 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.799 ms
rank =  0, finding HY took 29.143 ms
rank =  0, distributing HY into block cyclic form took 17.661 ms
rank =  0, finding Y'*HY took 5.396 ms
Rank 0, Project_Hamiltonian used 74.030 ms
Total time for projection: 74.044 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -1.055063182267013
    last  calculated eigval = 0.028701346120137
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61860897567095
lambda[   5] =  -0.60716397417472
lambda[   6] =  -0.54118787795464
lambda[   7] =  -0.44849073272516
lambda[   8] =  -0.44847132805248
lambda[   9] =  -0.32899642753998
lambda[  10] =  -0.29809628506155
lambda[  11] =  -0.27973566451381
lambda[  12] =  -0.25830732679609
lambda[  13] =  -0.24536160469892
lambda[  14] =  -0.05935607514990
lambda[  15] =  -0.03664080695835
lambda[  16] =  -0.02964236941127
lambda[  17] =   0.00305509630815
lambda[  18] =   0.01514444258623
lambda[  19] =   0.02022885146387
lambda[  20] =   0.02870134612014
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 7.186 ms
rank =  0, Distributing orbital back into band + domain format took 17.442 ms
rank = 0, Subspace_Rotation used 24.639 ms

Total time for subspace rotation: 24.643 ms
rank = 0, Efermi =  -0.088417795724 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.435 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.418 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.238 ms
rank = 0, Calculating density took 1807.199 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.823 ms
rank = 0, D2D took 0.976 ms
rank = 0, Transfering density took 1.884 ms
Etot    =   -48.627059086301
Eband   =   -13.629205220582
E1      =    29.804548023203
E2      =   -13.042301374001
E3      =   -16.624336279040
Exc     =   -14.934482026602
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 1.623e-05, dEband = 5.078e-03
rank = 0, Calculating/Estimating energy took 1.467 ms, Etot = -48.627059086, dEtot = 1.623e-05, dEband = 5.078e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1929269513597, which took 0.058 ms

iter_count = 108, r_2norm = 5.691e-06, tol*||rhs|| = 7.717e-06

Anderson update took 57.437 ms, out of which F'*F took 26.869 ms; b-Ax took 182.530 ms, out of which Lap took 163.281 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.446 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246384, int_b + int_rho = -1.673e-13, checking this took 0.104 ms
2-norm of RHS = 673.2968091710185, which took 0.108 ms

iter_count = 204, r_2norm = 5.771e-04, tol*||rhs|| = 6.733e-04

Anderson update took 107.831 ms, out of which F'*F took 50.415 ms; b-Ax took 343.452 ms, out of which Lap took 307.121 ms
Solving Poisson took 730.701 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.093750 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.801 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.096661 
Total time for convolution: 	 convolve: 5.088396 
Total time for convolution: 	 convolve: 5.133811 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.738 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 1.499 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.706 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.236 ms

This SCF took 27367.545 ms, scf error = 7.204e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.128701, lowerbound = -1.055063, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1689.529 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 17.838 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.015 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.880 ms
rank =  0, finding HY took 28.899 ms
rank =  0, distributing HY into block cyclic form took 17.725 ms
rank =  0, finding Y'*HY took 5.383 ms
Rank 0, Project_Hamiltonian used 73.918 ms
Total time for projection: 73.933 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.142 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -1.054149929783782
    last  calculated eigval = 0.029808431304327
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61779934254036
lambda[   5] =  -0.60633518444196
lambda[   6] =  -0.54038201053962
lambda[   7] =  -0.44770537663128
lambda[   8] =  -0.44763516278250
lambda[   9] =  -0.32824770849057
lambda[  10] =  -0.29725790909773
lambda[  11] =  -0.27894662762054
lambda[  12] =  -0.25758634054786
lambda[  13] =  -0.24465934188555
lambda[  14] =  -0.05854141565722
lambda[  15] =  -0.03437947024324
lambda[  16] =  -0.02883397455449
lambda[  17] =   0.00507070099404
lambda[  18] =   0.01631735448786
lambda[  19] =   0.02195241393282
lambda[  20] =   0.02980843130433
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 7.205 ms
rank =  0, Distributing orbital back into band + domain format took 17.502 ms
rank = 0, Subspace_Rotation used 24.719 ms

Total time for subspace rotation: 24.724 ms
rank = 0, Efermi =  -0.087603136339 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 4.418 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.412 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.254 ms
rank = 0, Calculating density took 1797.064 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.333 ms
rank = 0, D2D took 1.440 ms
rank = 0, Transfering density took 1.446 ms
Etot    =   -48.627171452068
Eband   =   -13.608277489366
E1      =    29.794601551247
E2      =   -13.030989114964
E3      =   -16.625365543556
Exc     =   -14.935292657108
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 1.605e-05, dEband = 2.990e-03
rank = 0, Calculating/Estimating energy took 0.903 ms, Etot = -48.627171452, dEtot = 1.605e-05, dEband = 2.990e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1086639327751, which took 0.054 ms

iter_count = 108, r_2norm = 4.106e-06, tol*||rhs|| = 4.347e-06

Anderson update took 56.745 ms, out of which F'*F took 26.796 ms; b-Ax took 183.218 ms, out of which Lap took 163.667 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.165 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246374, int_b + int_rho = -2.692e-13, checking this took 0.130 ms
2-norm of RHS = 673.2929954622361, which took 0.098 ms

iter_count = 192, r_2norm = 5.697e-04, tol*||rhs|| = 6.733e-04

Anderson update took 101.863 ms, out of which F'*F took 47.264 ms; b-Ax took 324.411 ms, out of which Lap took 290.214 ms
Solving Poisson took 688.150 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.088983 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.252 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.090869 
Total time for convolution: 	 convolve: 5.090426 
Total time for convolution: 	 convolve: 5.099028 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.393 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 1.426 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.697 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.156 ms

This SCF took 27333.802 ms, scf error = 5.320e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129808, lowerbound = -1.054150, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1709.156 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.639 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.159 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.822 ms
rank =  0, finding HY took 28.996 ms
rank =  0, distributing HY into block cyclic form took 17.742 ms
rank =  0, finding Y'*HY took 5.355 ms
Rank 0, Project_Hamiltonian used 73.947 ms
Total time for projection: 73.962 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.141 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -1.053299242876579
    last  calculated eigval = 0.031011232470746
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61704177960566
lambda[   5] =  -0.60553091198782
lambda[   6] =  -0.53962102932372
lambda[   7] =  -0.44697335331455
lambda[   8] =  -0.44683790179601
lambda[   9] =  -0.32750683818030
lambda[  10] =  -0.29647088073495
lambda[  11] =  -0.27815735309245
lambda[  12] =  -0.25684604926511
lambda[  13] =  -0.24391868907285
lambda[  14] =  -0.05776448648818
lambda[  15] =  -0.03185503381405
lambda[  16] =  -0.02801043725864
lambda[  17] =   0.00702511165659
lambda[  18] =   0.01802795699884
lambda[  19] =   0.02405828004426
lambda[  20] =   0.03101123247075
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.236 ms
rank =  0, subspace rotation using ScaLAPACK took 7.403 ms
rank =  0, Distributing orbital back into band + domain format took 17.848 ms
rank = 0, Subspace_Rotation used 25.677 ms

Total time for subspace rotation: 25.682 ms
rank = 0, Efermi =  -0.086826207043 calculate fermi energy took 0.119 ms
rank = 0, --- Calculate rho: sum over local bands took 4.504 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.370 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.265 ms
rank = 0, Calculating density took 1817.366 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.718 ms
rank = 0, D2D took 0.821 ms
rank = 0, Transfering density took 0.827 ms
Etot    =   -48.627239041096
Eband   =   -13.587997986519
E1      =    29.783687763901
E2      =   -13.021226499496
E3      =   -16.627010292303
Exc     =   -14.936608094915
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 9.656e-06, dEband = 2.897e-03
rank = 0, Calculating/Estimating energy took 0.908 ms, Etot = -48.627239041, dEtot = 9.656e-06, dEband = 2.897e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0650229650701, which took 0.053 ms

iter_count = 108, r_2norm = 2.483e-06, tol*||rhs|| = 2.601e-06

Anderson update took 57.466 ms, out of which F'*F took 26.845 ms; b-Ax took 182.944 ms, out of which Lap took 163.591 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.763 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246393, int_b + int_rho = -8.367e-14, checking this took 0.112 ms
2-norm of RHS = 673.3194815483025, which took 0.079 ms

iter_count = 192, r_2norm = 5.939e-04, tol*||rhs|| = 6.733e-04

Anderson update took 101.781 ms, out of which F'*F took 47.297 ms; b-Ax took 322.988 ms, out of which Lap took 288.899 ms
Solving Poisson took 687.969 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.106346 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.108347 
Total time for convolution: 	 convolve: 5.089387 
Total time for convolution: 	 convolve: 5.085352 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.365 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
---Transfer Veff_loc: D2D took 1.479 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.704 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.213 ms

This SCF took 27283.044 ms, scf error = 3.675e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.131011, lowerbound = -1.053299, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1718.234 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.745 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.097 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.866 ms
rank =  0, finding HY took 28.939 ms
rank =  0, distributing HY into block cyclic form took 17.683 ms
rank =  0, finding Y'*HY took 5.450 ms
Rank 0, Project_Hamiltonian used 73.966 ms
Total time for projection: 73.979 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.141 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -1.052477026812271
    last  calculated eigval = 0.033267070206086
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61626590829059
lambda[   5] =  -0.60474014747968
lambda[   6] =  -0.53884653819332
lambda[   7] =  -0.44620139219284
lambda[   8] =  -0.44604078294172
lambda[   9] =  -0.32674469349941
lambda[  10] =  -0.29568482455413
lambda[  11] =  -0.27735293789693
lambda[  12] =  -0.25608541230288
lambda[  13] =  -0.24314787136525
lambda[  14] =  -0.05698927946360
lambda[  15] =  -0.02779653035996
lambda[  16] =  -0.02716500904212
lambda[  17] =   0.00957222443052
lambda[  18] =   0.02089424330395
lambda[  19] =   0.02770307686080
lambda[  20] =   0.03326707020609
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 8.047 ms
rank =  0, Distributing orbital back into band + domain format took 17.048 ms
rank = 0, Subspace_Rotation used 25.113 ms

Total time for subspace rotation: 25.121 ms
rank = 0, Efermi =  -0.086051000133 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 4.581 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.450 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.185 ms
rank = 0, Calculating density took 1826.784 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.678 ms
rank = 0, D2D took 0.780 ms
rank = 0, Transfering density took 0.786 ms
Etot    =   -48.627303867666
Eband   =   -13.567526287597
E1      =    29.773755389752
E2      =   -13.010285239318
E3      =   -16.628472424048
Exc     =   -14.937733117826
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 9.261e-06, dEband = 2.925e-03
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -48.627303868, dEtot = 9.261e-06, dEband = 2.925e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0562502596019, which took 0.052 ms

iter_count = 108, r_2norm = 2.090e-06, tol*||rhs|| = 2.250e-06

Anderson update took 56.797 ms, out of which F'*F took 26.823 ms; b-Ax took 183.205 ms, out of which Lap took 163.824 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.425 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246376, int_b + int_rho = -2.474e-13, checking this took 0.107 ms
2-norm of RHS = 673.3256919111948, which took 0.107 ms

iter_count = 156, r_2norm = 6.570e-04, tol*||rhs|| = 6.733e-04

Anderson update took 82.805 ms, out of which F'*F took 38.660 ms; b-Ax took 262.767 ms, out of which Lap took 235.001 ms
Solving Poisson took 559.525 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.112444 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.369 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.097147 
Total time for convolution: 	 convolve: 5.086898 
Total time for convolution: 	 convolve: 5.089159 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.628 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.421 ms
---Transfer Veff_loc: D2D took 1.463 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.713 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.206 ms

This SCF took 27181.074 ms, scf error = 2.345e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.133267, lowerbound = -1.052477, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1681.783 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.700 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.066 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.790 ms
rank =  0, finding HY took 28.924 ms
rank =  0, distributing HY into block cyclic form took 17.680 ms
rank =  0, finding Y'*HY took 5.399 ms
Rank 0, Project_Hamiltonian used 73.822 ms
Total time for projection: 73.838 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -1.052267019373291
    last  calculated eigval = 0.034243062486844
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61603557003840
lambda[   5] =  -0.60451061332476
lambda[   6] =  -0.53861342416103
lambda[   7] =  -0.44597002691677
lambda[   8] =  -0.44580994385745
lambda[   9] =  -0.32651606263780
lambda[  10] =  -0.29545635145335
lambda[  11] =  -0.27712164122291
lambda[  12] =  -0.25585802093038
lambda[  13] =  -0.24291978790985
lambda[  14] =  -0.05676175984918
lambda[  15] =  -0.02690257756920
lambda[  16] =  -0.02620288839411
lambda[  17] =   0.00987369103526
lambda[  18] =   0.02225120011466
lambda[  19] =   0.02948761055538
lambda[  20] =   0.03424306248684
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 7.435 ms
rank =  0, Distributing orbital back into band + domain format took 17.190 ms
rank = 0, Subspace_Rotation used 24.638 ms

Total time for subspace rotation: 24.646 ms
rank = 0, Efermi =  -0.085823480468 calculate fermi energy took 0.077 ms
rank = 0, --- Calculate rho: sum over local bands took 4.515 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.375 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.260 ms
rank = 0, Calculating density took 1789.706 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.725 ms
rank = 0, D2D took 0.825 ms
rank = 0, Transfering density took 0.830 ms
Etot    =   -48.627340618911
Eband   =   -13.561617227030
E1      =    29.771037472605
E2      =   -13.007000284146
E3      =   -16.628739118277
Exc     =   -14.937942751548
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 5.250e-06, dEband = 8.442e-04
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -48.627340619, dEtot = 5.250e-06, dEband = 8.442e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0429468087646, which took 0.053 ms

iter_count = 108, r_2norm = 1.626e-06, tol*||rhs|| = 1.718e-06

Anderson update took 57.749 ms, out of which F'*F took 26.789 ms; b-Ax took 182.892 ms, out of which Lap took 163.521 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.076 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246376, int_b + int_rho = -2.474e-13, checking this took 0.127 ms
2-norm of RHS = 673.3267460412821, which took 0.117 ms

iter_count = 162, r_2norm = 5.623e-04, tol*||rhs|| = 6.733e-04

Anderson update took 85.722 ms, out of which F'*F took 39.812 ms; b-Ax took 272.146 ms, out of which Lap took 243.413 ms
Solving Poisson took 581.035 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.081153 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.097779 
Total time for convolution: 	 convolve: 5.088000 
Total time for convolution: 	 convolve: 5.147465 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.580 ms
---Transfer Veff_loc: D2D took 1.483 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.724 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.235 ms

This SCF took 27234.998 ms, scf error = 1.908e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.134243, lowerbound = -1.052267, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1680.739 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 17.686 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.092 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.801 ms
rank =  0, finding HY took 29.027 ms
rank =  0, distributing HY into block cyclic form took 17.641 ms
rank =  0, finding Y'*HY took 4.972 ms
Rank 0, Project_Hamiltonian used 73.991 ms
Total time for projection: 74.006 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.149 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -1.052168409105839
    last  calculated eigval = 0.035984574255297
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61589668608253
lambda[   5] =  -0.60437873836080
lambda[   6] =  -0.53847152192411
lambda[   7] =  -0.44583021347046
lambda[   8] =  -0.44567039395513
lambda[   9] =  -0.32638595012231
lambda[  10] =  -0.29531804660365
lambda[  11] =  -0.27698759873755
lambda[  12] =  -0.25573038573371
lambda[  13] =  -0.24279392271416
lambda[  14] =  -0.05662836514441
lambda[  15] =  -0.02675909521559
lambda[  16] =  -0.02535816292331
lambda[  17] =   0.01019326690876
lambda[  18] =   0.02341767945574
lambda[  19] =   0.03073588410272
lambda[  20] =   0.03598457425530
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 7.206 ms
rank =  0, Distributing orbital back into band + domain format took 17.535 ms
rank = 0, Subspace_Rotation used 24.753 ms

Total time for subspace rotation: 24.758 ms
rank = 0, Efermi =  -0.085690085726 calculate fermi energy took 0.092 ms
rank = 0, --- Calculate rho: sum over local bands took 4.467 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.407 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.215 ms
rank = 0, Calculating density took 1788.010 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.837 ms
rank = 0, D2D took 0.967 ms
rank = 0, Transfering density took 0.973 ms
Etot    =   -48.627379393939
Eband   =   -13.558250623512
E1      =    29.769740800082
E2      =   -13.004946182250
E3      =   -16.628562689295
Exc     =   -14.937820926693
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 5.539e-06, dEband = 4.809e-04
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -48.627379394, dEtot = 5.539e-06, dEband = 4.809e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0417233560292, which took 0.056 ms

iter_count = 108, r_2norm = 1.568e-06, tol*||rhs|| = 1.669e-06

Anderson update took 56.791 ms, out of which F'*F took 27.039 ms; b-Ax took 183.738 ms, out of which Lap took 164.349 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.296 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246377, int_b + int_rho = -2.365e-13, checking this took 0.112 ms
2-norm of RHS = 673.3240332564320, which took 0.118 ms

iter_count = 90, r_2norm = 6.649e-04, tol*||rhs|| = 6.733e-04

Anderson update took 47.692 ms, out of which F'*F took 22.224 ms; b-Ax took 151.483 ms, out of which Lap took 135.471 ms
Solving Poisson took 323.982 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.100438 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.150268 
Total time for convolution: 	 convolve: 5.083263 
Total time for convolution: 	 convolve: 5.082321 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.444 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.704 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.176 ms

This SCF took 26914.872 ms, scf error = 1.756e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.135985, lowerbound = -1.052168, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1688.955 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.827 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.741 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.593 ms
rank =  0, finding HY took 28.904 ms
rank =  0, distributing HY into block cyclic form took 17.686 ms
rank =  0, finding Y'*HY took 5.392 ms
Rank 0, Project_Hamiltonian used 74.134 ms
Total time for projection: 74.147 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.142 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.210 ms
    first calculated eigval = -1.052112641900901
    last  calculated eigval = 0.036353307325592
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61584731551006
lambda[   5] =  -0.60432666620001
lambda[   6] =  -0.53842203349643
lambda[   7] =  -0.44578120216491
lambda[   8] =  -0.44561980931474
lambda[   9] =  -0.32633405526405
lambda[  10] =  -0.29526645458016
lambda[  11] =  -0.27693592982567
lambda[  12] =  -0.25567686376971
lambda[  13] =  -0.24273872131056
lambda[  14] =  -0.05657814632959
lambda[  15] =  -0.02670491705098
lambda[  16] =  -0.02482685394545
lambda[  17] =   0.01043777979828
lambda[  18] =   0.02364589227313
lambda[  19] =   0.03107928929059
lambda[  20] =   0.03635330732559
==subpsace eigenproblem: bcast eigvals took 0.043 ms
Total time for solving subspace eigenvalue problem: 0.262 ms
rank =  0, subspace rotation using ScaLAPACK took 7.260 ms
rank =  0, Distributing orbital back into band + domain format took 17.616 ms
rank = 0, Subspace_Rotation used 24.889 ms

Total time for subspace rotation: 24.894 ms
rank = 0, Efermi =  -0.085639866995 calculate fermi energy took 0.137 ms
rank = 0, --- Calculate rho: sum over local bands took 4.448 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.416 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.229 ms
rank = 0, Calculating density took 1796.553 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.842 ms
rank = 0, D2D took 0.974 ms
rank = 0, Transfering density took 0.976 ms
Etot    =   -48.627376462077
Eband   =   -13.556892531200
E1      =    29.768937027659
E2      =   -13.004370683156
E3      =   -16.628698480170
Exc     =   -14.937932606501
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 4.188e-07, dEband = 1.940e-04
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -48.627376462, dEtot = 4.188e-07, dEband = 1.940e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0398663643388, which took 0.055 ms

iter_count = 108, r_2norm = 1.244e-06, tol*||rhs|| = 1.595e-06

Anderson update took 57.474 ms, out of which F'*F took 26.887 ms; b-Ax took 182.991 ms, out of which Lap took 163.556 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.980 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246373, int_b + int_rho = -2.801e-13, checking this took 0.102 ms
2-norm of RHS = 673.3215735062674, which took 0.112 ms

iter_count = 144, r_2norm = 6.655e-04, tol*||rhs|| = 6.733e-04

Anderson update took 76.273 ms, out of which F'*F took 35.638 ms; b-Ax took 242.333 ms, out of which Lap took 216.708 ms
Solving Poisson took 516.788 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.144 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Total time for convolution: 	 convolve: 5.098274 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 29.015 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.090808 
Total time for convolution: 	 convolve: 5.087504 
Total time for convolution: 	 convolve: 5.083072 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 1.455 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.665 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.169 ms

This SCF took 27093.200 ms, scf error = 1.577e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136353, lowerbound = -1.052113, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1710.586 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.364 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.830 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 22.223 ms
rank =  0, finding HY took 28.944 ms
rank =  0, distributing HY into block cyclic form took 17.684 ms
rank =  0, finding Y'*HY took 5.375 ms
Rank 0, Project_Hamiltonian used 74.258 ms
Total time for projection: 74.273 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -1.051919418255695
    last  calculated eigval = 0.037366601403184
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61567100751488
lambda[   5] =  -0.60414970001749
lambda[   6] =  -0.53824720619827
lambda[   7] =  -0.44560401053412
lambda[   8] =  -0.44543999014411
lambda[   9] =  -0.32615093767003
lambda[  10] =  -0.29508713905942
lambda[  11] =  -0.27675607674807
lambda[  12] =  -0.25549284617610
lambda[  13] =  -0.24254972829398
lambda[  14] =  -0.05641947386626
lambda[  15] =  -0.02656673600253
lambda[  16] =  -0.02485857041080
lambda[  17] =   0.01035255878787
lambda[  18] =   0.02356944573350
lambda[  19] =   0.03115105235157
lambda[  20] =   0.03736660140318
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 7.226 ms
rank =  0, Distributing orbital back into band + domain format took 17.550 ms
rank = 0, Subspace_Rotation used 24.789 ms

Total time for subspace rotation: 24.793 ms
rank = 0, Efermi =  -0.085481194447 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 4.431 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.444 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.379 ms
rank = 0, Calculating density took 1818.268 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.893 ms
rank = 0, D2D took 1.014 ms
rank = 0, Transfering density took 1.020 ms
Etot    =   -48.627413462376
Eband   =   -13.552160301631
E1      =    29.766486471278
E2      =   -13.002017706518
E3      =   -16.628910409554
Exc     =   -14.938110232736
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 5.286e-06, dEband = 6.760e-04
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -48.627413462, dEtot = 5.286e-06, dEband = 6.760e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0388837557458, which took 0.054 ms

iter_count = 108, r_2norm = 1.038e-06, tol*||rhs|| = 1.555e-06

Anderson update took 56.625 ms, out of which F'*F took 27.451 ms; b-Ax took 183.674 ms, out of which Lap took 164.371 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.966 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246384, int_b + int_rho = -1.710e-13, checking this took 0.109 ms
2-norm of RHS = 673.3221691182040, which took 0.064 ms

iter_count = 138, r_2norm = 6.015e-04, tol*||rhs|| = 6.733e-04

Anderson update took 72.717 ms, out of which F'*F took 34.032 ms; b-Ax took 234.419 ms, out of which Lap took 210.056 ms
Solving Poisson took 497.254 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.084728 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 120.947 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.085191 
Total time for convolution: 	 convolve: 5.094093 
Total time for convolution: 	 convolve: 5.157982 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 1.065 ms
---Transfer Veff_loc: D2D took 2.231 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.682 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.942 ms

This SCF took 27240.171 ms, scf error = 1.216e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.137367, lowerbound = -1.051919, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1686.212 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.917 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.040 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 21.986 ms
rank =  0, finding HY took 28.983 ms
rank =  0, distributing HY into block cyclic form took 17.611 ms
rank =  0, finding Y'*HY took 5.702 ms
Rank 0, Project_Hamiltonian used 74.310 ms
Total time for projection: 74.330 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -1.051899280398123
    last  calculated eigval = 0.037377879039361
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61564359731981
lambda[   5] =  -0.60412422574190
lambda[   6] =  -0.53821697660112
lambda[   7] =  -0.44557235652396
lambda[   8] =  -0.44541250090674
lambda[   9] =  -0.32612893980899
lambda[  10] =  -0.29506606411468
lambda[  11] =  -0.27673045787589
lambda[  12] =  -0.25547549992205
lambda[  13] =  -0.24253626703310
lambda[  14] =  -0.05640477062426
lambda[  15] =  -0.02658176671101
lambda[  16] =  -0.02575296297863
lambda[  17] =   0.01008400144302
lambda[  18] =   0.02303845809558
lambda[  19] =   0.03026314564870
lambda[  20] =   0.03737787903936
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 7.248 ms
rank =  0, Distributing orbital back into band + domain format took 17.417 ms
rank = 0, Subspace_Rotation used 24.678 ms

Total time for subspace rotation: 24.684 ms
rank = 0, Efermi =  -0.085466491145 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 4.420 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.479 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.233 ms
rank = 0, Calculating density took 1793.684 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.837 ms
rank = 0, D2D took 0.981 ms
rank = 0, Transfering density took 0.987 ms
Etot    =   -48.627427488329
Eband   =   -13.551552280913
E1      =    29.766323712998
E2      =   -13.001597595670
E3      =   -16.628755818774
Exc     =   -14.937994819496
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 2.004e-06, dEband = 8.686e-05
rank = 0, Calculating/Estimating energy took 0.908 ms, Etot = -48.627427488, dEtot = 2.004e-06, dEband = 8.686e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0348753483641, which took 0.985 ms

iter_count = 108, r_2norm = 1.012e-06, tol*||rhs|| = 1.395e-06

Anderson update took 57.147 ms, out of which F'*F took 26.971 ms; b-Ax took 182.866 ms, out of which Lap took 163.644 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.473 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246383, int_b + int_rho = -1.746e-13, checking this took 0.094 ms
2-norm of RHS = 673.3238129771306, which took 0.118 ms

iter_count = 108, r_2norm = 5.927e-04, tol*||rhs|| = 6.733e-04

Anderson update took 56.927 ms, out of which F'*F took 26.697 ms; b-Ax took 181.594 ms, out of which Lap took 162.402 ms
Solving Poisson took 388.435 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.089345 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.084312 
Total time for convolution: 	 convolve: 5.083630 
Total time for convolution: 	 convolve: 5.082947 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.173 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 1.461 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.701 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.194 ms

This SCF took 26907.098 ms, scf error = 1.175e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.137378, lowerbound = -1.051899, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1715.862 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.727 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.083 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 21.832 ms
rank =  0, finding HY took 28.806 ms
rank =  0, distributing HY into block cyclic form took 17.656 ms
rank =  0, finding Y'*HY took 5.481 ms
Rank 0, Project_Hamiltonian used 73.803 ms
Total time for projection: 73.818 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -1.051851100738087
    last  calculated eigval = 0.038046474766582
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61559686873852
lambda[   5] =  -0.60407835891253
lambda[   6] =  -0.53816920608939
lambda[   7] =  -0.44552228661023
lambda[   8] =  -0.44536546526014
lambda[   9] =  -0.32608506135051
lambda[  10] =  -0.29502110962199
lambda[  11] =  -0.27668097915343
lambda[  12] =  -0.25543238557679
lambda[  13] =  -0.24249264849811
lambda[  14] =  -0.05636264736109
lambda[  15] =  -0.02653886900942
lambda[  16] =  -0.02532353069277
lambda[  17] =   0.01056547932911
lambda[  18] =   0.02337769816870
lambda[  19] =   0.03056494680445
lambda[  20] =   0.03804647476658
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 7.201 ms
rank =  0, Distributing orbital back into band + domain format took 17.445 ms
rank = 0, Subspace_Rotation used 24.658 ms

Total time for subspace rotation: 24.662 ms
rank = 0, Efermi =  -0.085424367946 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 4.406 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.445 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.234 ms
rank = 0, Calculating density took 1822.751 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.851 ms
rank = 0, D2D took 0.978 ms
rank = 0, Transfering density took 0.984 ms
Etot    =   -48.627432375564
Eband   =   -13.550339531330
E1      =    29.765781811664
E2      =   -13.000925947246
E3      =   -16.628751892913
Exc     =   -14.937994980696
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 6.982e-07, dEband = 1.732e-04
rank = 0, Calculating/Estimating energy took 1.290 ms, Etot = -48.627432376, dEtot = 6.982e-07, dEband = 1.732e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0364208229703, which took 0.057 ms

iter_count = 108, r_2norm = 1.027e-06, tol*||rhs|| = 1.457e-06

Anderson update took 56.744 ms, out of which F'*F took 26.869 ms; b-Ax took 182.889 ms, out of which Lap took 163.542 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.467 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246392, int_b + int_rho = -8.731e-14, checking this took 0.100 ms
2-norm of RHS = 673.3238115382673, which took 0.125 ms

iter_count = 12, r_2norm = 6.711e-04, tol*||rhs|| = 6.733e-04

Anderson update took 6.290 ms, out of which F'*F took 2.997 ms; b-Ax took 20.121 ms, out of which Lap took 17.915 ms
Solving Poisson took 46.024 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.083141 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.084822 
Total time for convolution: 	 convolve: 5.086239 
Total time for convolution: 	 convolve: 5.077981 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.018 ms
======D2D: initiated sending and receiving took 1.183 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 1.480 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.708 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.214 ms

This SCF took 26586.806 ms, scf error = 1.186e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.138046, lowerbound = -1.051851, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1705.316 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.829 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.101 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 21.956 ms
rank =  0, finding HY took 28.872 ms
rank =  0, distributing HY into block cyclic form took 17.693 ms
rank =  0, finding Y'*HY took 5.457 ms
Rank 0, Project_Hamiltonian used 74.008 ms
Total time for projection: 74.020 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -1.051850588920575
    last  calculated eigval = 0.037833286683378
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61559663292542
lambda[   5] =  -0.60407812055471
lambda[   6] =  -0.53816909787796
lambda[   7] =  -0.44552220761082
lambda[   8] =  -0.44536493841619
lambda[   9] =  -0.32608460160271
lambda[  10] =  -0.29502064620786
lambda[  11] =  -0.27668039767867
lambda[  12] =  -0.25543185909021
lambda[  13] =  -0.24249200307439
lambda[  14] =  -0.05636246148344
lambda[  15] =  -0.02653958691253
lambda[  16] =  -0.02543937212091
lambda[  17] =   0.01036959458949
lambda[  18] =   0.02322038027038
lambda[  19] =   0.03040960606183
lambda[  20] =   0.03783328668338
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.218 ms
rank =  0, subspace rotation using ScaLAPACK took 7.198 ms
rank =  0, Distributing orbital back into band + domain format took 17.529 ms
rank = 0, Subspace_Rotation used 24.739 ms

Total time for subspace rotation: 24.744 ms
rank = 0, Efermi =  -0.085424182039 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 4.409 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.474 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.221 ms
rank = 0, Calculating density took 1812.506 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 2.152 ms
rank = 0, D2D took 2.256 ms
rank = 0, Transfering density took 2.260 ms
Etot    =   -48.627430477971
Eband   =   -13.550329197075
E1      =    29.765777076756
E2      =   -13.000923105606
E3      =   -16.628743834577
Exc     =   -14.937987782476
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 2.711e-07, dEband = 1.476e-06
rank = 0, Calculating/Estimating energy took 1.030 ms, Etot = -48.627430478, dEtot = 2.711e-07, dEband = 1.476e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0326205696224, which took 0.095 ms

iter_count = 108, r_2norm = 1.007e-06, tol*||rhs|| = 1.305e-06

Anderson update took 57.290 ms, out of which F'*F took 26.984 ms; b-Ax took 182.993 ms, out of which Lap took 163.620 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.534 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246378, int_b + int_rho = -2.328e-13, checking this took 0.113 ms
2-norm of RHS = 673.3221136909895, which took 0.121 ms

iter_count = 54, r_2norm = 6.207e-04, tol*||rhs|| = 6.733e-04

Anderson update took 28.474 ms, out of which F'*F took 13.250 ms; b-Ax took 90.418 ms, out of which Lap took 80.711 ms
Solving Poisson took 195.410 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.079867 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.088860 
Total time for convolution: 	 convolve: 5.084476 
Total time for convolution: 	 convolve: 5.075949 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.769 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.122 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 1.476 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.699 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.204 ms

This SCF took 26714.480 ms, scf error = 1.179e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.137833, lowerbound = -1.051851, upperbound = 267.581284

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1706.095 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.706 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.093 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.825 ms
rank =  0, finding HY took 28.984 ms
rank =  0, distributing HY into block cyclic form took 17.704 ms
rank =  0, finding Y'*HY took 5.410 ms
Rank 0, Project_Hamiltonian used 73.953 ms
Total time for projection: 73.966 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -1.051819752500756
    last  calculated eigval = 0.037345004509100
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61557674937543
lambda[   5] =  -0.60405491052531
lambda[   6] =  -0.53815094091726
lambda[   7] =  -0.44550521495905
lambda[   8] =  -0.44534417698851
lambda[   9] =  -0.32605898570716
lambda[  10] =  -0.29499841756038
lambda[  11] =  -0.27665862406163
lambda[  12] =  -0.25540386351223
lambda[  13] =  -0.24246174898184
lambda[  14] =  -0.05634578901467
lambda[  15] =  -0.02653017103737
lambda[  16] =  -0.02593797419072
lambda[  17] =   0.00996961278702
lambda[  18] =   0.02282363698608
lambda[  19] =   0.02987274851119
lambda[  20] =   0.03734500450910
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 7.196 ms
rank =  0, Distributing orbital back into band + domain format took 17.487 ms
rank = 0, Subspace_Rotation used 24.703 ms

Total time for subspace rotation: 24.708 ms
rank = 0, Efermi =  -0.085407509689 calculate fermi energy took 0.639 ms
rank = 0, --- Calculate rho: sum over local bands took 4.545 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.455 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.244 ms
rank = 0, Calculating density took 1813.329 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.844 ms
rank = 0, D2D took 0.991 ms
rank = 0, Transfering density took 0.998 ms
Etot    =   -48.627432463775
Eband   =   -13.549704844487
E1      =    29.765308735106
E2      =   -13.000730116656
E3      =   -16.628890191063
Exc     =   -14.938099146753
Esc     =   -79.534557514688
Entropy =    -0.000000000673
dE = 2.837e-07, dEband = 8.919e-05
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -48.627432464, dEtot = 2.837e-07, dEband = 8.919e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0222995310351, which took 0.055 ms

iter_count = 108, r_2norm = 7.382e-07, tol*||rhs|| = 8.920e-07

Anderson update took 56.901 ms, out of which F'*F took 26.952 ms; b-Ax took 183.161 ms, out of which Lap took 163.768 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.151 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002246401, int_rho =  26.00000002246388, int_b + int_rho = -1.273e-13, checking this took 0.102 ms
2-norm of RHS = 673.3244713768955, which took 0.113 ms

iter_count = 132, r_2norm = 6.520e-04, tol*||rhs|| = 6.733e-04

Anderson update took 70.000 ms, out of which F'*F took 32.572 ms; b-Ax took 221.588 ms, out of which Lap took 198.194 ms
Solving Poisson took 473.312 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.080871 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.082595 
Total time for convolution: 	 convolve: 5.101028 
Total time for convolution: 	 convolve: 5.102270 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.873 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 1.381 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.449 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.853 ms

This SCF took 27055.550 ms, scf error = 9.812e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.61557674937543, occ[   4] =   2.00000000000000
lambda[   5] =  -0.60405491052531, occ[   5] =   2.00000000000000
lambda[   6] =  -0.53815094091726, occ[   6] =   2.00000000000000
lambda[   7] =  -0.44550521495905, occ[   7] =   2.00000000000000
lambda[   8] =  -0.44534417698851, occ[   8] =   2.00000000000000
lambda[   9] =  -0.32605898570716, occ[   9] =   2.00000000000000
lambda[  10] =  -0.29499841756038, occ[  10] =   2.00000000000000
lambda[  11] =  -0.27665862406163, occ[  11] =   2.00000000000000
lambda[  12] =  -0.25540386351223, occ[  12] =   2.00000000000000
lambda[  13] =  -0.24246174898184, occ[  13] =   2.00000000000000
lambda[  14] =  -0.05634578901467, occ[  14] =   0.00000002246382
lambda[  15] =  -0.02653017103737, occ[  15] =   0.00000000000000
lambda[  16] =  -0.02593797419072, occ[  16] =   0.00000000000000
lambda[  17] =   0.00996961278702, occ[  17] =   0.00000000000000
lambda[  18] =   0.02282363698608, occ[  18] =   0.00000000000000
lambda[  19] =   0.02987274851119, occ[  19] =   0.00000000000000
lambda[  20] =   0.03734500450910, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.912 ms, time for Allreduce/Reduce: 9.488 ms 
Time for calculating local force components: 22.876 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.05261155740994  -0.01570452230109   0.00000000418251
  0.00453746175480  -0.06881060845624   0.00000000465370
 -0.14566099935464   0.06164670589395  -0.00000006979029
 -0.04887148527636  -0.07902450503125  -0.00000082861709
  0.98646885272270  -0.27490184690218  -0.00000033282065
  0.56510065844404   0.84515555099182   0.00000088406221
 -0.48299705201782   0.82644103026898   0.00000113324243
force_loc = 
  0.05724747759495   0.01724742400510   0.00000018291700
 -0.00476325081419   0.07448443950685  -0.00000015300141
  0.14802399091375  -0.05389744221754   0.00000070803573
  0.04931498469002   0.07912212343834   0.00000054281624
 -0.96751175130532   0.27471544631135   0.00000177984446
 -0.54968669934911  -0.83257497757204  -0.00000426433548
  0.46902878109919  -0.81129368524007  -0.00000600418483
Time for calculating nonlocal force components: 41.252 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00066963368634  -0.00533977808817   0.00000008364200
[0m[32m  0.00254036744080   0.00035720146695   0.00000000844070
[0m[32m -0.02779789138005   0.00425022495547   0.00000006218471
[0m[32m -0.01762738160195  -0.02196302233394  -0.00000018744783
[0m[32m  0.01437755432228  -0.01963283221454  -0.00000027873262
[0mTime for calculating XC forces components: 31.059 ms
 Cartesian force = 
  0.00466710673365   0.00150334077804   0.00000114780072
 -0.00019460251074   0.00563427012464   0.00000081235350
  0.00306381179410   0.00236992466228   0.00000168258865
  0.00301505340310   0.00041525894807   0.00000068334108
 -0.00880960341403   0.00402426343867   0.00000246990974
 -0.00218223595838  -0.00942200984012  -0.00000260701988
  0.00044046995229  -0.00452504811159  -0.00000418897381
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Time for printing density: 391.817 ms
The program took 579.471 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:32
Job ID:        2266479
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:58:36,vmem=8352K,walltime=00:09:53,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-20-1
---------------------------------------
