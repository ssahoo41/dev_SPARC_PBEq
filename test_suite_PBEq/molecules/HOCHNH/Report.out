---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:03
Job ID:    2266567
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:09
Job ID:    2266567
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.066 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.010 ms
Reading input file sprc-calc.inpt

Reading input file took 10.134 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 6.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 19.081 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 136.669 ms

Freeing SPARC_INPUT_MPI datatype took 0.015 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.999 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.083 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.125189	    8.156334	   10.000000	
    9.396069	   11.843666	   10.000000	
    6.545085	    9.049729	   10.000000	
   13.454915	   10.660384	   10.000000	
   10.026899	    9.876879	   10.000000	
   12.298087	    9.127260	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.006 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.163 ms
Set up communicators.

--set up spincomm took 3.091 ms

--set up kptcomm took 0.373 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.033 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.854 ms

Calculate_SplineDerivRadFun took 0.306 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.804 ms.
time spent on vectorized spline interp: 3.673 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.695 ms.
time spent on vectorized spline interp: 1.570 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.318 ms.
time spent on vectorized spline interp: 1.854 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.507 ms.
time spent on vectorized spline interp: 1.799 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.499 ms.

Calculating rb for all atom types took 20.730 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.815 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000164456, sum_int_rho = 17.6988209904892
PosCharge = 18.000000016446, NegCharge = -17.698820990489, scal_fac = 1.017016897686
After scaling, int_rho = 18.0000000164456, PosCharge + NegCharge - NetCharge = 4.263e-14
--Calculate Vref took 0.405 ms
--Calculate rho_guess took 2.119 ms

 integral of b = -18.0000000164456,
 int{b} + Nelectron + NetCharge = -1.645e-08,
 Esc = -55.2969288395876,
 MPI_Reduce took 5.138 ms

Calculating b & b_ref took 13.319 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.031 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.100 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.026 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.185 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 28.138 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644568, int_b + int_rho = 0.000e+00, checking this took 0.089 ms
2-norm of RHS = 608.1912788855566, which took 0.166 ms

iter_count = 420, r_2norm = 5.149e-04, tol*||rhs|| = 6.082e-04

Anderson update took 262.016 ms, out of which F'*F took 116.350 ms; b-Ax took 790.827 ms, out of which Lap took 705.900 ms
Solving Poisson took 1760.062 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.815 ms
Total time for convolution: 	 convolve: 5.114209 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
Total time for convolution: 	 convolve: 5.097070 
Total time for convolution: 	 convolve: 5.099936 
Total time for convolution: 	 convolve: 5.097190 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.726 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.269 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
rank = 0, XC calculation took 24236.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 1.559 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.163 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.852 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.146 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.939 ms
    Lanczos iter 53, eigmin  = -1.045469303, eigmax = 264.925314951, err_eigmin = 6.040e-04, err_eigmax = 9.605e-03
rank =   0, Lanczos took 138.675 ms, eigmin = -1.045469303386, eigmax = 267.574568100578

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.214549, lowerbound = -1.145469, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1395.830 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 15.344 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.097 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.751 ms
rank =  0, Distribute data + matrix mult took 20.212 ms
rank =  0, finding HY took 22.770 ms
rank =  0, distributing HY into block cyclic form took 14.427 ms
rank =  0, finding Y'*HY took 6.173 ms
Rank 0, Project_Hamiltonian used 63.614 ms
Total time for projection: 63.624 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.384 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.456 ms
    first calculated eigval = 2.819689558992817
    last  calculated eigval = 3.216211562887712
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.81968955899282
lambda[   2] =   2.85284484028474
lambda[   3] =   2.88138564890833
lambda[   4] =   2.93453601288109
lambda[   5] =   2.94679689608708
lambda[   6] =   2.96171022086040
lambda[   7] =   2.98230072560107
lambda[   8] =   3.01591820487074
lambda[   9] =   3.04374455381974
lambda[  10] =   3.06739208132691
lambda[  11] =   3.10232817550333
lambda[  12] =   3.12199511849088
lambda[  13] =   3.15104932067026
lambda[  14] =   3.15949210287219
lambda[  15] =   3.21621156288771
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.470 ms
rank =  0, subspace rotation using ScaLAPACK took 4.275 ms
rank =  0, Distributing orbital back into band + domain format took 14.380 ms
rank = 0, Subspace_Rotation used 18.673 ms

Total time for subspace rotation: 18.677 ms
rank = 0, Efermi =   3.055568318286 calculate fermi energy took 0.072 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.316212, lowerbound = -1.145469, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1461.918 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.271 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.657 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 17.952 ms
rank =  0, finding HY took 21.643 ms
rank =  0, distributing HY into block cyclic form took 14.289 ms
rank =  0, finding Y'*HY took 4.703 ms
Rank 0, Project_Hamiltonian used 58.622 ms
Total time for projection: 58.628 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -0.823288420391589
    last  calculated eigval = 0.443988080801227
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82328842039159
lambda[   2] =  -0.68173422195969
lambda[   3] =  -0.23286668926310
lambda[   4] =  -0.06172992473533
lambda[   5] =   0.02897126954597
lambda[   6] =   0.15126781399303
lambda[   7] =   0.22598832484670
lambda[   8] =   0.27484788554845
lambda[   9] =   0.29802171509973
lambda[  10] =   0.34230276098559
lambda[  11] =   0.36626726741849
lambda[  12] =   0.37535575474689
lambda[  13] =   0.42292403995495
lambda[  14] =   0.43160194990744
lambda[  15] =   0.44398808080123
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 4.359 ms
rank =  0, Distributing orbital back into band + domain format took 13.723 ms
rank = 0, Subspace_Rotation used 18.100 ms

Total time for subspace rotation: 18.108 ms
rank = 0, Efermi =   0.320162705560 calculate fermi energy took 0.023 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.543988, lowerbound = -1.145469, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1400.386 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.300 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.635 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.163 ms
rank =  0, Distribute data + matrix mult took 20.114 ms
rank =  0, finding HY took 21.750 ms
rank =  0, distributing HY into block cyclic form took 14.206 ms
rank =  0, finding Y'*HY took 4.736 ms
Rank 0, Project_Hamiltonian used 60.840 ms
Total time for projection: 60.854 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -1.059662705457590
    last  calculated eigval = 0.171646016397816
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.05966270545759
lambda[   2] =  -0.94618009620359
lambda[   3] =  -0.64692731299935
lambda[   4] =  -0.58340388921398
lambda[   5] =  -0.52775932969950
lambda[   6] =  -0.40886886836401
lambda[   7] =  -0.40030911551363
lambda[   8] =  -0.32686884846426
lambda[   9] =  -0.22465484417306
lambda[  10] =  -0.03614359963990
lambda[  11] =   0.07068639594837
lambda[  12] =   0.09222591284367
lambda[  13] =   0.12415834818810
lambda[  14] =   0.14967423927676
lambda[  15] =   0.17164601639782
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 4.235 ms
rank =  0, Distributing orbital back into band + domain format took 14.208 ms
rank = 0, Subspace_Rotation used 18.457 ms

Total time for subspace rotation: 18.461 ms
rank = 0, Efermi =  -0.065485384434 calculate fermi energy took 0.056 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.271646, lowerbound = -1.145469, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1462.775 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 14.318 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.540 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.336 ms
rank =  0, Distribute data + matrix mult took 18.209 ms
rank =  0, finding HY took 21.681 ms
rank =  0, distributing HY into block cyclic form took 14.390 ms
rank =  0, finding Y'*HY took 4.680 ms
Rank 0, Project_Hamiltonian used 58.989 ms
Total time for projection: 58.993 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.224 ms
rank = 0, Solve_Generalized_EigenProblem used 0.853 ms
    first calculated eigval = -1.059910058381204
    last  calculated eigval = 0.106137380583163
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.05991005838120
lambda[   2] =  -0.94672942747312
lambda[   3] =  -0.65129183255362
lambda[   4] =  -0.58913343270982
lambda[   5] =  -0.53549078647753
lambda[   6] =  -0.44029930553937
lambda[   7] =  -0.43110558487419
lambda[   8] =  -0.35859627986070
lambda[   9] =  -0.33978358673650
lambda[  10] =  -0.09712478725531
lambda[  11] =  -0.00160680068957
lambda[  12] =   0.04962096594098
lambda[  13] =   0.05965429127916
lambda[  14] =   0.09225364229198
lambda[  15] =   0.10613738058316
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.866 ms
rank =  0, subspace rotation using ScaLAPACK took 4.748 ms
rank =  0, Distributing orbital back into band + domain format took 14.038 ms
rank = 0, Subspace_Rotation used 18.806 ms

Total time for subspace rotation: 18.813 ms
rank = 0, Efermi =  -0.126466572109 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.174 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.756 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.215 ms
rank = 0, Calculating density took 6188.096 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.863 ms
rank = 0, D2D took 1.028 ms
rank = 0, Transfering density took 1.035 ms
Etot    =   -34.776513229590
Eband   =   -10.704680590809
E1      =    20.938509083318
E2      =    -9.087008639715
E3      =   -11.277640573419
Exc     =   -10.078062095147
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 5.796e+00, dEband = 1.784e+00
rank = 0, Calculating/Estimating energy took 0.987 ms, Etot = -34.776513230, dEtot = 5.796e+00, dEband = 1.784e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 51.4780359727653, which took 0.060 ms

iter_count = 96, r_2norm = 1.521e-03, tol*||rhs|| = 2.059e-03

Anderson update took 58.117 ms, out of which F'*F took 27.320 ms; b-Ax took 178.251 ms, out of which Lap took 159.202 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 407.666 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644563, int_b + int_rho = -5.457e-14, checking this took 0.152 ms
2-norm of RHS = 604.3968870945098, which took 0.143 ms

iter_count = 288, r_2norm = 5.331e-04, tol*||rhs|| = 6.044e-04

Anderson update took 169.926 ms, out of which F'*F took 79.925 ms; b-Ax took 538.327 ms, out of which Lap took 479.949 ms
Solving Poisson took 1208.349 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.771 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.316501 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.658 ms
Total time for convolution: 	 convolve: 5.298436 
Total time for convolution: 	 convolve: 5.300077 
Total time for convolution: 	 convolve: 5.305010 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.968 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.815 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.803 ms

This SCF took 32970.732 ms, scf error = 1.501e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.206137, lowerbound = -1.059910, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1355.689 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 44.719 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.649 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.132 ms
rank =  0, Distribute data + matrix mult took 48.515 ms
rank =  0, finding HY took 21.365 ms
rank =  0, distributing HY into block cyclic form took 18.335 ms
rank =  0, finding Y'*HY took 9.653 ms
Rank 0, Project_Hamiltonian used 99.281 ms
Total time for projection: 99.309 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -1.040255122094009
    last  calculated eigval = 0.079002560991441
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.04025512209401
lambda[   2] =  -0.90125158965376
lambda[   3] =  -0.62591841190179
lambda[   4] =  -0.57034358670291
lambda[   5] =  -0.49970161474186
lambda[   6] =  -0.41900054781529
lambda[   7] =  -0.40352728807907
lambda[   8] =  -0.31411820178129
lambda[   9] =  -0.30661182262987
lambda[  10] =  -0.08287294206046
lambda[  11] =  -0.03468967953140
lambda[  12] =   0.02529802941362
lambda[  13] =   0.02982213826620
lambda[  14] =   0.04815681155124
lambda[  15] =   0.07900256099144
==subpsace eigenproblem: bcast eigvals took 0.036 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 4.264 ms
rank =  0, Distributing orbital back into band + domain format took 14.294 ms
rank = 0, Subspace_Rotation used 18.574 ms

Total time for subspace rotation: 18.579 ms
rank = 0, Efermi =  -0.112214726639 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 3.119 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.119 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.207 ms
rank = 0, Calculating density took 1481.346 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.853 ms
rank = 0, D2D took 1.000 ms
rank = 0, Transfering density took 1.007 ms
Etot    =   -34.734945474682
Eband   =   -10.161456372163
E1      =    20.485118420821
E2      =    -9.008372784914
E3      =   -11.422804488086
Exc     =   -10.192855956256
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 6.928e-03, dEband = 9.054e-02
rank = 0, Calculating/Estimating energy took 0.985 ms, Etot = -34.734945475, dEtot = 6.928e-03, dEband = 9.054e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 24.8910740559235, which took 0.068 ms

iter_count = 102, r_2norm = 6.443e-04, tol*||rhs|| = 9.956e-04

Anderson update took 61.300 ms, out of which F'*F took 28.740 ms; b-Ax took 190.623 ms, out of which Lap took 169.446 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 432.745 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644558, int_b + int_rho = -9.823e-14, checking this took 0.126 ms
2-norm of RHS = 601.5617029020229, which took 0.210 ms

iter_count = 294, r_2norm = 5.086e-04, tol*||rhs|| = 6.016e-04

Anderson update took 176.178 ms, out of which F'*F took 83.454 ms; b-Ax took 563.252 ms, out of which Lap took 500.346 ms
Solving Poisson took 1237.568 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.902 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.242987 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.249515 
Total time for convolution: 	 convolve: 5.265674 
Total time for convolution: 	 convolve: 5.236986 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.383 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.218 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.183 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.961 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.811 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.791 ms

This SCF took 28221.137 ms, scf error = 9.428e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.179003, lowerbound = -1.040255, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1426.183 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.386 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.887 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 18.295 ms
rank =  0, finding HY took 22.831 ms
rank =  0, distributing HY into block cyclic form took 14.737 ms
rank =  0, finding Y'*HY took 4.369 ms
Rank 0, Project_Hamiltonian used 60.270 ms
Total time for projection: 60.285 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.166 ms
    first calculated eigval = -1.016022529692989
    last  calculated eigval = 0.065468204441876
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.01602252969299
lambda[   2] =  -0.85363022064726
lambda[   3] =  -0.59748768753001
lambda[   4] =  -0.54159483812878
lambda[   5] =  -0.45984271430817
lambda[   6] =  -0.39347635232915
lambda[   7] =  -0.37285061957341
lambda[   8] =  -0.27199541090104
lambda[   9] =  -0.26941270508245
lambda[  10] =  -0.05561093881697
lambda[  11] =  -0.04228873521537
lambda[  12] =   0.01390215599171
lambda[  13] =   0.01710862429610
lambda[  14] =   0.02929020100227
lambda[  15] =   0.06546820444188
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 4.143 ms
rank =  0, Distributing orbital back into band + domain format took 14.378 ms
rank = 0, Subspace_Rotation used 18.539 ms

Total time for subspace rotation: 18.546 ms
rank = 0, Efermi =  -0.084952723405 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 3.132 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.983 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.232 ms
rank = 0, Calculating density took 1512.690 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.703 ms
rank = 0, D2D took 0.964 ms
rank = 0, Transfering density took 0.968 ms
Etot    =   -34.711780915472
Eband   =    -9.552626157301
E1      =    20.000784832013
E2      =    -8.871353567117
E3      =   -11.592418589229
Exc     =   -10.326782906446
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 3.861e-03, dEband = 1.015e-01
rank = 0, Calculating/Estimating energy took 1.112 ms, Etot = -34.711780915, dEtot = 3.861e-03, dEband = 1.015e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.2042219800789, which took 0.569 ms

iter_count = 102, r_2norm = 2.448e-04, tol*||rhs|| = 2.482e-04

Anderson update took 60.265 ms, out of which F'*F took 28.493 ms; b-Ax took 197.177 ms, out of which Lap took 175.405 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 440.423 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644555, int_b + int_rho = -1.346e-13, checking this took 0.114 ms
2-norm of RHS = 602.0023850421190, which took 0.155 ms

iter_count = 288, r_2norm = 4.795e-04, tol*||rhs|| = 6.020e-04

Anderson update took 167.824 ms, out of which F'*F took 82.283 ms; b-Ax took 556.286 ms, out of which Lap took 491.442 ms
Solving Poisson took 1198.329 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.121161 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.138889 
Total time for convolution: 	 convolve: 5.104800 
Total time for convolution: 	 convolve: 5.110585 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.392 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.960 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.868 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.183 ms

This SCF took 27610.329 ms, scf error = 4.663e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.165468, lowerbound = -1.016023, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1397.991 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.497 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.622 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 18.146 ms
rank =  0, finding HY took 22.036 ms
rank =  0, distributing HY into block cyclic form took 14.866 ms
rank =  0, finding Y'*HY took 5.396 ms
Rank 0, Project_Hamiltonian used 60.482 ms
Total time for projection: 60.495 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.165 ms
    first calculated eigval = -1.004301514232490
    last  calculated eigval = 0.053113518307437
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.00430151423249
lambda[   2] =  -0.83297842226140
lambda[   3] =  -0.58289065222668
lambda[   4] =  -0.51953717031891
lambda[   5] =  -0.44154282517381
lambda[   6] =  -0.37994042951418
lambda[   7] =  -0.35830308941929
lambda[   8] =  -0.25996631737813
lambda[   9] =  -0.25293398541792
lambda[  10] =  -0.04329438764248
lambda[  11] =  -0.04064720949811
lambda[  12] =   0.00444783408411
lambda[  13] =   0.01417879424155
lambda[  14] =   0.02249070557190
lambda[  15] =   0.05311351830744
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 4.204 ms
rank =  0, Distributing orbital back into band + domain format took 14.341 ms
rank = 0, Subspace_Rotation used 18.561 ms

Total time for subspace rotation: 18.567 ms
rank = 0, Efermi =  -0.072675881821 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 3.059 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.388 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.269 ms
rank = 0, Calculating density took 1485.064 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.795 ms
rank = 0, D2D took 1.021 ms
rank = 0, Transfering density took 1.024 ms
Etot    =   -34.705813082815
Eband   =    -9.264788812596
E1      =    19.811374825958
E2      =    -8.760094169357
E3      =   -11.675551668949
Exc     =   -10.391116094396
Esc     =   -55.296928839588
Entropy =    -0.000000000499
dE = 9.946e-04, dEband = 4.797e-02
rank = 0, Calculating/Estimating energy took 1.042 ms, Etot = -34.705813083, dEtot = 9.946e-04, dEband = 4.797e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.7580650951533, which took 0.053 ms

iter_count = 108, r_2norm = 8.156e-05, tol*||rhs|| = 1.103e-04

Anderson update took 66.331 ms, out of which F'*F took 30.442 ms; b-Ax took 203.367 ms, out of which Lap took 182.783 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.371 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644557, int_b + int_rho = -1.091e-13, checking this took 0.120 ms
2-norm of RHS = 602.4140018047965, which took 0.140 ms

iter_count = 264, r_2norm = 5.288e-04, tol*||rhs|| = 6.024e-04

Anderson update took 156.986 ms, out of which F'*F took 73.553 ms; b-Ax took 500.189 ms, out of which Lap took 449.203 ms
Solving Poisson took 1090.886 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.168222 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.862 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
Total time for convolution: 	 convolve: 5.161889 
Total time for convolution: 	 convolve: 5.188558 
Total time for convolution: 	 convolve: 5.179864 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.432 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 1.152 ms
---Transfer Veff_loc: D2D took 1.883 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.813 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.715 ms

This SCF took 27720.346 ms, scf error = 1.339e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.153114, lowerbound = -1.004302, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1374.879 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.353 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.720 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 18.095 ms
rank =  0, finding HY took 22.026 ms
rank =  0, distributing HY into block cyclic form took 13.968 ms
rank =  0, finding Y'*HY took 5.357 ms
Rank 0, Project_Hamiltonian used 59.482 ms
Total time for projection: 59.499 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -1.002435504588912
    last  calculated eigval = 0.042199471360491
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.00243550458891
lambda[   2] =  -0.82649943286174
lambda[   3] =  -0.57954434068869
lambda[   4] =  -0.51575318261524
lambda[   5] =  -0.43550034016155
lambda[   6] =  -0.37736292675892
lambda[   7] =  -0.35523541397416
lambda[   8] =  -0.25551633469894
lambda[   9] =  -0.24565372867649
lambda[  10] =  -0.04388875534976
lambda[  11] =  -0.03720814549863
lambda[  12] =  -0.00083499160577
lambda[  13] =   0.01244220370107
lambda[  14] =   0.01941000311562
lambda[  15] =   0.04219947136049
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 4.211 ms
rank =  0, Distributing orbital back into band + domain format took 14.512 ms
rank = 0, Subspace_Rotation used 18.742 ms

Total time for subspace rotation: 18.747 ms
rank = 0, Efermi =  -0.073230766835 calculate fermi energy took 2.079 ms
rank = 0, --- Calculate rho: sum over local bands took 4.198 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.143 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.194 ms
rank = 0, Calculating density took 1461.979 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.727 ms
rank = 0, D2D took 0.985 ms
rank = 0, Transfering density took 0.995 ms
Etot    =   -34.704783999157
Eband   =    -9.187002410771
E1      =    19.772497214241
E2      =    -8.716271735927
E3      =   -11.697820894276
Exc     =   -10.407442592745
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 1.715e-04, dEband = 1.296e-02
rank = 0, Calculating/Estimating energy took 1.152 ms, Etot = -34.704783999, dEtot = 1.715e-04, dEband = 1.296e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.1762042176775, which took 0.066 ms

iter_count = 108, r_2norm = 4.277e-05, tol*||rhs|| = 4.705e-05

Anderson update took 66.058 ms, out of which F'*F took 30.631 ms; b-Ax took 201.613 ms, out of which Lap took 181.235 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.066 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644558, int_b + int_rho = -9.823e-14, checking this took 0.135 ms
2-norm of RHS = 602.8629493653314, which took 0.124 ms

iter_count = 246, r_2norm = 5.683e-04, tol*||rhs|| = 6.029e-04

Anderson update took 144.516 ms, out of which F'*F took 67.320 ms; b-Ax took 466.478 ms, out of which Lap took 414.907 ms
Solving Poisson took 1024.278 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.174187 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.159105 
Total time for convolution: 	 convolve: 5.150642 
Total time for convolution: 	 convolve: 5.154704 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.594 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.129 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.944 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.376 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.343 ms

This SCF took 27596.487 ms, scf error = 7.240e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.142199, lowerbound = -1.002436, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1378.479 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.336 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.608 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.134 ms
rank =  0, Distribute data + matrix mult took 18.095 ms
rank =  0, finding HY took 21.961 ms
rank =  0, distributing HY into block cyclic form took 14.309 ms
rank =  0, finding Y'*HY took 4.811 ms
Rank 0, Project_Hamiltonian used 59.211 ms
Total time for projection: 59.226 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -1.001880969785814
    last  calculated eigval = 0.034720197526163
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.00188096978581
lambda[   2] =  -0.82633708380762
lambda[   3] =  -0.57902289719494
lambda[   4] =  -0.51535285392731
lambda[   5] =  -0.43491799272256
lambda[   6] =  -0.37678992731998
lambda[   7] =  -0.35480245994292
lambda[   8] =  -0.25499605794139
lambda[   9] =  -0.24477596534923
lambda[  10] =  -0.04437663758755
lambda[  11] =  -0.03690183175138
lambda[  12] =  -0.00379167260597
lambda[  13] =   0.01129139163506
lambda[  14] =   0.01788348758771
lambda[  15] =   0.03472019752616
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 4.278 ms
rank =  0, Distributing orbital back into band + domain format took 14.231 ms
rank = 0, Subspace_Rotation used 18.523 ms

Total time for subspace rotation: 18.528 ms
rank = 0, Efermi =  -0.073718498400 calculate fermi energy took 0.120 ms
rank = 0, --- Calculate rho: sum over local bands took 4.179 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.276 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.224 ms
rank = 0, Calculating density took 1464.279 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.835 ms
rank = 0, D2D took 1.040 ms
rank = 0, Transfering density took 1.050 ms
Etot    =   -34.704471829174
Eband   =    -9.177752416713
E1      =    19.783233992802
E2      =    -8.695941484708
E3      =   -11.696414281978
Exc     =   -10.405380331864
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 5.203e-05, dEband = 1.542e-03
rank = 0, Calculating/Estimating energy took 1.399 ms, Etot = -34.704471829, dEtot = 5.203e-05, dEband = 1.542e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5309983328267, which took 0.057 ms

iter_count = 114, r_2norm = 1.493e-05, tol*||rhs|| = 2.124e-05

Anderson update took 70.309 ms, out of which F'*F took 31.665 ms; b-Ax took 213.556 ms, out of which Lap took 190.104 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 480.603 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644556, int_b + int_rho = -1.201e-13, checking this took 0.132 ms
2-norm of RHS = 602.9371230125791, which took 0.117 ms

iter_count = 246, r_2norm = 5.184e-04, tol*||rhs|| = 6.029e-04

Anderson update took 147.543 ms, out of which F'*F took 67.435 ms; b-Ax took 464.357 ms, out of which Lap took 412.033 ms
Solving Poisson took 1023.453 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.158615 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.203151 
Total time for convolution: 	 convolve: 5.148433 
Total time for convolution: 	 convolve: 5.153281 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.305 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
---Transfer Veff_loc: D2D took 0.960 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.379 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.360 ms

This SCF took 27611.341 ms, scf error = 3.907e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.134720, lowerbound = -1.001881, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1382.720 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.285 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.638 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.079 ms
rank =  0, Distribute data + matrix mult took 18.017 ms
rank =  0, finding HY took 21.856 ms
rank =  0, distributing HY into block cyclic form took 14.345 ms
rank =  0, finding Y'*HY took 4.614 ms
Rank 0, Project_Hamiltonian used 58.866 ms
Total time for projection: 58.882 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -0.999304602918452
    last  calculated eigval = 0.030753981272501
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99930460291845
lambda[   2] =  -0.82327702461081
lambda[   3] =  -0.57664900911085
lambda[   4] =  -0.51329850129535
lambda[   5] =  -0.43203219728354
lambda[   6] =  -0.37422474051099
lambda[   7] =  -0.35220700556551
lambda[   8] =  -0.25214800914495
lambda[   9] =  -0.24149946472783
lambda[  10] =  -0.04480389387876
lambda[  11] =  -0.03467797257232
lambda[  12] =  -0.00525833683744
lambda[  13] =   0.01056456166144
lambda[  14] =   0.01727844684337
lambda[  15] =   0.03075398127250
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 4.274 ms
rank =  0, Distributing orbital back into band + domain format took 14.268 ms
rank = 0, Subspace_Rotation used 18.557 ms

Total time for subspace rotation: 18.563 ms
rank = 0, Efermi =  -0.074145680334 calculate fermi energy took 0.102 ms
rank = 0, --- Calculate rho: sum over local bands took 4.164 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.234 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.224 ms
rank = 0, Calculating density took 1468.146 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.724 ms
rank = 0, D2D took 2.119 ms
rank = 0, Transfering density took 2.126 ms
Etot    =   -34.704215899586
Eband   =    -9.129281111073
E1      =    19.758826933599
E2      =    -8.669784872326
E3      =   -11.704565690399
Exc     =   -10.411183444752
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 4.265e-05, dEband = 8.079e-03
rank = 0, Calculating/Estimating energy took 1.138 ms, Etot = -34.704215900, dEtot = 4.265e-05, dEband = 8.079e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3015993141766, which took 0.077 ms

iter_count = 114, r_2norm = 7.838e-06, tol*||rhs|| = 1.206e-05

Anderson update took 70.434 ms, out of which F'*F took 31.634 ms; b-Ax took 213.977 ms, out of which Lap took 190.615 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 479.830 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644560, int_b + int_rho = -8.367e-14, checking this took 0.114 ms
2-norm of RHS = 602.9790877723549, which took 0.114 ms

iter_count = 246, r_2norm = 5.385e-04, tol*||rhs|| = 6.030e-04

Anderson update took 147.294 ms, out of which F'*F took 67.945 ms; b-Ax took 467.069 ms, out of which Lap took 415.434 ms
Solving Poisson took 1026.428 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.177742 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.153348 
Total time for convolution: 	 convolve: 5.165922 
Total time for convolution: 	 convolve: 5.160426 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.523 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.938 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.360 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.319 ms

This SCF took 27623.770 ms, scf error = 2.444e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.130754, lowerbound = -0.999305, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1378.983 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.250 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.395 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 17.670 ms
rank =  0, finding HY took 22.115 ms
rank =  0, distributing HY into block cyclic form took 14.295 ms
rank =  0, finding Y'*HY took 4.761 ms
Rank 0, Project_Hamiltonian used 58.878 ms
Total time for projection: 58.896 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.997101242753823
    last  calculated eigval = 0.029608694005393
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99710124275382
lambda[   2] =  -0.82007537956982
lambda[   3] =  -0.57439137175804
lambda[   4] =  -0.51117460405831
lambda[   5] =  -0.42918490678296
lambda[   6] =  -0.37166519442877
lambda[   7] =  -0.34995600653982
lambda[   8] =  -0.24934901582405
lambda[   9] =  -0.23826179668458
lambda[  10] =  -0.04487809517808
lambda[  11] =  -0.03214069929309
lambda[  12] =  -0.00509485591105
lambda[  13] =   0.01022183329226
lambda[  14] =   0.01779294179494
lambda[  15] =   0.02960869400539
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 4.262 ms
rank =  0, Distributing orbital back into band + domain format took 14.365 ms
rank = 0, Subspace_Rotation used 18.643 ms

Total time for subspace rotation: 18.650 ms
rank = 0, Efermi =  -0.074219879860 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 3.960 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.298 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.229 ms
rank = 0, Calculating density took 1465.053 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.695 ms
rank = 0, D2D took 0.839 ms
rank = 0, Transfering density took 0.846 ms
Etot    =   -34.704223432360
Eband   =    -9.082319037538
E1      =    19.736329594122
E2      =    -8.643863582177
E3      =   -11.709274747891
Exc     =   -10.414443478926
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 1.255e-06, dEband = 7.827e-03
rank = 0, Calculating/Estimating energy took 1.272 ms, Etot = -34.704223432, dEtot = 1.255e-06, dEband = 7.827e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2383457296901, which took 0.066 ms

iter_count = 114, r_2norm = 5.906e-06, tol*||rhs|| = 9.534e-06

Anderson update took 70.795 ms, out of which F'*F took 31.547 ms; b-Ax took 217.298 ms, out of which Lap took 194.197 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.984 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644560, int_b + int_rho = -8.367e-14, checking this took 0.117 ms
2-norm of RHS = 602.9744070634712, which took 0.121 ms

iter_count = 228, r_2norm = 5.039e-04, tol*||rhs|| = 6.030e-04

Anderson update took 136.117 ms, out of which F'*F took 63.518 ms; b-Ax took 429.876 ms, out of which Lap took 382.810 ms
Solving Poisson took 950.078 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.164142 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.172753 
Total time for convolution: 	 convolve: 5.259621 
Total time for convolution: 	 convolve: 5.175583 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.607 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.174 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.943 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.366 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.330 ms

This SCF took 27636.249 ms, scf error = 1.366e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.129609, lowerbound = -0.997101, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1376.220 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 14.221 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.687 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.063 ms
rank =  0, Distribute data + matrix mult took 17.987 ms
rank =  0, finding HY took 21.952 ms
rank =  0, distributing HY into block cyclic form took 13.966 ms
rank =  0, finding Y'*HY took 5.027 ms
Rank 0, Project_Hamiltonian used 58.969 ms
Total time for projection: 58.992 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -0.995672666100230
    last  calculated eigval = 0.029133832502813
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99567266610023
lambda[   2] =  -0.81834580034586
lambda[   3] =  -0.57292030943473
lambda[   4] =  -0.50961627716031
lambda[   5] =  -0.42755379116728
lambda[   6] =  -0.37012373820677
lambda[   7] =  -0.34843327184816
lambda[   8] =  -0.24780614006892
lambda[   9] =  -0.23665771870864
lambda[  10] =  -0.04332679878357
lambda[  11] =  -0.03060578571587
lambda[  12] =  -0.00321002609560
lambda[  13] =   0.01045426675648
lambda[  14] =   0.01877485499816
lambda[  15] =   0.02913383250281
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 4.282 ms
rank =  0, Distributing orbital back into band + domain format took 14.248 ms
rank = 0, Subspace_Rotation used 19.277 ms

Total time for subspace rotation: 19.284 ms
rank = 0, Efermi =  -0.072668583562 calculate fermi energy took 0.066 ms
rank = 0, --- Calculate rho: sum over local bands took 4.535 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.212 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.215 ms
rank = 0, Calculating density took 1461.819 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.683 ms
rank = 0, D2D took 0.922 ms
rank = 0, Transfering density took 0.926 ms
Etot    =   -34.704314541795
Eband   =    -9.054259426794
E1      =    19.722053234738
E2      =    -8.629359497803
E3      =   -11.711973748763
Exc     =   -10.416512756220
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 1.518e-05, dEband = 4.677e-03
rank = 0, Calculating/Estimating energy took 1.292 ms, Etot = -34.704314542, dEtot = 1.518e-05, dEband = 4.677e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1397675649276, which took 0.084 ms

iter_count = 108, r_2norm = 5.323e-06, tol*||rhs|| = 5.591e-06

Anderson update took 66.888 ms, out of which F'*F took 29.909 ms; b-Ax took 202.428 ms, out of which Lap took 180.740 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.141 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644553, int_b + int_rho = -1.492e-13, checking this took 0.112 ms
2-norm of RHS = 602.9538497477340, which took 0.120 ms

iter_count = 216, r_2norm = 5.354e-04, tol*||rhs|| = 6.030e-04

Anderson update took 128.231 ms, out of which F'*F took 59.735 ms; b-Ax took 409.173 ms, out of which Lap took 364.843 ms
Solving Poisson took 900.790 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.163265 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.150 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.157760 
Total time for convolution: 	 convolve: 5.165249 
Total time for convolution: 	 convolve: 5.159095 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.822 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.014 ms
======D2D: initiated sending and receiving took 0.903 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.932 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.377 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.330 ms

This SCF took 27463.812 ms, scf error = 9.619e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.129134, lowerbound = -0.995673, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1390.635 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.243 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.683 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.034 ms
rank =  0, Distribute data + matrix mult took 17.977 ms
rank =  0, finding HY took 21.912 ms
rank =  0, distributing HY into block cyclic form took 14.235 ms
rank =  0, finding Y'*HY took 4.791 ms
Rank 0, Project_Hamiltonian used 58.949 ms
Total time for projection: 58.963 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -0.994730042361674
    last  calculated eigval = 0.029720690837850
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99473004236167
lambda[   2] =  -0.81744309479224
lambda[   3] =  -0.57202642578868
lambda[   4] =  -0.50886461231724
lambda[   5] =  -0.42665091114395
lambda[   6] =  -0.36919462509625
lambda[   7] =  -0.34752173145642
lambda[   8] =  -0.24682370542094
lambda[   9] =  -0.23574489492021
lambda[  10] =  -0.04023450237547
lambda[  11] =  -0.02963672821720
lambda[  12] =   0.00001260825861
lambda[  13] =   0.01161156988611
lambda[  14] =   0.02061957386364
lambda[  15] =   0.02972069083785
==subpsace eigenproblem: bcast eigvals took 0.069 ms
Total time for solving subspace eigenvalue problem: 0.227 ms
rank =  0, subspace rotation using ScaLAPACK took 4.184 ms
rank =  0, Distributing orbital back into band + domain format took 14.085 ms
rank = 0, Subspace_Rotation used 18.282 ms

Total time for subspace rotation: 18.288 ms
rank = 0, Efermi =  -0.069576287841 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 4.084 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.437 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.213 ms
rank = 0, Calculating density took 1475.981 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 0.659 ms
rank = 0, D2D took 1.201 ms
rank = 0, Transfering density took 1.203 ms
Etot    =   -34.704406042451
Eband   =    -9.038000087257
E1      =    19.714309005844
E2      =    -8.620747661071
E3      =   -11.712332885927
Exc     =   -10.416866667952
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 1.525e-05, dEband = 2.710e-03
rank = 0, Calculating/Estimating energy took 1.022 ms, Etot = -34.704406042, dEtot = 1.525e-05, dEband = 2.710e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0744846732481, which took 0.076 ms

iter_count = 108, r_2norm = 2.754e-06, tol*||rhs|| = 2.979e-06

Anderson update took 67.030 ms, out of which F'*F took 30.045 ms; b-Ax took 202.739 ms, out of which Lap took 181.089 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.918 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644554, int_b + int_rho = -1.455e-13, checking this took 0.150 ms
2-norm of RHS = 602.9834439611627, which took 0.157 ms

iter_count = 210, r_2norm = 5.507e-04, tol*||rhs|| = 6.030e-04

Anderson update took 125.771 ms, out of which F'*F took 58.174 ms; b-Ax took 395.295 ms, out of which Lap took 351.823 ms
Solving Poisson took 876.177 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.156237 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.151252 
Total time for convolution: 	 convolve: 5.150777 
Total time for convolution: 	 convolve: 5.158262 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.934 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.376 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.330 ms

This SCF took 27403.281 ms, scf error = 5.796e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129721, lowerbound = -0.994730, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1368.371 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.336 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.546 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.219 ms
rank =  0, Distribute data + matrix mult took 18.118 ms
rank =  0, finding HY took 21.885 ms
rank =  0, distributing HY into block cyclic form took 14.171 ms
rank =  0, finding Y'*HY took 6.641 ms
Rank 0, Project_Hamiltonian used 60.851 ms
Total time for projection: 60.866 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -0.993256831972531
    last  calculated eigval = 0.032068251104458
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99325683197253
lambda[   2] =  -0.81597639241511
lambda[   3] =  -0.57061515703368
lambda[   4] =  -0.50746435764907
lambda[   5] =  -0.42521885118187
lambda[   6] =  -0.36776943457327
lambda[   7] =  -0.34617441152364
lambda[   8] =  -0.24542180425376
lambda[   9] =  -0.23435101560940
lambda[  10] =  -0.03457817331609
lambda[  11] =  -0.02817252335746
lambda[  12] =   0.00469860706504
lambda[  13] =   0.01497062400600
lambda[  14] =   0.02437305399800
lambda[  15] =   0.03206825110446
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 11.714 ms
rank =  0, Distributing orbital back into band + domain format took 17.277 ms
rank = 0, Subspace_Rotation used 29.017 ms

Total time for subspace rotation: 29.022 ms
rank = 0, Efermi =  -0.063920287213 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 4.088 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.514 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.125 ms
rank = 0, Calculating density took 1466.336 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.489 ms
rank = 0, D2D took 0.607 ms
rank = 0, Transfering density took 0.613 ms
Etot    =   -34.704510033535
Eband   =    -9.012496512993
E1      =    19.701575119370
E2      =    -8.607382400181
E3      =   -11.714698870507
Exc     =   -10.418741070516
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 1.733e-05, dEband = 4.251e-03
rank = 0, Calculating/Estimating energy took 1.020 ms, Etot = -34.704510034, dEtot = 1.733e-05, dEband = 4.251e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0596560485800, which took 0.058 ms

iter_count = 114, r_2norm = 1.537e-06, tol*||rhs|| = 2.386e-06

Anderson update took 70.865 ms, out of which F'*F took 31.309 ms; b-Ax took 213.903 ms, out of which Lap took 191.190 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 479.324 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644554, int_b + int_rho = -1.419e-13, checking this took 0.096 ms
2-norm of RHS = 602.9856195557531, which took 0.137 ms

iter_count = 162, r_2norm = 5.231e-04, tol*||rhs|| = 6.030e-04

Anderson update took 96.200 ms, out of which F'*F took 45.107 ms; b-Ax took 308.585 ms, out of which Lap took 275.424 ms
Solving Poisson took 677.414 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.150989 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.155096 
Total time for convolution: 	 convolve: 5.162302 
Total time for convolution: 	 convolve: 5.155797 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.766 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.935 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.374 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.330 ms

This SCF took 27277.013 ms, scf error = 3.135e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132068, lowerbound = -0.993257, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1384.050 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.234 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.630 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.076 ms
rank =  0, Distribute data + matrix mult took 17.960 ms
rank =  0, finding HY took 21.942 ms
rank =  0, distributing HY into block cyclic form took 14.215 ms
rank =  0, finding Y'*HY took 4.753 ms
Rank 0, Project_Hamiltonian used 58.905 ms
Total time for projection: 58.921 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.738 ms
    first calculated eigval = -0.993039391369735
    last  calculated eigval = 0.032629871352448
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99303939136973
lambda[   2] =  -0.81579753288116
lambda[   3] =  -0.57041171227492
lambda[   4] =  -0.50727288466270
lambda[   5] =  -0.42504232583241
lambda[   6] =  -0.36756379652991
lambda[   7] =  -0.34597045657610
lambda[   8] =  -0.24522947939552
lambda[   9] =  -0.23418614745699
lambda[  10] =  -0.03351047488029
lambda[  11] =  -0.02800195587663
lambda[  12] =   0.00465735750038
lambda[  13] =   0.01534495617063
lambda[  14] =   0.02491134890472
lambda[  15] =   0.03262987135245
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.756 ms
rank =  0, subspace rotation using ScaLAPACK took 1.748 ms
rank =  0, Distributing orbital back into band + domain format took 19.963 ms
rank = 0, Subspace_Rotation used 21.725 ms

Total time for subspace rotation: 21.731 ms
rank = 0, Efermi =  -0.062853348678 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.241 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.372 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.226 ms
rank = 0, Calculating density took 1473.419 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.776 ms
rank = 0, D2D took 1.002 ms
rank = 0, Transfering density took 1.011 ms
Etot    =   -34.704547357690
Eband   =    -9.009027454510
E1      =    19.699890346820
E2      =    -8.605545111963
E3      =   -11.714833967913
Exc     =   -10.418860489792
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 6.221e-06, dEband = 5.782e-04
rank = 0, Calculating/Estimating energy took 1.061 ms, Etot = -34.704547358, dEtot = 6.221e-06, dEband = 5.782e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0527692074046, which took 0.068 ms

iter_count = 108, r_2norm = 1.735e-06, tol*||rhs|| = 2.111e-06

Anderson update took 67.122 ms, out of which F'*F took 29.762 ms; b-Ax took 203.379 ms, out of which Lap took 181.884 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.266 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644563, int_b + int_rho = -4.729e-14, checking this took 0.146 ms
2-norm of RHS = 602.9974580100366, which took 0.173 ms

iter_count = 180, r_2norm = 5.170e-04, tol*||rhs|| = 6.030e-04

Anderson update took 107.113 ms, out of which F'*F took 50.064 ms; b-Ax took 343.686 ms, out of which Lap took 306.715 ms
Solving Poisson took 753.733 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.170208 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.198 ms
Total time for convolution: 	 convolve: 5.170538 
Total time for convolution: 	 convolve: 5.144720 
Total time for convolution: 	 convolve: 5.156444 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.978 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.944 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.385 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.354 ms

This SCF took 27283.051 ms, scf error = 2.552e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132630, lowerbound = -0.993039, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1399.427 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.377 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.755 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.102 ms
rank =  0, Distribute data + matrix mult took 18.252 ms
rank =  0, finding HY took 21.543 ms
rank =  0, distributing HY into block cyclic form took 14.215 ms
rank =  0, finding Y'*HY took 4.777 ms
Rank 0, Project_Hamiltonian used 59.278 ms
Total time for projection: 59.292 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.992843770587869
    last  calculated eigval = 0.034577297180466
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99284377058787
lambda[   2] =  -0.81564759528050
lambda[   3] =  -0.57020262881310
lambda[   4] =  -0.50705465171441
lambda[   5] =  -0.42488076976597
lambda[   6] =  -0.36735517770960
lambda[   7] =  -0.34574682897272
lambda[   8] =  -0.24504575586460
lambda[   9] =  -0.23403631606478
lambda[  10] =  -0.03273995179500
lambda[  11] =  -0.02787000693833
lambda[  12] =   0.00375721040162
lambda[  13] =   0.01574696542640
lambda[  14] =   0.02629184674614
lambda[  15] =   0.03457729718047
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 4.275 ms
rank =  0, Distributing orbital back into band + domain format took 14.192 ms
rank = 0, Subspace_Rotation used 18.482 ms

Total time for subspace rotation: 18.487 ms
rank = 0, Efermi =  -0.062084241592 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.193 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.360 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.211 ms
rank = 0, Calculating density took 1485.279 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
rank = 0, D2D took 1.014 ms
rank = 0, Transfering density took 1.017 ms
Etot    =   -34.704622346826
Eband   =    -9.005626990085
E1      =    19.698833751874
E2      =    -8.603200410785
E3      =   -11.714559306675
Exc     =   -10.418659985991
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 1.250e-05, dEband = 5.667e-04
rank = 0, Calculating/Estimating energy took 1.077 ms, Etot = -34.704622347, dEtot = 1.250e-05, dEband = 5.667e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0503436835146, which took 0.059 ms

iter_count = 108, r_2norm = 1.587e-06, tol*||rhs|| = 2.014e-06

Anderson update took 67.818 ms, out of which F'*F took 30.053 ms; b-Ax took 202.270 ms, out of which Lap took 180.698 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.740 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644559, int_b + int_rho = -9.459e-14, checking this took 0.106 ms
2-norm of RHS = 602.9980854742972, which took 0.118 ms

iter_count = 102, r_2norm = 5.737e-04, tol*||rhs|| = 6.030e-04

Anderson update took 60.822 ms, out of which F'*F took 28.319 ms; b-Ax took 191.986 ms, out of which Lap took 171.216 ms
Solving Poisson took 426.280 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.159206 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.292 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.168140 
Total time for convolution: 	 convolve: 5.142047 
Total time for convolution: 	 convolve: 5.147544 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.764 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.275 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 0.955 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.376 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.364 ms

This SCF took 26988.564 ms, scf error = 2.378e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.134577, lowerbound = -0.992844, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1399.480 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.385 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.643 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.057 ms
rank =  0, Distribute data + matrix mult took 18.105 ms
rank =  0, finding HY took 22.000 ms
rank =  0, distributing HY into block cyclic form took 14.282 ms
rank =  0, finding Y'*HY took 4.793 ms
Rank 0, Project_Hamiltonian used 59.222 ms
Total time for projection: 59.292 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -0.992818292691717
    last  calculated eigval = 0.035047974556227
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99281829269172
lambda[   2] =  -0.81561288450111
lambda[   3] =  -0.57017209764859
lambda[   4] =  -0.50702260626928
lambda[   5] =  -0.42484675375481
lambda[   6] =  -0.36732460198069
lambda[   7] =  -0.34571478051792
lambda[   8] =  -0.24501178926715
lambda[   9] =  -0.23399796362131
lambda[  10] =  -0.03244170503133
lambda[  11] =  -0.02783976371057
lambda[  12] =   0.00369197444870
lambda[  13] =   0.01560823801116
lambda[  14] =   0.02656125071866
lambda[  15] =   0.03504797455623
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.240 ms
rank =  0, subspace rotation using ScaLAPACK took 4.251 ms
rank =  0, Distributing orbital back into band + domain format took 14.234 ms
rank = 0, Subspace_Rotation used 18.500 ms

Total time for subspace rotation: 18.505 ms
rank = 0, Efermi =  -0.061787026635 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.955 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.600 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.210 ms
rank = 0, Calculating density took 1485.397 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.748 ms
rank = 0, D2D took 0.963 ms
rank = 0, Transfering density took 0.968 ms
Etot    =   -34.704628153258
Eband   =    -9.005043541038
E1      =    19.698591326396
E2      =    -8.602854933108
E3      =   -11.714564932351
Exc     =   -10.418666963989
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 9.677e-07, dEband = 9.724e-05
rank = 0, Calculating/Estimating energy took 1.112 ms, Etot = -34.704628153, dEtot = 9.677e-07, dEband = 9.724e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0456119884381, which took 0.076 ms

iter_count = 108, r_2norm = 1.474e-06, tol*||rhs|| = 1.824e-06

Anderson update took 68.054 ms, out of which F'*F took 30.071 ms; b-Ax took 202.701 ms, out of which Lap took 181.065 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.389 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644560, int_b + int_rho = -8.367e-14, checking this took 0.110 ms
2-norm of RHS = 602.9958030605239, which took 0.136 ms

iter_count = 138, r_2norm = 5.441e-04, tol*||rhs|| = 6.030e-04

Anderson update took 82.485 ms, out of which F'*F took 38.660 ms; b-Ax took 260.396 ms, out of which Lap took 232.034 ms
Solving Poisson took 576.915 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.170306 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.151933 
Total time for convolution: 	 convolve: 5.142416 
Total time for convolution: 	 convolve: 5.148846 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.933 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.374 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.709 ms

This SCF took 27136.073 ms, scf error = 2.291e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.135048, lowerbound = -0.992818, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1322.913 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.497 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.652 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 18.172 ms
rank =  0, finding HY took 22.005 ms
rank =  0, distributing HY into block cyclic form took 14.227 ms
rank =  0, finding Y'*HY took 4.737 ms
Rank 0, Project_Hamiltonian used 59.171 ms
Total time for projection: 59.182 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -0.992734361954272
    last  calculated eigval = 0.036337360437760
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99273436195427
lambda[   2] =  -0.81550471700195
lambda[   3] =  -0.57008118036385
lambda[   4] =  -0.50692554642651
lambda[   5] =  -0.42474410440786
lambda[   6] =  -0.36723096461050
lambda[   7] =  -0.34562008596108
lambda[   8] =  -0.24491333126371
lambda[   9] =  -0.23389230895077
lambda[  10] =  -0.03179790822593
lambda[  11] =  -0.02775293996695
lambda[  12] =   0.00398363774399
lambda[  13] =   0.01573126972371
lambda[  14] =   0.02727503251314
lambda[  15] =   0.03633736043776
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 4.251 ms
rank =  0, Distributing orbital back into band + domain format took 14.296 ms
rank = 0, Subspace_Rotation used 18.563 ms

Total time for subspace rotation: 18.568 ms
rank = 0, Efermi =  -0.061146868616 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 3.646 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.177 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.093 ms
rank = 0, Calculating density took 1416.877 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.407 ms
rank = 0, D2D took 6.301 ms
rank = 0, Transfering density took 6.308 ms
Etot    =   -34.704642800355
Eband   =    -9.003293202403
E1      =    19.697682064542
E2      =    -8.601997065354
E3      =   -11.714630400345
Exc     =   -10.418730288107
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 2.441e-06, dEband = 2.917e-04
rank = 0, Calculating/Estimating energy took 0.991 ms, Etot = -34.704642800, dEtot = 2.441e-06, dEband = 2.917e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0428130571228, which took 0.061 ms

iter_count = 108, r_2norm = 1.484e-06, tol*||rhs|| = 1.713e-06

Anderson update took 66.979 ms, out of which F'*F took 30.442 ms; b-Ax took 203.175 ms, out of which Lap took 181.583 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.260 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644563, int_b + int_rho = -5.093e-14, checking this took 0.096 ms
2-norm of RHS = 602.9924790522435, which took 0.139 ms

iter_count = 108, r_2norm = 5.247e-04, tol*||rhs|| = 6.030e-04

Anderson update took 64.540 ms, out of which F'*F took 30.034 ms; b-Ax took 202.676 ms, out of which Lap took 180.410 ms
Solving Poisson took 451.469 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.182236 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.899 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.336149 
Total time for convolution: 	 convolve: 5.144129 
Total time for convolution: 	 convolve: 5.149715 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.170 ms
---Transfer Veff_loc: D2D took 1.883 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.379 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.280 ms

This SCF took 27254.880 ms, scf error = 2.072e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136337, lowerbound = -0.992734, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1395.217 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.150 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.733 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 17.910 ms
rank =  0, finding HY took 21.957 ms
rank =  0, distributing HY into block cyclic form took 14.145 ms
rank =  0, finding Y'*HY took 4.820 ms
Rank 0, Project_Hamiltonian used 58.865 ms
Total time for projection: 58.885 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -0.992666894437400
    last  calculated eigval = 0.036691181005326
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99266689443740
lambda[   2] =  -0.81543513765363
lambda[   3] =  -0.57001916037962
lambda[   4] =  -0.50686697270989
lambda[   5] =  -0.42467934398072
lambda[   6] =  -0.36716758842025
lambda[   7] =  -0.34555866909526
lambda[   8] =  -0.24484952475183
lambda[   9] =  -0.23383087568356
lambda[  10] =  -0.03170403400152
lambda[  11] =  -0.02770591150102
lambda[  12] =   0.00395948556606
lambda[  13] =   0.01543652596390
lambda[  14] =   0.02738457906672
lambda[  15] =   0.03669118100533
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 4.236 ms
rank =  0, Distributing orbital back into band + domain format took 14.292 ms
rank = 0, Subspace_Rotation used 18.548 ms

Total time for subspace rotation: 18.552 ms
rank = 0, Efermi =  -0.061053429891 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.147 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.378 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.309 ms
rank = 0, Calculating density took 1480.802 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.733 ms
rank = 0, D2D took 0.960 ms
rank = 0, Transfering density took 0.963 ms
Etot    =   -34.704649251372
Eband   =    -9.002148334745
E1      =    19.696980246542
E2      =    -8.601530074058
E3      =   -11.714738679183
Exc     =   -10.418821076324
Esc     =   -55.296928839588
Entropy =    -0.000000000498
dE = 1.075e-06, dEband = 1.908e-04
rank = 0, Calculating/Estimating energy took 1.115 ms, Etot = -34.704649251, dEtot = 1.075e-06, dEband = 1.908e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0585837526253, which took 0.055 ms

iter_count = 102, r_2norm = 1.796e-06, tol*||rhs|| = 2.343e-06

Anderson update took 64.975 ms, out of which F'*F took 28.381 ms; b-Ax took 191.206 ms, out of which Lap took 170.791 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 432.794 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644558, int_b + int_rho = -9.823e-14, checking this took 0.143 ms
2-norm of RHS = 602.9974192166060, which took 0.141 ms

iter_count = 150, r_2norm = 5.850e-04, tol*||rhs|| = 6.030e-04

Anderson update took 90.446 ms, out of which F'*F took 41.432 ms; b-Ax took 284.545 ms, out of which Lap took 254.008 ms
Solving Poisson took 629.633 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.199423 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.583 ms
Total time for convolution: 	 convolve: 5.180992 
Total time for convolution: 	 convolve: 5.157393 
Total time for convolution: 	 convolve: 5.142905 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.021 ms
======D2D: initiated sending and receiving took 1.230 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 0.950 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.381 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.353 ms

This SCF took 27191.951 ms, scf error = 1.764e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.136691, lowerbound = -0.992667, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1390.116 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.409 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.751 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.129 ms
rank =  0, Distribute data + matrix mult took 18.304 ms
rank =  0, finding HY took 22.202 ms
rank =  0, distributing HY into block cyclic form took 14.230 ms
rank =  0, finding Y'*HY took 4.817 ms
Rank 0, Project_Hamiltonian used 59.588 ms
Total time for projection: 59.601 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -0.992592328166016
    last  calculated eigval = 0.038169358949353
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99259232816602
lambda[   2] =  -0.81534561860101
lambda[   3] =  -0.56993419393570
lambda[   4] =  -0.50678264394622
lambda[   5] =  -0.42458819855398
lambda[   6] =  -0.36708448623416
lambda[   7] =  -0.34548621344005
lambda[   8] =  -0.24476422601892
lambda[   9] =  -0.23374125706452
lambda[  10] =  -0.03298351838649
lambda[  11] =  -0.02770352837895
lambda[  12] =   0.00319399795818
lambda[  13] =   0.01450100925675
lambda[  14] =   0.02790920783990
lambda[  15] =   0.03816935894935
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 4.289 ms
rank =  0, Distributing orbital back into band + domain format took 14.249 ms
rank = 0, Subspace_Rotation used 18.553 ms

Total time for subspace rotation: 18.558 ms
rank = 0, Efermi =  -0.062326772833 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.044 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.437 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.232 ms
rank = 0, Calculating density took 1476.301 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.786 ms
rank = 0, D2D took 1.011 ms
rank = 0, Transfering density took 1.013 ms
Etot    =   -34.704681790579
Eband   =    -9.000638332463
E1      =    19.696524396728
E2      =    -8.600476295288
E3      =   -11.714568830594
Exc     =   -10.418684140642
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 5.423e-06, dEband = 2.517e-04
rank = 0, Calculating/Estimating energy took 1.070 ms, Etot = -34.704681791, dEtot = 5.423e-06, dEband = 2.517e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0558311357042, which took 0.063 ms

iter_count = 102, r_2norm = 1.792e-06, tol*||rhs|| = 2.233e-06

Anderson update took 63.643 ms, out of which F'*F took 28.361 ms; b-Ax took 191.217 ms, out of which Lap took 170.899 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 430.086 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644561, int_b + int_rho = -6.912e-14, checking this took 0.130 ms
2-norm of RHS = 602.9969854993653, which took 0.140 ms

iter_count = 96, r_2norm = 5.302e-04, tol*||rhs|| = 6.030e-04

Anderson update took 57.082 ms, out of which F'*F took 26.660 ms; b-Ax took 180.990 ms, out of which Lap took 161.295 ms
Solving Poisson took 401.847 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.152105 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.171567 
Total time for convolution: 	 convolve: 5.194065 
Total time for convolution: 	 convolve: 5.182358 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.216 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.924 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.375 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.321 ms

This SCF took 27000.607 ms, scf error = 2.041e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.138169, lowerbound = -0.992592, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1390.890 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.435 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.533 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.282 ms
rank =  0, Distribute data + matrix mult took 18.268 ms
rank =  0, finding HY took 21.992 ms
rank =  0, distributing HY into block cyclic form took 14.280 ms
rank =  0, finding Y'*HY took 4.622 ms
Rank 0, Project_Hamiltonian used 59.198 ms
Total time for projection: 59.241 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -0.992589667664794
    last  calculated eigval = 0.038500590560068
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99258966766479
lambda[   2] =  -0.81534069758937
lambda[   3] =  -0.56992965508777
lambda[   4] =  -0.50677868681265
lambda[   5] =  -0.42458159737085
lambda[   6] =  -0.36707900857020
lambda[   7] =  -0.34548255741408
lambda[   8] =  -0.24475750872313
lambda[   9] =  -0.23373307419300
lambda[  10] =  -0.03275182690014
lambda[  11] =  -0.02769606805266
lambda[  12] =   0.00342005201428
lambda[  13] =   0.01452822525956
lambda[  14] =   0.02826683565045
lambda[  15] =   0.03850059056007
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 4.285 ms
rank =  0, Distributing orbital back into band + domain format took 14.176 ms
rank = 0, Subspace_Rotation used 18.476 ms

Total time for subspace rotation: 18.482 ms
rank = 0, Efermi =  -0.062095580559 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.146 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.377 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.220 ms
rank = 0, Calculating density took 1476.671 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.736 ms
rank = 0, D2D took 2.337 ms
rank = 0, Transfering density took 2.344 ms
Etot    =   -34.704679070735
Eband   =    -9.000544907390
E1      =    19.696524922715
E2      =    -8.600400607897
E3      =   -11.714515049290
Exc     =   -10.418645903163
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 4.533e-07, dEband = 1.557e-05
rank = 0, Calculating/Estimating energy took 1.046 ms, Etot = -34.704679071, dEtot = 4.533e-07, dEband = 1.557e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0539143647271, which took 0.062 ms

iter_count = 102, r_2norm = 1.740e-06, tol*||rhs|| = 2.157e-06

Anderson update took 63.887 ms, out of which F'*F took 28.478 ms; b-Ax took 191.615 ms, out of which Lap took 171.257 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 430.657 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644558, int_b + int_rho = -1.019e-13, checking this took 0.114 ms
2-norm of RHS = 602.9932808624168, which took 0.129 ms

iter_count = 138, r_2norm = 6.027e-04, tol*||rhs|| = 6.030e-04

Anderson update took 81.709 ms, out of which F'*F took 38.408 ms; b-Ax took 259.652 ms, out of which Lap took 231.433 ms
Solving Poisson took 576.586 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.163311 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.171060 
Total time for convolution: 	 convolve: 5.163931 
Total time for convolution: 	 convolve: 5.159960 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.305 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.426 ms
---Transfer Veff_loc: D2D took 2.256 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.013 ms

This SCF took 27196.146 ms, scf error = 2.126e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.138501, lowerbound = -0.992590, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1389.484 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.290 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.571 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.311 ms
rank =  0, Distribute data + matrix mult took 18.190 ms
rank =  0, finding HY took 21.671 ms
rank =  0, distributing HY into block cyclic form took 14.213 ms
rank =  0, finding Y'*HY took 4.864 ms
Rank 0, Project_Hamiltonian used 58.977 ms
Total time for projection: 59.041 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.163 ms
    first calculated eigval = -0.992558482206235
    last  calculated eigval = 0.037190045183275
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99255848220623
lambda[   2] =  -0.81533506068100
lambda[   3] =  -0.56991843892616
lambda[   4] =  -0.50677920058929
lambda[   5] =  -0.42458485524628
lambda[   6] =  -0.36706967549887
lambda[   7] =  -0.34546831540545
lambda[   8] =  -0.24475600179297
lambda[   9] =  -0.23375326114663
lambda[  10] =  -0.03410067072360
lambda[  11] =  -0.02773827941771
lambda[  12] =   0.00232882616699
lambda[  13] =   0.01355175184905
lambda[  14] =   0.02704293889793
lambda[  15] =   0.03719004518327
==subpsace eigenproblem: bcast eigvals took 0.069 ms
Total time for solving subspace eigenvalue problem: 0.238 ms
rank =  0, subspace rotation using ScaLAPACK took 4.264 ms
rank =  0, Distributing orbital back into band + domain format took 14.247 ms
rank = 0, Subspace_Rotation used 18.526 ms

Total time for subspace rotation: 18.532 ms
rank = 0, Efermi =  -0.063442804405 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.030 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.513 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.252 ms
rank = 0, Calculating density took 1481.785 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.177 ms
rank = 0, D2D took 1.277 ms
rank = 0, Transfering density took 1.284 ms
Etot    =   -34.704683370472
Eband   =    -9.000446583547
E1      =    19.696159268252
E2      =    -8.600609157632
E3      =   -11.714715519603
Exc     =   -10.418791892327
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 7.166e-07, dEband = 1.639e-05
rank = 0, Calculating/Estimating energy took 1.121 ms, Etot = -34.704683370, dEtot = 7.166e-07, dEband = 1.639e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0431105720909, which took 0.055 ms

iter_count = 102, r_2norm = 1.668e-06, tol*||rhs|| = 1.724e-06

Anderson update took 63.801 ms, out of which F'*F took 28.423 ms; b-Ax took 191.529 ms, out of which Lap took 171.154 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 430.651 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644559, int_b + int_rho = -9.459e-14, checking this took 0.113 ms
2-norm of RHS = 602.9909116265386, which took 0.130 ms

iter_count = 114, r_2norm = 5.423e-04, tol*||rhs|| = 6.030e-04

Anderson update took 71.156 ms, out of which F'*F took 31.538 ms; b-Ax took 214.655 ms, out of which Lap took 191.005 ms
Solving Poisson took 480.435 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.174513 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.194 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.154655 
Total time for convolution: 	 convolve: 5.173120 
Total time for convolution: 	 convolve: 5.174763 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.297 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 0.942 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.387 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.351 ms

This SCF took 27056.341 ms, scf error = 1.344e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.137190, lowerbound = -0.992558, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1361.159 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.450 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.556 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.091 ms
rank =  0, Distribute data + matrix mult took 18.112 ms
rank =  0, finding HY took 22.062 ms
rank =  0, distributing HY into block cyclic form took 14.189 ms
rank =  0, finding Y'*HY took 4.811 ms
Rank 0, Project_Hamiltonian used 59.207 ms
Total time for projection: 59.219 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -0.992496640464472
    last  calculated eigval = 0.037027298191691
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99249664046447
lambda[   2] =  -0.81529343438713
lambda[   3] =  -0.56986957925914
lambda[   4] =  -0.50673643815516
lambda[   5] =  -0.42454886029282
lambda[   6] =  -0.36702352881751
lambda[   7] =  -0.34541858809332
lambda[   8] =  -0.24471785217698
lambda[   9] =  -0.23373520874322
lambda[  10] =  -0.03441240936284
lambda[  11] =  -0.02771916090578
lambda[  12] =   0.00207059856373
lambda[  13] =   0.01331616297457
lambda[  14] =   0.02688833110570
lambda[  15] =   0.03702729819169
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 4.297 ms
rank =  0, Distributing orbital back into band + domain format took 14.242 ms
rank = 0, Subspace_Rotation used 19.006 ms

Total time for subspace rotation: 19.038 ms
rank = 0, Efermi =  -0.063754417118 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.864 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.625 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.214 ms
rank = 0, Calculating density took 1447.023 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.800 ms
rank = 0, D2D took 0.992 ms
rank = 0, Transfering density took 0.995 ms
Etot    =   -34.704685566871
Eband   =    -8.999680261345
E1      =    19.695583531434
E2      =    -8.600374885013
E3      =   -11.714890252827
Exc     =   -10.418925134716
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 3.661e-07, dEband = 1.277e-04
rank = 0, Calculating/Estimating energy took 1.061 ms, Etot = -34.704685567, dEtot = 3.661e-07, dEband = 1.277e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0301493878380, which took 0.065 ms

iter_count = 102, r_2norm = 8.863e-07, tol*||rhs|| = 1.206e-06

Anderson update took 63.782 ms, out of which F'*F took 28.406 ms; b-Ax took 191.048 ms, out of which Lap took 170.748 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 430.381 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644563, int_b + int_rho = -5.093e-14, checking this took 0.131 ms
2-norm of RHS = 603.0031182976193, which took 0.129 ms

iter_count = 150, r_2norm = 5.749e-04, tol*||rhs|| = 6.030e-04

Anderson update took 89.379 ms, out of which F'*F took 41.678 ms; b-Ax took 282.785 ms, out of which Lap took 252.197 ms
Solving Poisson took 625.663 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.161 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.220 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.516 ms
Total time for convolution: 	 convolve: 5.176078 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.148137 
Total time for convolution: 	 convolve: 5.172790 
Total time for convolution: 	 convolve: 5.151798 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.017 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.889 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.929 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.385 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.336 ms

This SCF took 27110.383 ms, scf error = 1.027e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.137027, lowerbound = -0.992497, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1378.894 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.219 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.580 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 17.825 ms
rank =  0, finding HY took 21.848 ms
rank =  0, distributing HY into block cyclic form took 14.146 ms
rank =  0, finding Y'*HY took 4.744 ms
Rank 0, Project_Hamiltonian used 58.596 ms
Total time for projection: 58.614 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -0.992447518157194
    last  calculated eigval = 0.039827713208533
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99244751815719
lambda[   2] =  -0.81524563331994
lambda[   3] =  -0.56979453713008
lambda[   4] =  -0.50663966461901
lambda[   5] =  -0.42448905410748
lambda[   6] =  -0.36696213542492
lambda[   7] =  -0.34535692548294
lambda[   8] =  -0.24466252443433
lambda[   9] =  -0.23368431081160
lambda[  10] =  -0.03279657419250
lambda[  11] =  -0.02762717806177
lambda[  12] =   0.00355554128553
lambda[  13] =   0.01474527919617
lambda[  14] =   0.02939327686095
lambda[  15] =   0.03982771320853
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 4.186 ms
rank =  0, Distributing orbital back into band + domain format took 13.981 ms
rank = 0, Subspace_Rotation used 18.187 ms

Total time for subspace rotation: 18.194 ms
rank = 0, Efermi =  -0.062140057129 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 3.598 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.757 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.229 ms
rank = 0, Calculating density took 1463.609 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.679 ms
rank = 0, D2D took 0.904 ms
rank = 0, Transfering density took 0.911 ms
Etot    =   -34.704693435779
Eband   =    -8.998564607514
E1      =    19.695568039586
E2      =    -8.599313273775
E3      =   -11.714675741500
Exc     =   -10.418757043042
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 1.311e-06, dEband = 1.859e-04
rank = 0, Calculating/Estimating energy took 1.752 ms, Etot = -34.704693436, dEtot = 1.311e-06, dEband = 1.859e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0186928893399, which took 0.053 ms

iter_count = 108, r_2norm = 5.595e-07, tol*||rhs|| = 7.477e-07

Anderson update took 67.348 ms, out of which F'*F took 30.140 ms; b-Ax took 203.053 ms, out of which Lap took 181.330 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.205 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644562, int_b + int_rho = -5.821e-14, checking this took 0.134 ms
2-norm of RHS = 602.9952635595469, which took 0.147 ms

iter_count = 126, r_2norm = 5.977e-04, tol*||rhs|| = 6.030e-04

Anderson update took 74.814 ms, out of which F'*F took 34.834 ms; b-Ax took 238.362 ms, out of which Lap took 212.381 ms
Solving Poisson took 526.149 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.164881 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.383 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.155820 
Total time for convolution: 	 convolve: 5.160645 
Total time for convolution: 	 convolve: 5.159559 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.016 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.932 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.371 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.324 ms

This SCF took 27104.577 ms, scf error = 2.082e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.139828, lowerbound = -0.992448, upperbound = 267.574568

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1378.003 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.378 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.670 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.074 ms
rank =  0, Distribute data + matrix mult took 18.140 ms
rank =  0, finding HY took 21.895 ms
rank =  0, distributing HY into block cyclic form took 14.155 ms
rank =  0, finding Y'*HY took 4.857 ms
Rank 0, Project_Hamiltonian used 59.079 ms
Total time for projection: 59.091 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.992271016913558
    last  calculated eigval = 0.038580487893347
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99227101691356
lambda[   2] =  -0.81509781162339
lambda[   3] =  -0.56965260839476
lambda[   4] =  -0.50651900239193
lambda[   5] =  -0.42435838700848
lambda[   6] =  -0.36682142826018
lambda[   7] =  -0.34521515713929
lambda[   8] =  -0.24452993907734
lambda[   9] =  -0.23358018449855
lambda[  10] =  -0.03383259070204
lambda[  11] =  -0.02754434717554
lambda[  12] =   0.00273090013104
lambda[  13] =   0.01406250788044
lambda[  14] =   0.02826956781488
lambda[  15] =   0.03858048789335
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 4.056 ms
rank =  0, Distributing orbital back into band + domain format took 14.104 ms
rank = 0, Subspace_Rotation used 18.188 ms

Total time for subspace rotation: 18.194 ms
rank = 0, Efermi =  -0.063174761189 calculate fermi energy took 0.880 ms
rank = 0, --- Calculate rho: sum over local bands took 4.062 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.541 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.255 ms
rank = 0, Calculating density took 1463.443 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.631 ms
rank = 0, D2D took 1.471 ms
rank = 0, Transfering density took 1.479 ms
Etot    =   -34.704693292517
Eband   =    -8.996091071171
E1      =    19.693757860525
E2      =    -8.598524217141
E3      =   -11.715226867261
Exc     =   -10.419182326188
Esc     =   -55.296928839588
Entropy =    -0.000000000497
dE = 2.388e-08, dEband = 4.123e-04
rank = 0, Calculating/Estimating energy took 1.261 ms, Etot = -34.704693293, dEtot = 2.388e-08, dEband = 4.123e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0228391962658, which took 0.084 ms

iter_count = 102, r_2norm = 8.827e-07, tol*||rhs|| = 9.136e-07

Anderson update took 63.441 ms, out of which F'*F took 28.435 ms; b-Ax took 191.905 ms, out of which Lap took 171.402 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 431.398 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001644568, int_rho =  18.00000001644559, int_b + int_rho = -9.459e-14, checking this took 0.142 ms
2-norm of RHS = 602.9951281175076, which took 0.150 ms

iter_count = 96, r_2norm = 5.979e-04, tol*||rhs|| = 6.030e-04

Anderson update took 57.109 ms, out of which F'*F took 26.378 ms; b-Ax took 180.899 ms, out of which Lap took 161.077 ms
Solving Poisson took 402.075 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.145513 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.380 ms
Total time for convolution: 	 convolve: 5.149041 
Total time for convolution: 	 convolve: 5.172730 
Total time for convolution: 	 convolve: 5.160979 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.872 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.587 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.964 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.360 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.357 ms

This SCF took 26926.246 ms, scf error = 7.015e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.99227101691356, occ[   1] =   2.00000000000000
lambda[   2] =  -0.81509781162339, occ[   2] =   2.00000000000000
lambda[   3] =  -0.56965260839476, occ[   3] =   2.00000000000000
lambda[   4] =  -0.50651900239193, occ[   4] =   2.00000000000000
lambda[   5] =  -0.42435838700848, occ[   5] =   2.00000000000000
lambda[   6] =  -0.36682142826018, occ[   6] =   2.00000000000000
lambda[   7] =  -0.34521515713929, occ[   7] =   2.00000000000000
lambda[   8] =  -0.24452993907734, occ[   8] =   2.00000000000000
lambda[   9] =  -0.23358018449855, occ[   9] =   2.00000000000000
lambda[  10] =  -0.03383259070204, occ[  10] =   0.00000001643849
lambda[  11] =  -0.02754434717554, occ[  11] =   0.00000000000709
lambda[  12] =   0.00273090013104, occ[  12] =   0.00000000000000
lambda[  13] =   0.01406250788044, occ[  13] =   0.00000000000000
lambda[  14] =   0.02826956781488, occ[  14] =   0.00000000000000
lambda[  15] =   0.03858048789335, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.500 ms, time for Allreduce/Reduce: 6.936 ms 
Time for calculating local force components: 16.240 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.12907490516220   1.08886460747280   0.00000068182399
  0.01422389550357  -0.04912582526206  -0.00000000585012
  0.06749694281894  -0.03474295605873   0.00000001976406
 -0.04026394494445  -0.04902165248344   0.00000003149576
 -0.12301956604293  -0.16057757192407  -0.00000070819839
 -0.37514034541995   0.75322869191159   0.00000068098945
force_loc = 
  0.12614325376767  -1.06028067461700  -0.00000140008360
 -0.01639969877732   0.05411443244100  -0.00000014149214
 -0.07243266597949   0.03598381156763  -0.00000021836197
  0.04459222505485   0.05026918753058  -0.00000020351089
  0.11195332249058   0.15223966356006  -0.00000113724626
  0.37132870943468  -0.73574121272280  -0.00000067159227
Time for calculating nonlocal force components: 31.664 ms
[32mforces_xc: 
[0m[32m  0.00393646042565  -0.03168083660024  -0.00000012619133
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.01171662596225   0.00440170090600  -0.00000007530067
[0m[32m  0.00501882469167  -0.01799724230358  -0.00000000225250
[0mTime for calculating XC forces components: 20.604 ms
 Cartesian force = 
  0.00099162006053  -0.00308592431406  -0.00000029844979
 -0.00218899224434   0.00499958660931   0.00000039865889
 -0.00494891213113   0.00125183493927   0.00000034740323
  0.00431509113982   0.00125851447751   0.00000037398602
  0.00063719343931  -0.00392522802763  -0.00000137474418
  0.00119399973581  -0.00049878368441   0.00000055314583
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.026 ms
Time for printing density: 387.361 ms
The program took 635.317 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:45
Job ID:        2266567
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:09:48,vmem=8340K,walltime=00:10:49,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-13-2
---------------------------------------
