---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:02
Job ID:    2266902
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:07
Job ID:    2266902
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.049 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 1.116 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 9.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8

Reading ion file took 14.553 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 54.471 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.914 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.085 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   12.736991	    8.282642	   10.000000	
   13.638820	   11.663812	   10.000000	
    9.221938	   12.892395	   10.000000	
    8.249353	    7.107605	   10.000000	
    6.361180	    9.317492	   11.661287	
    6.361180	    9.317492	    8.338713	
    7.560402	    9.051585	   10.000000	
    9.716123	   10.898845	   10.000000	
   12.159722	   10.249709	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.161 ms
Set up communicators.

--set up spincomm took 2.269 ms

--set up kptcomm took 0.398 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.011 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.078 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.069 ms

Calculate_SplineDerivRadFun took 0.115 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.792 ms.
time spent on vectorized spline interp: 3.131 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.573 ms.
time spent on vectorized spline interp: 1.615 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.577 ms.

Calculating rb for all atom types took 11.697 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.046 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000216212, sum_int_rho = 17.3984566308115
PosCharge = 18.000000021621, NegCharge = -17.398456630811, scal_fac = 1.034574525981
After scaling, int_rho = 18.0000000216213, PosCharge + NegCharge - NetCharge = -8.527e-14
--Calculate Vref took 0.422 ms
--Calculate rho_guess took 2.224 ms

 integral of b = -18.0000000216212,
 int{b} + Nelectron + NetCharge = -2.162e-08,
 Esc = -39.7752192203218,
 MPI_Reduce took 5.971 ms

Calculating b & b_ref took 14.452 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.030 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.105 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.015 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.124 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.824 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 28.008 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162114, int_b + int_rho = -2.910e-14, checking this took 0.089 ms
2-norm of RHS = 694.5469426180520, which took 0.072 ms

iter_count = 420, r_2norm = 5.738e-04, tol*||rhs|| = 6.945e-04

Anderson update took 240.621 ms, out of which F'*F took 105.958 ms; b-Ax took 714.674 ms, out of which Lap took 641.269 ms
Solving Poisson took 1521.623 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.446 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
Total time for convolution: 	 convolve: 5.164791 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
Total time for convolution: 	 convolve: 5.128179 
Total time for convolution: 	 convolve: 5.129318 
Total time for convolution: 	 convolve: 5.149466 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.728 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.452 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
rank = 0, XC calculation took 24457.474 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 1.604 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 1.550 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.260 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 5.035 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.648 ms
    Lanczos iter 53, eigmin  = -0.826392074, eigmax = 264.932626851, err_eigmin = 6.176e-04, err_eigmax = 9.554e-03
rank =   0, Lanczos took 120.689 ms, eigmin = -0.826392073854, eigmax = 267.581953119694

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.327781, lowerbound = -0.926392, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1136.444 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 28.091 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.005 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.226 ms
rank =  0, Distribute data + matrix mult took 33.337 ms
rank =  0, finding HY took 20.444 ms
rank =  0, distributing HY into block cyclic form took 12.026 ms
rank =  0, finding Y'*HY took 5.390 ms
Rank 0, Project_Hamiltonian used 71.228 ms
Total time for projection: 71.238 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.303 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.375 ms
    first calculated eigval = 2.803129564096790
    last  calculated eigval = 3.210905901409022
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.80312956409679
lambda[   2] =   2.84786782989542
lambda[   3] =   2.88583026216704
lambda[   4] =   2.92419218715276
lambda[   5] =   2.94040587968456
lambda[   6] =   2.94916715428015
lambda[   7] =   2.99528831711112
lambda[   8] =   3.01436119684771
lambda[   9] =   3.03513246664020
lambda[  10] =   3.05790164358627
lambda[  11] =   3.08907356496214
lambda[  12] =   3.11254007476007
lambda[  13] =   3.13715731667586
lambda[  14] =   3.16296148866239
lambda[  15] =   3.21090590140902
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.387 ms
rank =  0, subspace rotation using ScaLAPACK took 3.549 ms
rank =  0, Distributing orbital back into band + domain format took 12.935 ms
rank = 0, Subspace_Rotation used 16.498 ms

Total time for subspace rotation: 16.502 ms
rank = 0, Efermi =   3.046517055911 calculate fermi energy took 0.050 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.310906, lowerbound = -0.926392, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1192.791 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.496 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.901 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 15.438 ms
rank =  0, finding HY took 19.472 ms
rank =  0, distributing HY into block cyclic form took 12.003 ms
rank =  0, finding Y'*HY took 4.294 ms
Rank 0, Project_Hamiltonian used 51.236 ms
Total time for projection: 51.250 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.515719036361602
    last  calculated eigval = 0.455883793909023
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.51571903636160
lambda[   2] =  -0.37484991866647
lambda[   3] =  -0.16536920314021
lambda[   4] =  -0.09592391657477
lambda[   5] =  -0.04340949797865
lambda[   6] =  -0.02963769994707
lambda[   7] =   0.15232153596480
lambda[   8] =   0.21754319645612
lambda[   9] =   0.26081904740945
lambda[  10] =   0.32063389163643
lambda[  11] =   0.36994462367718
lambda[  12] =   0.39225355060928
lambda[  13] =   0.40659103081090
lambda[  14] =   0.41511421670326
lambda[  15] =   0.45588379390902
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 3.495 ms
rank =  0, Distributing orbital back into band + domain format took 12.043 ms
rank = 0, Subspace_Rotation used 15.551 ms

Total time for subspace rotation: 15.554 ms
rank = 0, Efermi =   0.291654031435 calculate fermi energy took 0.039 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.555884, lowerbound = -0.926392, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1153.768 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 31.056 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.267 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 34.371 ms
rank =  0, finding HY took 19.426 ms
rank =  0, distributing HY into block cyclic form took 11.974 ms
rank =  0, finding Y'*HY took 4.265 ms
Rank 0, Project_Hamiltonian used 70.064 ms
Total time for projection: 70.077 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -0.831055191876385
    last  calculated eigval = 0.167664954563113
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83105519187639
lambda[   2] =  -0.74176768936441
lambda[   3] =  -0.59749497434240
lambda[   4] =  -0.51147482375254
lambda[   5] =  -0.48450979139078
lambda[   6] =  -0.45679599329433
lambda[   7] =  -0.42328638519544
lambda[   8] =  -0.39366256982616
lambda[   9] =  -0.29578174035481
lambda[  10] =  -0.02371725146363
lambda[  11] =   0.06526640315868
lambda[  12] =   0.09004681948788
lambda[  13] =   0.12072502766278
lambda[  14] =   0.15437702245342
lambda[  15] =   0.16766495456311
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 3.516 ms
rank =  0, Distributing orbital back into band + domain format took 12.081 ms
rank = 0, Subspace_Rotation used 15.611 ms

Total time for subspace rotation: 15.615 ms
rank = 0, Efermi =  -0.052813440969 calculate fermi energy took 0.044 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.267665, lowerbound = -0.926392, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1176.541 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 23.390 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.264 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.050 ms
rank =  0, Distribute data + matrix mult took 26.718 ms
rank =  0, finding HY took 19.404 ms
rank =  0, distributing HY into block cyclic form took 12.029 ms
rank =  0, finding Y'*HY took 4.254 ms
Rank 0, Project_Hamiltonian used 62.439 ms
Total time for projection: 62.669 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -0.832540670151975
    last  calculated eigval = 0.093309025388693
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83254067015198
lambda[   2] =  -0.74348037937454
lambda[   3] =  -0.60409819796901
lambda[   4] =  -0.52778591409527
lambda[   5] =  -0.49286585174287
lambda[   6] =  -0.47670380585267
lambda[   7] =  -0.44390550462241
lambda[   8] =  -0.40848476264749
lambda[   9] =  -0.32029534717515
lambda[  10] =  -0.09649835547082
lambda[  11] =   0.01234916438538
lambda[  12] =   0.04262576677206
lambda[  13] =   0.06173143909821
lambda[  14] =   0.08908617582922
lambda[  15] =   0.09330902538869
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 3.512 ms
rank =  0, Distributing orbital back into band + domain format took 12.014 ms
rank = 0, Subspace_Rotation used 15.542 ms

Total time for subspace rotation: 15.546 ms
rank = 0, Efermi =  -0.125594544912 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.215 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.033 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 5114.755 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.575 ms
rank = 0, D2D took 0.891 ms
rank = 0, Transfering density took 0.898 ms
Etot    =   -21.740765911742
Eband   =    -9.700320869349
E1      =    19.990097555759
E2      =    -6.689603704851
E3      =    -9.127166180395
Exc     =    -8.072093262428
Esc     =   -39.775219220322
Entropy =    -0.000000000648
dE = 2.416e+00, dEband = 1.078e+00
rank = 0, Calculating/Estimating energy took 0.954 ms, Etot = -21.740765912, dEtot = 2.416e+00, dEband = 1.078e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 40.5179943012090, which took 0.059 ms

iter_count = 96, r_2norm = 1.552e-03, tol*||rhs|| = 1.621e-03

Anderson update took 51.143 ms, out of which F'*F took 24.141 ms; b-Ax took 164.577 ms, out of which Lap took 146.539 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.699 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162122, int_b + int_rho = 4.366e-14, checking this took 0.168 ms
2-norm of RHS = 690.3479437757062, which took 0.112 ms

iter_count = 288, r_2norm = 5.724e-04, tol*||rhs|| = 6.903e-04

Anderson update took 154.954 ms, out of which F'*F took 72.342 ms; b-Ax took 484.730 ms, out of which Lap took 435.280 ms
Solving Poisson took 1033.808 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.793 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.100469 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.825 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.119717 
Total time for convolution: 	 convolve: 5.136176 
Total time for convolution: 	 convolve: 5.112878 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.255 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.813 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.862 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.696 ms

This SCF took 30973.296 ms, scf error = 2.230e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.193309, lowerbound = -0.832541, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1176.919 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.126 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.541 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 15.698 ms
rank =  0, finding HY took 19.260 ms
rank =  0, distributing HY into block cyclic form took 12.067 ms
rank =  0, finding Y'*HY took 4.198 ms
Rank 0, Project_Hamiltonian used 51.249 ms
Total time for projection: 51.260 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -0.797782908032111
    last  calculated eigval = 0.057065866541326
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.79778290803211
lambda[   2] =  -0.70638296036810
lambda[   3] =  -0.57520275668101
lambda[   4] =  -0.49712956935358
lambda[   5] =  -0.45818407816683
lambda[   6] =  -0.44629233177009
lambda[   7] =  -0.41070277218268
lambda[   8] =  -0.38045841308361
lambda[   9] =  -0.29342812400257
lambda[  10] =  -0.08204963168126
lambda[  11] =  -0.01833454240614
lambda[  12] =   0.02277187428606
lambda[  13] =   0.03641660467946
lambda[  14] =   0.04395529922625
lambda[  15] =   0.05706586654133
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 3.507 ms
rank =  0, Distributing orbital back into band + domain format took 12.059 ms
rank = 0, Subspace_Rotation used 15.578 ms

Total time for subspace rotation: 15.581 ms
rank = 0, Efermi =  -0.111145821133 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.420 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.815 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.176 ms
rank = 0, Calculating density took 1250.428 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
rank = 0, D2D took 0.776 ms
rank = 0, Transfering density took 0.781 ms
Etot    =   -21.686593385970
Eband   =    -9.131127829055
E1      =    19.473554140116
E2      =    -6.664413755560
E3      =    -9.278336173924
Exc     =    -8.196550405545
Esc     =   -39.775219220322
Entropy =    -0.000000000648
dE = 6.019e-03, dEband = 6.324e-02
rank = 0, Calculating/Estimating energy took 1.060 ms, Etot = -21.686593386, dEtot = 6.019e-03, dEband = 6.324e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 13.0713537761752, which took 0.087 ms

iter_count = 102, r_2norm = 5.043e-04, tol*||rhs|| = 5.229e-04

Anderson update took 54.066 ms, out of which F'*F took 25.832 ms; b-Ax took 172.959 ms, out of which Lap took 154.683 ms
rank = 0, Mixing (+ precond) took 374.552 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162130, int_b + int_rho = 1.237e-13, checking this took 0.074 ms
2-norm of RHS = 683.4856743763418, which took 0.134 ms

iter_count = 300, r_2norm = 6.583e-04, tol*||rhs|| = 6.835e-04

Anderson update took 161.770 ms, out of which F'*F took 78.216 ms; b-Ax took 510.329 ms, out of which Lap took 456.722 ms
Solving Poisson took 1079.104 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.839 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.227027 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.209477 
Total time for convolution: 	 convolve: 5.233205 
Total time for convolution: 	 convolve: 5.309096 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.238 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.690 ms
---Transfer Veff_loc: D2D took 1.402 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.857 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.885 ms

This SCF took 27642.962 ms, scf error = 1.554e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.157066, lowerbound = -0.797783, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1170.814 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 13.435 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.689 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.102 ms
rank =  0, Distribute data + matrix mult took 17.240 ms
rank =  0, finding HY took 20.138 ms
rank =  0, distributing HY into block cyclic form took 12.202 ms
rank =  0, finding Y'*HY took 4.745 ms
Rank 0, Project_Hamiltonian used 54.352 ms
Total time for projection: 54.364 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -0.734040419913676
    last  calculated eigval = 0.042898092436564
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.73404041991368
lambda[   2] =  -0.64018982027335
lambda[   3] =  -0.52024463595775
lambda[   4] =  -0.43951913282837
lambda[   5] =  -0.39542622404617
lambda[   6] =  -0.39029964449552
lambda[   7] =  -0.34916951008939
lambda[   8] =  -0.32653030263764
lambda[   9] =  -0.24469824340202
lambda[  10] =  -0.04155339363963
lambda[  11] =  -0.02855995674836
lambda[  12] =   0.01288447921444
lambda[  13] =   0.01791362383671
lambda[  14] =   0.03897454534169
lambda[  15] =   0.04289809243656
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 3.387 ms
rank =  0, Distributing orbital back into band + domain format took 12.123 ms
rank = 0, Subspace_Rotation used 15.524 ms

Total time for subspace rotation: 15.528 ms
rank = 0, Efermi =  -0.070649583157 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.291 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.886 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.162 ms
rank = 0, Calculating density took 1247.313 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.643 ms
rank = 0, D2D took 0.832 ms
rank = 0, Transfering density took 0.836 ms
Etot    =   -21.639974894333
Eband   =    -8.080235868186
E1      =    18.550500725710
E2      =    -6.522373156757
E3      =    -9.609654223520
Exc     =    -8.467047911165
Esc     =   -39.775219220322
Entropy =    -0.000000000648
dE = 5.180e-03, dEband = 1.168e-01
rank = 0, Calculating/Estimating energy took 0.974 ms, Etot = -21.639974894, dEtot = 5.180e-03, dEband = 1.168e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.5626877538479, which took 0.069 ms

iter_count = 108, r_2norm = 1.195e-04, tol*||rhs|| = 1.825e-04

Anderson update took 57.379 ms, out of which F'*F took 26.806 ms; b-Ax took 181.653 ms, out of which Lap took 161.477 ms
rank = 0, Mixing (+ precond) took 394.904 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162123, int_b + int_rho = 5.093e-14, checking this took 0.099 ms
2-norm of RHS = 682.9789723801448, which took 0.103 ms

iter_count = 270, r_2norm = 6.494e-04, tol*||rhs|| = 6.830e-04

Anderson update took 144.054 ms, out of which F'*F took 66.396 ms; b-Ax took 450.258 ms, out of which Lap took 403.072 ms
Solving Poisson took 967.927 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.098541 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.089846 
Total time for convolution: 	 convolve: 5.106459 
Total time for convolution: 	 convolve: 5.085868 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.100 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.942 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.855 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.817 ms

This SCF took 26957.354 ms, scf error = 4.936e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.142898, lowerbound = -0.734040, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1181.930 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.220 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.268 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 15.526 ms
rank =  0, finding HY took 19.309 ms
rank =  0, distributing HY into block cyclic form took 11.878 ms
rank =  0, finding Y'*HY took 5.165 ms
Rank 0, Project_Hamiltonian used 51.905 ms
Total time for projection: 51.918 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.723026142348203
    last  calculated eigval = 0.037195804812538
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.72302614234820
lambda[   2] =  -0.62961191987457
lambda[   3] =  -0.50823325895943
lambda[   4] =  -0.42803623506731
lambda[   5] =  -0.38443197882882
lambda[   6] =  -0.37939520779787
lambda[   7] =  -0.33762487287272
lambda[   8] =  -0.31466427756458
lambda[   9] =  -0.23642723943360
lambda[  10] =  -0.03419391233019
lambda[  11] =  -0.03147216905029
lambda[  12] =   0.00879933911406
lambda[  13] =   0.01475078165486
lambda[  14] =   0.02819720998751
lambda[  15] =   0.03719580481254
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 3.487 ms
rank =  0, Distributing orbital back into band + domain format took 12.104 ms
rank = 0, Subspace_Rotation used 15.607 ms

Total time for subspace rotation: 15.612 ms
rank = 0, Efermi =  -0.063327610960 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.296 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.223 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.233 ms
rank = 0, Calculating density took 1256.472 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.600 ms
rank = 0, D2D took 0.848 ms
rank = 0, Transfering density took 0.852 ms
Etot    =   -21.635926231938
Eband   =    -7.882902266231
E1      =    18.419937083856
E2      =    -6.441270966379
E3      =    -9.687583108127
Exc     =    -8.526595903096
Esc     =   -39.775219220322
Entropy =    -0.000000000651
dE = 4.499e-04, dEband = 2.193e-02
rank = 0, Calculating/Estimating energy took 1.805 ms, Etot = -21.635926232, dEtot = 4.499e-04, dEband = 2.193e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.3747222707905, which took 0.084 ms

iter_count = 114, r_2norm = 3.478e-05, tol*||rhs|| = 5.499e-05

Anderson update took 60.799 ms, out of which F'*F took 28.414 ms; b-Ax took 192.092 ms, out of which Lap took 172.222 ms
rank = 0, Mixing (+ precond) took 417.436 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162121, int_b + int_rho = 3.638e-14, checking this took 0.113 ms
2-norm of RHS = 683.1845767223634, which took 0.102 ms

iter_count = 258, r_2norm = 6.355e-04, tol*||rhs|| = 6.832e-04

Anderson update took 141.099 ms, out of which F'*F took 72.597 ms; b-Ax took 443.824 ms, out of which Lap took 397.766 ms
Solving Poisson took 939.759 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.092515 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.084867 
Total time for convolution: 	 convolve: 5.091656 
Total time for convolution: 	 convolve: 5.089741 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.334 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.925 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.802 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.747 ms

This SCF took 26941.179 ms, scf error = 1.768e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.137196, lowerbound = -0.723026, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1135.928 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.198 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.305 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.018 ms
rank =  0, Distribute data + matrix mult took 15.534 ms
rank =  0, finding HY took 19.399 ms
rank =  0, distributing HY into block cyclic form took 12.010 ms
rank =  0, finding Y'*HY took 4.361 ms
Rank 0, Project_Hamiltonian used 51.333 ms
Total time for projection: 51.348 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.717465168638679
    last  calculated eigval = 0.032456396552748
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.71746516863868
lambda[   2] =  -0.62347032023289
lambda[   3] =  -0.50186706487838
lambda[   4] =  -0.42161755061002
lambda[   5] =  -0.37836992525438
lambda[   6] =  -0.37318570220919
lambda[   7] =  -0.33126063763575
lambda[   8] =  -0.30827201269997
lambda[   9] =  -0.23169600999382
lambda[  10] =  -0.03234409534065
lambda[  11] =  -0.03007762517582
lambda[  12] =   0.00781741910344
lambda[  13] =   0.01353034350585
lambda[  14] =   0.02209006364993
lambda[  15] =   0.03245639655275
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 3.489 ms
rank =  0, Distributing orbital back into band + domain format took 12.149 ms
rank = 0, Subspace_Rotation used 15.652 ms

Total time for subspace rotation: 15.657 ms
rank = 0, Efermi =  -0.061503981914 calculate fermi energy took 2.084 ms
rank = 0, --- Calculate rho: sum over local bands took 3.284 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.919 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.168 ms
rank = 0, Calculating density took 1210.634 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.961 ms
rank = 0, D2D took 2.062 ms
rank = 0, Transfering density took 2.066 ms
Etot    =   -21.634815526725
Eband   =    -7.774408785002
E1      =    18.364523040559
E2      =    -6.378888313411
E3      =    -9.725283181969
Exc     =    -8.553882056688
Esc     =   -39.775219220322
Entropy =    -0.000000000653
dE = 1.234e-04, dEband = 1.205e-02
rank = 0, Calculating/Estimating energy took 0.981 ms, Etot = -21.634815527, dEtot = 1.234e-04, dEband = 1.205e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7483226327553, which took 0.092 ms

iter_count = 108, r_2norm = 2.947e-05, tol*||rhs|| = 2.993e-05

Anderson update took 57.785 ms, out of which F'*F took 26.558 ms; b-Ax took 182.076 ms, out of which Lap took 162.049 ms
rank = 0, Mixing (+ precond) took 395.939 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162130, int_b + int_rho = 1.237e-13, checking this took 0.101 ms
2-norm of RHS = 683.4828977744874, which took 0.085 ms

iter_count = 240, r_2norm = 5.480e-04, tol*||rhs|| = 6.835e-04

Anderson update took 127.605 ms, out of which F'*F took 67.463 ms; b-Ax took 416.651 ms, out of which Lap took 371.420 ms
Solving Poisson took 873.281 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Total time for convolution: 	 convolve: 5.090007 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.089111 
Total time for convolution: 	 convolve: 5.084798 
Total time for convolution: 	 convolve: 5.088786 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 0.953 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.336 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.311 ms

This SCF took 26819.685 ms, scf error = 6.870e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.132456, lowerbound = -0.717465, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1154.401 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.277 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.201 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.058 ms
rank =  0, Distribute data + matrix mult took 15.549 ms
rank =  0, finding HY took 19.423 ms
rank =  0, distributing HY into block cyclic form took 12.022 ms
rank =  0, finding Y'*HY took 4.268 ms
Rank 0, Project_Hamiltonian used 51.290 ms
Total time for projection: 51.303 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.714905016472974
    last  calculated eigval = 0.028060103086156
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.71490501647297
lambda[   2] =  -0.62059204771378
lambda[   3] =  -0.49960550722126
lambda[   4] =  -0.41910648703328
lambda[   5] =  -0.37577455870515
lambda[   6] =  -0.37047834845910
lambda[   7] =  -0.32865961105815
lambda[   8] =  -0.30595814129846
lambda[   9] =  -0.22928628736273
lambda[  10] =  -0.03229575567038
lambda[  11] =  -0.02812131721298
lambda[  12] =   0.00751905148237
lambda[  13] =   0.01277262089186
lambda[  14] =   0.01952627036228
lambda[  15] =   0.02806010308616
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 3.517 ms
rank =  0, Distributing orbital back into band + domain format took 12.129 ms
rank = 0, Subspace_Rotation used 15.661 ms

Total time for subspace rotation: 15.666 ms
rank = 0, Efermi =  -0.061398319085 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.190 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.233 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.183 ms
rank = 0, Calculating density took 1228.233 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.175 ms
rank = 0, D2D took 1.271 ms
rank = 0, Transfering density took 1.278 ms
Etot    =   -21.634589767960
Eband   =    -7.728732011347
E1      =    18.346228597466
E2      =    -6.349459299801
E3      =    -9.731125361018
Exc     =    -8.557451793927
Esc     =   -39.775219220322
Entropy =    -0.000000000649
dE = 2.508e-05, dEband = 5.075e-03
rank = 0, Calculating/Estimating energy took 1.041 ms, Etot = -21.634589768, dEtot = 2.508e-05, dEband = 5.075e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2936498937976, which took 0.053 ms

iter_count = 114, r_2norm = 9.057e-06, tol*||rhs|| = 1.175e-05

Anderson update took 64.471 ms, out of which F'*F took 28.193 ms; b-Ax took 196.372 ms, out of which Lap took 174.947 ms
rank = 0, Mixing (+ precond) took 425.792 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162125, int_b + int_rho = 7.276e-14, checking this took 0.104 ms
2-norm of RHS = 683.7097594786707, which took 0.105 ms

iter_count = 246, r_2norm = 5.454e-04, tol*||rhs|| = 6.837e-04

Anderson update took 129.870 ms, out of which F'*F took 60.903 ms; b-Ax took 418.043 ms, out of which Lap took 373.185 ms
Solving Poisson took 881.105 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.097384 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.093646 
Total time for convolution: 	 convolve: 5.102848 
Total time for convolution: 	 convolve: 5.104655 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.116 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.939 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.324 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.283 ms

This SCF took 26910.296 ms, scf error = 4.131e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.128060, lowerbound = -0.714905, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1163.157 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.165 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.362 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.034 ms
rank =  0, Distribute data + matrix mult took 15.577 ms
rank =  0, finding HY took 19.303 ms
rank =  0, distributing HY into block cyclic form took 12.122 ms
rank =  0, finding Y'*HY took 4.228 ms
Rank 0, Project_Hamiltonian used 51.262 ms
Total time for projection: 51.273 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -0.710275572925525
    last  calculated eigval = 0.025579789762976
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.71027557292553
lambda[   2] =  -0.61615132774779
lambda[   3] =  -0.49541806202630
lambda[   4] =  -0.41486320300455
lambda[   5] =  -0.37146115338526
lambda[   6] =  -0.36613037604678
lambda[   7] =  -0.32434389331679
lambda[   8] =  -0.30179350616879
lambda[   9] =  -0.22524874878835
lambda[  10] =  -0.03088705085786
lambda[  11] =  -0.02446780151923
lambda[  12] =   0.00841877645064
lambda[  13] =   0.01369366287062
lambda[  14] =   0.01974628393204
lambda[  15] =   0.02557978976298
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.166 ms
rank =  0, subspace rotation using ScaLAPACK took 3.509 ms
rank =  0, Distributing orbital back into band + domain format took 12.172 ms
rank = 0, Subspace_Rotation used 15.695 ms

Total time for subspace rotation: 15.700 ms
rank = 0, Efermi =  -0.059983585160 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 1.731 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.426 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.095 ms
rank = 0, Calculating density took 1235.414 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.374 ms
rank = 0, D2D took 150.917 ms
rank = 0, Transfering density took 150.929 ms
Etot    =   -21.634431779982
Eband   =    -7.651371687488
E1      =    18.308319199041
E2      =    -6.305986596735
E3      =    -9.745208935590
Exc     =    -8.567355602891
Esc     =   -39.775219220322
Entropy =    -0.000000000648
dE = 1.755e-05, dEband = 8.596e-03
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -21.634431780, dEtot = 1.755e-05, dEband = 8.596e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1989304791462, which took 0.050 ms

iter_count = 114, r_2norm = 5.344e-06, tol*||rhs|| = 7.957e-06

Anderson update took 61.039 ms, out of which F'*F took 28.493 ms; b-Ax took 193.885 ms, out of which Lap took 172.923 ms
rank = 0, Mixing (+ precond) took 420.919 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162125, int_b + int_rho = 8.004e-14, checking this took 0.103 ms
2-norm of RHS = 683.7250474818640, which took 0.082 ms

iter_count = 228, r_2norm = 5.884e-04, tol*||rhs|| = 6.837e-04

Anderson update took 121.090 ms, out of which F'*F took 57.524 ms; b-Ax took 386.471 ms, out of which Lap took 346.567 ms
Solving Poisson took 820.789 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Total time for convolution: 	 convolve: 5.088160 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.155891 
Total time for convolution: 	 convolve: 5.106171 
Total time for convolution: 	 convolve: 5.105879 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
---Transfer Veff_loc: D2D took 0.965 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.359 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.352 ms

This SCF took 27064.261 ms, scf error = 2.115e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.125580, lowerbound = -0.710276, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1156.671 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.228 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.254 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 15.519 ms
rank =  0, finding HY took 19.341 ms
rank =  0, distributing HY into block cyclic form took 12.033 ms
rank =  0, finding Y'*HY took 4.290 ms
Rank 0, Project_Hamiltonian used 51.211 ms
Total time for projection: 51.226 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -0.707342415280221
    last  calculated eigval = 0.024990628619908
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.70734241528022
lambda[   2] =  -0.61330591840230
lambda[   3] =  -0.49271944153009
lambda[   4] =  -0.41212456406923
lambda[   5] =  -0.36866594783841
lambda[   6] =  -0.36355112100493
lambda[   7] =  -0.32163273205252
lambda[   8] =  -0.29918141896420
lambda[   9] =  -0.22242060152093
lambda[  10] =  -0.02861810821235
lambda[  11] =  -0.02170429134828
lambda[  12] =   0.01070125410766
lambda[  13] =   0.01573442350330
lambda[  14] =   0.02147412689268
lambda[  15] =   0.02499062861991
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 3.464 ms
rank =  0, Distributing orbital back into band + domain format took 12.902 ms
rank = 0, Subspace_Rotation used 16.384 ms

Total time for subspace rotation: 16.389 ms
rank = 0, Efermi =  -0.057714474464 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 3.213 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.130 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.187 ms
rank = 0, Calculating density took 1231.117 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.510 ms
rank = 0, D2D took 0.613 ms
rank = 0, Transfering density took 0.619 ms
Etot    =   -21.634379316895
Eband   =    -7.601888321944
E1      =    18.282079979228
E2      =    -6.281162064023
E3      =    -9.751689845717
Exc     =    -8.572203662949
Esc     =   -39.775219220322
Entropy =    -0.000000000648
dE = 5.829e-06, dEband = 5.498e-03
rank = 0, Calculating/Estimating energy took 0.890 ms, Etot = -21.634379317, dEtot = 5.829e-06, dEband = 5.498e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1112388371093, which took 0.054 ms

iter_count = 114, r_2norm = 3.485e-06, tol*||rhs|| = 4.450e-06

Anderson update took 60.910 ms, out of which F'*F took 28.440 ms; b-Ax took 203.619 ms, out of which Lap took 182.669 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 430.285 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162123, int_b + int_rho = 5.457e-14, checking this took 0.106 ms
2-norm of RHS = 683.7200859674317, which took 0.117 ms

iter_count = 210, r_2norm = 6.007e-04, tol*||rhs|| = 6.837e-04

Anderson update took 111.346 ms, out of which F'*F took 52.790 ms; b-Ax took 356.431 ms, out of which Lap took 319.611 ms
Solving Poisson took 757.347 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.084913 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.279 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.091780 
Total time for convolution: 	 convolve: 5.115833 
Total time for convolution: 	 convolve: 5.126214 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.956 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.338 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.317 ms

This SCF took 26811.965 ms, scf error = 1.359e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.124991, lowerbound = -0.707342, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2071.926 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 11.247 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.092 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 31.869 ms
rank =  0, Distribute data + matrix mult took 46.221 ms
rank =  0, finding HY took 15.907 ms
rank =  0, distributing HY into block cyclic form took 70.459 ms
rank =  0, finding Y'*HY took 51.600 ms
Rank 0, Project_Hamiltonian used 184.218 ms
Total time for projection: 184.228 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -0.706410156199413
    last  calculated eigval = 0.025733133117588
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.70641015619941
lambda[   2] =  -0.61234745834236
lambda[   3] =  -0.49169732037233
lambda[   4] =  -0.41111862969687
lambda[   5] =  -0.36770232052580
lambda[   6] =  -0.36257483904140
lambda[   7] =  -0.32065733971554
lambda[   8] =  -0.29817297378190
lambda[   9] =  -0.22138853397104
lambda[  10] =  -0.02620893777981
lambda[  11] =  -0.02042828236164
lambda[  12] =   0.01351806507351
lambda[  13] =   0.01798999772787
lambda[  14] =   0.02364685649822
lambda[  15] =   0.02573313311759
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 4.127 ms
rank =  0, Distributing orbital back into band + domain format took 39.387 ms
rank = 0, Subspace_Rotation used 43.533 ms

Total time for subspace rotation: 43.538 ms
rank = 0, Efermi =  -0.055305933537 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 3.119 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.776 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.100 ms
rank = 0, Calculating density took 2307.989 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.390 ms
rank = 0, D2D took 0.492 ms
rank = 0, Transfering density took 0.494 ms
Etot    =   -21.634363251502
Eband   =    -7.584139143860
E1      =    18.274843603357
E2      =    -6.270465223193
E3      =    -9.752531729804
Exc     =    -8.572845443027
Esc     =   -39.775219220322
Entropy =    -0.000000000648
dE = 1.785e-06, dEband = 1.972e-03
rank = 0, Calculating/Estimating energy took 19.681 ms, Etot = -21.634363252, dEtot = 1.785e-06, dEband = 1.972e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0610703300720, which took 13.757 ms

iter_count = 114, r_2norm = 1.946e-06, tol*||rhs|| = 2.443e-06

Anderson update took 366.472 ms, out of which F'*F took 106.006 ms; b-Ax took 697.042 ms, out of which Lap took 680.126 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 1484.256 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162132, int_b + int_rho = 1.419e-13, checking this took 0.076 ms
2-norm of RHS = 683.7027273304213, which took 0.065 ms

iter_count = 204, r_2norm = 5.617e-04, tol*||rhs|| = 6.837e-04

Anderson update took 111.806 ms, out of which F'*F took 50.982 ms; b-Ax took 386.400 ms, out of which Lap took 351.567 ms
Solving Poisson took 813.662 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.090249 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.094845 
Total time for convolution: 	 convolve: 5.090417 
Total time for convolution: 	 convolve: 5.095095 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 2.086 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.580 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.183 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.934 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.290 ms

This SCF took 28986.535 ms, scf error = 8.901e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.125733, lowerbound = -0.706410, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1142.665 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.175 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.235 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.053 ms
rank =  0, Distribute data + matrix mult took 15.476 ms
rank =  0, finding HY took 19.251 ms
rank =  0, distributing HY into block cyclic form took 11.999 ms
rank =  0, finding Y'*HY took 4.336 ms
Rank 0, Project_Hamiltonian used 51.087 ms
Total time for projection: 51.098 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.479 ms
    first calculated eigval = -0.705101523240575
    last  calculated eigval = 0.028240147361459
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.70510152324057
lambda[   2] =  -0.61102917066189
lambda[   3] =  -0.49046033021829
lambda[   4] =  -0.40987004080169
lambda[   5] =  -0.36642696991952
lambda[   6] =  -0.36124961050882
lambda[   7] =  -0.31936570166729
lambda[   8] =  -0.29692702699599
lambda[   9] =  -0.22018046794020
lambda[  10] =  -0.02320626591566
lambda[  11] =  -0.01908718354348
lambda[  12] =   0.01708789379546
lambda[  13] =   0.02078201449497
lambda[  14] =   0.02649974532008
lambda[  15] =   0.02824014736146
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.538 ms
rank =  0, subspace rotation using ScaLAPACK took 4.047 ms
rank =  0, Distributing orbital back into band + domain format took 11.878 ms
rank = 0, Subspace_Rotation used 15.947 ms

Total time for subspace rotation: 15.954 ms
rank = 0, Efermi =  -0.052309287392 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.222 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.086 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 1216.822 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.732 ms
rank = 0, D2D took 0.842 ms
rank = 0, Transfering density took 0.845 ms
Etot    =   -21.634364890344
Eband   =    -7.561221684410
E1      =    18.262471675650
E2      =    -6.259382493951
E3      =    -9.755261141433
Exc     =    -8.575039295997
Esc     =   -39.775219220322
Entropy =    -0.000000000649
dE = 1.821e-07, dEband = 2.546e-03
rank = 0, Calculating/Estimating energy took 0.895 ms, Etot = -21.634364890, dEtot = 1.821e-07, dEband = 2.546e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0541983485254, which took 0.078 ms

iter_count = 114, r_2norm = 1.402e-06, tol*||rhs|| = 2.168e-06

Anderson update took 60.983 ms, out of which F'*F took 28.483 ms; b-Ax took 194.076 ms, out of which Lap took 173.281 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.430 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162133, int_b + int_rho = 1.528e-13, checking this took 0.105 ms
2-norm of RHS = 683.7137651599934, which took 0.085 ms

iter_count = 180, r_2norm = 6.658e-04, tol*||rhs|| = 6.837e-04

Anderson update took 95.312 ms, out of which F'*F took 45.253 ms; b-Ax took 305.405 ms, out of which Lap took 273.709 ms
Solving Poisson took 649.226 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.090566 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.097680 
Total time for convolution: 	 convolve: 5.091078 
Total time for convolution: 	 convolve: 5.090566 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.941 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.294 ms

This SCF took 26625.155 ms, scf error = 5.158e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.128240, lowerbound = -0.705102, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1189.378 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.029 ms
rank =  0, Distribute orbital to block cyclic format took 12.168 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.322 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 15.522 ms
rank =  0, finding HY took 19.440 ms
rank =  0, distributing HY into block cyclic form took 12.034 ms
rank =  0, finding Y'*HY took 3.911 ms
Rank 0, Project_Hamiltonian used 51.379 ms
Total time for projection: 51.389 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -0.704358065137204
    last  calculated eigval = 0.030688827664036
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.70435806513720
lambda[   2] =  -0.61030519191204
lambda[   3] =  -0.48976685928017
lambda[   4] =  -0.40917251735627
lambda[   5] =  -0.36570855335960
lambda[   6] =  -0.36054643489220
lambda[   7] =  -0.31866692261631
lambda[   8] =  -0.29623968774645
lambda[   9] =  -0.21947506679951
lambda[  10] =  -0.02072479330953
lambda[  11] =  -0.01833562094778
lambda[  12] =   0.01953968191855
lambda[  13] =   0.02277355561271
lambda[  14] =   0.02902211562525
lambda[  15] =   0.03068882766404
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 3.453 ms
rank =  0, Distributing orbital back into band + domain format took 12.220 ms
rank = 0, Subspace_Rotation used 15.689 ms

Total time for subspace rotation: 15.693 ms
rank = 0, Efermi =  -0.049876293058 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 3.172 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.266 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.177 ms
rank = 0, Calculating density took 1263.335 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.664 ms
rank = 0, D2D took 0.867 ms
rank = 0, Transfering density took 0.870 ms
Etot    =   -21.634425281358
Eband   =    -7.548478598645
E1      =    18.255884246603
E2      =    -6.252948723190
E3      =    -9.756475010028
Exc     =    -8.576035441560
Esc     =   -39.775219220322
Entropy =    -0.000000000652
dE = 6.710e-06, dEband = 1.416e-03
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -21.634425281, dEtot = 6.710e-06, dEband = 1.416e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0307872047882, which took 0.081 ms

iter_count = 114, r_2norm = 8.061e-07, tol*||rhs|| = 1.231e-06

Anderson update took 60.830 ms, out of which F'*F took 28.752 ms; b-Ax took 194.660 ms, out of which Lap took 173.656 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.482 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162128, int_b + int_rho = 1.055e-13, checking this took 0.106 ms
2-norm of RHS = 683.7254351875984, which took 0.125 ms

iter_count = 174, r_2norm = 5.925e-04, tol*||rhs|| = 6.837e-04

Anderson update took 92.055 ms, out of which F'*F took 43.860 ms; b-Ax took 295.778 ms, out of which Lap took 265.008 ms
Solving Poisson took 628.158 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.104569 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.551 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.093662 
Total time for convolution: 	 convolve: 5.089428 
Total time for convolution: 	 convolve: 5.090488 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.938 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.339 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.297 ms

This SCF took 26932.867 ms, scf error = 3.651e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.130689, lowerbound = -0.704358, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1163.195 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.353 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.753 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.043 ms
rank =  0, Distribute data + matrix mult took 15.167 ms
rank =  0, finding HY took 19.584 ms
rank =  0, distributing HY into block cyclic form took 12.016 ms
rank =  0, finding Y'*HY took 4.313 ms
Rank 0, Project_Hamiltonian used 52.028 ms
Total time for projection: 52.042 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.704164110506938
    last  calculated eigval = 0.033557070431557
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.70416411050694
lambda[   2] =  -0.61010663565264
lambda[   3] =  -0.48952447454762
lambda[   4] =  -0.40894456133179
lambda[   5] =  -0.36549338327010
lambda[   6] =  -0.36033723579314
lambda[   7] =  -0.31845887980851
lambda[   8] =  -0.29600817970723
lambda[   9] =  -0.21924085333727
lambda[  10] =  -0.01810521397682
lambda[  11] =  -0.01795187593734
lambda[  12] =   0.02198781209786
lambda[  13] =   0.02556472026553
lambda[  14] =   0.03178474323571
lambda[  15] =   0.03355707043156
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 3.482 ms
rank =  0, Distributing orbital back into band + domain format took 12.230 ms
rank = 0, Subspace_Rotation used 15.727 ms

Total time for subspace rotation: 15.732 ms
rank = 0, Efermi =  -0.047746386522 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.205 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.139 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.173 ms
rank = 0, Calculating density took 1237.761 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.686 ms
rank = 0, D2D took 0.862 ms
rank = 0, Transfering density took 0.869 ms
Etot    =   -21.634480857338
Eband   =    -7.544556628300
E1      =    18.254621397537
E2      =    -6.250285268973
E3      =    -9.756401371936
Exc     =    -8.576013046500
Esc     =   -39.775219220322
Entropy =    -0.000000000661
dE = 6.175e-06, dEband = 4.358e-04
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -21.634480857, dEtot = 6.175e-06, dEband = 4.358e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0353916413497, which took 0.107 ms

iter_count = 108, r_2norm = 1.253e-06, tol*||rhs|| = 1.416e-06

Anderson update took 57.532 ms, out of which F'*F took 27.032 ms; b-Ax took 184.582 ms, out of which Lap took 164.342 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.484 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162127, int_b + int_rho = 9.823e-14, checking this took 0.098 ms
2-norm of RHS = 683.7266600886530, which took 0.113 ms

iter_count = 144, r_2norm = 5.481e-04, tol*||rhs|| = 6.837e-04

Anderson update took 76.160 ms, out of which F'*F took 36.099 ms; b-Ax took 244.344 ms, out of which Lap took 218.984 ms
Solving Poisson took 520.409 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.119 ms
Total time for convolution: 	 convolve: 5.097429 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.094849 
Total time for convolution: 	 convolve: 5.087569 
Total time for convolution: 	 convolve: 5.094695 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.940 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.338 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.298 ms

This SCF took 26495.544 ms, scf error = 2.598e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.133557, lowerbound = -0.704164, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1172.306 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.021 ms
rank =  0, Distribute orbital to block cyclic format took 12.092 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.268 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.171 ms
rank =  0, Distribute data + matrix mult took 15.543 ms
rank =  0, finding HY took 19.315 ms
rank =  0, distributing HY into block cyclic form took 12.100 ms
rank =  0, finding Y'*HY took 4.217 ms
Rank 0, Project_Hamiltonian used 51.223 ms
Total time for projection: 51.234 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.703974463220008
    last  calculated eigval = 0.033507544022442
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.70397446322001
lambda[   2] =  -0.60991729351668
lambda[   3] =  -0.48934873566991
lambda[   4] =  -0.40876716788356
lambda[   5] =  -0.36530975793653
lambda[   6] =  -0.36016269926259
lambda[   7] =  -0.31827979397896
lambda[   8] =  -0.29583907955293
lambda[   9] =  -0.21906873755633
lambda[  10] =  -0.01804843047127
lambda[  11] =  -0.01765035440211
lambda[  12] =   0.02190299843248
lambda[  13] =   0.02570644898827
lambda[  14] =   0.03212460446575
lambda[  15] =   0.03350754402244
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.179 ms
rank =  0, subspace rotation using ScaLAPACK took 3.507 ms
rank =  0, Distributing orbital back into band + domain format took 12.222 ms
rank = 0, Subspace_Rotation used 15.744 ms

Total time for subspace rotation: 15.749 ms
rank = 0, Efermi =  -0.047585631384 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.218 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.165 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.164 ms
rank = 0, Calculating density took 1246.125 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.678 ms
rank = 0, D2D took 0.864 ms
rank = 0, Transfering density took 0.867 ms
Etot    =   -21.634511798120
Eband   =    -7.541335457542
E1      =    18.252801628282
E2      =    -6.248767339205
E3      =    -9.756821162779
Exc     =    -8.576347249862
Esc     =   -39.775219220322
Entropy =    -0.000000000661
dE = 3.438e-06, dEband = 3.579e-04
rank = 0, Calculating/Estimating energy took 0.941 ms, Etot = -21.634511798, dEtot = 3.438e-06, dEband = 3.579e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0281277940999, which took 0.091 ms

iter_count = 108, r_2norm = 8.780e-07, tol*||rhs|| = 1.125e-06

Anderson update took 57.683 ms, out of which F'*F took 27.004 ms; b-Ax took 183.758 ms, out of which Lap took 163.990 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.323 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162120, int_b + int_rho = 2.910e-14, checking this took 0.108 ms
2-norm of RHS = 683.7286033458660, which took 0.103 ms

iter_count = 138, r_2norm = 6.643e-04, tol*||rhs|| = 6.837e-04

Anderson update took 73.037 ms, out of which F'*F took 34.675 ms; b-Ax took 234.419 ms, out of which Lap took 210.268 ms
Solving Poisson took 499.726 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.098634 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.102030 
Total time for convolution: 	 convolve: 5.098748 
Total time for convolution: 	 convolve: 5.101337 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.491 ms
---Transfer Veff_loc: D2D took 1.292 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.645 ms

This SCF took 26979.816 ms, scf error = 1.793e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133508, lowerbound = -0.703974, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1141.409 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.222 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.185 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.067 ms
rank =  0, Distribute data + matrix mult took 15.488 ms
rank =  0, finding HY took 19.369 ms
rank =  0, distributing HY into block cyclic form took 12.045 ms
rank =  0, finding Y'*HY took 4.236 ms
Rank 0, Project_Hamiltonian used 51.166 ms
Total time for projection: 51.176 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.703946826694796
    last  calculated eigval = 0.032987067322074
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.70394682669480
lambda[   2] =  -0.60987999126038
lambda[   3] =  -0.48930862670664
lambda[   4] =  -0.40872848194579
lambda[   5] =  -0.36527512752020
lambda[   6] =  -0.36012408193135
lambda[   7] =  -0.31824346018384
lambda[   8] =  -0.29580289731145
lambda[   9] =  -0.21903473565439
lambda[  10] =  -0.01815432708086
lambda[  11] =  -0.01778621428556
lambda[  12] =   0.02080748255414
lambda[  13] =   0.02513189410067
lambda[  14] =   0.03182666170473
lambda[  15] =   0.03298706732207
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 3.491 ms
rank =  0, Distributing orbital back into band + domain format took 12.212 ms
rank = 0, Subspace_Rotation used 15.718 ms

Total time for subspace rotation: 15.723 ms
rank = 0, Efermi =  -0.047703396561 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.251 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.127 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.173 ms
rank = 0, Calculating density took 1215.139 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.667 ms
rank = 0, D2D took 0.860 ms
rank = 0, Transfering density took 0.863 ms
Etot    =   -21.634547247219
Eband   =    -7.540688458807
E1      =    18.252723784007
E2      =    -6.248207985560
E3      =    -9.756600487743
Exc     =    -8.576171824740
Esc     =   -39.775219220322
Entropy =    -0.000000000661
dE = 3.939e-06, dEband = 7.189e-05
rank = 0, Calculating/Estimating energy took 0.949 ms, Etot = -21.634547247, dEtot = 3.939e-06, dEband = 7.189e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0281022858830, which took 0.057 ms

iter_count = 108, r_2norm = 8.713e-07, tol*||rhs|| = 1.124e-06

Anderson update took 57.587 ms, out of which F'*F took 27.213 ms; b-Ax took 185.302 ms, out of which Lap took 164.878 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 400.104 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162124, int_b + int_rho = 6.548e-14, checking this took 0.089 ms
2-norm of RHS = 683.7272278451974, which took 0.107 ms

iter_count = 72, r_2norm = 6.356e-04, tol*||rhs|| = 6.837e-04

Anderson update took 38.163 ms, out of which F'*F took 18.151 ms; b-Ax took 122.349 ms, out of which Lap took 109.688 ms
Solving Poisson took 261.955 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.105396 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.109211 
Total time for convolution: 	 convolve: 5.090683 
Total time for convolution: 	 convolve: 5.095323 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.931 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.336 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.288 ms

This SCF took 26242.083 ms, scf error = 1.629e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.132987, lowerbound = -0.703947, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1138.955 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.084 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.294 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 15.410 ms
rank =  0, finding HY took 19.312 ms
rank =  0, distributing HY into block cyclic form took 12.067 ms
rank =  0, finding Y'*HY took 4.220 ms
Rank 0, Project_Hamiltonian used 51.037 ms
Total time for projection: 51.051 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.147 ms
    first calculated eigval = -0.703905914221902
    last  calculated eigval = 0.033059824558517
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.70390591422190
lambda[   2] =  -0.60984392603589
lambda[   3] =  -0.48927506085039
lambda[   4] =  -0.40869457067205
lambda[   5] =  -0.36523875592843
lambda[   6] =  -0.36009247596574
lambda[   7] =  -0.31820983464543
lambda[   8] =  -0.29577000271218
lambda[   9] =  -0.21899954426667
lambda[  10] =  -0.01813003271597
lambda[  11] =  -0.01765544650453
lambda[  12] =   0.02083907493210
lambda[  13] =   0.02505954795366
lambda[  14] =   0.03196020218103
lambda[  15] =   0.03305982455852
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.172 ms
rank =  0, subspace rotation using ScaLAPACK took 3.479 ms
rank =  0, Distributing orbital back into band + domain format took 12.166 ms
rank = 0, Subspace_Rotation used 15.659 ms

Total time for subspace rotation: 15.663 ms
rank = 0, Efermi =  -0.047637994213 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.240 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.207 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.174 ms
rank = 0, Calculating density took 1212.567 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.643 ms
rank = 0, D2D took 0.847 ms
rank = 0, Transfering density took 0.851 ms
Etot    =   -21.634551864196
Eband   =    -7.540060170986
E1      =    18.252311242095
E2      =    -6.247971797381
E3      =    -9.756688813948
Exc     =    -8.576244325652
Esc     =   -39.775219220322
Entropy =    -0.000000000660
dE = 5.130e-07, dEband = 6.981e-05
rank = 0, Calculating/Estimating energy took 0.974 ms, Etot = -21.634551864, dEtot = 5.130e-07, dEband = 6.981e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0161640865739, which took 0.057 ms

iter_count = 114, r_2norm = 3.915e-07, tol*||rhs|| = 6.466e-07

Anderson update took 64.125 ms, out of which F'*F took 30.503 ms; b-Ax took 198.862 ms, out of which Lap took 178.289 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 429.274 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162126, int_b + int_rho = 8.367e-14, checking this took 0.103 ms
2-norm of RHS = 683.7226063752989, which took 0.105 ms

iter_count = 120, r_2norm = 6.056e-04, tol*||rhs|| = 6.837e-04

Anderson update took 63.941 ms, out of which F'*F took 30.094 ms; b-Ax took 203.394 ms, out of which Lap took 182.322 ms
Solving Poisson took 434.609 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.091047 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.204 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.098808 
Total time for convolution: 	 convolve: 5.088431 
Total time for convolution: 	 convolve: 5.088037 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.704 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.407 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.926 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.336 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.283 ms

This SCF took 26552.380 ms, scf error = 1.329e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.133060, lowerbound = -0.703906, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1158.013 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.248 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.340 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 15.622 ms
rank =  0, finding HY took 19.370 ms
rank =  0, distributing HY into block cyclic form took 12.054 ms
rank =  0, finding Y'*HY took 4.352 ms
Rank 0, Project_Hamiltonian used 51.426 ms
Total time for projection: 51.439 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.703831095966714
    last  calculated eigval = 0.033383968546851
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.70383109596671
lambda[   2] =  -0.60977819969898
lambda[   3] =  -0.48920613834168
lambda[   4] =  -0.40862603500891
lambda[   5] =  -0.36516976859807
lambda[   6] =  -0.36002954304000
lambda[   7] =  -0.31814445905159
lambda[   8] =  -0.29570066292211
lambda[   9] =  -0.21893000477783
lambda[  10] =  -0.01809683586654
lambda[  11] =  -0.01726437715626
lambda[  12] =   0.02087640783025
lambda[  13] =   0.02512196616008
lambda[  14] =   0.03238539642223
lambda[  15] =   0.03338396854685
==subpsace eigenproblem: bcast eigvals took 0.037 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 3.513 ms
rank =  0, Distributing orbital back into band + domain format took 12.177 ms
rank = 0, Subspace_Rotation used 15.705 ms

Total time for subspace rotation: 15.710 ms
rank = 0, Efermi =  -0.047487490390 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 3.155 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.264 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.227 ms
rank = 0, Calculating density took 1232.114 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.696 ms
rank = 0, D2D took 0.843 ms
rank = 0, Transfering density took 0.849 ms
Etot    =   -21.634562614072
Eband   =    -7.538831815198
E1      =    18.251639220736
E2      =    -6.247409824406
E3      =    -9.756699650564
Exc     =    -8.576260273598
Esc     =   -39.775219220322
Entropy =    -0.000000000659
dE = 1.194e-06, dEband = 1.365e-04
rank = 0, Calculating/Estimating energy took 1.356 ms, Etot = -21.634562614, dEtot = 1.194e-06, dEband = 1.365e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0125930548410, which took 0.050 ms

iter_count = 114, r_2norm = 3.439e-07, tol*||rhs|| = 5.037e-07

Anderson update took 61.113 ms, out of which F'*F took 28.494 ms; b-Ax took 194.615 ms, out of which Lap took 173.571 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.974 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162124, int_b + int_rho = 6.548e-14, checking this took 0.101 ms
2-norm of RHS = 683.7213501977016, which took 0.106 ms

iter_count = 96, r_2norm = 6.743e-04, tol*||rhs|| = 6.837e-04

Anderson update took 51.147 ms, out of which F'*F took 24.122 ms; b-Ax took 162.965 ms, out of which Lap took 146.088 ms
Solving Poisson took 348.249 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.095703 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.090854 
Total time for convolution: 	 convolve: 5.095341 
Total time for convolution: 	 convolve: 5.087421 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.076 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.931 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.286 ms

This SCF took 26329.791 ms, scf error = 1.031e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.133384, lowerbound = -0.703831, upperbound = 267.581953

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1139.069 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.130 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.347 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 15.515 ms
rank =  0, finding HY took 19.296 ms
rank =  0, distributing HY into block cyclic form took 12.097 ms
rank =  0, finding Y'*HY took 4.253 ms
Rank 0, Project_Hamiltonian used 51.194 ms
Total time for projection: 51.209 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -0.703774653190577
    last  calculated eigval = 0.033072453571726
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.70377465319058
lambda[   2] =  -0.60972982969197
lambda[   3] =  -0.48916001886013
lambda[   4] =  -0.40857939717195
lambda[   5] =  -0.36511994264960
lambda[   6] =  -0.35998628291405
lambda[   7] =  -0.31809865162684
lambda[   8] =  -0.29565433278325
lambda[   9] =  -0.21888357805551
lambda[  10] =  -0.01809388086340
lambda[  11] =  -0.01740233945098
lambda[  12] =   0.02057827046991
lambda[  13] =   0.02480638290405
lambda[  14] =   0.03218396785761
lambda[  15] =   0.03307245357173
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.163 ms
rank =  0, subspace rotation using ScaLAPACK took 3.479 ms
rank =  0, Distributing orbital back into band + domain format took 12.194 ms
rank = 0, Subspace_Rotation used 15.687 ms

Total time for subspace rotation: 15.692 ms
rank = 0, Efermi =  -0.047527023822 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.222 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.190 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.179 ms
rank = 0, Calculating density took 1212.830 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.932 ms
rank = 0, D2D took 2.034 ms
rank = 0, Transfering density took 2.039 ms
Etot    =   -21.634564629216
Eband   =    -7.537973374274
E1      =    18.251085972970
E2      =    -6.247069158848
E3      =    -9.756844164494
Exc     =    -8.576371330273
Esc     =   -39.775219220322
Entropy =    -0.000000000660
dE = 2.239e-07, dEband = 9.538e-05
rank = 0, Calculating/Estimating energy took 0.896 ms, Etot = -21.634564629, dEtot = 2.239e-07, dEband = 9.538e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0114191665820, which took 0.062 ms

iter_count = 108, r_2norm = 3.712e-07, tol*||rhs|| = 4.568e-07

Anderson update took 57.853 ms, out of which F'*F took 27.204 ms; b-Ax took 184.431 ms, out of which Lap took 164.528 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 400.388 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002162118, int_rho =  18.00000002162126, int_b + int_rho = 8.731e-14, checking this took 0.098 ms
2-norm of RHS = 683.7231382451025, which took 0.118 ms

iter_count = 114, r_2norm = 5.998e-04, tol*||rhs|| = 6.837e-04

Anderson update took 60.335 ms, out of which F'*F took 28.600 ms; b-Ax took 193.370 ms, out of which Lap took 173.372 ms
Solving Poisson took 412.542 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.099734 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.468 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.094060 
Total time for convolution: 	 convolve: 5.113346 
Total time for convolution: 	 convolve: 5.090477 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.436 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.944 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.300 ms

This SCF took 26438.535 ms, scf error = 7.523e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.70377465319058, occ[   1] =   2.00000000000000
lambda[   2] =  -0.60972982969197, occ[   2] =   2.00000000000000
lambda[   3] =  -0.48916001886013, occ[   3] =   2.00000000000000
lambda[   4] =  -0.40857939717195, occ[   4] =   2.00000000000000
lambda[   5] =  -0.36511994264960, occ[   5] =   2.00000000000000
lambda[   6] =  -0.35998628291405, occ[   6] =   2.00000000000000
lambda[   7] =  -0.31809865162684, occ[   7] =   2.00000000000000
lambda[   8] =  -0.29565433278325, occ[   8] =   2.00000000000000
lambda[   9] =  -0.21888357805551, occ[   9] =   2.00000000000000
lambda[  10] =  -0.01809388086340, occ[  10] =   0.00000001484583
lambda[  11] =  -0.01740233945098, occ[  11] =   0.00000000677545
lambda[  12] =   0.02057827046991, occ[  12] =   0.00000000000000
lambda[  13] =   0.02480638290405, occ[  13] =   0.00000000000000
lambda[  14] =   0.03218396785761, occ[  14] =   0.00000000000000
lambda[  15] =   0.03307245357173, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.494 ms, time for Allreduce/Reduce: 8.912 ms 
Time for calculating local force components: 18.492 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.01429018515358   0.04887967528994   0.00000003311872
 -0.03699291266570  -0.03553798853450   0.00000002472350
  0.01166363876527  -0.04965612077795   0.00000001520018
 -0.01637103307620   0.04682484150596   0.00000003023347
  0.02851892986683  -0.00597590316942  -0.03949286384962
  0.02851893147028  -0.00597590211120   0.03949292113813
  0.00723609593910   0.02014265495153   0.00000082548592
 -0.03312340691511  -0.00634402659669   0.00000026213643
  0.01154379779388  -0.00207683076297  -0.00000002252396
force_loc = 
  0.01584083320331  -0.05157860040034  -0.00000011764585
  0.03975047775299   0.03738831659020  -0.00000035654442
 -0.01307007050835   0.05289138519650  -0.00000007431773
  0.01672370772656  -0.04943894163790   0.00000014384344
 -0.03103059615955   0.00634543082872   0.04171374470672
 -0.03103065699758   0.00634561207625  -0.04171393068914
 -0.00211851705237  -0.01589196215436   0.00000026986153
  0.02902634133062   0.00103578690879  -0.00000216159074
 -0.01111376683485   0.00280721486538  -0.00000085096267
Time for calculating nonlocal force components: 27.370 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00100435835605  -0.00133560625828  -0.00000000246924
[0m[32m  0.00661641089072  -0.00018876122414  -0.00000008915537
[0m[32m -0.00528702316132   0.00135053260020  -0.00000001301501
[0mTime for calculating XC forces components: 25.237 ms
 Cartesian force = 
  0.00154991050985  -0.00270012590881   0.00000016128573
  0.00275682754742   0.00184912725728  -0.00000008600807
 -0.00140716928296   0.00323406362014   0.00000018669531
  0.00035193711048  -0.00261530093036   0.00000041988976
 -0.00251240383259   0.00036832686089   0.00222112666996
 -0.00251246306718   0.00036850916664  -0.00222076373815
  0.00411248299080   0.00291388574047   0.00000133869107
  0.00251860776635  -0.00549820171046  -0.00000174279683
 -0.00485772974217   0.00207971590420  -0.00000064068879
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Time for printing density: 386.137 ms
The program took 489.475 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:36:18
Job ID:        2266902
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:40:12,vmem=8408K,walltime=00:08:21,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-12-2
---------------------------------------
