---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:13
Job ID:    2266593
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:17
Job ID:    2266593
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.052 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.008 ms
Reading input file sprc-calc.inpt

Reading input file took 8.269 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 20.570 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 112.933 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.970 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.098 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    7.505784	    9.735381	    9.170593	
    9.679673	    9.906352	   12.503525	
   13.315694	    7.586836	   10.494278	
   11.583737	    7.622896	    7.496475	
   13.224979	   12.413164	   10.511472	
   11.520800	   12.327832	    7.498716	
    6.684306	   11.349742	    9.313363	
    9.817489	    9.917004	   10.457284	
   11.982874	    8.542945	    9.276406	
   11.931242	   11.416823	    9.281975	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.181 ms
Set up communicators.

--set up spincomm took 3.764 ms

--set up kptcomm took 0.362 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 19, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 19 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 19, mbQ = nbQ = 64
rank = 0, nr_Hp = 19, nc_Hp = 19
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.067 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.375 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.940 ms

Calculate_SplineDerivRadFun took 0.210 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.838 ms.
time spent on vectorized spline interp: 3.361 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.730 ms.
time spent on vectorized spline interp: 1.589 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.307 ms.
time spent on vectorized spline interp: 1.871 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.554 ms.

Calculating rb for all atom types took 16.261 ms
----------------------
Estimated memory usage
Total: 1.16 GB
orbitals             : 869.75 MB
global sized vectors : 213.62 MB
subspace matrices : 8.46 kB
others : 108.34 MB
----------------------------------------------
Estimated memory usage per processor: 99.31 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.817 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.031 ms
Calculating pseudocharge density ... 
the global sum of int_b = -24.0000000377249, sum_int_rho = 23.3979778397039
PosCharge = 24.000000037725, NegCharge = -23.397977839704, scal_fac = 1.025729667843
After scaling, int_rho = 24.0000000377251, PosCharge + NegCharge - NetCharge = -1.812e-13
--Calculate Vref took 0.539 ms
--Calculate rho_guess took 2.867 ms

 integral of b = -24.0000000377249,
 int{b} + Nelectron + NetCharge = -3.772e-08,
 Esc = -63.7895330262728,
 MPI_Reduce took 9.447 ms

Calculating b & b_ref took 19.710 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.111 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.120 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.088 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.610 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.484 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772496, int_b + int_rho = 2.219e-13, checking this took 0.527 ms
2-norm of RHS = 751.4229657076950, which took 0.465 ms

iter_count = 420, r_2norm = 6.271e-04, tol*||rhs|| = 7.514e-04

Anderson update took 257.525 ms, out of which F'*F took 119.785 ms; b-Ax took 814.525 ms, out of which Lap took 722.652 ms
Solving Poisson took 1811.263 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.514 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
Total time for convolution: 	 convolve: 5.154442 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.146 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
Total time for convolution: 	 convolve: 5.123537 
Total time for convolution: 	 convolve: 5.125338 
Total time for convolution: 	 convolve: 5.135671 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.741 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.382 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
rank = 0, XC calculation took 24444.540 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 4.829 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.374 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.342 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.153 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.999 ms
    Lanczos iter 54, eigmin  = -0.983269349, eigmax = 264.938168956, err_eigmin = 9.019e-04, err_eigmax = 9.555e-03
rank =   0, Lanczos took 141.889 ms, eigmin = -0.983269349269, eigmax = 267.587550645116

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.252141, lowerbound = -1.083269, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1610.864 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 24.103 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.798 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.931 ms
rank =  0, finding HY took 25.745 ms
rank =  0, distributing HY into block cyclic form took 23.521 ms
rank =  0, finding Y'*HY took 4.093 ms
Rank 0, Project_Hamiltonian used 80.851 ms
Total time for projection: 80.865 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.808 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.915 ms
    first calculated eigval = 2.724484923697098
    last  calculated eigval = 3.251180431493853
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =   2.81460351889258
lambda[   4] =   2.83169945641647
lambda[   5] =   2.84123601591295
lambda[   6] =   2.90424504010915
lambda[   7] =   2.92727754113684
lambda[   8] =   2.97278839373405
lambda[   9] =   2.98620309700189
lambda[  10] =   2.99864015031221
lambda[  11] =   3.01424178535033
lambda[  12] =   3.04096729570122
lambda[  13] =   3.09184921033525
lambda[  14] =   3.12890897231738
lambda[  15] =   3.13556521683033
lambda[  16] =   3.15468294095824
lambda[  17] =   3.18025047672096
lambda[  18] =   3.21363029656020
lambda[  19] =   3.25118043149385
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.938 ms
rank =  0, subspace rotation using ScaLAPACK took 8.528 ms
rank =  0, Distributing orbital back into band + domain format took 19.376 ms
rank = 0, Subspace_Rotation used 27.925 ms

Total time for subspace rotation: 27.929 ms
rank = 0, Efermi =   3.066427880501 calculate fermi energy took 0.046 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.351180, lowerbound = -1.083269, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1572.317 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 47.110 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.776 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 49.917 ms
rank =  0, finding HY took 25.092 ms
rank =  0, distributing HY into block cyclic form took 19.832 ms
rank =  0, finding Y'*HY took 3.788 ms
Rank 0, Project_Hamiltonian used 98.673 ms
Total time for projection: 98.707 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.153 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.105 ms
rank = 0, Solve_Generalized_EigenProblem used 0.264 ms
    first calculated eigval = -0.790018029608267
    last  calculated eigval = 0.433587259313273
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.38177263132243
lambda[   4] =  -0.23104100509405
lambda[   5] =  -0.17799218694367
lambda[   6] =  -0.08487360383977
lambda[   7] =  -0.06222766560495
lambda[   8] =   0.05149502594329
lambda[   9] =   0.08210290262128
lambda[  10] =   0.16748053064061
lambda[  11] =   0.23604063483021
lambda[  12] =   0.29799156423517
lambda[  13] =   0.32942171991604
lambda[  14] =   0.33865229815255
lambda[  15] =   0.36572085928566
lambda[  16] =   0.39288008231328
lambda[  17] =   0.40090982275203
lambda[  18] =   0.41311427911496
lambda[  19] =   0.43358725931327
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.282 ms
rank =  0, subspace rotation using ScaLAPACK took 8.460 ms
rank =  0, Distributing orbital back into band + domain format took 19.171 ms
rank = 0, Subspace_Rotation used 27.655 ms

Total time for subspace rotation: 27.659 ms
rank = 0, Efermi =   0.313706154179 calculate fermi energy took 0.044 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.533587, lowerbound = -1.083269, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1574.958 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 48.594 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.779 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 51.394 ms
rank =  0, finding HY took 25.177 ms
rank =  0, distributing HY into block cyclic form took 19.732 ms
rank =  0, finding Y'*HY took 3.817 ms
Rank 0, Project_Hamiltonian used 100.661 ms
Total time for projection: 100.669 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -1.001755089562537
    last  calculated eigval = 0.124835685195976
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66754172123812
lambda[   4] =  -0.63099876495059
lambda[   5] =  -0.56336726580051
lambda[   6] =  -0.53336674292869
lambda[   7] =  -0.47084691260764
lambda[   8] =  -0.42894019001506
lambda[   9] =  -0.41465821528996
lambda[  10] =  -0.38725352884191
lambda[  11] =  -0.31678581917142
lambda[  12] =  -0.28241206681155
lambda[  13] =   0.05347840206490
lambda[  14] =   0.07274635498654
lambda[  15] =   0.08262125164199
lambda[  16] =   0.08591323797071
lambda[  17] =   0.11345983059094
lambda[  18] =   0.11946506794538
lambda[  19] =   0.12483568519598
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 8.420 ms
rank =  0, Distributing orbital back into band + domain format took 19.112 ms
rank = 0, Subspace_Rotation used 27.550 ms

Total time for subspace rotation: 27.554 ms
rank = 0, Efermi =   0.024887987718 calculate fermi energy took 0.023 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.224836, lowerbound = -1.083269, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1577.795 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 48.442 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.717 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 51.178 ms
rank =  0, finding HY took 25.238 ms
rank =  0, distributing HY into block cyclic form took 19.747 ms
rank =  0, finding Y'*HY took 3.798 ms
Rank 0, Project_Hamiltonian used 99.991 ms
Total time for projection: 99.998 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -1.002244491226908
    last  calculated eigval = 0.080800465325869
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.67076753997163
lambda[   4] =  -0.63556580323505
lambda[   5] =  -0.56929961515016
lambda[   6] =  -0.54459003930288
lambda[   7] =  -0.48248443201024
lambda[   8] =  -0.44538196948733
lambda[   9] =  -0.42076579482887
lambda[  10] =  -0.39591578413719
lambda[  11] =  -0.34474754874923
lambda[  12] =  -0.30233762691741
lambda[  13] =  -0.00681552419515
lambda[  14] =   0.00300475624190
lambda[  15] =   0.01380549831670
lambda[  16] =   0.03277574953818
lambda[  17] =   0.06168440208984
lambda[  18] =   0.07947996621968
lambda[  19] =   0.08080046532587
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 8.444 ms
rank =  0, Distributing orbital back into band + domain format took 19.120 ms
rank = 0, Subspace_Rotation used 28.525 ms

Total time for subspace rotation: 28.532 ms
rank = 0, Efermi =  -0.035405942077 calculate fermi energy took 0.026 ms
rank = 0, --- Calculate rho: sum over local bands took 6.377 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.752 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.620 ms
rank = 0, Calculating density took 6992.784 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.977 ms
rank = 0, D2D took 2.083 ms
rank = 0, Transfering density took 2.088 ms
Etot    =   -38.261957984596
Eband   =   -13.419079893701
E1      =    26.924056752652
E2      =   -10.477194741377
E3      =   -13.814908868858
Exc     =   -12.269505426398
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 3.826e+00, dEband = 1.342e+00
rank = 0, Calculating/Estimating energy took 1.028 ms, Etot = -38.261957985, dEtot = 3.826e+00, dEband = 1.342e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 57.0473465865586, which took 0.688 ms

iter_count = 96, r_2norm = 1.755e-03, tol*||rhs|| = 2.282e-03

Anderson update took 58.400 ms, out of which F'*F took 27.787 ms; b-Ax took 187.209 ms, out of which Lap took 166.771 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.334 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772516, int_b + int_rho = 4.220e-13, checking this took 0.130 ms
2-norm of RHS = 747.3785055265471, which took 0.226 ms

iter_count = 288, r_2norm = 6.373e-04, tol*||rhs|| = 7.474e-04

Anderson update took 177.643 ms, out of which F'*F took 81.813 ms; b-Ax took 545.815 ms, out of which Lap took 490.253 ms
Solving Poisson took 1234.628 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.396 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.189589 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 147.350 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.182114 
Total time for convolution: 	 convolve: 5.152630 
Total time for convolution: 	 convolve: 5.149450 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.274 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 2.035 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
---Transfer Veff_loc: D2D took 3.520 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.932 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.487 ms

This SCF took 33458.182 ms, scf error = 1.678e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.180800, lowerbound = -1.002244, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1602.225 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.006 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.739 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.767 ms
rank =  0, finding HY took 25.713 ms
rank =  0, distributing HY into block cyclic form took 21.606 ms
rank =  0, finding Y'*HY took 3.720 ms
Rank 0, Project_Hamiltonian used 73.844 ms
Total time for projection: 73.856 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.113 ms
rank = 0, Solve_Generalized_EigenProblem used 0.244 ms
    first calculated eigval = -0.984566987970410
    last  calculated eigval = 0.059304621620743
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.63557956253119
lambda[   4] =  -0.60896289878702
lambda[   5] =  -0.54279700403813
lambda[   6] =  -0.51599118394579
lambda[   7] =  -0.45794719084084
lambda[   8] =  -0.41390797492208
lambda[   9] =  -0.39758181779719
lambda[  10] =  -0.36257991674343
lambda[  11] =  -0.31767353941195
lambda[  12] =  -0.27904513295447
lambda[  13] =  -0.02634338964440
lambda[  14] =  -0.00128430912497
lambda[  15] =   0.00063744484013
lambda[  16] =   0.02258810222079
lambda[  17] =   0.03484476964497
lambda[  18] =   0.05265756877737
lambda[  19] =   0.05930462162074
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.260 ms
rank =  0, subspace rotation using ScaLAPACK took 8.541 ms
rank =  0, Distributing orbital back into band + domain format took 19.113 ms
rank = 0, Subspace_Rotation used 27.672 ms

Total time for subspace rotation: 27.677 ms
rank = 0, Efermi =  -0.054933803985 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 6.537 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.525 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 1723.260 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.931 ms
rank = 0, D2D took 2.027 ms
rank = 0, Transfering density took 2.029 ms
Etot    =   -38.204336445919
Eband   =   -12.752290004213
E1      =    26.348331174952
E2      =   -10.411597404772
E3      =   -13.986881985640
Exc     =   -12.409323979685
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 5.762e-03, dEband = 6.668e-02
rank = 0, Calculating/Estimating energy took 1.014 ms, Etot = -38.204336446, dEtot = 5.762e-03, dEband = 6.668e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 17.4328906464447, which took 0.103 ms

iter_count = 102, r_2norm = 6.006e-04, tol*||rhs|| = 6.973e-04

Anderson update took 61.938 ms, out of which F'*F took 28.474 ms; b-Ax took 192.243 ms, out of which Lap took 170.213 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 442.364 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772504, int_b + int_rho = 3.020e-13, checking this took 0.125 ms
2-norm of RHS = 741.4633967959209, which took 0.151 ms

iter_count = 306, r_2norm = 6.291e-04, tol*||rhs|| = 7.415e-04

Anderson update took 192.059 ms, out of which F'*F took 85.773 ms; b-Ax took 569.775 ms, out of which Lap took 512.033 ms
Solving Poisson took 1296.093 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.214086 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 60.163 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.204850 
Total time for convolution: 	 convolve: 5.252509 
Total time for convolution: 	 convolve: 5.152727 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.376 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.386 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.207 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.515 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.047 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.608 ms

This SCF took 28355.909 ms, scf error = 1.159e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.159305, lowerbound = -0.984567, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1603.573 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.723 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.744 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.482 ms
rank =  0, finding HY took 26.927 ms
rank =  0, distributing HY into block cyclic form took 20.197 ms
rank =  0, finding Y'*HY took 3.888 ms
Rank 0, Project_Hamiltonian used 73.528 ms
Total time for projection: 73.538 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.221 ms
    first calculated eigval = -0.956315197201411
    last  calculated eigval = 0.055416551809191
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.57302504868599
lambda[   4] =  -0.55911737462721
lambda[   5] =  -0.49697092304936
lambda[   6] =  -0.46010141327738
lambda[   7] =  -0.40946251226628
lambda[   8] =  -0.36118209840643
lambda[   9] =  -0.34933222282879
lambda[  10] =  -0.30696721156342
lambda[  11] =  -0.26815047080921
lambda[  12] =  -0.23781294793382
lambda[  13] =  -0.03144669334976
lambda[  14] =  -0.00266880317668
lambda[  15] =   0.00347188095972
lambda[  16] =   0.02013304207882
lambda[  17] =   0.03803060105831
lambda[  18] =   0.05368912987373
lambda[  19] =   0.05541655180919
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 8.592 ms
rank =  0, Distributing orbital back into band + domain format took 19.556 ms
rank = 0, Subspace_Rotation used 28.171 ms

Total time for subspace rotation: 28.179 ms
rank = 0, Efermi =  -0.060037107671 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 6.748 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.384 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1725.133 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.939 ms
rank = 0, D2D took 2.043 ms
rank = 0, Transfering density took 2.049 ms
Etot    =   -38.155626050341
Eband   =   -11.545922451321
E1      =    25.343811741386
E2      =   -10.189964417824
E3      =   -14.346130301682
Exc     =   -12.700077032526
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 4.871e-03, dEband = 1.206e-01
rank = 0, Calculating/Estimating energy took 1.023 ms, Etot = -38.155626050, dEtot = 4.871e-03, dEband = 1.206e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.4477250859083, which took 0.586 ms

iter_count = 108, r_2norm = 1.323e-04, tol*||rhs|| = 1.779e-04

Anderson update took 64.876 ms, out of which F'*F took 30.014 ms; b-Ax took 206.088 ms, out of which Lap took 181.690 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.177 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772499, int_b + int_rho = 2.510e-13, checking this took 0.133 ms
2-norm of RHS = 741.7834271240094, which took 0.202 ms

iter_count = 276, r_2norm = 6.579e-04, tol*||rhs|| = 7.418e-04

Anderson update took 163.454 ms, out of which F'*F took 77.011 ms; b-Ax took 521.229 ms, out of which Lap took 460.705 ms
Solving Poisson took 1169.796 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.171708 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 129.153 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.209476 
Total time for convolution: 	 convolve: 5.140642 
Total time for convolution: 	 convolve: 5.139968 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.347 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.134 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 3.522 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.213 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.767 ms

This SCF took 28185.099 ms, scf error = 3.782e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.155417, lowerbound = -0.956315, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1611.263 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.845 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.670 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.536 ms
rank =  0, finding HY took 25.465 ms
rank =  0, distributing HY into block cyclic form took 19.681 ms
rank =  0, finding Y'*HY took 3.805 ms
Rank 0, Project_Hamiltonian used 71.519 ms
Total time for projection: 71.545 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.430 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.256 ms
rank = 0, Solve_Generalized_EigenProblem used 1.693 ms
    first calculated eigval = -0.953392699228738
    last  calculated eigval = 0.051077175709129
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.56094307317818
lambda[   4] =  -0.54693961014951
lambda[   5] =  -0.48612313730932
lambda[   6] =  -0.44806652409883
lambda[   7] =  -0.39905412931336
lambda[   8] =  -0.35196956934035
lambda[   9] =  -0.33628503283116
lambda[  10] =  -0.30039548345555
lambda[  11] =  -0.25826384934236
lambda[  12] =  -0.23240255362176
lambda[  13] =  -0.03257768778136
lambda[  14] =  -0.00305697402826
lambda[  15] =   0.00341945109466
lambda[  16] =   0.01724690678543
lambda[  17] =   0.03017290959156
lambda[  18] =   0.04955149487581
lambda[  19] =   0.05107717570913
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.712 ms
rank =  0, subspace rotation using ScaLAPACK took 8.066 ms
rank =  0, Distributing orbital back into band + domain format took 19.224 ms
rank = 0, Subspace_Rotation used 27.315 ms

Total time for subspace rotation: 27.321 ms
rank = 0, Efermi =  -0.061168102112 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 6.792 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.256 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.193 ms
rank = 0, Calculating density took 1732.218 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.012 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.156 ms
rank = 0, D2D took 2.273 ms
rank = 0, Transfering density took 2.282 ms
Etot    =   -38.150806226678
Eband   =   -11.314847940169
E1      =    25.213476199168
E2      =   -10.075095978947
E3      =   -14.423408875454
Exc     =   -12.758406312693
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 4.820e-04, dEband = 2.311e-02
rank = 0, Calculating/Estimating energy took 1.013 ms, Etot = -38.150806227, dEtot = 4.820e-04, dEband = 2.311e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.8103900715405, which took 0.079 ms

iter_count = 108, r_2norm = 7.927e-05, tol*||rhs|| = 1.124e-04

Anderson update took 82.607 ms, out of which F'*F took 30.653 ms; b-Ax took 209.018 ms, out of which Lap took 185.628 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.571 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772513, int_b + int_rho = 3.893e-13, checking this took 0.130 ms
2-norm of RHS = 741.8616191655719, which took 0.111 ms

iter_count = 258, r_2norm = 6.447e-04, tol*||rhs|| = 7.419e-04

Anderson update took 156.630 ms, out of which F'*F took 72.525 ms; b-Ax took 505.465 ms, out of which Lap took 453.370 ms
Solving Poisson took 1102.298 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.175744 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 118.819 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.148801 
Total time for convolution: 	 convolve: 5.142184 
Total time for convolution: 	 convolve: 5.159333 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.007 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.340 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
---Transfer Veff_loc: D2D took 3.528 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.661 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.229 ms

This SCF took 28072.839 ms, scf error = 1.212e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.151077, lowerbound = -0.953393, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1613.200 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.811 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.322 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.626 ms
rank =  0, finding HY took 24.959 ms
rank =  0, distributing HY into block cyclic form took 19.743 ms
rank =  0, finding Y'*HY took 4.008 ms
Rank 0, Project_Hamiltonian used 72.369 ms
Total time for projection: 72.380 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -0.947963923268307
    last  calculated eigval = 0.047007223346657
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.55434197457233
lambda[   4] =  -0.54067220980929
lambda[   5] =  -0.48021212487767
lambda[   6] =  -0.44160707490564
lambda[   7] =  -0.39280088664203
lambda[   8] =  -0.34593190172593
lambda[   9] =  -0.32912096752400
lambda[  10] =  -0.29438960338513
lambda[  11] =  -0.25249953984709
lambda[  12] =  -0.22661280286303
lambda[  13] =  -0.03279767257796
lambda[  14] =  -0.00328240728543
lambda[  15] =   0.00335270402789
lambda[  16] =   0.01632075211344
lambda[  17] =   0.02459637640286
lambda[  18] =   0.04149280556977
lambda[  19] =   0.04700722334666
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 8.036 ms
rank =  0, Distributing orbital back into band + domain format took 19.258 ms
rank = 0, Subspace_Rotation used 27.311 ms

Total time for subspace rotation: 27.316 ms
rank = 0, Efermi =  -0.061388086922 calculate fermi energy took 0.599 ms
rank = 0, --- Calculate rho: sum over local bands took 6.803 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.418 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 1732.610 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.953 ms
rank = 0, D2D took 2.052 ms
rank = 0, Transfering density took 2.054 ms
Etot    =   -38.149606345865
Eband   =   -11.166879718507
E1      =    25.127830058881
E2      =   -10.003635124066
E3      =   -14.463746546289
Exc     =   -12.788405329209
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 1.200e-04, dEband = 1.480e-02
rank = 0, Calculating/Estimating energy took 1.034 ms, Etot = -38.149606346, dEtot = 1.200e-04, dEband = 1.480e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9065820633161, which took 0.090 ms

iter_count = 114, r_2norm = 2.329e-05, tol*||rhs|| = 3.626e-05

Anderson update took 70.615 ms, out of which F'*F took 33.506 ms; b-Ax took 236.917 ms, out of which Lap took 213.023 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 508.313 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772515, int_b + int_rho = 4.184e-13, checking this took 0.127 ms
2-norm of RHS = 742.1714855215141, which took 0.204 ms

iter_count = 246, r_2norm = 6.182e-04, tol*||rhs|| = 7.422e-04

Anderson update took 146.174 ms, out of which F'*F took 69.900 ms; b-Ax took 469.454 ms, out of which Lap took 417.948 ms
Solving Poisson took 1045.557 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.924 ms
Total time for convolution: 	 convolve: 5.158844 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 137.591 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.205213 
Total time for convolution: 	 convolve: 5.184680 
Total time for convolution: 	 convolve: 5.141812 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.505 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.176 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.717 ms

This SCF took 28212.249 ms, scf error = 6.457e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.147007, lowerbound = -0.947964, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1614.679 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.775 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.670 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.464 ms
rank =  0, finding HY took 25.418 ms
rank =  0, distributing HY into block cyclic form took 19.751 ms
rank =  0, finding Y'*HY took 3.784 ms
Rank 0, Project_Hamiltonian used 71.448 ms
Total time for projection: 71.459 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -0.945030756795942
    last  calculated eigval = 0.042952385449101
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.55136975381558
lambda[   4] =  -0.53786421247471
lambda[   5] =  -0.47752539162543
lambda[   6] =  -0.43878002796044
lambda[   7] =  -0.38994194711034
lambda[   8] =  -0.34309405372308
lambda[   9] =  -0.32589892764761
lambda[  10] =  -0.29140898532332
lambda[  11] =  -0.24986887652372
lambda[  12] =  -0.22383186601711
lambda[  13] =  -0.03259203957905
lambda[  14] =  -0.00334022827365
lambda[  15] =   0.00351716957743
lambda[  16] =   0.01625484113836
lambda[  17] =   0.02132939671679
lambda[  18] =   0.03392767640315
lambda[  19] =   0.04295238544910
==subpsace eigenproblem: bcast eigvals took 0.086 ms
Total time for solving subspace eigenvalue problem: 0.314 ms
rank =  0, subspace rotation using ScaLAPACK took 8.040 ms
rank =  0, Distributing orbital back into band + domain format took 19.371 ms
rank = 0, Subspace_Rotation used 27.429 ms

Total time for subspace rotation: 27.434 ms
rank = 0, Efermi =  -0.061182453923 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 6.534 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.992 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 1733.129 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.961 ms
rank = 0, D2D took 2.065 ms
rank = 0, Transfering density took 2.068 ms
Etot    =   -38.149224184400
Eband   =   -11.098238195301
E1      =    25.101736320090
E2      =    -9.957630537993
E3      =   -14.474358170361
Exc     =   -12.795177990159
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 3.822e-05, dEband = 6.864e-03
rank = 0, Calculating/Estimating energy took 1.026 ms, Etot = -38.149224184, dEtot = 3.822e-05, dEband = 6.864e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4501871741912, which took 0.067 ms

iter_count = 114, r_2norm = 1.152e-05, tol*||rhs|| = 1.801e-05

Anderson update took 69.307 ms, out of which F'*F took 32.526 ms; b-Ax took 217.878 ms, out of which Lap took 193.493 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 491.733 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772497, int_b + int_rho = 2.365e-13, checking this took 0.114 ms
2-norm of RHS = 742.4301169802926, which took 0.152 ms

iter_count = 246, r_2norm = 6.786e-04, tol*||rhs|| = 7.424e-04

Anderson update took 148.145 ms, out of which F'*F took 71.865 ms; b-Ax took 492.117 ms, out of which Lap took 436.019 ms
Solving Poisson took 1055.196 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.133348 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 158.981 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.138113 
Total time for convolution: 	 convolve: 5.146865 
Total time for convolution: 	 convolve: 5.147524 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.043 ms
---Transfer Veff_loc: D2D took 4.295 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.155 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.486 ms

This SCF took 28022.765 ms, scf error = 3.660e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.142952, lowerbound = -0.945031, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1603.293 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.791 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.728 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.535 ms
rank =  0, finding HY took 25.609 ms
rank =  0, distributing HY into block cyclic form took 19.735 ms
rank =  0, finding Y'*HY took 3.824 ms
Rank 0, Project_Hamiltonian used 71.737 ms
Total time for projection: 71.749 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -0.942238454612077
    last  calculated eigval = 0.039599564504068
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54673629759432
lambda[   4] =  -0.53340692173921
lambda[   5] =  -0.47356315085376
lambda[   6] =  -0.43406332950917
lambda[   7] =  -0.38584055105415
lambda[   8] =  -0.33933927534283
lambda[   9] =  -0.32103365485110
lambda[  10] =  -0.28705777550917
lambda[  11] =  -0.24542761559028
lambda[  12] =  -0.22016190208099
lambda[  13] =  -0.03153662397474
lambda[  14] =  -0.00257628044737
lambda[  15] =   0.00542921010661
lambda[  16] =   0.01845176789189
lambda[  17] =   0.02080906873137
lambda[  18] =   0.02963206981466
lambda[  19] =   0.03959956450407
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.263 ms
rank =  0, subspace rotation using ScaLAPACK took 8.061 ms
rank =  0, Distributing orbital back into band + domain format took 19.409 ms
rank = 0, Subspace_Rotation used 27.486 ms

Total time for subspace rotation: 27.490 ms
rank = 0, Efermi =  -0.060127038289 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 6.988 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.439 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.557 ms
rank = 0, Calculating density took 1721.959 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.945 ms
rank = 0, D2D took 2.051 ms
rank = 0, Transfering density took 2.057 ms
Etot    =   -38.148905826725
Eband   =   -10.996145964258
E1      =    25.053750966798
E2      =    -9.899883534699
E3      =   -14.487029711132
Exc     =   -12.803891047711
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 3.184e-05, dEband = 1.021e-02
rank = 0, Calculating/Estimating energy took 1.038 ms, Etot = -38.148905827, dEtot = 3.184e-05, dEband = 1.021e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2364897380692, which took 0.059 ms

iter_count = 114, r_2norm = 6.966e-06, tol*||rhs|| = 9.460e-06

Anderson update took 67.788 ms, out of which F'*F took 31.765 ms; b-Ax took 217.673 ms, out of which Lap took 193.623 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.482 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772508, int_b + int_rho = 3.383e-13, checking this took 0.175 ms
2-norm of RHS = 742.4529668272947, which took 0.168 ms

iter_count = 228, r_2norm = 6.990e-04, tol*||rhs|| = 7.425e-04

Anderson update took 138.224 ms, out of which F'*F took 64.698 ms; b-Ax took 433.406 ms, out of which Lap took 387.233 ms
Solving Poisson took 964.638 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.142913 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 148.160 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.145184 
Total time for convolution: 	 convolve: 5.170234 
Total time for convolution: 	 convolve: 5.149654 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.148 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.408 ms
---Transfer Veff_loc: D2D took 3.474 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.284 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.796 ms

This SCF took 27945.736 ms, scf error = 1.839e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.139600, lowerbound = -0.942238, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1602.964 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.742 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.735 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.495 ms
rank =  0, finding HY took 25.444 ms
rank =  0, distributing HY into block cyclic form took 19.676 ms
rank =  0, finding Y'*HY took 3.776 ms
Rank 0, Project_Hamiltonian used 71.422 ms
Total time for projection: 71.434 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.221 ms
    first calculated eigval = -0.939873936050290
    last  calculated eigval = 0.037689842143592
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54414986506667
lambda[   4] =  -0.53077993969895
lambda[   5] =  -0.47108199330566
lambda[   6] =  -0.43144389542523
lambda[   7] =  -0.38332269336720
lambda[   8] =  -0.33679334801203
lambda[   9] =  -0.31839255372272
lambda[  10] =  -0.28449694469756
lambda[  11] =  -0.24277671888169
lambda[  12] =  -0.21768247881947
lambda[  13] =  -0.02984793909063
lambda[  14] =  -0.00076594595967
lambda[  15] =   0.00866653496928
lambda[  16] =   0.02082253870315
lambda[  17] =   0.02241489541265
lambda[  18] =   0.02797771779868
lambda[  19] =   0.03768984214359
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 8.049 ms
rank =  0, Distributing orbital back into band + domain format took 19.254 ms
rank = 0, Subspace_Rotation used 27.322 ms

Total time for subspace rotation: 27.328 ms
rank = 0, Efermi =  -0.058438353434 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 6.672 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.823 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 1721.197 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.963 ms
rank = 0, D2D took 2.066 ms
rank = 0, Transfering density took 2.072 ms
Etot    =   -38.148782499539
Eband   =   -10.934532249594
E1      =    25.023301504549
E2      =    -9.867314058394
E3      =   -14.492529648781
Exc     =   -12.807862434284
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 1.233e-05, dEband = 6.161e-03
rank = 0, Calculating/Estimating energy took 1.772 ms, Etot = -38.148782500, dEtot = 1.233e-05, dEband = 6.161e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2049746612389, which took 0.068 ms

iter_count = 108, r_2norm = 7.932e-06, tol*||rhs|| = 8.199e-06

Anderson update took 63.999 ms, out of which F'*F took 30.604 ms; b-Ax took 211.114 ms, out of which Lap took 189.269 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 470.577 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772502, int_b + int_rho = 2.801e-13, checking this took 0.133 ms
2-norm of RHS = 742.4296604653473, which took 0.183 ms

iter_count = 216, r_2norm = 6.052e-04, tol*||rhs|| = 7.424e-04

Anderson update took 129.325 ms, out of which F'*F took 62.731 ms; b-Ax took 420.233 ms, out of which Lap took 374.558 ms
Solving Poisson took 918.086 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.153689 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 139.430 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.228882 
Total time for convolution: 	 convolve: 5.140549 
Total time for convolution: 	 convolve: 5.142797 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.134 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.880 ms
---Transfer Veff_loc: D2D took 3.521 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.219 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.778 ms

This SCF took 27929.893 ms, scf error = 1.140e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.137690, lowerbound = -0.939874, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1608.728 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.803 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.730 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.553 ms
rank =  0, finding HY took 25.542 ms
rank =  0, distributing HY into block cyclic form took 19.898 ms
rank =  0, finding Y'*HY took 3.763 ms
Rank 0, Project_Hamiltonian used 71.788 ms
Total time for projection: 71.799 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -0.938779546666157
    last  calculated eigval = 0.036429945884346
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54254117538429
lambda[   4] =  -0.52914397301053
lambda[   5] =  -0.46959578758437
lambda[   6] =  -0.42978201904333
lambda[   7] =  -0.38180430614865
lambda[   8] =  -0.33536947818942
lambda[   9] =  -0.31663498560175
lambda[  10] =  -0.28305560251476
lambda[  11] =  -0.24121988767008
lambda[  12] =  -0.21632974096950
lambda[  13] =  -0.02819272605289
lambda[  14] =   0.00117303361194
lambda[  15] =   0.01113199641103
lambda[  16] =   0.02187265505315
lambda[  17] =   0.02421925118792
lambda[  18] =   0.02790198675963
lambda[  19] =   0.03642994588435
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.254 ms
rank =  0, subspace rotation using ScaLAPACK took 8.072 ms
rank =  0, Distributing orbital back into band + domain format took 19.432 ms
rank = 0, Subspace_Rotation used 27.519 ms

Total time for subspace rotation: 27.525 ms
rank = 0, Efermi =  -0.056783140403 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 6.697 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.696 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1727.412 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 2.986 ms
rank = 0, D2D took 3.086 ms
rank = 0, Transfering density took 3.089 ms
Etot    =   -38.148755259655
Eband   =   -10.898082555941
E1      =    25.003379473527
E2      =    -9.849717047390
E3      =   -14.497431872060
Exc     =   -12.811668069307
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 2.724e-06, dEband = 3.645e-03
rank = 0, Calculating/Estimating energy took 1.034 ms, Etot = -38.148755260, dEtot = 2.724e-06, dEband = 3.645e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0889199587302, which took 0.343 ms

iter_count = 114, r_2norm = 2.499e-06, tol*||rhs|| = 3.557e-06

Anderson update took 68.254 ms, out of which F'*F took 32.381 ms; b-Ax took 219.754 ms, out of which Lap took 196.144 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 501.551 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772510, int_b + int_rho = 3.602e-13, checking this took 0.166 ms
2-norm of RHS = 742.4214452760752, which took 0.196 ms

iter_count = 210, r_2norm = 7.031e-04, tol*||rhs|| = 7.424e-04

Anderson update took 126.234 ms, out of which F'*F took 59.287 ms; b-Ax took 401.793 ms, out of which Lap took 357.112 ms
Solving Poisson took 888.954 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.152426 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 146.500 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.138376 
Total time for convolution: 	 convolve: 5.141084 
Total time for convolution: 	 convolve: 5.142181 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.284 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.720 ms
---Transfer Veff_loc: D2D took 3.534 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.228 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.797 ms

This SCF took 27933.750 ms, scf error = 8.350e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.136430, lowerbound = -0.938780, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1598.865 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.866 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.715 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.599 ms
rank =  0, finding HY took 25.513 ms
rank =  0, distributing HY into block cyclic form took 19.922 ms
rank =  0, finding Y'*HY took 3.756 ms
Rank 0, Project_Hamiltonian used 71.829 ms
Total time for projection: 71.841 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -0.937937623962746
    last  calculated eigval = 0.036285813529542
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54155982181663
lambda[   4] =  -0.52814452397807
lambda[   5] =  -0.46867479255843
lambda[   6] =  -0.42879870073096
lambda[   7] =  -0.38082847064340
lambda[   8] =  -0.33444228416532
lambda[   9] =  -0.31553740975794
lambda[  10] =  -0.28208489354503
lambda[  11] =  -0.24027958747787
lambda[  12] =  -0.21542230865380
lambda[  13] =  -0.02461029261843
lambda[  14] =   0.00567457301434
lambda[  15] =   0.01496422348323
lambda[  16] =   0.02499856907783
lambda[  17] =   0.02674125867959
lambda[  18] =   0.03056555498451
lambda[  19] =   0.03628581352954
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.256 ms
rank =  0, subspace rotation using ScaLAPACK took 8.006 ms
rank =  0, Distributing orbital back into band + domain format took 19.331 ms
rank = 0, Subspace_Rotation used 27.354 ms

Total time for subspace rotation: 27.359 ms
rank = 0, Efermi =  -0.053200706934 calculate fermi energy took 0.705 ms
rank = 0, --- Calculate rho: sum over local bands took 6.300 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.134 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.566 ms
rank = 0, Calculating density took 1718.529 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.934 ms
rank = 0, D2D took 2.050 ms
rank = 0, Transfering density took 2.056 ms
Etot    =   -38.148797167064
Eband   =   -10.875117959659
E1      =    24.993314318914
E2      =    -9.836929007343
E3      =   -14.497197777055
Exc     =   -12.811587283333
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 4.191e-06, dEband = 2.296e-03
rank = 0, Calculating/Estimating energy took 1.054 ms, Etot = -38.148797167, dEtot = 4.191e-06, dEband = 2.296e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0954872108816, which took 0.133 ms

iter_count = 108, r_2norm = 3.166e-06, tol*||rhs|| = 3.819e-06

Anderson update took 66.170 ms, out of which F'*F took 30.703 ms; b-Ax took 208.846 ms, out of which Lap took 186.652 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 469.138 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772510, int_b + int_rho = 3.674e-13, checking this took 0.140 ms
2-norm of RHS = 742.4334848251308, which took 0.216 ms

iter_count = 192, r_2norm = 5.986e-04, tol*||rhs|| = 7.424e-04

Anderson update took 114.468 ms, out of which F'*F took 53.164 ms; b-Ax took 364.851 ms, out of which Lap took 324.054 ms
Solving Poisson took 809.364 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.134 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
Total time for convolution: 	 convolve: 5.144059 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 138.227 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.142543 
Total time for convolution: 	 convolve: 5.148644 
Total time for convolution: 	 convolve: 5.147884 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.723 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.491 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.213 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.742 ms

This SCF took 27803.148 ms, scf error = 4.880e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.136286, lowerbound = -0.937938, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1609.474 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.823 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.717 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.558 ms
rank =  0, finding HY took 25.488 ms
rank =  0, distributing HY into block cyclic form took 19.881 ms
rank =  0, finding Y'*HY took 3.807 ms
Rank 0, Project_Hamiltonian used 71.766 ms
Total time for projection: 71.777 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.226 ms
    first calculated eigval = -0.937388444670283
    last  calculated eigval = 0.035359651684104
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54088656153331
lambda[   4] =  -0.52742764379545
lambda[   5] =  -0.46803388379502
lambda[   6] =  -0.42809287200043
lambda[   7] =  -0.38016432230581
lambda[   8] =  -0.33380227986604
lambda[   9] =  -0.31478565957017
lambda[  10] =  -0.28141934667762
lambda[  11] =  -0.23960558183047
lambda[  12] =  -0.21481772842357
lambda[  13] =  -0.02234019913117
lambda[  14] =   0.00780004404755
lambda[  15] =   0.01512822083800
lambda[  16] =   0.02551814978655
lambda[  17] =   0.02609553523612
lambda[  18] =   0.03165110291357
lambda[  19] =   0.03535965168410
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.253 ms
rank =  0, subspace rotation using ScaLAPACK took 7.921 ms
rank =  0, Distributing orbital back into band + domain format took 20.459 ms
rank = 0, Subspace_Rotation used 28.401 ms

Total time for subspace rotation: 28.407 ms
rank = 0, Efermi =  -0.050930613460 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 6.160 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.412 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.556 ms
rank = 0, Calculating density took 1729.186 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.929 ms
rank = 0, D2D took 2.034 ms
rank = 0, Transfering density took 2.040 ms
Etot    =   -38.148943129745
Eband   =   -10.859096419563
E1      =    24.985150042059
E2      =    -9.828673411492
E3      =   -14.498579971438
Exc     =   -12.812717107787
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 1.460e-05, dEband = 1.602e-03
rank = 0, Calculating/Estimating energy took 1.035 ms, Etot = -38.148943130, dEtot = 1.460e-05, dEband = 1.602e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0819880872563, which took 0.064 ms

iter_count = 108, r_2norm = 2.764e-06, tol*||rhs|| = 3.280e-06

Anderson update took 65.256 ms, out of which F'*F took 30.660 ms; b-Ax took 206.275 ms, out of which Lap took 183.892 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.294 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772506, int_b + int_rho = 3.274e-13, checking this took 0.136 ms
2-norm of RHS = 742.4378133009463, which took 0.131 ms

iter_count = 162, r_2norm = 6.859e-04, tol*||rhs|| = 7.424e-04

Anderson update took 96.242 ms, out of which F'*F took 44.105 ms; b-Ax took 305.677 ms, out of which Lap took 269.121 ms
Solving Poisson took 684.667 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.151093 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 142.486 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.145965 
Total time for convolution: 	 convolve: 5.149031 
Total time for convolution: 	 convolve: 5.148369 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.579 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
---Transfer Veff_loc: D2D took 3.498 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.191 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.725 ms

This SCF took 27633.412 ms, scf error = 3.201e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.135360, lowerbound = -0.937388, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1611.300 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.767 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.733 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.519 ms
rank =  0, finding HY took 25.441 ms
rank =  0, distributing HY into block cyclic form took 19.851 ms
rank =  0, finding Y'*HY took 3.767 ms
Rank 0, Project_Hamiltonian used 71.608 ms
Total time for projection: 71.620 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.937229863404548
    last  calculated eigval = 0.036192258946329
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54068395729977
lambda[   4] =  -0.52721650519657
lambda[   5] =  -0.46783692373084
lambda[   6] =  -0.42787911463924
lambda[   7] =  -0.37997080078956
lambda[   8] =  -0.33361882853138
lambda[   9] =  -0.31457503456524
lambda[  10] =  -0.28122338620217
lambda[  11] =  -0.23939568947950
lambda[  12] =  -0.21464113191178
lambda[  13] =  -0.02052846228266
lambda[  14] =   0.00922141063555
lambda[  15] =   0.01570793166739
lambda[  16] =   0.02511987626766
lambda[  17] =   0.02708229875799
lambda[  18] =   0.03212937462544
lambda[  19] =   0.03619225894633
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.239 ms
rank =  0, subspace rotation using ScaLAPACK took 8.003 ms
rank =  0, Distributing orbital back into band + domain format took 20.130 ms
rank = 0, Subspace_Rotation used 28.156 ms

Total time for subspace rotation: 28.161 ms
rank = 0, Efermi =  -0.049118876616 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 6.107 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.484 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.610 ms
rank = 0, Calculating density took 1730.691 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.960 ms
rank = 0, D2D took 2.064 ms
rank = 0, Transfering density took 2.073 ms
Etot    =   -38.148988063262
Eband   =   -10.854321770672
E1      =    24.982774583171
E2      =    -9.826242158817
E3      =   -14.498698987300
Exc     =   -12.812848994493
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 4.493e-06, dEband = 4.775e-04
rank = 0, Calculating/Estimating energy took 1.040 ms, Etot = -38.148988063, dEtot = 4.493e-06, dEband = 4.775e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0438380731613, which took 0.061 ms

iter_count = 114, r_2norm = 1.311e-06, tol*||rhs|| = 1.754e-06

Anderson update took 67.909 ms, out of which F'*F took 32.043 ms; b-Ax took 214.343 ms, out of which Lap took 191.535 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 490.643 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772503, int_b + int_rho = 2.910e-13, checking this took 0.126 ms
2-norm of RHS = 742.4417201458416, which took 0.147 ms

iter_count = 156, r_2norm = 6.974e-04, tol*||rhs|| = 7.424e-04

Anderson update took 92.726 ms, out of which F'*F took 43.713 ms; b-Ax took 298.809 ms, out of which Lap took 265.455 ms
Solving Poisson took 661.173 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.154390 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 112.460 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.143238 
Total time for convolution: 	 convolve: 5.151262 
Total time for convolution: 	 convolve: 5.143888 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.724 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.590 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.338 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 3.505 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.378 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.922 ms

This SCF took 27601.633 ms, scf error = 2.617e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136192, lowerbound = -0.937230, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1612.043 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.857 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.660 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.536 ms
rank =  0, finding HY took 25.473 ms
rank =  0, distributing HY into block cyclic form took 19.865 ms
rank =  0, finding Y'*HY took 3.738 ms
Rank 0, Project_Hamiltonian used 71.642 ms
Total time for projection: 71.652 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.757 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.253 ms
rank = 0, Solve_Generalized_EigenProblem used 1.018 ms
    first calculated eigval = -0.936960198217344
    last  calculated eigval = 0.035965429127912
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54046069702910
lambda[   4] =  -0.52700077074330
lambda[   5] =  -0.46760036791380
lambda[   6] =  -0.42766590582311
lambda[   7] =  -0.37975019913911
lambda[   8] =  -0.33338878828959
lambda[   9] =  -0.31437506428570
lambda[  10] =  -0.28100683086614
lambda[  11] =  -0.23917478912332
lambda[  12] =  -0.21441253991336
lambda[  13] =  -0.02009761477361
lambda[  14] =   0.00909959564482
lambda[  15] =   0.01533523137479
lambda[  16] =   0.02416625963962
lambda[  17] =   0.02727110128026
lambda[  18] =   0.03223040561303
lambda[  19] =   0.03596542912791
==subpsace eigenproblem: bcast eigvals took 0.058 ms
Total time for solving subspace eigenvalue problem: 1.485 ms
rank =  0, subspace rotation using ScaLAPACK took 8.033 ms
rank =  0, Distributing orbital back into band + domain format took 19.365 ms
rank = 0, Subspace_Rotation used 27.417 ms

Total time for subspace rotation: 27.422 ms
rank = 0, Efermi =  -0.048688029091 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 6.695 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.577 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.566 ms
rank = 0, Calculating density took 1731.573 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.923 ms
rank = 0, D2D took 2.029 ms
rank = 0, Transfering density took 2.036 ms
Etot    =   -38.149037798409
Eband   =   -10.848931332452
E1      =    24.980247750764
E2      =    -9.823275794490
E3      =   -14.498920193806
Exc     =   -12.813017177632
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 4.974e-06, dEband = 5.390e-04
rank = 0, Calculating/Estimating energy took 1.039 ms, Etot = -38.149037798, dEtot = 4.974e-06, dEband = 5.390e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0360204693436, which took 0.073 ms

iter_count = 114, r_2norm = 1.104e-06, tol*||rhs|| = 1.441e-06

Anderson update took 67.964 ms, out of which F'*F took 32.205 ms; b-Ax took 218.352 ms, out of which Lap took 193.230 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.115 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772510, int_b + int_rho = 3.674e-13, checking this took 0.146 ms
2-norm of RHS = 742.4428070115928, which took 0.171 ms

iter_count = 138, r_2norm = 6.303e-04, tol*||rhs|| = 7.424e-04

Anderson update took 82.106 ms, out of which F'*F took 37.636 ms; b-Ax took 257.672 ms, out of which Lap took 228.645 ms
Solving Poisson took 581.412 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.142367 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 155.764 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.614 ms
Total time for convolution: 	 convolve: 5.143534 
Total time for convolution: 	 convolve: 5.149091 
Total time for convolution: 	 convolve: 5.143378 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.591 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 3.495 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.198 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.729 ms

This SCF took 27559.858 ms, scf error = 2.101e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135965, lowerbound = -0.936960, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1607.129 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.699 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.779 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.991 ms
rank =  0, finding HY took 25.630 ms
rank =  0, distributing HY into block cyclic form took 19.823 ms
rank =  0, finding Y'*HY took 3.955 ms
Rank 0, Project_Hamiltonian used 72.439 ms
Total time for projection: 72.453 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -0.936781643507763
    last  calculated eigval = 0.036508107884704
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54031363455992
lambda[   4] =  -0.52685784607867
lambda[   5] =  -0.46744563063651
lambda[   6] =  -0.42752515486207
lambda[   7] =  -0.37960366075355
lambda[   8] =  -0.33323697771439
lambda[   9] =  -0.31424441104373
lambda[  10] =  -0.28085947713878
lambda[  11] =  -0.23902763960071
lambda[  12] =  -0.21425863145848
lambda[  13] =  -0.01965093009689
lambda[  14] =   0.00905442092952
lambda[  15] =   0.01527758889968
lambda[  16] =   0.02406100876637
lambda[  17] =   0.02784771666458
lambda[  18] =   0.03257136301088
lambda[  19] =   0.03650810788470
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.247 ms
rank =  0, subspace rotation using ScaLAPACK took 7.979 ms
rank =  0, Distributing orbital back into band + domain format took 19.652 ms
rank = 0, Subspace_Rotation used 27.650 ms

Total time for subspace rotation: 27.655 ms
rank = 0, Efermi =  -0.048241344422 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 6.909 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.433 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.599 ms
rank = 0, Calculating density took 1726.593 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.961 ms
rank = 0, D2D took 2.069 ms
rank = 0, Transfering density took 2.076 ms
Etot    =   -38.149059333504
Eband   =   -10.845348701424
E1      =    24.978446484611
E2      =    -9.821411801900
E3      =   -14.499172554365
Exc     =   -12.813208445571
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 2.154e-06, dEband = 3.583e-04
rank = 0, Calculating/Estimating energy took 1.034 ms, Etot = -38.149059334, dEtot = 2.154e-06, dEband = 3.583e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0271997601125, which took 0.063 ms

iter_count = 108, r_2norm = 1.038e-06, tol*||rhs|| = 1.088e-06

Anderson update took 65.380 ms, out of which F'*F took 30.324 ms; b-Ax took 204.886 ms, out of which Lap took 182.563 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.253 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772501, int_b + int_rho = 2.728e-13, checking this took 0.134 ms
2-norm of RHS = 742.4451607153416, which took 0.167 ms

iter_count = 150, r_2norm = 6.578e-04, tol*||rhs|| = 7.424e-04

Anderson update took 90.400 ms, out of which F'*F took 41.789 ms; b-Ax took 284.866 ms, out of which Lap took 252.170 ms
Solving Poisson took 634.307 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.212 ms
Total time for convolution: 	 convolve: 5.143965 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 119.236 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.142111 
Total time for convolution: 	 convolve: 5.160640 
Total time for convolution: 	 convolve: 6.389174 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.344 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.472 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.186 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.694 ms

This SCF took 28798.354 ms, scf error = 1.749e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136508, lowerbound = -0.936782, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1613.868 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.898 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.726 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.643 ms
rank =  0, finding HY took 25.429 ms
rank =  0, distributing HY into block cyclic form took 19.778 ms
rank =  0, finding Y'*HY took 4.096 ms
Rank 0, Project_Hamiltonian used 71.975 ms
Total time for projection: 71.987 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.223 ms
    first calculated eigval = -0.936517504057955
    last  calculated eigval = 0.038209579604556
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54006572416601
lambda[   4] =  -0.52661001631817
lambda[   5] =  -0.46719380061698
lambda[   6] =  -0.42728588288381
lambda[   7] =  -0.37935545887376
lambda[   8] =  -0.33298983599906
lambda[   9] =  -0.31400791788353
lambda[  10] =  -0.28061170823992
lambda[  11] =  -0.23878142584632
lambda[  12] =  -0.21400987710524
lambda[  13] =  -0.01906560780223
lambda[  14] =   0.00902566448749
lambda[  15] =   0.01533663299223
lambda[  16] =   0.02437007755712
lambda[  17] =   0.02884824662118
lambda[  18] =   0.03396078007515
lambda[  19] =   0.03820957960456
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 8.019 ms
rank =  0, Distributing orbital back into band + domain format took 19.356 ms
rank = 0, Subspace_Rotation used 27.393 ms

Total time for subspace rotation: 27.399 ms
rank = 0, Efermi =  -0.047656022117 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 6.584 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.749 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.610 ms
rank = 0, Calculating density took 1732.574 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.947 ms
rank = 0, D2D took 2.043 ms
rank = 0, Transfering density took 2.046 ms
Etot    =   -38.149082831633
Eband   =   -10.839397985601
E1      =    24.975541102172
E2      =    -9.818248844519
E3      =   -14.499546102770
Exc     =   -12.813487868107
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 2.350e-06, dEband = 5.951e-04
rank = 0, Calculating/Estimating energy took 1.034 ms, Etot = -38.149082832, dEtot = 2.350e-06, dEband = 5.951e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0253226565154, which took 0.059 ms

iter_count = 114, r_2norm = 6.403e-07, tol*||rhs|| = 1.013e-06

Anderson update took 68.757 ms, out of which F'*F took 32.104 ms; b-Ax took 214.878 ms, out of which Lap took 192.038 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 492.311 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772514, int_b + int_rho = 4.002e-13, checking this took 0.140 ms
2-norm of RHS = 742.4455682309383, which took 0.185 ms

iter_count = 78, r_2norm = 7.154e-04, tol*||rhs|| = 7.424e-04

Anderson update took 46.882 ms, out of which F'*F took 21.721 ms; b-Ax took 147.794 ms, out of which Lap took 131.382 ms
Solving Poisson took 338.429 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.143637 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 155.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.142817 
Total time for convolution: 	 convolve: 5.145744 
Total time for convolution: 	 convolve: 5.159271 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
---Transfer Veff_loc: D2D took 4.265 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.196 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.501 ms

This SCF took 27314.476 ms, scf error = 1.412e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.138210, lowerbound = -0.936518, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1613.853 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.869 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.756 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.645 ms
rank =  0, finding HY took 25.571 ms
rank =  0, distributing HY into block cyclic form took 19.864 ms
rank =  0, finding Y'*HY took 4.076 ms
Rank 0, Project_Hamiltonian used 72.192 ms
Total time for projection: 72.204 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -0.936536459204470
    last  calculated eigval = 0.038388145152586
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54008841422322
lambda[   4] =  -0.52663101603667
lambda[   5] =  -0.46721487381362
lambda[   6] =  -0.42730921986165
lambda[   7] =  -0.37937590385009
lambda[   8] =  -0.33301027711153
lambda[   9] =  -0.31402915114218
lambda[  10] =  -0.28063356842473
lambda[  11] =  -0.23880548491153
lambda[  12] =  -0.21403128424272
lambda[  13] =  -0.01901052053397
lambda[  14] =   0.00893551798008
lambda[  15] =   0.01522116236890
lambda[  16] =   0.02426894221955
lambda[  17] =   0.02887859581637
lambda[  18] =   0.03414975147573
lambda[  19] =   0.03838814515259
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 8.029 ms
rank =  0, Distributing orbital back into band + domain format took 19.346 ms
rank = 0, Subspace_Rotation used 27.399 ms

Total time for subspace rotation: 27.404 ms
rank = 0, Efermi =  -0.047600934876 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 6.635 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.947 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.196 ms
rank = 0, Calculating density took 1733.598 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.112 ms
rank = 0, D2D took 2.209 ms
rank = 0, Transfering density took 2.212 ms
Etot    =   -38.149079509312
Eband   =   -10.839925977717
E1      =    24.975830455044
E2      =    -9.818506886438
E3      =   -14.499488164929
Exc     =   -12.813446010622
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 3.322e-07, dEband = 5.280e-05
rank = 0, Calculating/Estimating energy took 1.019 ms, Etot = -38.149079509, dEtot = 3.322e-07, dEband = 5.280e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0270445891452, which took 0.061 ms

iter_count = 108, r_2norm = 1.061e-06, tol*||rhs|| = 1.082e-06

Anderson update took 65.635 ms, out of which F'*F took 30.565 ms; b-Ax took 206.287 ms, out of which Lap took 183.007 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 469.395 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772512, int_b + int_rho = 3.783e-13, checking this took 0.128 ms
2-norm of RHS = 742.4454911298213, which took 0.165 ms

iter_count = 54, r_2norm = 6.638e-04, tol*||rhs|| = 7.424e-04

Anderson update took 32.013 ms, out of which F'*F took 15.057 ms; b-Ax took 101.972 ms, out of which Lap took 90.464 ms
Solving Poisson took 230.841 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.139431 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 146.213 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.147234 
Total time for convolution: 	 convolve: 5.148274 
Total time for convolution: 	 convolve: 5.138085 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.219 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
---Transfer Veff_loc: D2D took 3.487 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.195 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.719 ms

This SCF took 27157.315 ms, scf error = 1.418e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.138388, lowerbound = -0.936536, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1601.883 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.838 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.717 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.574 ms
rank =  0, finding HY took 25.369 ms
rank =  0, distributing HY into block cyclic form took 19.839 ms
rank =  0, finding Y'*HY took 4.051 ms
Rank 0, Project_Hamiltonian used 71.862 ms
Total time for projection: 71.875 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.936524996041324
    last  calculated eigval = 0.038262390911743
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54007150267274
lambda[   4] =  -0.52661471344317
lambda[   5] =  -0.46719982959259
lambda[   6] =  -0.42729221693237
lambda[   7] =  -0.37936032381443
lambda[   8] =  -0.33299551153441
lambda[   9] =  -0.31401129137437
lambda[  10] =  -0.28061885372929
lambda[  11] =  -0.23878978076751
lambda[  12] =  -0.21401664823483
lambda[  13] =  -0.01889544833408
lambda[  14] =   0.00907538078184
lambda[  15] =   0.01534550038994
lambda[  16] =   0.02435678764567
lambda[  17] =   0.02896218345813
lambda[  18] =   0.03400358758427
lambda[  19] =   0.03826239091174
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.252 ms
rank =  0, subspace rotation using ScaLAPACK took 8.003 ms
rank =  0, Distributing orbital back into band + domain format took 19.486 ms
rank = 0, Subspace_Rotation used 27.509 ms

Total time for subspace rotation: 27.514 ms
rank = 0, Efermi =  -0.047485862642 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 6.801 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.629 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1720.650 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.929 ms
rank = 0, D2D took 2.029 ms
rank = 0, Transfering density took 2.031 ms
Etot    =   -38.149075063107
Eband   =   -10.839553655071
E1      =    24.975642944016
E2      =    -9.818311327698
E3      =   -14.499549549640
Exc     =   -12.813492202004
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 4.446e-07, dEband = 3.723e-05
rank = 0, Calculating/Estimating energy took 1.970 ms, Etot = -38.149075063, dEtot = 4.446e-07, dEband = 3.723e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0238229319990, which took 0.076 ms

iter_count = 114, r_2norm = 6.120e-07, tol*||rhs|| = 9.529e-07

Anderson update took 67.986 ms, out of which F'*F took 32.257 ms; b-Ax took 215.872 ms, out of which Lap took 191.933 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.855 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772509, int_b + int_rho = 3.492e-13, checking this took 0.139 ms
2-norm of RHS = 742.4469329294453, which took 0.131 ms

iter_count = 72, r_2norm = 7.246e-04, tol*||rhs|| = 7.424e-04

Anderson update took 43.230 ms, out of which F'*F took 19.913 ms; b-Ax took 137.269 ms, out of which Lap took 121.459 ms
Solving Poisson took 308.414 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.145220 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 132.709 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.151817 
Total time for convolution: 	 convolve: 5.141997 
Total time for convolution: 	 convolve: 5.144749 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 3.452 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.186 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.674 ms

This SCF took 27285.954 ms, scf error = 1.443e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.138262, lowerbound = -0.936525, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1610.068 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.878 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.691 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.588 ms
rank =  0, finding HY took 25.462 ms
rank =  0, distributing HY into block cyclic form took 19.831 ms
rank =  0, finding Y'*HY took 4.054 ms
Rank 0, Project_Hamiltonian used 71.964 ms
Total time for projection: 71.975 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -0.936531723254354
    last  calculated eigval = 0.038461248406141
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54008497614993
lambda[   4] =  -0.52662781011155
lambda[   5] =  -0.46721144397944
lambda[   6] =  -0.42730713342819
lambda[   7] =  -0.37937206837524
lambda[   8] =  -0.33300593767806
lambda[   9] =  -0.31402610772868
lambda[  10] =  -0.28062990760770
lambda[  11] =  -0.23880263997400
lambda[  12] =  -0.21402707533364
lambda[  13] =  -0.01889098864124
lambda[  14] =   0.00898963764788
lambda[  15] =   0.01524457754990
lambda[  16] =   0.02427147471992
lambda[  17] =   0.02894544956372
lambda[  18] =   0.03423925822374
lambda[  19] =   0.03846124840614
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.240 ms
rank =  0, subspace rotation using ScaLAPACK took 7.984 ms
rank =  0, Distributing orbital back into band + domain format took 19.459 ms
rank = 0, Subspace_Rotation used 27.460 ms

Total time for subspace rotation: 27.465 ms
rank = 0, Efermi =  -0.047481402986 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 6.655 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.687 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.579 ms
rank = 0, Calculating density took 1728.783 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 3.308 ms
rank = 0, D2D took 3.413 ms
rank = 0, Transfering density took 3.417 ms
Etot    =   -38.149079600651
Eband   =   -10.839847917516
E1      =    24.975874713486
E2      =    -9.818392163559
E3      =   -14.499439932339
Exc     =   -12.813405465134
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 4.538e-07, dEband = 2.943e-05
rank = 0, Calculating/Estimating energy took 1.093 ms, Etot = -38.149079601, dEtot = 4.538e-07, dEband = 2.943e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0282115612862, which took 0.063 ms

iter_count = 108, r_2norm = 1.035e-06, tol*||rhs|| = 1.128e-06

Anderson update took 64.627 ms, out of which F'*F took 30.672 ms; b-Ax took 203.331 ms, out of which Lap took 182.058 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.483 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772500, int_b + int_rho = 2.656e-13, checking this took 0.116 ms
2-norm of RHS = 742.4432464762882, which took 0.119 ms

iter_count = 108, r_2norm = 7.199e-04, tol*||rhs|| = 7.424e-04

Anderson update took 64.319 ms, out of which F'*F took 30.526 ms; b-Ax took 206.504 ms, out of which Lap took 183.478 ms
Solving Poisson took 458.877 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.141675 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 155.393 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.156708 
Total time for convolution: 	 convolve: 5.152708 
Total time for convolution: 	 convolve: 5.148029 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.620 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
---Transfer Veff_loc: D2D took 3.502 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.181 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.719 ms

This SCF took 27423.446 ms, scf error = 1.483e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.138461, lowerbound = -0.936532, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1615.266 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.851 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.724 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.595 ms
rank =  0, finding HY took 25.588 ms
rank =  0, distributing HY into block cyclic form took 19.774 ms
rank =  0, finding Y'*HY took 4.035 ms
Rank 0, Project_Hamiltonian used 72.031 ms
Total time for projection: 72.042 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -0.936502331793570
    last  calculated eigval = 0.037337677303635
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54009165971522
lambda[   4] =  -0.52663667014087
lambda[   5] =  -0.46720888758983
lambda[   6] =  -0.42731478618800
lambda[   7] =  -0.37937694276637
lambda[   8] =  -0.33300288887718
lambda[   9] =  -0.31404975572837
lambda[  10] =  -0.28062718822701
lambda[  11] =  -0.23880163955816
lambda[  12] =  -0.21401831140386
lambda[  13] =  -0.02013266615837
lambda[  14] =   0.00796622543843
lambda[  15] =   0.01459900587667
lambda[  16] =   0.02385883505885
lambda[  17] =   0.02786568899435
lambda[  18] =   0.03322083191504
lambda[  19] =   0.03733767730363
==subpsace eigenproblem: bcast eigvals took 0.087 ms
Total time for solving subspace eigenvalue problem: 0.311 ms
rank =  0, subspace rotation using ScaLAPACK took 8.711 ms
rank =  0, Distributing orbital back into band + domain format took 19.110 ms
rank = 0, Subspace_Rotation used 27.841 ms

Total time for subspace rotation: 27.846 ms
rank = 0, Efermi =  -0.048723080480 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 6.778 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.891 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.561 ms
rank = 0, Calculating density took 1734.703 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.926 ms
rank = 0, D2D took 2.029 ms
rank = 0, Transfering density took 2.037 ms
Etot    =   -38.149088534622
Eband   =   -10.839841464759
E1      =    24.975617473117
E2      =    -9.818609941705
E3      =   -14.499537374577
Exc     =   -12.813478831877
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 8.934e-07, dEband = 6.453e-07
rank = 0, Calculating/Estimating energy took 1.214 ms, Etot = -38.149088535, dEtot = 8.934e-07, dEband = 6.453e-07
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0295666005516, which took 0.060 ms

iter_count = 108, r_2norm = 8.723e-07, tol*||rhs|| = 1.183e-06

Anderson update took 65.272 ms, out of which F'*F took 30.585 ms; b-Ax took 206.080 ms, out of which Lap took 182.120 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 465.840 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772509, int_b + int_rho = 3.565e-13, checking this took 0.126 ms
2-norm of RHS = 742.4420561366870, which took 0.158 ms

iter_count = 138, r_2norm = 7.095e-04, tol*||rhs|| = 7.424e-04

Anderson update took 81.554 ms, out of which F'*F took 37.962 ms; b-Ax took 257.677 ms, out of which Lap took 228.327 ms
Solving Poisson took 581.762 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.145022 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 152.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.145371 
Total time for convolution: 	 convolve: 5.189535 
Total time for convolution: 	 convolve: 5.139699 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.767 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
---Transfer Veff_loc: D2D took 3.465 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.189 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.690 ms

This SCF took 27565.861 ms, scf error = 1.131e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.137338, lowerbound = -0.936502, upperbound = 267.587551

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1603.065 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.777 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.718 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.513 ms
rank =  0, finding HY took 25.445 ms
rank =  0, distributing HY into block cyclic form took 19.837 ms
rank =  0, finding Y'*HY took 4.098 ms
Rank 0, Project_Hamiltonian used 71.923 ms
Total time for projection: 71.935 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -0.936379893496928
    last  calculated eigval = 0.037509117016151
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.54002506624917
lambda[   4] =  -0.52657732418732
lambda[   5] =  -0.46712515002372
lambda[   6] =  -0.42725801384379
lambda[   7] =  -0.37930727664491
lambda[   8] =  -0.33292311653162
lambda[   9] =  -0.31401226852099
lambda[  10] =  -0.28055501418237
lambda[  11] =  -0.23873026319959
lambda[  12] =  -0.21393143404892
lambda[  13] =  -0.02123415502076
lambda[  14] =   0.00712186666028
lambda[  15] =   0.01404100653354
lambda[  16] =   0.02352705545487
lambda[  17] =   0.02696116651137
lambda[  18] =   0.03300344569650
lambda[  19] =   0.03750911701615
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 8.029 ms
rank =  0, Distributing orbital back into band + domain format took 20.374 ms
rank = 0, Subspace_Rotation used 28.426 ms

Total time for subspace rotation: 28.431 ms
rank = 0, Efermi =  -0.049824569354 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 6.142 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.363 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.596 ms
rank = 0, Calculating density took 1722.930 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.956 ms
rank = 0, D2D took 2.062 ms
rank = 0, Transfering density took 2.068 ms
Etot    =   -38.149089095356
Eband   =   -10.838088941384
E1      =    24.974654265225
E2      =    -9.817771731234
E3      =   -14.499708615126
Exc     =   -12.813601738173
Esc     =   -63.789533026273
Entropy =    -0.000000001112
dE = 5.607e-08, dEband = 1.753e-04
rank = 0, Calculating/Estimating energy took 1.034 ms, Etot = -38.149089095, dEtot = 5.607e-08, dEband = 1.753e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0242507689574, which took 0.063 ms

iter_count = 108, r_2norm = 7.606e-07, tol*||rhs|| = 9.700e-07

Anderson update took 64.353 ms, out of which F'*F took 31.056 ms; b-Ax took 204.866 ms, out of which Lap took 182.720 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.783 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003772474, int_rho =  24.00000003772498, int_b + int_rho = 2.401e-13, checking this took 0.134 ms
2-norm of RHS = 742.4423856623611, which took 0.164 ms

iter_count = 114, r_2norm = 6.661e-04, tol*||rhs|| = 7.424e-04

Anderson update took 68.249 ms, out of which F'*F took 31.935 ms; b-Ax took 217.788 ms, out of which Lap took 193.060 ms
Solving Poisson took 483.581 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.146299 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 143.616 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.145030 
Total time for convolution: 	 convolve: 5.141297 
Total time for convolution: 	 convolve: 5.162323 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.010 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.080 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 3.487 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.179 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.703 ms

This SCF took 27418.418 ms, scf error = 8.516e-05
The last 17 occupations of kpoints #1 are (Nelectron = 24):
lambda[   3] =  -0.54002506624917, occ[   3] =   2.00000000000000
lambda[   4] =  -0.52657732418732, occ[   4] =   2.00000000000000
lambda[   5] =  -0.46712515002372, occ[   5] =   2.00000000000000
lambda[   6] =  -0.42725801384379, occ[   6] =   2.00000000000000
lambda[   7] =  -0.37930727664491, occ[   7] =   2.00000000000000
lambda[   8] =  -0.33292311653162, occ[   8] =   2.00000000000000
lambda[   9] =  -0.31401226852099, occ[   9] =   2.00000000000000
lambda[  10] =  -0.28055501418237, occ[  10] =   2.00000000000000
lambda[  11] =  -0.23873026319959, occ[  11] =   2.00000000000000
lambda[  12] =  -0.21393143404892, occ[  12] =   2.00000000000000
lambda[  13] =  -0.02123415502076, occ[  13] =   0.00000003772507
lambda[  14] =   0.00712186666028, occ[  14] =   0.00000000000000
lambda[  15] =   0.01404100653354, occ[  15] =   0.00000000000000
lambda[  16] =   0.02352705545487, occ[  16] =   0.00000000000000
lambda[  17] =   0.02696116651137, occ[  17] =   0.00000000000000
lambda[  18] =   0.03300344569650, occ[  18] =   0.00000000000000
lambda[  19] =   0.03750911701615, occ[  19] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 17 (90%) = 0.000000000000000.
Occupation of state 19 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.705 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.660 ms, time for Allreduce/Reduce: 11.037 ms 
Time for calculating local force components: 22.423 ms
Start Calculating nonlocal forces
force_nloc = 
  0.35174679443404   0.88211477540106   0.50215883909632
  0.00350042334395   0.00051278376184  -0.05187076907566
 -0.03363536546522   0.02451218870546  -0.03037958506233
  0.01023768478578   0.02347501300229   0.04493175067526
 -0.03259288924490  -0.02532208722879  -0.03041597047653
  0.01012508752028  -0.02306825516409   0.04499840174815
  0.03578252352398  -0.06586937330698  -0.00453289556610
 -0.04127293232138  -0.00376136305256  -0.17047913274051
 -0.04996402260488   0.14120873238600   0.03827463158981
 -0.04120871691621  -0.13674968992257   0.02976514159430
force_loc = 
 -0.34380905494125  -0.85798560548490  -0.48753461923227
 -0.00448242471501  -0.00076611325204   0.05639103460695
  0.03574655073850  -0.02660658824015   0.03191909308866
 -0.01014794023687  -0.02560341111566  -0.04759821085958
  0.03463365281918   0.02761851976032   0.03213467317399
 -0.01015341570237   0.02505677084619  -0.04750751043330
 -0.03897998523720   0.06845701323033   0.00428980926354
  0.03989493440616   0.00331927726058   0.16192736431528
  0.04939536326559  -0.13419038201623  -0.03678985173797
  0.04125678860174   0.12989874295237  -0.02914711757170
Time for calculating nonlocal force components: 45.170 ms
[32mforces_xc: 
[0m[32m -0.01197753561966  -0.02633512903896  -0.01597567610836
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00491011423131   0.00014920222133   0.00697945709179
[0m[32m  0.00037723187020  -0.00407248394151  -0.00087450569579
[0m[32m  0.00034391374942   0.00392127749221  -0.00064369283892
[0mTime for calculating XC forces components: 31.074 ms
 Cartesian force = 
 -0.00401247415539  -0.00219734064836  -0.00135352212880
 -0.00095467939958  -0.00024471101575   0.00451819964678
  0.00213850724476  -0.00208578106024   0.00153744214183
  0.00011706652039  -0.00211977963893  -0.00266852606882
  0.00206808554576   0.00230505100598   0.00171663681295
 -0.00000100621061   0.00199713415654  -0.00251117456965
 -0.00317013974174   0.00259625839780  -0.00024515218706
  0.00355943828757  -0.00028426509620  -0.00157437721795
 -0.00016410549760   0.00295448490271   0.00060820827154
  0.00041930740644  -0.00292105100355  -0.00002773470082
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.332 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.369 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Time for printing density: 392.522 ms
The program took 589.844 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:09
Job ID:        2266593
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:01:36,vmem=8328K,walltime=00:10:08,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-25-1
---------------------------------------
