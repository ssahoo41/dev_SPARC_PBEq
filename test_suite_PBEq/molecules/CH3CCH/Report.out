---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:18
Job ID:    2266573
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:25
Job ID:    2266573
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.085 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 11.696 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 7.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8

Reading ion file took 24.851 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 35.082 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.904 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.295 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	    9.517554	   13.887060	
   10.000000	   11.447340	    6.112940	
   11.671244	    8.552660	    6.112940	
    8.328756	    8.552660	    6.112940	
   10.000000	    9.517554	    6.861194	
   10.000000	    9.517554	    9.610697	
   10.000000	    9.517554	   11.881151	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.365 ms
Set up communicators.

--set up spincomm took 2.030 ms

--set up kptcomm took 0.379 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.073 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.447 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.422 ms

Calculate_SplineDerivRadFun took 0.112 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.302 ms.
time spent on vectorized spline interp: 2.350 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.018 ms.
time spent on vectorized spline interp: 1.859 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.527 ms.

Calculating rb for all atom types took 11.064 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.006 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.010 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000177636, sum_int_rho = 15.5920373521916
PosCharge = 16.000000017764, NegCharge = -15.592037352192, scal_fac = 1.026164808123
After scaling, int_rho = 16.0000000177636, PosCharge + NegCharge - NetCharge = 4.619e-14
--Calculate Vref took 0.485 ms
--Calculate rho_guess took 3.191 ms

 integral of b = -16.0000000177636,
 int{b} + Nelectron + NetCharge = -1.776e-08,
 Esc = -36.8664341434035,
 MPI_Reduce took 1.973 ms

Calculating b & b_ref took 12.711 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.024 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.112 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.010 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.109 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.009 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.777 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.005 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.048 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 26.816 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776362, int_b + int_rho = -4.402e-13, checking this took 0.091 ms
2-norm of RHS = 612.3044685063142, which took 0.179 ms

iter_count = 420, r_2norm = 5.554e-04, tol*||rhs|| = 6.123e-04

Anderson update took 256.696 ms, out of which F'*F took 117.906 ms; b-Ax took 789.263 ms, out of which Lap took 706.281 ms
Solving Poisson took 1740.080 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.413 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.815 ms
Total time for convolution: 	 convolve: 5.144556 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
Total time for convolution: 	 convolve: 5.096317 
Total time for convolution: 	 convolve: 5.093287 
Total time for convolution: 	 convolve: 5.086350 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.716 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.502 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.452 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.827 ms
rank = 0, XC calculation took 24234.524 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 1.091 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.767 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 2.979 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.139 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.852 ms
    Lanczos iter 56, eigmin  = -0.840518483, eigmax = 264.944190923, err_eigmin = 6.518e-04, err_eigmax = 9.820e-03
rank =   0, Lanczos took 140.889 ms, eigmin = -0.840518482748, eigmax = 267.593632832264

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.326557, lowerbound = -0.940518, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1378.392 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 16.586 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.551 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.037 ms
rank =  0, Distribute data + matrix mult took 19.195 ms
rank =  0, finding HY took 21.566 ms
rank =  0, distributing HY into block cyclic form took 15.733 ms
rank =  0, finding Y'*HY took 2.213 ms
Rank 0, Project_Hamiltonian used 58.743 ms
Total time for projection: 58.754 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.213 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 1.275 ms
    first calculated eigval = 2.795658251585701
    last  calculated eigval = 3.185314245102169
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.79565825158570
lambda[   2] =   2.83795475496970
lambda[   3] =   2.85217620487066
lambda[   4] =   2.91535060023780
lambda[   5] =   2.93751182937480
lambda[   6] =   2.99000999051087
lambda[   7] =   3.00759511387411
lambda[   8] =   3.05074599509165
lambda[   9] =   3.05548946337161
lambda[  10] =   3.07843824113007
lambda[  11] =   3.09248596399174
lambda[  12] =   3.12012524427654
lambda[  13] =   3.14690984202206
lambda[  14] =   3.18531424510217
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.290 ms
rank =  0, subspace rotation using ScaLAPACK took 3.849 ms
rank =  0, Distributing orbital back into band + domain format took 14.286 ms
rank = 0, Subspace_Rotation used 18.149 ms

Total time for subspace rotation: 18.152 ms
rank = 0, Efermi =   3.053117725303 calculate fermi energy took 0.048 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.285314, lowerbound = -0.940518, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1361.984 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 14.634 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.137 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 17.229 ms
rank =  0, finding HY took 21.212 ms
rank =  0, distributing HY into block cyclic form took 14.686 ms
rank =  0, finding Y'*HY took 2.252 ms
Rank 0, Project_Hamiltonian used 55.407 ms
Total time for projection: 55.413 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.659274590144462
    last  calculated eigval = 0.446235581515533
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.65927459014446
lambda[   2] =  -0.49806335417948
lambda[   3] =  -0.24247988336574
lambda[   4] =  -0.11040920326231
lambda[   5] =  -0.00803825287706
lambda[   6] =   0.09802214801318
lambda[   7] =   0.14756578133210
lambda[   8] =   0.27702949799988
lambda[   9] =   0.30040368284840
lambda[  10] =   0.33405090247707
lambda[  11] =   0.34694092828249
lambda[  12] =   0.36031470961015
lambda[  13] =   0.41652330524043
lambda[  14] =   0.44623558151553
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 3.825 ms
rank =  0, Distributing orbital back into band + domain format took 14.211 ms
rank = 0, Subspace_Rotation used 18.048 ms

Total time for subspace rotation: 18.052 ms
rank = 0, Efermi =   0.288716591149 calculate fermi energy took 0.018 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.546236, lowerbound = -0.940518, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1333.693 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.601 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.535 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 16.172 ms
rank =  0, finding HY took 20.658 ms
rank =  0, distributing HY into block cyclic form took 14.652 ms
rank =  0, finding Y'*HY took 2.249 ms
Rank 0, Project_Hamiltonian used 53.760 ms
Total time for projection: 53.766 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.848063872078784
    last  calculated eigval = 0.130847692185886
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84806387207878
lambda[   2] =  -0.78237800277732
lambda[   3] =  -0.57032688715234
lambda[   4] =  -0.52661002864629
lambda[   5] =  -0.49205598630106
lambda[   6] =  -0.48640797195564
lambda[   7] =  -0.34023792931462
lambda[   8] =  -0.33123773935702
lambda[   9] =  -0.00993447664098
lambda[  10] =   0.01929083123521
lambda[  11] =   0.06959007168945
lambda[  12] =   0.08540695908122
lambda[  13] =   0.10413558306882
lambda[  14] =   0.13084769218589
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 3.840 ms
rank =  0, Distributing orbital back into band + domain format took 14.206 ms
rank = 0, Subspace_Rotation used 18.061 ms

Total time for subspace rotation: 18.064 ms
rank = 0, Efermi =  -0.039207260312 calculate fermi energy took 0.020 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.230848, lowerbound = -0.940518, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1362.561 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.713 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.532 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.042 ms
rank =  0, Distribute data + matrix mult took 16.301 ms
rank =  0, finding HY took 20.601 ms
rank =  0, distributing HY into block cyclic form took 14.606 ms
rank =  0, finding Y'*HY took 2.276 ms
Rank 0, Project_Hamiltonian used 53.812 ms
Total time for projection: 53.819 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.849460299272642
    last  calculated eigval = 0.067199637750269
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84946029927264
lambda[   2] =  -0.78436622953957
lambda[   3] =  -0.57770611195346
lambda[   4] =  -0.53644503685110
lambda[   5] =  -0.49928582126556
lambda[   6] =  -0.49918707909014
lambda[   7] =  -0.35040266250045
lambda[   8] =  -0.35031470895133
lambda[   9] =  -0.06614070191070
lambda[  10] =  -0.06137122956122
lambda[  11] =   0.00639033388481
lambda[  12] =   0.04036748102009
lambda[  13] =   0.05136903935989
lambda[  14] =   0.06719963775027
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.814 ms
rank =  0, Distributing orbital back into band + domain format took 14.281 ms
rank = 0, Subspace_Rotation used 18.111 ms

Total time for subspace rotation: 18.114 ms
rank = 0, Efermi =  -0.095416377845 calculate fermi energy took 0.020 ms
rank = 0, --- Calculate rho: sum over local bands took 2.503 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.756 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 5880.247 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.513 ms
rank = 0, D2D took 0.762 ms
rank = 0, Transfering density took 0.766 ms
Etot    =   -20.508687481516
Eband   =    -8.894335900023
E1      =    18.118638586055
E2      =    -6.292134847819
E3      =    -8.197793618392
Exc     =    -7.356484489819
Esc     =   -36.866434143404
Entropy =    -0.000000000536
dE = 2.930e+00, dEband = 1.271e+00
rank = 0, Calculating/Estimating energy took 1.136 ms, Etot = -20.508687482, dEtot = 2.930e+00, dEband = 1.271e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 37.6268309748887, which took 0.123 ms

iter_count = 102, r_2norm = 8.997e-04, tol*||rhs|| = 1.505e-03

Anderson update took 60.827 ms, out of which F'*F took 28.570 ms; b-Ax took 191.554 ms, out of which Lap took 170.723 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 427.713 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776362, int_b + int_rho = -4.384e-13, checking this took 0.105 ms
2-norm of RHS = 608.4556840970339, which took 0.175 ms

iter_count = 288, r_2norm = 5.570e-04, tol*||rhs|| = 6.085e-04

Anderson update took 171.353 ms, out of which F'*F took 80.201 ms; b-Ax took 534.863 ms, out of which Lap took 479.255 ms
Solving Poisson took 1187.695 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.296 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.083017 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.819 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.083781 
Total time for convolution: 	 convolve: 5.083267 
Total time for convolution: 	 convolve: 5.090582 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.354 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.321 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.335 ms

This SCF took 31894.058 ms, scf error = 2.290e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.167200, lowerbound = -0.849460, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1314.081 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.534 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.554 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 16.127 ms
rank =  0, finding HY took 20.328 ms
rank =  0, distributing HY into block cyclic form took 14.685 ms
rank =  0, finding Y'*HY took 2.258 ms
Rank 0, Project_Hamiltonian used 53.429 ms
Total time for projection: 53.450 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.805291296792202
    last  calculated eigval = 0.044903001363366
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.80529129679220
lambda[   2] =  -0.74076776867572
lambda[   3] =  -0.55022886512001
lambda[   4] =  -0.50044850891039
lambda[   5] =  -0.46833223710126
lambda[   6] =  -0.46829611072203
lambda[   7] =  -0.31751623838194
lambda[   8] =  -0.31748928960564
lambda[   9] =  -0.05001287867915
lambda[  10] =  -0.04978332645976
lambda[  11] =  -0.02753075237305
lambda[  12] =   0.02188007791146
lambda[  13] =   0.02880181159582
lambda[  14] =   0.04490300136337
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 3.816 ms
rank =  0, Distributing orbital back into band + domain format took 14.270 ms
rank = 0, Subspace_Rotation used 18.102 ms

Total time for subspace rotation: 18.106 ms
rank = 0, Efermi =  -0.079793120176 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.410 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.747 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.116 ms
rank = 0, Calculating density took 1389.181 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.518 ms
rank = 0, D2D took 0.803 ms
rank = 0, Transfering density took 0.806 ms
Etot    =   -20.443823647108
Eband   =    -8.336740631505
E1      =    17.629519552777
E2      =    -6.264255684889
E3      =    -8.335266089240
Exc     =    -7.469690198560
Esc     =   -36.866434143404
Entropy =    -0.000000000546
dE = 9.266e-03, dEband = 7.966e-02
rank = 0, Calculating/Estimating energy took 1.120 ms, Etot = -20.443823647, dEtot = 9.266e-03, dEband = 7.966e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 10.9338662688693, which took 0.065 ms

iter_count = 108, r_2norm = 2.894e-04, tol*||rhs|| = 4.374e-04

Anderson update took 66.983 ms, out of which F'*F took 30.272 ms; b-Ax took 204.966 ms, out of which Lap took 182.771 ms
rank = 0, Mixing (+ precond) took 457.535 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776361, int_b + int_rho = -4.511e-13, checking this took 0.158 ms
2-norm of RHS = 602.4693105852342, which took 0.194 ms

iter_count = 306, r_2norm = 5.313e-04, tol*||rhs|| = 6.025e-04

Anderson update took 178.085 ms, out of which F'*F took 84.867 ms; b-Ax took 574.790 ms, out of which Lap took 512.932 ms
Solving Poisson took 1255.941 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.536 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.087014 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.087688 
Total time for convolution: 	 convolve: 5.080990 
Total time for convolution: 	 convolve: 5.077678 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.364 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.330 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.178 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.354 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.877 ms
---Transfer Veff_loc: D2D took 1.398 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.551 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.970 ms

This SCF took 27405.835 ms, scf error = 1.565e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.144903, lowerbound = -0.805291, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1317.235 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.653 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.671 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 16.349 ms
rank =  0, finding HY took 22.038 ms
rank =  0, distributing HY into block cyclic form took 14.825 ms
rank =  0, finding Y'*HY took 2.218 ms
Rank 0, Project_Hamiltonian used 55.462 ms
Total time for projection: 55.483 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.732232192331734
    last  calculated eigval = 0.034722185418149
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.73223219233173
lambda[   2] =  -0.65774870084778
lambda[   3] =  -0.49832259574096
lambda[   4] =  -0.43135401244295
lambda[   5] =  -0.41091815919074
lambda[   6] =  -0.41087939746239
lambda[   7] =  -0.25816192962371
lambda[   8] =  -0.25815136192416
lambda[   9] =  -0.03527515212839
lambda[  10] =  -0.01393252738397
lambda[  11] =  -0.01204523516649
lambda[  12] =   0.01655359054385
lambda[  13] =   0.02367096925801
lambda[  14] =   0.03472218541815
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 3.826 ms
rank =  0, Distributing orbital back into band + domain format took 14.238 ms
rank = 0, Subspace_Rotation used 18.077 ms

Total time for subspace rotation: 18.080 ms
rank = 0, Efermi =  -0.064547935727 calculate fermi energy took 0.103 ms
rank = 0, --- Calculate rho: sum over local bands took 2.537 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.666 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.092 ms
rank = 0, Calculating density took 1394.412 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.625 ms
rank = 0, D2D took 0.893 ms
rank = 0, Transfering density took 0.896 ms
Etot    =   -20.391736618664
Eband   =    -7.315536699755
E1      =    16.756883283637
E2      =    -6.113131810390
E3      =    -8.630916665386
Exc     =    -7.710697534382
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 7.441e-03, dEband = 1.459e-01
rank = 0, Calculating/Estimating energy took 1.125 ms, Etot = -20.391736619, dEtot = 7.441e-03, dEband = 1.459e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.0728167706141, which took 0.053 ms

iter_count = 108, r_2norm = 1.154e-04, tol*||rhs|| = 1.629e-04

Anderson update took 64.061 ms, out of which F'*F took 30.051 ms; b-Ax took 201.575 ms, out of which Lap took 181.252 ms
rank = 0, Mixing (+ precond) took 453.756 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776363, int_b + int_rho = -4.366e-13, checking this took 0.075 ms
2-norm of RHS = 602.5766638920609, which took 0.129 ms

iter_count = 270, r_2norm = 5.576e-04, tol*||rhs|| = 6.026e-04

Anderson update took 168.491 ms, out of which F'*F took 76.229 ms; b-Ax took 505.692 ms, out of which Lap took 455.060 ms
Solving Poisson took 1128.259 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
Total time for convolution: 	 convolve: 5.071616 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.074979 
Total time for convolution: 	 convolve: 5.087581 
Total time for convolution: 	 convolve: 5.076903 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.404 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.378 ms
---Transfer Veff_loc: D2D took 0.645 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.976 ms

This SCF took 27293.462 ms, scf error = 4.574e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.134722, lowerbound = -0.732232, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1321.125 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.693 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.540 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 16.284 ms
rank =  0, finding HY took 20.680 ms
rank =  0, distributing HY into block cyclic form took 14.516 ms
rank =  0, finding Y'*HY took 2.550 ms
Rank 0, Project_Hamiltonian used 54.065 ms
Total time for projection: 54.080 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -0.723251680506009
    last  calculated eigval = 0.029449291534118
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.72325168050601
lambda[   2] =  -0.64882318358318
lambda[   3] =  -0.48937664164493
lambda[   4] =  -0.42218803281944
lambda[   5] =  -0.40130511493315
lambda[   6] =  -0.40124696874808
lambda[   7] =  -0.25046042596325
lambda[   8] =  -0.25044999385086
lambda[   9] =  -0.03655703805703
lambda[  10] =  -0.00894565012757
lambda[  11] =  -0.00728484580060
lambda[  12] =   0.01388015716655
lambda[  13] =   0.02301952633791
lambda[  14] =   0.02944929153412
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.816 ms
rank =  0, Distributing orbital back into band + domain format took 14.251 ms
rank = 0, Subspace_Rotation used 18.080 ms

Total time for subspace rotation: 18.085 ms
rank = 0, Efermi =  -0.065829821738 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.514 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.013 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.088 ms
rank = 0, Calculating density took 1397.161 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.450 ms
rank = 0, D2D took 0.832 ms
rank = 0, Transfering density took 0.836 ms
Etot    =   -20.388792752577
Eband   =    -7.174204084747
E1      =    16.681094783422
E2      =    -6.037305106667
E3      =    -8.680828605743
Exc     =    -7.747383019722
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 4.206e-04, dEband = 2.019e-02
rank = 0, Calculating/Estimating energy took 1.244 ms, Etot = -20.388792753, dEtot = 4.206e-04, dEband = 2.019e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0698328593905, which took 0.052 ms

iter_count = 114, r_2norm = 3.370e-05, tol*||rhs|| = 4.279e-05

Anderson update took 67.659 ms, out of which F'*F took 31.696 ms; b-Ax took 213.491 ms, out of which Lap took 191.618 ms
rank = 0, Mixing (+ precond) took 480.996 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776360, int_b + int_rho = -4.620e-13, checking this took 0.119 ms
2-norm of RHS = 602.7944269111053, which took 0.145 ms

iter_count = 264, r_2norm = 5.669e-04, tol*||rhs|| = 6.028e-04

Anderson update took 159.179 ms, out of which F'*F took 75.150 ms; b-Ax took 502.233 ms, out of which Lap took 450.760 ms
Solving Poisson took 1100.394 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.078997 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.083253 
Total time for convolution: 	 convolve: 5.085267 
Total time for convolution: 	 convolve: 5.068308 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.107 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
---Transfer Veff_loc: D2D took 0.701 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.320 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.046 ms

This SCF took 27272.675 ms, scf error = 1.773e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.129449, lowerbound = -0.723252, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1365.297 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.763 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.557 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 16.360 ms
rank =  0, finding HY took 20.842 ms
rank =  0, distributing HY into block cyclic form took 14.649 ms
rank =  0, finding Y'*HY took 2.509 ms
Rank 0, Project_Hamiltonian used 54.392 ms
Total time for projection: 54.415 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.715848222189816
    last  calculated eigval = 0.027070194114976
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.71584822218982
lambda[   2] =  -0.64090846411610
lambda[   3] =  -0.48124124263496
lambda[   4] =  -0.41458674292835
lambda[   5] =  -0.39319093299172
lambda[   6] =  -0.39313157222174
lambda[   7] =  -0.24387397378335
lambda[   8] =  -0.24386067100205
lambda[   9] =  -0.03648676457852
lambda[  10] =  -0.00516297232324
lambda[  11] =  -0.00366331058564
lambda[  12] =   0.01280632751904
lambda[  13] =   0.02381572345608
lambda[  14] =   0.02707019411498
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 3.957 ms
rank =  0, Distributing orbital back into band + domain format took 14.105 ms
rank = 0, Subspace_Rotation used 18.076 ms

Total time for subspace rotation: 18.079 ms
rank = 0, Efermi =  -0.065759548245 calculate fermi energy took 0.113 ms
rank = 0, --- Calculate rho: sum over local bands took 2.506 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.757 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.067 ms
rank = 0, Calculating density took 1441.507 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.613 ms
rank = 0, D2D took 0.873 ms
rank = 0, Transfering density took 0.878 ms
Etot    =   -20.387614255128
Eband   =    -7.053283644384
E1      =    16.616171678820
E2      =    -5.972119742303
E3      =    -8.718600722842
Exc     =    -7.774788610770
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 1.684e-04, dEband = 1.727e-02
rank = 0, Calculating/Estimating energy took 1.471 ms, Etot = -20.387614255, dEtot = 1.684e-04, dEband = 1.727e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7591563560284, which took 0.056 ms

iter_count = 108, r_2norm = 2.995e-05, tol*||rhs|| = 3.037e-05

Anderson update took 67.083 ms, out of which F'*F took 30.750 ms; b-Ax took 203.163 ms, out of which Lap took 183.127 ms
rank = 0, Mixing (+ precond) took 456.433 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776359, int_b + int_rho = -4.766e-13, checking this took 0.125 ms
2-norm of RHS = 603.0677712837391, which took 0.165 ms

iter_count = 240, r_2norm = 5.067e-04, tol*||rhs|| = 6.031e-04

Anderson update took 139.916 ms, out of which F'*F took 67.098 ms; b-Ax took 454.476 ms, out of which Lap took 405.591 ms
Solving Poisson took 998.030 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.078086 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.078927 
Total time for convolution: 	 convolve: 5.068995 
Total time for convolution: 	 convolve: 5.069661 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.992 ms

This SCF took 27160.398 ms, scf error = 6.963e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.127070, lowerbound = -0.715848, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1375.970 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.647 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.520 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.079 ms
rank =  0, Distribute data + matrix mult took 16.259 ms
rank =  0, finding HY took 20.736 ms
rank =  0, distributing HY into block cyclic form took 14.739 ms
rank =  0, finding Y'*HY took 2.383 ms
Rank 0, Project_Hamiltonian used 54.151 ms
Total time for projection: 54.173 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -0.713831616195262
    last  calculated eigval = 0.026201524920838
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.71383161619526
lambda[   2] =  -0.63925413941234
lambda[   3] =  -0.47937060683931
lambda[   4] =  -0.41270145069962
lambda[   5] =  -0.39101822136949
lambda[   6] =  -0.39096607762898
lambda[   7] =  -0.24214115415531
lambda[   8] =  -0.24212913102123
lambda[   9] =  -0.03610435619140
lambda[  10] =  -0.00397132791223
lambda[  11] =  -0.00301682623902
lambda[  12] =   0.01238926418688
lambda[  13] =   0.02374130942806
lambda[  14] =   0.02620152492084
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 3.923 ms
rank =  0, Distributing orbital back into band + domain format took 14.050 ms
rank = 0, Subspace_Rotation used 17.996 ms

Total time for subspace rotation: 18.000 ms
rank = 0, Efermi =  -0.065377139823 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.545 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.714 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.069 ms
rank = 0, Calculating density took 1451.736 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.484 ms
rank = 0, D2D took 1.493 ms
rank = 0, Transfering density took 1.498 ms
Etot    =   -20.387431908126
Eband   =    -7.022824795284
E1      =    16.607711425706
E2      =    -5.948745075647
E3      =    -8.721458904907
Exc     =    -7.776088375163
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 2.605e-05, dEband = 4.351e-03
rank = 0, Calculating/Estimating energy took 1.008 ms, Etot = -20.387431908, dEtot = 2.605e-05, dEband = 4.351e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3128609945949, which took 0.051 ms

iter_count = 114, r_2norm = 1.001e-05, tol*||rhs|| = 1.251e-05

Anderson update took 67.174 ms, out of which F'*F took 31.543 ms; b-Ax took 214.228 ms, out of which Lap took 191.983 ms
rank = 0, Mixing (+ precond) took 479.570 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776355, int_b + int_rho = -5.075e-13, checking this took 0.135 ms
2-norm of RHS = 603.2586140193870, which took 0.174 ms

iter_count = 246, r_2norm = 4.996e-04, tol*||rhs|| = 6.033e-04

Anderson update took 143.983 ms, out of which F'*F took 67.420 ms; b-Ax took 459.133 ms, out of which Lap took 409.190 ms
Solving Poisson took 1019.156 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.081954 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.086957 
Total time for convolution: 	 convolve: 5.074104 
Total time for convolution: 	 convolve: 5.070684 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.636 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.375 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.167 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
---Transfer Veff_loc: D2D took 0.721 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.319 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.066 ms

This SCF took 27427.377 ms, scf error = 4.350e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.126202, lowerbound = -0.713832, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1323.981 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.761 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.536 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.047 ms
rank =  0, Distribute data + matrix mult took 16.357 ms
rank =  0, finding HY took 21.039 ms
rank =  0, distributing HY into block cyclic form took 14.697 ms
rank =  0, finding Y'*HY took 2.351 ms
Rank 0, Project_Hamiltonian used 54.474 ms
Total time for projection: 54.490 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.709257133552357
    last  calculated eigval = 0.027672688603095
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.70925713355236
lambda[   2] =  -0.63489688359957
lambda[   3] =  -0.47563388234185
lambda[   4] =  -0.40834013110368
lambda[   5] =  -0.38681888775158
lambda[   6] =  -0.38677267279360
lambda[   7] =  -0.23808661841743
lambda[   8] =  -0.23807540639019
lambda[   9] =  -0.03462938443565
lambda[  10] =  -0.00123744310087
lambda[  11] =  -0.00056435986636
lambda[  12] =   0.01331845337727
lambda[  13] =   0.02457264982934
lambda[  14] =   0.02767268860310
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.911 ms
rank =  0, Distributing orbital back into band + domain format took 14.163 ms
rank = 0, Subspace_Rotation used 18.087 ms

Total time for subspace rotation: 18.090 ms
rank = 0, Efermi =  -0.063902168052 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.523 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.679 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.068 ms
rank = 0, Calculating density took 1400.163 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.945 ms
rank = 0, D2D took 2.053 ms
rank = 0, Transfering density took 2.057 ms
Etot    =   -20.387284280024
Eband   =    -6.955763232516
E1      =    16.574791266458
E2      =    -5.911169450101
E3      =    -8.733487598882
Exc     =    -7.784535219011
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 2.109e-05, dEband = 9.580e-03
rank = 0, Calculating/Estimating energy took 0.990 ms, Etot = -20.387284280, dEtot = 2.109e-05, dEband = 9.580e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1893901061792, which took 0.078 ms

iter_count = 114, r_2norm = 5.079e-06, tol*||rhs|| = 7.576e-06

Anderson update took 67.373 ms, out of which F'*F took 31.169 ms; b-Ax took 214.396 ms, out of which Lap took 190.175 ms
rank = 0, Mixing (+ precond) took 480.267 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776357, int_b + int_rho = -4.929e-13, checking this took 0.123 ms
2-norm of RHS = 603.3023736983329, which took 0.105 ms

iter_count = 234, r_2norm = 5.787e-04, tol*||rhs|| = 6.033e-04

Anderson update took 139.385 ms, out of which F'*F took 65.511 ms; b-Ax took 441.317 ms, out of which Lap took 394.758 ms
Solving Poisson took 973.483 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.107642 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.080616 
Total time for convolution: 	 convolve: 5.076421 
Total time for convolution: 	 convolve: 5.081008 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.618 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.312 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.002 ms

This SCF took 27421.510 ms, scf error = 2.503e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.127673, lowerbound = -0.709257, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1383.291 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.833 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.532 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.397 ms
rank =  0, finding HY took 21.026 ms
rank =  0, distributing HY into block cyclic form took 14.834 ms
rank =  0, finding Y'*HY took 2.237 ms
Rank 0, Project_Hamiltonian used 54.526 ms
Total time for projection: 54.544 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.705843478631829
    last  calculated eigval = 0.030801823413125
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.70584347863183
lambda[   2] =  -0.63125080133447
lambda[   3] =  -0.47256188380942
lambda[   4] =  -0.40512567103996
lambda[   5] =  -0.38398975833567
lambda[   6] =  -0.38394395321288
lambda[   7] =  -0.23447080067131
lambda[   8] =  -0.23446056703741
lambda[   9] =  -0.03151135210259
lambda[  10] =   0.00214839168903
lambda[  11] =   0.00243435711812
lambda[  12] =   0.01600832989517
lambda[  13] =   0.02711483698020
lambda[  14] =   0.03080182341313
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 3.952 ms
rank =  0, Distributing orbital back into band + domain format took 14.053 ms
rank = 0, Subspace_Rotation used 18.019 ms

Total time for subspace rotation: 18.024 ms
rank = 0, Efermi =  -0.060784135740 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.492 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.288 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1460.759 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.390 ms
rank = 0, D2D took 0.496 ms
rank = 0, Transfering density took 0.502 ms
Etot    =   -20.387210837269
Eband   =    -6.903293828706
E1      =    16.548109588553
E2      =    -5.883687374123
E3      =    -8.740220476216
Exc     =    -7.789500303517
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 1.049e-05, dEband = 7.496e-03
rank = 0, Calculating/Estimating energy took 1.620 ms, Etot = -20.387210837, dEtot = 1.049e-05, dEband = 7.496e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1307543321351, which took 0.054 ms

iter_count = 114, r_2norm = 4.069e-06, tol*||rhs|| = 5.230e-06

Anderson update took 67.240 ms, out of which F'*F took 31.652 ms; b-Ax took 214.807 ms, out of which Lap took 190.763 ms
rank = 0, Mixing (+ precond) took 480.219 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776358, int_b + int_rho = -4.875e-13, checking this took 0.117 ms
2-norm of RHS = 603.2921483886200, which took 0.144 ms

iter_count = 210, r_2norm = 5.214e-04, tol*||rhs|| = 6.033e-04

Anderson update took 124.939 ms, out of which F'*F took 58.651 ms; b-Ax took 394.852 ms, out of which Lap took 353.879 ms
Solving Poisson took 874.164 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Total time for convolution: 	 convolve: 5.084122 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.084365 
Total time for convolution: 	 convolve: 5.082508 
Total time for convolution: 	 convolve: 5.083008 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.716 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.706 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.320 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.051 ms

This SCF took 27121.417 ms, scf error = 1.431e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.130802, lowerbound = -0.705843, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1389.061 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.673 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.543 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 16.264 ms
rank =  0, finding HY took 21.281 ms
rank =  0, distributing HY into block cyclic form took 14.722 ms
rank =  0, finding Y'*HY took 2.280 ms
Rank 0, Project_Hamiltonian used 54.581 ms
Total time for projection: 54.599 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.705123989240933
    last  calculated eigval = 0.032091476527220
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.70512398924093
lambda[   2] =  -0.63055982878265
lambda[   3] =  -0.47173149214686
lambda[   4] =  -0.40442435215586
lambda[   5] =  -0.38319188888615
lambda[   6] =  -0.38314497359186
lambda[   7] =  -0.23371516990794
lambda[   8] =  -0.23370444953578
lambda[   9] =  -0.02990171148642
lambda[  10] =   0.00335936994612
lambda[  11] =   0.00344506905011
lambda[  12] =   0.01732951716849
lambda[  13] =   0.02761267127993
lambda[  14] =   0.03209147652722
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.927 ms
rank =  0, Distributing orbital back into band + domain format took 13.772 ms
rank = 0, Subspace_Rotation used 18.285 ms

Total time for subspace rotation: 18.289 ms
rank = 0, Efermi =  -0.059174495138 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.543 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.700 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.070 ms
rank = 0, Calculating density took 1465.579 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.610 ms
rank = 0, D2D took 0.922 ms
rank = 0, Transfering density took 0.927 ms
Etot    =   -20.387237033536
Eband   =    -6.891192289027
E1      =    16.543104438750
E2      =    -5.876305638092
E3      =    -8.741388081512
Exc     =    -7.790408758923
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 3.742e-06, dEband = 1.729e-03
rank = 0, Calculating/Estimating energy took 1.081 ms, Etot = -20.387237034, dEtot = 3.742e-06, dEband = 1.729e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0581810595616, which took 0.051 ms

iter_count = 114, r_2norm = 1.913e-06, tol*||rhs|| = 2.327e-06

Anderson update took 67.120 ms, out of which F'*F took 31.616 ms; b-Ax took 214.173 ms, out of which Lap took 190.586 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 480.849 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776359, int_b + int_rho = -4.693e-13, checking this took 0.135 ms
2-norm of RHS = 603.2715643590909, which took 0.124 ms

iter_count = 210, r_2norm = 5.379e-04, tol*||rhs|| = 6.033e-04

Anderson update took 125.369 ms, out of which F'*F took 58.816 ms; b-Ax took 393.789 ms, out of which Lap took 353.169 ms
Solving Poisson took 874.023 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.073533 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.078574 
Total time for convolution: 	 convolve: 5.079180 
Total time for convolution: 	 convolve: 5.078863 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.681 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.325 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.030 ms

This SCF took 27140.578 ms, scf error = 1.103e-03
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.132091, lowerbound = -0.705124, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1385.124 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.667 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.505 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.040 ms
rank =  0, Distribute data + matrix mult took 16.226 ms
rank =  0, finding HY took 21.150 ms
rank =  0, distributing HY into block cyclic form took 14.814 ms
rank =  0, finding Y'*HY took 2.214 ms
Rank 0, Project_Hamiltonian used 54.438 ms
Total time for projection: 54.460 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.703814279596609
    last  calculated eigval = 0.035676949764160
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.70381427959661
lambda[   2] =  -0.62925096128179
lambda[   3] =  -0.47051225951915
lambda[   4] =  -0.40317047245708
lambda[   5] =  -0.38194601325488
lambda[   6] =  -0.38189893506777
lambda[   7] =  -0.23242156594666
lambda[   8] =  -0.23241083999019
lambda[   9] =  -0.02590353901539
lambda[  10] =   0.00575160994356
lambda[  11] =   0.00597032143308
lambda[  12] =   0.02041868438230
lambda[  13] =   0.03053225799630
lambda[  14] =   0.03567694976416
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 4.664 ms
rank =  0, Distributing orbital back into band + domain format took 13.112 ms
rank = 0, Subspace_Rotation used 17.795 ms

Total time for subspace rotation: 17.802 ms
rank = 0, Efermi =  -0.055176322639 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.537 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.703 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.070 ms
rank = 0, Calculating density took 1461.570 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.633 ms
rank = 0, D2D took 0.856 ms
rank = 0, Transfering density took 0.860 ms
Etot    =   -20.387223394553
Eband   =    -6.870850654688
E1      =    16.532574982355
E2      =    -5.866237383112
E3      =    -8.743110122855
Exc     =    -7.791861084248
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 1.948e-06, dEband = 2.906e-03
rank = 0, Calculating/Estimating energy took 1.119 ms, Etot = -20.387223395, dEtot = 1.948e-06, dEband = 2.906e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0531871631944, which took 0.072 ms

iter_count = 114, r_2norm = 1.431e-06, tol*||rhs|| = 2.127e-06

Anderson update took 67.245 ms, out of which F'*F took 31.650 ms; b-Ax took 213.651 ms, out of which Lap took 189.936 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 479.649 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776359, int_b + int_rho = -4.766e-13, checking this took 0.154 ms
2-norm of RHS = 603.2893502793320, which took 0.136 ms

iter_count = 192, r_2norm = 5.181e-04, tol*||rhs|| = 6.033e-04

Anderson update took 114.437 ms, out of which F'*F took 53.553 ms; b-Ax took 361.558 ms, out of which Lap took 324.084 ms
Solving Poisson took 799.526 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.075082 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.081170 
Total time for convolution: 	 convolve: 5.077302 
Total time for convolution: 	 convolve: 5.083680 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 2.008 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.667 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.995 ms

This SCF took 27111.194 ms, scf error = 5.578e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.135677, lowerbound = -0.703814, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1387.273 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.035 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.511 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.037 ms
rank =  0, Distribute data + matrix mult took 16.594 ms
rank =  0, finding HY took 21.075 ms
rank =  0, distributing HY into block cyclic form took 14.832 ms
rank =  0, finding Y'*HY took 2.248 ms
Rank 0, Project_Hamiltonian used 54.778 ms
Total time for projection: 54.805 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -0.703115814128813
    last  calculated eigval = 0.037101738091699
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.70311581412881
lambda[   2] =  -0.62858037520823
lambda[   3] =  -0.46982180709896
lambda[   4] =  -0.40250544502336
lambda[   5] =  -0.38126951993429
lambda[   6] =  -0.38122188099868
lambda[   7] =  -0.23172121017605
lambda[   8] =  -0.23171018187849
lambda[   9] =  -0.02357987827011
lambda[  10] =   0.00698723509097
lambda[  11] =   0.00723174901603
lambda[  12] =   0.02181205222145
lambda[  13] =   0.03091933439825
lambda[  14] =   0.03710173809170
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 4.587 ms
rank =  0, Distributing orbital back into band + domain format took 13.916 ms
rank = 0, Subspace_Rotation used 18.521 ms

Total time for subspace rotation: 18.533 ms
rank = 0, Efermi =  -0.052852661865 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.329 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.685 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.075 ms
rank = 0, Calculating density took 1465.490 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.601 ms
rank = 0, D2D took 0.932 ms
rank = 0, Transfering density took 0.941 ms
Etot    =   -20.387322688403
Eband   =    -6.859892469313
E1      =    16.527579082359
E2      =    -5.859979589003
E3      =    -8.744099402292
Exc     =    -7.792654148805
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 1.418e-05, dEband = 1.565e-03
rank = 0, Calculating/Estimating energy took 1.053 ms, Etot = -20.387322688, dEtot = 1.418e-05, dEband = 1.565e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0504086956703, which took 0.048 ms

iter_count = 108, r_2norm = 1.740e-06, tol*||rhs|| = 2.016e-06

Anderson update took 63.357 ms, out of which F'*F took 29.580 ms; b-Ax took 203.118 ms, out of which Lap took 180.095 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.222 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776359, int_b + int_rho = -4.693e-13, checking this took 0.147 ms
2-norm of RHS = 603.2934590787490, which took 0.134 ms

iter_count = 168, r_2norm = 5.889e-04, tol*||rhs|| = 6.033e-04

Anderson update took 99.118 ms, out of which F'*F took 47.111 ms; b-Ax took 316.156 ms, out of which Lap took 282.980 ms
Solving Poisson took 700.803 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.081570 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.616 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.086883 
Total time for convolution: 	 convolve: 5.083012 
Total time for convolution: 	 convolve: 5.074184 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.348 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.684 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.324 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.033 ms

This SCF took 26917.209 ms, scf error = 4.473e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.137102, lowerbound = -0.703116, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1385.260 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.883 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.395 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.270 ms
rank =  0, Distribute data + matrix mult took 16.561 ms
rank =  0, finding HY took 21.271 ms
rank =  0, distributing HY into block cyclic form took 14.737 ms
rank =  0, finding Y'*HY took 2.301 ms
Rank 0, Project_Hamiltonian used 54.899 ms
Total time for projection: 54.924 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.547 ms
    first calculated eigval = -0.702935566746621
    last  calculated eigval = 0.038379196221168
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.70293556674662
lambda[   2] =  -0.62838222514759
lambda[   3] =  -0.46963517146253
lambda[   4] =  -0.40233413239573
lambda[   5] =  -0.38111487663467
lambda[   6] =  -0.38106699366732
lambda[   7] =  -0.23151927478906
lambda[   8] =  -0.23150813949370
lambda[   9] =  -0.02161824195823
lambda[  10] =   0.00774898191329
lambda[  11] =   0.00798073234895
lambda[  12] =   0.02283859779018
lambda[  13] =   0.03166482708563
lambda[  14] =   0.03837919622117
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.559 ms
rank =  0, subspace rotation using ScaLAPACK took 4.554 ms
rank =  0, Distributing orbital back into band + domain format took 13.614 ms
rank = 0, Subspace_Rotation used 18.183 ms

Total time for subspace rotation: 18.188 ms
rank = 0, Efermi =  -0.050891025612 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.489 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.725 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.071 ms
rank = 0, Calculating density took 1462.373 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.622 ms
rank = 0, D2D took 0.927 ms
rank = 0, Transfering density took 0.931 ms
Etot    =   -20.387374842689
Eband   =    -6.856992761058
E1      =    16.526095650387
E2      =    -5.858573199073
E3      =    -8.744064319097
Exc     =    -7.792681106249
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 7.451e-06, dEband = 4.142e-04
rank = 0, Calculating/Estimating energy took 1.091 ms, Etot = -20.387374843, dEtot = 7.451e-06, dEband = 4.142e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0489226797865, which took 0.075 ms

iter_count = 108, r_2norm = 1.597e-06, tol*||rhs|| = 1.957e-06

Anderson update took 64.069 ms, out of which F'*F took 30.063 ms; b-Ax took 202.292 ms, out of which Lap took 179.784 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.239 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776361, int_b + int_rho = -4.511e-13, checking this took 0.128 ms
2-norm of RHS = 603.2932300560814, which took 0.134 ms

iter_count = 138, r_2norm = 5.915e-04, tol*||rhs|| = 6.033e-04

Anderson update took 82.402 ms, out of which F'*F took 38.837 ms; b-Ax took 259.762 ms, out of which Lap took 233.099 ms
Solving Poisson took 575.547 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.074583 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.220 ms
Total time for convolution: 	 convolve: 5.075279 
Total time for convolution: 	 convolve: 5.077684 
Total time for convolution: 	 convolve: 5.079163 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.687 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.013 ms

This SCF took 26761.026 ms, scf error = 2.965e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.138379, lowerbound = -0.702936, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1388.635 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.956 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.519 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 16.515 ms
rank =  0, finding HY took 21.335 ms
rank =  0, distributing HY into block cyclic form took 14.709 ms
rank =  0, finding Y'*HY took 2.346 ms
Rank 0, Project_Hamiltonian used 55.431 ms
Total time for projection: 55.456 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.702747101716513
    last  calculated eigval = 0.038592732194723
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.70274710171651
lambda[   2] =  -0.62819426615633
lambda[   3] =  -0.46947610639988
lambda[   4] =  -0.40215198979389
lambda[   5] =  -0.38094930462103
lambda[   6] =  -0.38090152457862
lambda[   7] =  -0.23134867131952
lambda[   8] =  -0.23133750774880
lambda[   9] =  -0.02140044535026
lambda[  10] =   0.00782912030350
lambda[  11] =   0.00804945932512
lambda[  12] =   0.02265018446837
lambda[  13] =   0.03170927324843
lambda[  14] =   0.03859273219472
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 3.919 ms
rank =  0, Distributing orbital back into band + domain format took 14.077 ms
rank = 0, Subspace_Rotation used 18.007 ms

Total time for subspace rotation: 18.010 ms
rank = 0, Efermi =  -0.050673229005 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.550 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.748 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.072 ms
rank = 0, Calculating density took 1465.734 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.625 ms
rank = 0, D2D took 0.859 ms
rank = 0, Transfering density took 0.863 ms
Etot    =   -20.387398088803
Eband   =    -6.854212945049
E1      =    16.524517633266
E2      =    -5.857271908359
E3      =    -8.744431248614
Exc     =    -7.792971790054
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 3.321e-06, dEband = 3.971e-04
rank = 0, Calculating/Estimating energy took 1.115 ms, Etot = -20.387398089, dEtot = 3.321e-06, dEband = 3.971e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0340958607793, which took 0.084 ms

iter_count = 108, r_2norm = 1.291e-06, tol*||rhs|| = 1.364e-06

Anderson update took 63.358 ms, out of which F'*F took 29.599 ms; b-Ax took 202.538 ms, out of which Lap took 180.083 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.397 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776359, int_b + int_rho = -4.766e-13, checking this took 0.112 ms
2-norm of RHS = 603.2909475805686, which took 0.141 ms

iter_count = 132, r_2norm = 5.417e-04, tol*||rhs|| = 6.033e-04

Anderson update took 78.460 ms, out of which F'*F took 36.790 ms; b-Ax took 247.987 ms, out of which Lap took 222.374 ms
Solving Poisson took 550.966 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.074234 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.586 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.079497 
Total time for convolution: 	 convolve: 5.078791 
Total time for convolution: 	 convolve: 5.074234 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.409 ms
---Transfer Veff_loc: D2D took 0.681 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.007 ms

This SCF took 27229.157 ms, scf error = 2.253e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.138593, lowerbound = -0.702747, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1381.827 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.529 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.429 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 16.010 ms
rank =  0, finding HY took 21.177 ms
rank =  0, distributing HY into block cyclic form took 14.767 ms
rank =  0, finding Y'*HY took 2.298 ms
Rank 0, Project_Hamiltonian used 54.868 ms
Total time for projection: 54.895 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.702658138087231
    last  calculated eigval = 0.039300779996489
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.70265813808723
lambda[   2] =  -0.62810723849438
lambda[   3] =  -0.46938062039011
lambda[   4] =  -0.40206453929971
lambda[   5] =  -0.38086710304218
lambda[   6] =  -0.38081922985559
lambda[   7] =  -0.23125912499649
lambda[   8] =  -0.23124798000269
lambda[   9] =  -0.02059265702470
lambda[  10] =   0.00800930917204
lambda[  11] =   0.00821401660388
lambda[  12] =   0.02303248973828
lambda[  13] =   0.03224951163486
lambda[  14] =   0.03930077999649
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.917 ms
rank =  0, Distributing orbital back into band + domain format took 14.069 ms
rank = 0, Subspace_Rotation used 17.998 ms

Total time for subspace rotation: 18.002 ms
rank = 0, Efermi =  -0.049865440683 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 2.494 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.792 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1458.350 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.639 ms
rank = 0, D2D took 0.894 ms
rank = 0, Transfering density took 0.897 ms
Etot    =   -20.387411760849
Eband   =    -6.852807948703
E1      =    16.523804906617
E2      =    -5.856552876910
E3      =    -8.744512253254
Exc     =    -7.793039704989
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 1.953e-06, dEband = 2.007e-04
rank = 0, Calculating/Estimating energy took 1.082 ms, Etot = -20.387411761, dEtot = 1.953e-06, dEband = 2.007e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0200378622018, which took 0.067 ms

iter_count = 108, r_2norm = 6.261e-07, tol*||rhs|| = 8.015e-07

Anderson update took 63.895 ms, out of which F'*F took 30.094 ms; b-Ax took 202.360 ms, out of which Lap took 180.132 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.122 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776360, int_b + int_rho = -4.620e-13, checking this took 0.154 ms
2-norm of RHS = 603.2914273077845, which took 0.135 ms

iter_count = 150, r_2norm = 5.168e-04, tol*||rhs|| = 6.033e-04

Anderson update took 90.175 ms, out of which F'*F took 42.373 ms; b-Ax took 282.010 ms, out of which Lap took 253.077 ms
Solving Poisson took 625.899 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.076 ms
Total time for convolution: 	 convolve: 5.079596 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.106834 
Total time for convolution: 	 convolve: 5.075893 
Total time for convolution: 	 convolve: 5.074888 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.836 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.326 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.014 ms

This SCF took 26925.212 ms, scf error = 1.801e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.139301, lowerbound = -0.702658, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1322.242 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.759 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.521 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.067 ms
rank =  0, Distribute data + matrix mult took 16.361 ms
rank =  0, finding HY took 21.055 ms
rank =  0, distributing HY into block cyclic form took 14.746 ms
rank =  0, finding Y'*HY took 2.290 ms
Rank 0, Project_Hamiltonian used 54.480 ms
Total time for projection: 54.493 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.702481911796409
    last  calculated eigval = 0.040152955346691
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.70248191179641
lambda[   2] =  -0.62794194701627
lambda[   3] =  -0.46920202041792
lambda[   4] =  -0.40189315865009
lambda[   5] =  -0.38069903066939
lambda[   6] =  -0.38065119225312
lambda[   7] =  -0.23109010515798
lambda[   8] =  -0.23107911288201
lambda[   9] =  -0.02007953704029
lambda[  10] =   0.00792738154160
lambda[  11] =   0.00811550628098
lambda[  12] =   0.02350088778989
lambda[  13] =   0.03277401949060
lambda[  14] =   0.04015295534669
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.941 ms
rank =  0, Distributing orbital back into band + domain format took 14.099 ms
rank = 0, Subspace_Rotation used 18.056 ms

Total time for subspace rotation: 18.060 ms
rank = 0, Efermi =  -0.049352320654 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.480 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.803 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1398.399 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.619 ms
rank = 0, D2D took 0.913 ms
rank = 0, Transfering density took 0.919 ms
Etot    =   -20.387439143065
Eband   =    -6.850076958043
E1      =    16.522551406478
E2      =    -5.855001679156
E3      =    -8.744663401671
Exc     =    -7.793144528387
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 3.912e-06, dEband = 3.901e-04
rank = 0, Calculating/Estimating energy took 1.068 ms, Etot = -20.387439143, dEtot = 3.912e-06, dEband = 3.901e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0194905398566, which took 0.086 ms

iter_count = 108, r_2norm = 6.115e-07, tol*||rhs|| = 7.796e-07

Anderson update took 64.783 ms, out of which F'*F took 30.195 ms; b-Ax took 206.106 ms, out of which Lap took 183.173 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.783 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776358, int_b + int_rho = -4.802e-13, checking this took 0.133 ms
2-norm of RHS = 603.2911713652699, which took 0.149 ms

iter_count = 48, r_2norm = 5.818e-04, tol*||rhs|| = 6.033e-04

Anderson update took 28.463 ms, out of which F'*F took 13.403 ms; b-Ax took 90.196 ms, out of which Lap took 80.771 ms
Solving Poisson took 203.669 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.213434 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.374 ms
Total time for convolution: 	 convolve: 5.105641 
Total time for convolution: 	 convolve: 5.083218 
Total time for convolution: 	 convolve: 5.078134 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.826 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 1.477 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.326 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.828 ms

This SCF took 26504.913 ms, scf error = 1.420e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.140153, lowerbound = -0.702482, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1334.851 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.732 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.529 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 16.304 ms
rank =  0, finding HY took 21.152 ms
rank =  0, distributing HY into block cyclic form took 14.828 ms
rank =  0, finding Y'*HY took 2.251 ms
Rank 0, Project_Hamiltonian used 54.567 ms
Total time for projection: 54.586 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -0.702484640310797
    last  calculated eigval = 0.040000694800860
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.70248464031080
lambda[   2] =  -0.62794640014191
lambda[   3] =  -0.46920697935187
lambda[   4] =  -0.40189561332409
lambda[   5] =  -0.38070105861562
lambda[   6] =  -0.38065323708480
lambda[   7] =  -0.23109659907106
lambda[   8] =  -0.23108560214835
lambda[   9] =  -0.02012669731954
lambda[  10] =   0.00786822596145
lambda[  11] =   0.00805830287056
lambda[  12] =   0.02335854383832
lambda[  13] =   0.03242457797748
lambda[  14] =   0.04000069480086
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.911 ms
rank =  0, Distributing orbital back into band + domain format took 14.099 ms
rank = 0, Subspace_Rotation used 18.021 ms

Total time for subspace rotation: 18.025 ms
rank = 0, Efermi =  -0.049399480920 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.517 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.700 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.073 ms
rank = 0, Calculating density took 1411.062 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.598 ms
rank = 0, D2D took 0.951 ms
rank = 0, Transfering density took 0.955 ms
Etot    =   -20.387442629548
Eband   =    -6.850140260455
E1      =    16.522559110928
E2      =    -5.855056618690
E3      =    -8.744658089930
Exc     =    -7.793142044702
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 4.981e-07, dEband = 9.043e-06
rank = 0, Calculating/Estimating energy took 1.052 ms, Etot = -20.387442630, dEtot = 4.981e-07, dEband = 9.043e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0164116185863, which took 0.067 ms

iter_count = 108, r_2norm = 6.084e-07, tol*||rhs|| = 6.565e-07

Anderson update took 63.943 ms, out of which F'*F took 29.888 ms; b-Ax took 203.112 ms, out of which Lap took 180.448 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.526 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776359, int_b + int_rho = -4.729e-13, checking this took 0.077 ms
2-norm of RHS = 603.2908572967328, which took 0.101 ms

iter_count = 102, r_2norm = 5.606e-04, tol*||rhs|| = 6.033e-04

Anderson update took 61.223 ms, out of which F'*F took 28.818 ms; b-Ax took 191.365 ms, out of which Lap took 172.024 ms
Solving Poisson took 427.168 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.083124 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.084052 
Total time for convolution: 	 convolve: 5.076450 
Total time for convolution: 	 convolve: 5.076925 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.223 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.015 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.692 ms
---Transfer Veff_loc: D2D took 1.160 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.319 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.847 ms

This SCF took 26654.877 ms, scf error = 1.285e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.140001, lowerbound = -0.702485, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1386.835 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.675 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.545 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.079 ms
rank =  0, Distribute data + matrix mult took 16.314 ms
rank =  0, finding HY took 21.069 ms
rank =  0, distributing HY into block cyclic form took 14.691 ms
rank =  0, finding Y'*HY took 2.280 ms
Rank 0, Project_Hamiltonian used 54.386 ms
Total time for projection: 54.406 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.702457956185843
    last  calculated eigval = 0.040083154838690
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.70245795618584
lambda[   2] =  -0.62792024001580
lambda[   3] =  -0.46918051574776
lambda[   4] =  -0.40186714017235
lambda[   5] =  -0.38067017567360
lambda[   6] =  -0.38062249037973
lambda[   7] =  -0.23107762940661
lambda[   8] =  -0.23106664675178
lambda[   9] =  -0.02001030640334
lambda[  10] =   0.00780743692217
lambda[  11] =   0.00799523145754
lambda[  12] =   0.02343015387420
lambda[  13] =   0.03224940302706
lambda[  14] =   0.04008315483869
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.912 ms
rank =  0, Distributing orbital back into band + domain format took 14.142 ms
rank = 0, Subspace_Rotation used 18.067 ms

Total time for subspace rotation: 18.071 ms
rank = 0, Efermi =  -0.049283090056 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.570 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.688 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.072 ms
rank = 0, Calculating density took 1462.957 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.615 ms
rank = 0, D2D took 0.947 ms
rank = 0, Transfering density took 0.952 ms
Etot    =   -20.387443513771
Eband   =    -6.849725589022
E1      =    16.522310504885
E2      =    -5.854878801287
E3      =    -8.744719042578
Exc     =    -7.793192129559
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 1.263e-07, dEband = 5.924e-05
rank = 0, Calculating/Estimating energy took 1.056 ms, Etot = -20.387443514, dEtot = 1.263e-07, dEband = 5.924e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0154483367629, which took 0.058 ms

iter_count = 108, r_2norm = 6.128e-07, tol*||rhs|| = 6.179e-07

Anderson update took 63.519 ms, out of which F'*F took 29.931 ms; b-Ax took 203.512 ms, out of which Lap took 180.469 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.211 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776363, int_b + int_rho = -4.366e-13, checking this took 0.153 ms
2-norm of RHS = 603.2909721126487, which took 0.112 ms

iter_count = 36, r_2norm = 5.902e-04, tol*||rhs|| = 6.033e-04

Anderson update took 21.519 ms, out of which F'*F took 10.111 ms; b-Ax took 67.892 ms, out of which Lap took 60.888 ms
Solving Poisson took 153.392 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.080203 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.077497 
Total time for convolution: 	 convolve: 5.081918 
Total time for convolution: 	 convolve: 5.075447 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.888 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.691 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.321 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.039 ms

This SCF took 26359.874 ms, scf error = 1.123e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.140083, lowerbound = -0.702458, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1385.790 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.670 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.516 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.057 ms
rank =  0, Distribute data + matrix mult took 16.258 ms
rank =  0, finding HY took 21.239 ms
rank =  0, distributing HY into block cyclic form took 14.625 ms
rank =  0, finding Y'*HY took 2.342 ms
Rank 0, Project_Hamiltonian used 54.497 ms
Total time for projection: 54.519 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.702454837016874
    last  calculated eigval = 0.039791078525822
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.70245483701687
lambda[   2] =  -0.62791793880496
lambda[   3] =  -0.46918177792862
lambda[   4] =  -0.40186477756588
lambda[   5] =  -0.38066936479549
lambda[   6] =  -0.38062166882983
lambda[   7] =  -0.23107645465364
lambda[   8] =  -0.23106547350367
lambda[   9] =  -0.02023258763085
lambda[  10] =   0.00772511811372
lambda[  11] =   0.00791587248333
lambda[  12] =   0.02328408604031
lambda[  13] =   0.03164151998977
lambda[  14] =   0.03979107852582
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.919 ms
rank =  0, Distributing orbital back into band + domain format took 14.158 ms
rank = 0, Subspace_Rotation used 18.090 ms

Total time for subspace rotation: 18.094 ms
rank = 0, Efermi =  -0.049505371240 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.526 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.712 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1462.040 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.628 ms
rank = 0, D2D took 0.913 ms
rank = 0, Transfering density took 0.918 ms
Etot    =   -20.387453082250
Eband   =    -6.849704586557
E1      =    16.522284769762
E2      =    -5.854876829806
E3      =    -8.744705812774
Exc     =    -7.793181764096
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 1.367e-06, dEband = 3.000e-06
rank = 0, Calculating/Estimating energy took 1.478 ms, Etot = -20.387453082, dEtot = 1.367e-06, dEband = 3.000e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0123386468027, which took 0.065 ms

iter_count = 114, r_2norm = 3.349e-07, tol*||rhs|| = 4.935e-07

Anderson update took 66.991 ms, out of which F'*F took 31.923 ms; b-Ax took 214.379 ms, out of which Lap took 190.803 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.041 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776363, int_b + int_rho = -4.366e-13, checking this took 0.129 ms
2-norm of RHS = 603.2909290875525, which took 0.094 ms

iter_count = 84, r_2norm = 5.445e-04, tol*||rhs|| = 6.033e-04

Anderson update took 50.471 ms, out of which F'*F took 23.817 ms; b-Ax took 157.964 ms, out of which Lap took 142.036 ms
Solving Poisson took 352.920 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.078383 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.081955 
Total time for convolution: 	 convolve: 5.078105 
Total time for convolution: 	 convolve: 5.080450 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.039 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.684 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.310 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.014 ms

This SCF took 26588.078 ms, scf error = 1.054e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.139791, lowerbound = -0.702455, upperbound = 267.593633

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1384.405 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.692 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.536 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.048 ms
rank =  0, Distribute data + matrix mult took 16.292 ms
rank =  0, finding HY took 21.061 ms
rank =  0, distributing HY into block cyclic form took 14.699 ms
rank =  0, finding Y'*HY took 2.303 ms
Rank 0, Project_Hamiltonian used 54.383 ms
Total time for projection: 54.401 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -0.702462209561233
    last  calculated eigval = 0.039434263875055
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.70246220956123
lambda[   2] =  -0.62792385688025
lambda[   3] =  -0.46918722497541
lambda[   4] =  -0.40187111041814
lambda[   5] =  -0.38067677851634
lambda[   6] =  -0.38062909255707
lambda[   7] =  -0.23108441552316
lambda[   8] =  -0.23107344952394
lambda[   9] =  -0.02062485747542
lambda[  10] =   0.00754446436645
lambda[  11] =   0.00773928277488
lambda[  12] =   0.02307509755398
lambda[  13] =   0.03079522758309
lambda[  14] =   0.03943426387506
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.931 ms
rank =  0, Distributing orbital back into band + domain format took 14.081 ms
rank = 0, Subspace_Rotation used 18.024 ms

Total time for subspace rotation: 18.028 ms
rank = 0, Efermi =  -0.049897641092 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.536 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.747 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1460.447 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.014 ms
rank = 0, D2D took 2.120 ms
rank = 0, Transfering density took 2.125 ms
Etot    =   -20.387449665752
Eband   =    -6.849816276277
E1      =    16.522313845271
E2      =    -5.854960115365
E3      =    -8.744711233132
Exc     =    -7.793184439303
Esc     =   -36.866434143404
Entropy =    -0.000000000535
dE = 4.881e-07, dEband = 1.596e-05
rank = 0, Calculating/Estimating energy took 1.109 ms, Etot = -20.387449666, dEtot = 4.881e-07, dEband = 1.596e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0116159713328, which took 0.070 ms

iter_count = 114, r_2norm = 2.877e-07, tol*||rhs|| = 4.646e-07

Anderson update took 67.175 ms, out of which F'*F took 31.539 ms; b-Ax took 214.677 ms, out of which Lap took 190.805 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.415 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001776406, int_rho =  16.00000001776361, int_b + int_rho = -4.493e-13, checking this took 0.144 ms
2-norm of RHS = 603.2919165361783, which took 0.120 ms

iter_count = 90, r_2norm = 5.968e-04, tol*||rhs|| = 6.033e-04

Anderson update took 53.876 ms, out of which F'*F took 25.012 ms; b-Ax took 169.889 ms, out of which Lap took 152.570 ms
Solving Poisson took 378.483 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.077319 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.077070 
Total time for convolution: 	 convolve: 5.080268 
Total time for convolution: 	 convolve: 5.078581 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.817 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.670 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.000 ms

This SCF took 26608.804 ms, scf error = 9.565e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -0.70246220956123, occ[   1] =   2.00000000000000
lambda[   2] =  -0.62792385688025, occ[   2] =   2.00000000000000
lambda[   3] =  -0.46918722497541, occ[   3] =   2.00000000000000
lambda[   4] =  -0.40187111041814, occ[   4] =   2.00000000000000
lambda[   5] =  -0.38067677851634, occ[   5] =   2.00000000000000
lambda[   6] =  -0.38062909255707, occ[   6] =   2.00000000000000
lambda[   7] =  -0.23108441552316, occ[   7] =   2.00000000000000
lambda[   8] =  -0.23107344952394, occ[   8] =   2.00000000000000
lambda[   9] =  -0.02062485747542, occ[   9] =   0.00000001776360
lambda[  10] =   0.00754446436645, occ[  10] =   0.00000000000000
lambda[  11] =   0.00773928277488, occ[  11] =   0.00000000000000
lambda[  12] =   0.02307509755398, occ[  12] =   0.00000000000000
lambda[  13] =   0.03079522758309, occ[  13] =   0.00000000000000
lambda[  14] =   0.03943426387506, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.157 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.795 ms, time for Allreduce/Reduce: 3.938 ms 
Time for calculating local force components: 15.179 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000000562167   0.00002207239005  -0.05526278813149
  0.00000001165535  -0.04596381339853   0.01794038248748
 -0.03987928649082   0.02303406095054   0.01800330362249
  0.03987929440691   0.02303405362519   0.01800329319403
  0.00000007197802  -0.00001753240030   0.09054184894408
  0.00000008954027   0.00001022966642  -0.04696249528094
 -0.00000049733540   0.00013586742191   0.00591867702698
force_loc = 
  0.00000075035325  -0.00002238164569   0.05880572936671
 -0.00000001784887   0.04726129735875  -0.01815397418752
  0.04088910442040  -0.02360553788618  -0.01812485225216
 -0.04088880765018  -0.02360546837180  -0.01812492205433
  0.00000017078495  -0.00013331707423  -0.08614113379914
 -0.00000023957537  -0.00002775460765   0.01552331935510
  0.00000297932817  -0.00013036191760   0.02021617558712
Time for calculating nonlocal force components: 28.430 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000534787  -0.00000134088412  -0.00389783062298
[0m[32m -0.00000001084020   0.00000130658386   0.01472350700809
[0m[32m  0.00000013877785  -0.00000108763612  -0.01304563530010
[0mTime for calculating XC forces components: 20.092 ms
 Cartesian force = 
  0.00000021847865   0.00000107757657   0.00354828338330
 -0.00000054368978   0.00129887079244  -0.00020824955195
  0.00100928043332  -0.00057009010342  -0.00011620648159
 -0.00101005073953  -0.00057002791440  -0.00011628671222
 -0.00000028938542  -0.00015080352643   0.00050822667004
 -0.00000069837157  -0.00001483152515  -0.01671032676967
  0.00000208327434   0.00000580470040   0.01309455946208
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.375 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Time for printing density: 375.347 ms
The program took 545.542 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:31
Job ID:        2266573
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:54:36,vmem=8372K,walltime=00:09:33,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-16-2
---------------------------------------
