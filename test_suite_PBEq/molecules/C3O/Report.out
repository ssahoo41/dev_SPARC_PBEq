---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:43
Job ID:    2266467
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:49
Job ID:    2266467
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.060 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 12.039 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 4.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = C.psp8

Reading ion file took 21.593 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 109.816 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.941 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.139 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   13.532305	
   10.000000	   10.000000	    6.467695	
   10.000000	   10.000000	    8.887024	
   10.000000	   10.000000	   11.350498	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.211 ms
Set up communicators.

--set up spincomm took 3.816 ms

--set up kptcomm took 0.353 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.043 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.617 ms

Calculate_SplineDerivRadFun took 0.172 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.797 ms.
time spent on vectorized spline interp: 3.642 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.713 ms.
time spent on vectorized spline interp: 1.595 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.525 ms.

Calculating rb for all atom types took 12.280 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.182 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000045118, sum_int_rho = 17.9778479786611
PosCharge = 18.000000004512, NegCharge = -17.977847978661, scal_fac = 1.001232184513
After scaling, int_rho = 18.0000000045118, PosCharge + NegCharge - NetCharge = 1.066e-14
--Calculate Vref took 0.459 ms
--Calculate rho_guess took 2.652 ms

 integral of b = -18.0000000045118,
 int{b} + Nelectron + NetCharge = -4.512e-09,
 Esc = -55.0650194109162,
 MPI_Reduce took 1.624 ms

Calculating b & b_ref took 11.138 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.018 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.096 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.011 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.091 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.008 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.823 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.015 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 28.014 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451189, int_b + int_rho = -9.350e-13, checking this took 0.087 ms
2-norm of RHS = 495.1132784988390, which took 0.102 ms

iter_count = 426, r_2norm = 4.485e-04, tol*||rhs|| = 4.951e-04

Anderson update took 248.955 ms, out of which F'*F took 107.116 ms; b-Ax took 724.673 ms, out of which Lap took 650.980 ms
Solving Poisson took 1553.864 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
Total time for convolution: 	 convolve: 5.106117 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.737 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
Total time for convolution: 	 convolve: 5.159485 
Total time for convolution: 	 convolve: 5.108237 
Total time for convolution: 	 convolve: 5.102587 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.719 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.408 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
rank = 0, XC calculation took 24517.525 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.593 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.264 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.946 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.134 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.706 ms
    Lanczos iter 55, eigmin  = -1.134913882, eigmax = 264.935559898, err_eigmin = 2.764e-03, err_eigmax = 9.893e-03
rank =   0, Lanczos took 125.837 ms, eigmin = -1.134913881650, eigmax = 267.584915497394

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.175001, lowerbound = -1.234914, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1186.641 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 13.153 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.033 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.697 ms
rank =  0, Distribute data + matrix mult took 17.900 ms
rank =  0, finding HY took 20.417 ms
rank =  0, distributing HY into block cyclic form took 12.246 ms
rank =  0, finding Y'*HY took 5.430 ms
Rank 0, Project_Hamiltonian used 56.024 ms
Total time for projection: 56.038 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.574 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.650 ms
    first calculated eigval = 2.803518257096503
    last  calculated eigval = 3.191178199675053
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.80351825709650
lambda[   2] =   2.85559733146463
lambda[   3] =   2.86919845183333
lambda[   4] =   2.91373263735866
lambda[   5] =   2.93575982221267
lambda[   6] =   2.95343782809857
lambda[   7] =   2.98477491505314
lambda[   8] =   3.02053126604129
lambda[   9] =   3.04231786255800
lambda[  10] =   3.06192909431916
lambda[  11] =   3.09301940262640
lambda[  12] =   3.10676074777302
lambda[  13] =   3.13096747581168
lambda[  14] =   3.15410067944754
lambda[  15] =   3.19117819967505
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.666 ms
rank =  0, subspace rotation using ScaLAPACK took 3.562 ms
rank =  0, Distributing orbital back into band + domain format took 12.805 ms
rank = 0, Subspace_Rotation used 16.381 ms

Total time for subspace rotation: 16.385 ms
rank = 0, Efermi =   3.052123478549 calculate fermi energy took 0.064 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.291178, lowerbound = -1.234914, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1153.965 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 40.235 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.315 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.066 ms
rank =  0, Distribute data + matrix mult took 43.634 ms
rank =  0, finding HY took 19.408 ms
rank =  0, distributing HY into block cyclic form took 12.238 ms
rank =  0, finding Y'*HY took 4.155 ms
Rank 0, Project_Hamiltonian used 79.472 ms
Total time for projection: 79.512 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -0.985899030339731
    last  calculated eigval = 0.418965684387093
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98589903033973
lambda[   2] =  -0.48055304392198
lambda[   3] =  -0.34827993547338
lambda[   4] =  -0.14939417234226
lambda[   5] =  -0.06079545276113
lambda[   6] =   0.04693021724368
lambda[   7] =   0.11270901929633
lambda[   8] =   0.16680428410123
lambda[   9] =   0.21991381853668
lambda[  10] =   0.28324619724995
lambda[  11] =   0.32610451174602
lambda[  12] =   0.36824438162445
lambda[  13] =   0.37529720361326
lambda[  14] =   0.41192794551470
lambda[  15] =   0.41896568438709
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 3.537 ms
rank =  0, Distributing orbital back into band + domain format took 11.906 ms
rank = 0, Subspace_Rotation used 15.455 ms

Total time for subspace rotation: 15.459 ms
rank = 0, Efermi =   0.252814419965 calculate fermi energy took 0.044 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.518966, lowerbound = -1.234914, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1138.405 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 33.727 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.755 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 36.522 ms
rank =  0, finding HY took 19.478 ms
rank =  0, distributing HY into block cyclic form took 12.155 ms
rank =  0, finding Y'*HY took 4.156 ms
Rank 0, Project_Hamiltonian used 72.346 ms
Total time for projection: 72.350 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -1.153508616871674
    last  calculated eigval = 0.128877353067197
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.15350861687167
lambda[   2] =  -0.86979529583462
lambda[   3] =  -0.76210294037725
lambda[   4] =  -0.57237097692516
lambda[   5] =  -0.49996325080619
lambda[   6] =  -0.48356453931827
lambda[   7] =  -0.38113580205008
lambda[   8] =  -0.37444718199167
lambda[   9] =  -0.33264836439745
lambda[  10] =  -0.14948056264219
lambda[  11] =  -0.07929089240249
lambda[  12] =   0.07011576123060
lambda[  13] =   0.09315390618051
lambda[  14] =   0.11586148080690
lambda[  15] =   0.12887735306720
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.191 ms
rank =  0, subspace rotation using ScaLAPACK took 3.500 ms
rank =  0, Distributing orbital back into band + domain format took 12.050 ms
rank = 0, Subspace_Rotation used 15.563 ms

Total time for subspace rotation: 15.567 ms
rank = 0, Efermi =  -0.179957856476 calculate fermi energy took 0.652 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.228877, lowerbound = -1.234914, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1163.435 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 16.135 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.402 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 19.580 ms
rank =  0, finding HY took 19.350 ms
rank =  0, distributing HY into block cyclic form took 12.269 ms
rank =  0, finding Y'*HY took 4.158 ms
Rank 0, Project_Hamiltonian used 55.381 ms
Total time for projection: 55.386 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -1.153626134706693
    last  calculated eigval = 0.079611353720454
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.15362613470669
lambda[   2] =  -0.87110322519114
lambda[   3] =  -0.76359059954197
lambda[   4] =  -0.57629174521677
lambda[   5] =  -0.50623658397499
lambda[   6] =  -0.50610842800773
lambda[   7] =  -0.39021882654387
lambda[   8] =  -0.38992610363729
lambda[   9] =  -0.36523828306919
lambda[  10] =  -0.19849821324202
lambda[  11] =  -0.19187904940016
lambda[  12] =   0.00799891350908
lambda[  13] =   0.02643272481569
lambda[  14] =   0.06631428571938
lambda[  15] =   0.07961135372045
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 3.541 ms
rank =  0, Distributing orbital back into band + domain format took 12.029 ms
rank = 0, Subspace_Rotation used 15.582 ms

Total time for subspace rotation: 15.586 ms
rank = 0, Efermi =  -0.228975688382 calculate fermi energy took 0.024 ms
rank = 0, --- Calculate rho: sum over local bands took 3.307 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.770 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.162 ms
rank = 0, Calculating density took 5107.470 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.602 ms
rank = 0, D2D took 0.797 ms
rank = 0, Transfering density took 0.812 ms
Etot    =   -34.546795012647
Eband   =   -11.044679860675
E1      =    21.436769238109
E2      =    -9.261325878864
E3      =   -10.860626043813
Exc     =    -9.995816901701
Esc     =   -55.065019410916
Entropy =    -0.000000000141
dE = 8.637e+00, dEband = 2.761e+00
rank = 0, Calculating/Estimating energy took 0.980 ms, Etot = -34.546795013, dEtot = 8.637e+00, dEband = 2.761e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 44.4027990726497, which took 0.079 ms

iter_count = 96, r_2norm = 1.361e-03, tol*||rhs|| = 1.776e-03

Anderson update took 51.877 ms, out of which F'*F took 24.006 ms; b-Ax took 161.335 ms, out of which Lap took 144.829 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.791 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451184, int_b + int_rho = -9.932e-13, checking this took 0.093 ms
2-norm of RHS = 491.7730589279869, which took 0.102 ms

iter_count = 294, r_2norm = 4.294e-04, tol*||rhs|| = 4.918e-04

Anderson update took 155.552 ms, out of which F'*F took 74.017 ms; b-Ax took 504.210 ms, out of which Lap took 451.438 ms
Solving Poisson took 1059.812 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.831 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.115393 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.132917 
Total time for convolution: 	 convolve: 5.126772 
Total time for convolution: 	 convolve: 5.111428 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.363 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.176 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.339 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.859 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.220 ms

This SCF took 30983.700 ms, scf error = 1.658e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.179611, lowerbound = -1.153626, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1162.921 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.011 ms
rank =  0, Distribute orbital to block cyclic format took 34.836 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.308 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.064 ms
rank =  0, Distribute data + matrix mult took 38.222 ms
rank =  0, finding HY took 19.453 ms
rank =  0, distributing HY into block cyclic form took 12.177 ms
rank =  0, finding Y'*HY took 4.363 ms
Rank 0, Project_Hamiltonian used 74.250 ms
Total time for projection: 74.303 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -1.133603534140821
    last  calculated eigval = 0.054979944662850
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.13360353414082
lambda[   2] =  -0.83245877874937
lambda[   3] =  -0.72564646956019
lambda[   4] =  -0.55146642773615
lambda[   5] =  -0.49289993918800
lambda[   6] =  -0.49287381595225
lambda[   7] =  -0.35710381723713
lambda[   8] =  -0.35708886937139
lambda[   9] =  -0.33505790729168
lambda[  10] =  -0.18411097173143
lambda[  11] =  -0.18338561007502
lambda[  12] =  -0.01288169164558
lambda[  13] =   0.01994179536473
lambda[  14] =   0.03777054713947
lambda[  15] =   0.05497994466285
==subpsace eigenproblem: bcast eigvals took 0.050 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 3.534 ms
rank =  0, Distributing orbital back into band + domain format took 11.972 ms
rank = 0, Subspace_Rotation used 15.519 ms

Total time for subspace rotation: 15.524 ms
rank = 0, Efermi =  -0.214891559242 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.234 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.896 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.161 ms
rank = 0, Calculating density took 1259.406 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.517 ms
rank = 0, D2D took 1.018 ms
rank = 0, Transfering density took 1.030 ms
Etot    =   -34.487894014181
Eband   =   -10.556399119284
E1      =    21.019542275235
E2      =    -9.223915821997
E3      =   -10.989170095290
Exc     =   -10.099103676360
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 1.473e-02, dEband = 1.221e-01
rank = 0, Calculating/Estimating energy took 0.968 ms, Etot = -34.487894014, dEtot = 1.473e-02, dEband = 1.221e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 18.8493223041685, which took 0.062 ms

iter_count = 102, r_2norm = 5.399e-04, tol*||rhs|| = 7.540e-04

Anderson update took 55.111 ms, out of which F'*F took 25.401 ms; b-Ax took 173.180 ms, out of which Lap took 154.862 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.313 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451181, int_b + int_rho = -1.019e-12, checking this took 0.089 ms
2-norm of RHS = 489.4275128093279, which took 0.167 ms

iter_count = 300, r_2norm = 4.695e-04, tol*||rhs|| = 4.894e-04

Anderson update took 160.834 ms, out of which F'*F took 77.481 ms; b-Ax took 508.329 ms, out of which Lap took 455.820 ms
Solving Poisson took 1073.765 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.893 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.271709 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.238642 
Total time for convolution: 	 convolve: 5.327575 
Total time for convolution: 	 convolve: 5.242635 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.348 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.207 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.090 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.953 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.846 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.820 ms

This SCF took 27797.901 ms, scf error = 1.052e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.154980, lowerbound = -1.133604, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1161.136 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.101 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.678 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 15.813 ms
rank =  0, finding HY took 20.032 ms
rank =  0, distributing HY into block cyclic form took 12.314 ms
rank =  0, finding Y'*HY took 4.558 ms
Rank 0, Project_Hamiltonian used 52.749 ms
Total time for projection: 52.761 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -1.111698170537802
    last  calculated eigval = 0.050390379430780
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.11169817053780
lambda[   2] =  -0.78266139493840
lambda[   3] =  -0.66684376531067
lambda[   4] =  -0.52799674889717
lambda[   5] =  -0.47817172422369
lambda[   6] =  -0.47815544776472
lambda[   7] =  -0.31731819787677
lambda[   8] =  -0.31728020425217
lambda[   9] =  -0.28999131685389
lambda[  10] =  -0.15953185967209
lambda[  11] =  -0.15941585141625
lambda[  12] =  -0.02461157417133
lambda[  13] =   0.02465666503932
lambda[  14] =   0.03992583441795
lambda[  15] =   0.05039037943078
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 3.420 ms
rank =  0, Distributing orbital back into band + domain format took 11.989 ms
rank = 0, Subspace_Rotation used 15.426 ms

Total time for subspace rotation: 15.430 ms
rank = 0, Efermi =  -0.190545421454 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.182 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.890 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.168 ms
rank = 0, Calculating density took 1235.868 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.522 ms
rank = 0, D2D took 0.886 ms
rank = 0, Transfering density took 0.894 ms
Etot    =   -34.451188636931
Eband   =    -9.940233942030
E1      =    20.501148579004
E2      =    -9.127954957901
E3      =   -11.164412199340
Exc     =   -10.239451020086
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 9.176e-03, dEband = 1.540e-01
rank = 0, Calculating/Estimating energy took 1.026 ms, Etot = -34.451188637, dEtot = 9.176e-03, dEband = 1.540e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.3676775424896, which took 0.116 ms

iter_count = 102, r_2norm = 2.222e-04, tol*||rhs|| = 2.947e-04

Anderson update took 55.758 ms, out of which F'*F took 25.547 ms; b-Ax took 170.701 ms, out of which Lap took 153.883 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 377.063 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451183, int_b + int_rho = -9.968e-13, checking this took 0.114 ms
2-norm of RHS = 489.6444482184592, which took 0.089 ms

iter_count = 276, r_2norm = 4.553e-04, tol*||rhs|| = 4.896e-04

Anderson update took 150.582 ms, out of which F'*F took 70.062 ms; b-Ax took 465.111 ms, out of which Lap took 420.516 ms
Solving Poisson took 998.933 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.086850 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 30.567 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.152028 
Total time for convolution: 	 convolve: 5.103758 
Total time for convolution: 	 convolve: 5.098308 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.177 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 0.964 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.839 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.823 ms

This SCF took 27090.954 ms, scf error = 3.841e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.150390, lowerbound = -1.111698, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1180.526 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.165 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.342 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.528 ms
rank =  0, finding HY took 19.343 ms
rank =  0, distributing HY into block cyclic form took 11.817 ms
rank =  0, finding Y'*HY took 5.386 ms
Rank 0, Project_Hamiltonian used 52.107 ms
Total time for projection: 52.118 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.165 ms
    first calculated eigval = -1.097540215227671
    last  calculated eigval = 0.048540059435861
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.09754021522767
lambda[   2] =  -0.76559814653172
lambda[   3] =  -0.64900515200121
lambda[   4] =  -0.51524909133780
lambda[   5] =  -0.46782071645775
lambda[   6] =  -0.46779636604548
lambda[   7] =  -0.30639695491665
lambda[   8] =  -0.30635624150683
lambda[   9] =  -0.27557676906299
lambda[  10] =  -0.14862519892218
lambda[  11] =  -0.14861175245356
lambda[  12] =  -0.02913311656671
lambda[  13] =   0.02081680987108
lambda[  14] =   0.03899301396369
lambda[  15] =   0.04854005943586
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 3.463 ms
rank =  0, Distributing orbital back into band + domain format took 12.028 ms
rank = 0, Subspace_Rotation used 15.504 ms

Total time for subspace rotation: 15.509 ms
rank = 0, Efermi =  -0.179688133846 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 2.150 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.529 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.258 ms
rank = 0, Calculating density took 1255.380 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.621 ms
rank = 0, D2D took 0.833 ms
rank = 0, Transfering density took 0.837 ms
Etot    =   -34.446599441337
Eband   =    -9.702679306847
E1      =    20.323630420923
E2      =    -9.057427097049
E3      =   -11.233006585807
Exc     =   -10.292964827209
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 1.147e-03, dEband = 5.939e-02
rank = 0, Calculating/Estimating energy took 1.823 ms, Etot = -34.446599441, dEtot = 1.147e-03, dEband = 5.939e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.1496999043052, which took 0.051 ms

iter_count = 108, r_2norm = 7.277e-05, tol*||rhs|| = 8.599e-05

Anderson update took 58.398 ms, out of which F'*F took 27.183 ms; b-Ax took 184.362 ms, out of which Lap took 166.067 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.240 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451180, int_b + int_rho = -1.030e-12, checking this took 0.098 ms
2-norm of RHS = 490.6242179296697, which took 0.113 ms

iter_count = 264, r_2norm = 4.791e-04, tol*||rhs|| = 4.906e-04

Anderson update took 141.712 ms, out of which F'*F took 66.530 ms; b-Ax took 449.302 ms, out of which Lap took 402.618 ms
Solving Poisson took 951.635 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Total time for convolution: 	 convolve: 5.096951 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.095175 
Total time for convolution: 	 convolve: 5.097648 
Total time for convolution: 	 convolve: 5.104822 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.047 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 0.965 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.803 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.791 ms

This SCF took 27008.688 ms, scf error = 1.689e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.148540, lowerbound = -1.097540, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1161.475 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.500 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.381 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.043 ms
rank =  0, Distribute data + matrix mult took 18.937 ms
rank =  0, finding HY took 19.360 ms
rank =  0, distributing HY into block cyclic form took 11.914 ms
rank =  0, finding Y'*HY took 4.360 ms
Rank 0, Project_Hamiltonian used 54.601 ms
Total time for projection: 54.615 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -1.090697104203432
    last  calculated eigval = 0.045725090439578
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.09069710420343
lambda[   2] =  -0.76191007132322
lambda[   3] =  -0.64563933526169
lambda[   4] =  -0.50927083469875
lambda[   5] =  -0.46267357652311
lambda[   6] =  -0.46265614398091
lambda[   7] =  -0.30466951443044
lambda[   8] =  -0.30464267568214
lambda[   9] =  -0.27028951375863
lambda[  10] =  -0.14400942152839
lambda[  11] =  -0.14400265227009
lambda[  12] =  -0.03102735595449
lambda[  13] =   0.01917185622667
lambda[  14] =   0.03381798475939
lambda[  15] =   0.04572509043958
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 3.509 ms
rank =  0, Distributing orbital back into band + domain format took 11.971 ms
rank = 0, Subspace_Rotation used 15.496 ms

Total time for subspace rotation: 15.501 ms
rank = 0, Efermi =  -0.175075675514 calculate fermi energy took 2.308 ms
rank = 0, --- Calculate rho: sum over local bands took 3.042 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.981 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.157 ms
rank = 0, Calculating density took 1239.316 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.671 ms
rank = 0, D2D took 1.778 ms
rank = 0, Transfering density took 1.785 ms
Etot    =   -34.445431901380
Eband   =    -9.624897540374
E1      =    20.286966165559
E2      =    -9.011076868973
E3      =   -11.254963602475
Exc     =   -10.308521586952
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 2.919e-04, dEband = 1.945e-02
rank = 0, Calculating/Estimating energy took 0.899 ms, Etot = -34.445431901, dEtot = 2.919e-04, dEband = 1.945e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9979428519130, which took 0.049 ms

iter_count = 114, r_2norm = 2.802e-05, tol*||rhs|| = 3.992e-05

Anderson update took 61.904 ms, out of which F'*F took 28.734 ms; b-Ax took 192.163 ms, out of which Lap took 173.337 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.129 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451181, int_b + int_rho = -1.015e-12, checking this took 0.104 ms
2-norm of RHS = 491.2448488720256, which took 0.125 ms

iter_count = 252, r_2norm = 4.496e-04, tol*||rhs|| = 4.912e-04

Anderson update took 135.402 ms, out of which F'*F took 63.693 ms; b-Ax took 425.008 ms, out of which Lap took 381.942 ms
Solving Poisson took 907.015 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 6.807631 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.098891 
Total time for convolution: 	 convolve: 5.096255 
Total time for convolution: 	 convolve: 5.100024 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.593 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.109 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.944 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.331 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.297 ms

This SCF took 28679.608 ms, scf error = 7.123e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.145725, lowerbound = -1.090697, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1151.373 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.095 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.285 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.064 ms
rank =  0, Distribute data + matrix mult took 15.459 ms
rank =  0, finding HY took 19.532 ms
rank =  0, distributing HY into block cyclic form took 12.062 ms
rank =  0, finding Y'*HY took 4.237 ms
Rank 0, Project_Hamiltonian used 51.320 ms
Total time for projection: 51.333 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.106 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -1.090027854112665
    last  calculated eigval = 0.041391924647636
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.09002785411267
lambda[   2] =  -0.76074239024875
lambda[   3] =  -0.64397719377916
lambda[   4] =  -0.50805302602834
lambda[   5] =  -0.46215027296835
lambda[   6] =  -0.46214344050804
lambda[   7] =  -0.30323989405861
lambda[   8] =  -0.30322975644896
lambda[   9] =  -0.26680117694617
lambda[  10] =  -0.14255094123149
lambda[  11] =  -0.14254734710567
lambda[  12] =  -0.03196713725340
lambda[  13] =   0.01841030910546
lambda[  14] =   0.02978793272268
lambda[  15] =   0.04139192464764
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 3.537 ms
rank =  0, Distributing orbital back into band + domain format took 11.944 ms
rank = 0, Subspace_Rotation used 15.497 ms

Total time for subspace rotation: 15.502 ms
rank = 0, Efermi =  -0.173618778067 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.250 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.062 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.163 ms
rank = 0, Calculating density took 1225.058 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
rank = 0, D2D took 0.831 ms
rank = 0, Transfering density took 0.840 ms
Etot    =   -34.445100939970
Eband   =    -9.600730010841
E1      =    20.284428665427
E2      =    -8.987056911611
E3      =   -11.261978811423
Exc     =   -10.312815906530
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 8.274e-05, dEband = 6.042e-03
rank = 0, Calculating/Estimating energy took 1.112 ms, Etot = -34.445100940, dEtot = 8.274e-05, dEband = 6.042e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4605216601292, which took 0.061 ms

iter_count = 114, r_2norm = 1.259e-05, tol*||rhs|| = 1.842e-05

Anderson update took 61.422 ms, out of which F'*F took 28.622 ms; b-Ax took 194.144 ms, out of which Lap took 173.431 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.619 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451182, int_b + int_rho = -1.008e-12, checking this took 0.104 ms
2-norm of RHS = 491.7436096324095, which took 0.126 ms

iter_count = 252, r_2norm = 4.467e-04, tol*||rhs|| = 4.917e-04

Anderson update took 137.406 ms, out of which F'*F took 62.612 ms; b-Ax took 426.586 ms, out of which Lap took 381.158 ms
Solving Poisson took 906.846 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.108225 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.095467 
Total time for convolution: 	 convolve: 5.137744 
Total time for convolution: 	 convolve: 5.098037 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.014 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.947 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.336 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.304 ms

This SCF took 26993.845 ms, scf error = 4.516e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.141392, lowerbound = -1.090028, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1160.762 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 15.585 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.346 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 18.960 ms
rank =  0, finding HY took 19.391 ms
rank =  0, distributing HY into block cyclic form took 12.019 ms
rank =  0, finding Y'*HY took 4.225 ms
Rank 0, Project_Hamiltonian used 54.628 ms
Total time for projection: 54.652 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -1.089276253143711
    last  calculated eigval = 0.037175822490813
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08927625314371
lambda[   2] =  -0.75924258536192
lambda[   3] =  -0.64284942996880
lambda[   4] =  -0.50683035697943
lambda[   5] =  -0.46135452931120
lambda[   6] =  -0.46135271642206
lambda[   7] =  -0.30179287780242
lambda[   8] =  -0.30179009412025
lambda[   9] =  -0.26449273394395
lambda[  10] =  -0.14142218253171
lambda[  11] =  -0.14142159522152
lambda[  12] =  -0.03230903543232
lambda[  13] =   0.01833605607220
lambda[  14] =   0.02703688156595
lambda[  15] =   0.03717582249081
==subpsace eigenproblem: bcast eigvals took 0.053 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 3.479 ms
rank =  0, Distributing orbital back into band + domain format took 11.614 ms
rank = 0, Subspace_Rotation used 15.106 ms

Total time for subspace rotation: 15.120 ms
rank = 0, Efermi =  -0.172491521062 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 3.052 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.208 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.245 ms
rank = 0, Calculating density took 1238.400 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.286 ms
rank = 0, D2D took 1.394 ms
rank = 0, Transfering density took 1.400 ms
Etot    =   -34.444939054658
Eband   =    -9.577963154746
E1      =    20.283627045127
E2      =    -8.962966446978
E3      =   -11.266942281278
Exc     =   -10.315492262235
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 4.047e-05, dEband = 5.692e-03
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -34.444939055, dEtot = 4.047e-05, dEband = 5.692e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3221437093759, which took 0.052 ms

iter_count = 114, r_2norm = 7.830e-06, tol*||rhs|| = 1.289e-05

Anderson update took 61.440 ms, out of which F'*F took 28.636 ms; b-Ax took 194.053 ms, out of which Lap took 173.326 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.646 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451180, int_b + int_rho = -1.026e-12, checking this took 0.107 ms
2-norm of RHS = 491.7108629289043, which took 0.124 ms

iter_count = 234, r_2norm = 4.570e-04, tol*||rhs|| = 4.917e-04

Anderson update took 125.821 ms, out of which F'*F took 58.712 ms; b-Ax took 397.584 ms, out of which Lap took 356.274 ms
Solving Poisson took 843.234 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Total time for convolution: 	 convolve: 5.093476 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.105504 
Total time for convolution: 	 convolve: 5.094849 
Total time for convolution: 	 convolve: 5.096112 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.540 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.955 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.375 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.351 ms

This SCF took 26949.081 ms, scf error = 2.199e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.137176, lowerbound = -1.089276, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1178.141 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.214 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.232 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 15.472 ms
rank =  0, finding HY took 19.406 ms
rank =  0, distributing HY into block cyclic form took 11.931 ms
rank =  0, finding Y'*HY took 4.255 ms
Rank 0, Project_Hamiltonian used 51.095 ms
Total time for projection: 51.109 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -1.088409138738168
    last  calculated eigval = 0.032978189514713
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08840913873817
lambda[   2] =  -0.75735674390012
lambda[   3] =  -0.64070163238156
lambda[   4] =  -0.50593889967663
lambda[   5] =  -0.46059463297170
lambda[   6] =  -0.46059377493008
lambda[   7] =  -0.30009464031011
lambda[   8] =  -0.30009322008748
lambda[   9] =  -0.26185140698675
lambda[  10] =  -0.13993286457571
lambda[  11] =  -0.13993279480045
lambda[  12] =  -0.03219486105060
lambda[  13] =   0.01792785684751
lambda[  14] =   0.02493860579498
lambda[  15] =   0.03297818951471
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 3.974 ms
rank =  0, Distributing orbital back into band + domain format took 11.570 ms
rank = 0, Subspace_Rotation used 15.563 ms

Total time for subspace rotation: 15.579 ms
rank = 0, Efermi =  -0.171002461780 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.010 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.201 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.239 ms
rank = 0, Calculating density took 1252.059 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.603 ms
rank = 0, D2D took 0.713 ms
rank = 0, Transfering density took 0.718 ms
Etot    =   -34.444982682129
Eband   =    -9.551268180597
E1      =    20.267045896066
E2      =    -8.951316117882
E3      =   -11.272914258858
Exc     =   -10.319971363279
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 1.091e-05, dEband = 6.674e-03
rank = 0, Calculating/Estimating energy took 0.953 ms, Etot = -34.444982682, dEtot = 1.091e-05, dEband = 6.674e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2116516024275, which took 0.052 ms

iter_count = 108, r_2norm = 7.642e-06, tol*||rhs|| = 8.466e-06

Anderson update took 57.996 ms, out of which F'*F took 26.842 ms; b-Ax took 184.284 ms, out of which Lap took 164.511 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.985 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451183, int_b + int_rho = -1.000e-12, checking this took 0.098 ms
2-norm of RHS = 491.6672315215311, which took 0.116 ms

iter_count = 228, r_2norm = 4.457e-04, tol*||rhs|| = 4.917e-04

Anderson update took 122.786 ms, out of which F'*F took 57.176 ms; b-Ax took 388.575 ms, out of which Lap took 348.203 ms
Solving Poisson took 821.431 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.095257 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.587 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.105630 
Total time for convolution: 	 convolve: 5.097987 
Total time for convolution: 	 convolve: 5.106489 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.601 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.973 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.342 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.339 ms

This SCF took 26895.707 ms, scf error = 1.706e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.132978, lowerbound = -1.088409, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1148.753 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.173 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.290 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 22.485 ms
rank =  0, finding HY took 19.457 ms
rank =  0, distributing HY into block cyclic form took 12.058 ms
rank =  0, finding Y'*HY took 4.164 ms
Rank 0, Project_Hamiltonian used 58.190 ms
Total time for projection: 58.201 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 1.134 ms
    first calculated eigval = -1.087048452838810
    last  calculated eigval = 0.030858613016477
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08704845283881
lambda[   2] =  -0.75626427215307
lambda[   3] =  -0.63973874415488
lambda[   4] =  -0.50467928747550
lambda[   5] =  -0.45941419591981
lambda[   6] =  -0.45941383689865
lambda[   7] =  -0.29908482185823
lambda[   8] =  -0.29908445324838
lambda[   9] =  -0.26047647838319
lambda[  10] =  -0.13875827034902
lambda[  11] =  -0.13875816847039
lambda[  12] =  -0.03075967772034
lambda[  13] =   0.01877174184059
lambda[  14] =   0.02439326061749
lambda[  15] =   0.03085861301648
==subpsace eigenproblem: bcast eigvals took 0.492 ms
Total time for solving subspace eigenvalue problem: 1.637 ms
rank =  0, subspace rotation using ScaLAPACK took 3.411 ms
rank =  0, Distributing orbital back into band + domain format took 12.312 ms
rank = 0, Subspace_Rotation used 15.743 ms

Total time for subspace rotation: 15.750 ms
rank = 0, Efermi =  -0.169827851555 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 3.060 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.239 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.150 ms
rank = 0, Calculating density took 1230.932 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.587 ms
rank = 0, D2D took 0.743 ms
rank = 0, Transfering density took 0.751 ms
Etot    =   -34.445051954123
Eband   =    -9.530409086487
E1      =    20.255651190808
E2      =    -8.940890322852
E3      =   -11.276320590804
Exc     =   -10.322485561039
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 1.732e-05, dEband = 5.215e-03
rank = 0, Calculating/Estimating energy took 1.212 ms, Etot = -34.445051954, dEtot = 1.732e-05, dEband = 5.215e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1476677410144, which took 0.063 ms

iter_count = 114, r_2norm = 3.702e-06, tol*||rhs|| = 5.907e-06

Anderson update took 61.278 ms, out of which F'*F took 28.564 ms; b-Ax took 193.741 ms, out of which Lap took 172.820 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.930 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451181, int_b + int_rho = -1.015e-12, checking this took 0.102 ms
2-norm of RHS = 491.6734295162437, which took 0.105 ms

iter_count = 204, r_2norm = 4.823e-04, tol*||rhs|| = 4.917e-04

Anderson update took 109.935 ms, out of which F'*F took 50.996 ms; b-Ax took 346.980 ms, out of which Lap took 310.796 ms
Solving Poisson took 735.672 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.098336 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.093647 
Total time for convolution: 	 convolve: 5.108882 
Total time for convolution: 	 convolve: 5.099949 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.976 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.341 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.349 ms

This SCF took 26878.691 ms, scf error = 8.824e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.130859, lowerbound = -1.087048, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1131.032 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.283 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.341 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 22.643 ms
rank =  0, finding HY took 19.419 ms
rank =  0, distributing HY into block cyclic form took 11.927 ms
rank =  0, finding Y'*HY took 3.770 ms
Rank 0, Project_Hamiltonian used 58.308 ms
Total time for projection: 58.326 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.165 ms
    first calculated eigval = -1.086114833760951
    last  calculated eigval = 0.029711654194364
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08611483376095
lambda[   2] =  -0.75568438867993
lambda[   3] =  -0.63925858220153
lambda[   4] =  -0.50381231222045
lambda[   5] =  -0.45857727417350
lambda[   6] =  -0.45857710446426
lambda[   7] =  -0.29851421333257
lambda[   8] =  -0.29851389873050
lambda[   9] =  -0.26010664359084
lambda[  10] =  -0.13816357490171
lambda[  11] =  -0.13816348836786
lambda[  12] =  -0.02929471489906
lambda[  13] =   0.01911525804982
lambda[  14] =   0.02464679203880
lambda[  15] =   0.02971165419436
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 3.522 ms
rank =  0, Distributing orbital back into band + domain format took 12.274 ms
rank = 0, Subspace_Rotation used 15.812 ms

Total time for subspace rotation: 15.818 ms
rank = 0, Efermi =  -0.169233163653 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.104 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.202 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 1211.948 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.676 ms
rank = 0, D2D took 0.820 ms
rank = 0, Transfering density took 0.827 ms
Etot    =   -34.445160473859
Eband   =    -9.518318502932
E1      =    20.249640176686
E2      =    -8.934444956992
E3      =   -11.277424340700
Exc     =   -10.323332034245
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 2.713e-05, dEband = 3.023e-03
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -34.445160474, dEtot = 2.713e-05, dEband = 3.023e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1124127177410, which took 0.052 ms

iter_count = 108, r_2norm = 2.838e-06, tol*||rhs|| = 4.497e-06

Anderson update took 58.094 ms, out of which F'*F took 27.036 ms; b-Ax took 184.579 ms, out of which Lap took 165.005 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.886 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451183, int_b + int_rho = -1.004e-12, checking this took 0.100 ms
2-norm of RHS = 491.7300008684620, which took 0.102 ms

iter_count = 216, r_2norm = 4.111e-04, tol*||rhs|| = 4.917e-04

Anderson update took 116.281 ms, out of which F'*F took 54.227 ms; b-Ax took 367.807 ms, out of which Lap took 329.740 ms
Solving Poisson took 779.124 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.131108 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.133089 
Total time for convolution: 	 convolve: 5.098748 
Total time for convolution: 	 convolve: 5.092314 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.951 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.332 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.305 ms

This SCF took 26844.297 ms, scf error = 7.352e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129712, lowerbound = -1.086115, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1152.582 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 19.182 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.358 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 22.563 ms
rank =  0, finding HY took 19.356 ms
rank =  0, distributing HY into block cyclic form took 12.040 ms
rank =  0, finding Y'*HY took 4.201 ms
Rank 0, Project_Hamiltonian used 58.671 ms
Total time for projection: 58.695 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.107 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -1.085265618088174
    last  calculated eigval = 0.030996410402447
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08526561808817
lambda[   2] =  -0.75458328683108
lambda[   3] =  -0.63810801625978
lambda[   4] =  -0.50304179738454
lambda[   5] =  -0.45771841256644
lambda[   6] =  -0.45771821826878
lambda[   7] =  -0.29748888847426
lambda[   8] =  -0.29748863402247
lambda[   9] =  -0.25910635638520
lambda[  10] =  -0.13720988086496
lambda[  11] =  -0.13720980846056
lambda[  12] =  -0.02566516710661
lambda[  13] =   0.02019691609293
lambda[  14] =   0.02789140355190
lambda[  15] =   0.03099641040245
==subpsace eigenproblem: bcast eigvals took 0.045 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 3.554 ms
rank =  0, Distributing orbital back into band + domain format took 11.883 ms
rank = 0, Subspace_Rotation used 15.450 ms

Total time for subspace rotation: 15.456 ms
rank = 0, Efermi =  -0.168279476744 calculate fermi energy took 0.072 ms
rank = 0, --- Calculate rho: sum over local bands took 3.000 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.271 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.153 ms
rank = 0, Calculating density took 1233.516 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
rank = 0, D2D took 0.865 ms
rank = 0, Transfering density took 0.875 ms
Etot    =   -34.445240609977
Eband   =    -9.501038457181
E1      =    20.241455658973
E2      =    -8.924921380277
E3      =   -11.279025055280
Exc     =   -10.324584836267
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 2.003e-05, dEband = 4.320e-03
rank = 0, Calculating/Estimating energy took 1.043 ms, Etot = -34.445240610, dEtot = 2.003e-05, dEband = 4.320e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0867267252522, which took 0.122 ms

iter_count = 108, r_2norm = 2.734e-06, tol*||rhs|| = 3.469e-06

Anderson update took 58.225 ms, out of which F'*F took 27.087 ms; b-Ax took 183.727 ms, out of which Lap took 164.079 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.206 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451181, int_b + int_rho = -1.015e-12, checking this took 0.102 ms
2-norm of RHS = 491.7264346165989, which took 0.116 ms

iter_count = 162, r_2norm = 4.168e-04, tol*||rhs|| = 4.917e-04

Anderson update took 87.303 ms, out of which F'*F took 40.676 ms; b-Ax took 276.551 ms, out of which Lap took 248.089 ms
Solving Poisson took 585.523 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.112 ms
Total time for convolution: 	 convolve: 5.095646 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.094310 
Total time for convolution: 	 convolve: 5.106799 
Total time for convolution: 	 convolve: 5.101308 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.969 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.349 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.342 ms

This SCF took 26609.901 ms, scf error = 3.563e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.130996, lowerbound = -1.085266, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1136.240 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.493 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.335 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 21.848 ms
rank =  0, finding HY took 19.333 ms
rank =  0, distributing HY into block cyclic form took 12.050 ms
rank =  0, finding Y'*HY took 4.182 ms
Rank 0, Project_Hamiltonian used 57.454 ms
Total time for projection: 57.470 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -1.085003941562536
    last  calculated eigval = 0.031354891716840
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08500394156254
lambda[   2] =  -0.75432673418518
lambda[   3] =  -0.63783952564228
lambda[   4] =  -0.50280038801685
lambda[   5] =  -0.45747913347371
lambda[   6] =  -0.45747906100047
lambda[   7] =  -0.29724585998024
lambda[   8] =  -0.29724567468909
lambda[   9] =  -0.25885526251606
lambda[  10] =  -0.13696964008006
lambda[  11] =  -0.13696957206238
lambda[  12] =  -0.02451774662395
lambda[  13] =   0.02030253051659
lambda[  14] =   0.02888635107469
lambda[  15] =   0.03135489171684
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 3.536 ms
rank =  0, Distributing orbital back into band + domain format took 11.940 ms
rank = 0, Subspace_Rotation used 15.488 ms

Total time for subspace rotation: 15.492 ms
rank = 0, Efermi =  -0.168039238485 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 3.011 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.294 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.159 ms
rank = 0, Calculating density took 1215.976 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.588 ms
rank = 0, D2D took 0.787 ms
rank = 0, Transfering density took 0.795 ms
Etot    =   -34.445258514493
Eband   =    -9.496551162751
E1      =    20.238933165083
E2      =    -8.922816630020
E3      =   -11.279614396514
Exc     =   -10.325052132300
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 4.476e-06, dEband = 1.122e-03
rank = 0, Calculating/Estimating energy took 1.070 ms, Etot = -34.445258514, dEtot = 4.476e-06, dEband = 1.122e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0474799277027, which took 0.057 ms

iter_count = 108, r_2norm = 1.507e-06, tol*||rhs|| = 1.899e-06

Anderson update took 58.212 ms, out of which F'*F took 27.084 ms; b-Ax took 183.793 ms, out of which Lap took 164.203 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.516 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451177, int_b + int_rho = -1.062e-12, checking this took 0.099 ms
2-norm of RHS = 491.7356092303357, which took 0.094 ms

iter_count = 198, r_2norm = 3.942e-04, tol*||rhs|| = 4.917e-04

Anderson update took 106.822 ms, out of which F'*F took 49.793 ms; b-Ax took 337.685 ms, out of which Lap took 302.881 ms
Solving Poisson took 715.379 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.096249 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.100925 
Total time for convolution: 	 convolve: 5.096182 
Total time for convolution: 	 convolve: 5.093293 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 1.740 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.345 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.111 ms

This SCF took 26707.438 ms, scf error = 3.085e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.131355, lowerbound = -1.085004, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1167.589 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 21.616 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.393 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 25.028 ms
rank =  0, finding HY took 19.322 ms
rank =  0, distributing HY into block cyclic form took 11.909 ms
rank =  0, finding Y'*HY took 4.297 ms
Rank 0, Project_Hamiltonian used 60.594 ms
Total time for projection: 60.606 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -1.084411710543404
    last  calculated eigval = 0.035080746855836
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08441171054340
lambda[   2] =  -0.75370662545061
lambda[   3] =  -0.63722356097101
lambda[   4] =  -0.50223992711465
lambda[   5] =  -0.45689331498460
lambda[   6] =  -0.45689323857940
lambda[   7] =  -0.29664741267512
lambda[   8] =  -0.29664728066801
lambda[   9] =  -0.25828791602950
lambda[  10] =  -0.13638803941868
lambda[  11] =  -0.13638801704619
lambda[  12] =  -0.02138448963656
lambda[  13] =   0.02039678983232
lambda[  14] =   0.03242253997160
lambda[  15] =   0.03508074685584
==subpsace eigenproblem: bcast eigvals took 0.045 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 3.521 ms
rank =  0, Distributing orbital back into band + domain format took 11.981 ms
rank = 0, Subspace_Rotation used 15.518 ms

Total time for subspace rotation: 15.524 ms
rank = 0, Efermi =  -0.167457660458 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.012 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.304 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.149 ms
rank = 0, Calculating density took 1250.514 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
rank = 0, D2D took 0.758 ms
rank = 0, Transfering density took 0.762 ms
Etot    =   -34.445331757475
Eband   =    -9.485901974648
E1      =    20.233925720943
E2      =    -8.916938381297
E3      =   -11.280368105517
Exc     =   -10.325642579524
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 1.831e-05, dEband = 2.662e-03
rank = 0, Calculating/Estimating energy took 1.163 ms, Etot = -34.445331757, dEtot = 1.831e-05, dEband = 2.662e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0536711337802, which took 0.059 ms

iter_count = 102, r_2norm = 1.931e-06, tol*||rhs|| = 2.147e-06

Anderson update took 54.734 ms, out of which F'*F took 25.978 ms; b-Ax took 175.709 ms, out of which Lap took 157.177 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.002 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451183, int_b + int_rho = -9.968e-13, checking this took 0.076 ms
2-norm of RHS = 491.7339365802322, which took 0.135 ms

iter_count = 162, r_2norm = 4.520e-04, tol*||rhs|| = 4.917e-04

Anderson update took 87.283 ms, out of which F'*F took 40.642 ms; b-Ax took 275.472 ms, out of which Lap took 246.735 ms
Solving Poisson took 584.619 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.096393 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.097212 
Total time for convolution: 	 convolve: 5.100255 
Total time for convolution: 	 convolve: 5.092431 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.851 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.386 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.459 ms
---Transfer Veff_loc: D2D took 0.925 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.349 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.297 ms

This SCF took 26585.634 ms, scf error = 1.881e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135081, lowerbound = -1.084412, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1154.534 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.651 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.275 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.253 ms
rank =  0, Distribute data + matrix mult took 18.198 ms
rank =  0, finding HY took 19.388 ms
rank =  0, distributing HY into block cyclic form took 12.015 ms
rank =  0, finding Y'*HY took 4.210 ms
Rank 0, Project_Hamiltonian used 53.843 ms
Total time for projection: 53.905 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.100 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -1.084350854933407
    last  calculated eigval = 0.037018587653269
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08435085493341
lambda[   2] =  -0.75358428715567
lambda[   3] =  -0.63710174739748
lambda[   4] =  -0.50215859982843
lambda[   5] =  -0.45680869461174
lambda[   6] =  -0.45680853060666
lambda[   7] =  -0.29651414393215
lambda[   8] =  -0.29651402508294
lambda[   9] =  -0.25816086104135
lambda[  10] =  -0.13628350673152
lambda[  11] =  -0.13628345066670
lambda[  12] =  -0.02039067885525
lambda[  13] =   0.02026663384477
lambda[  14] =   0.03324785202814
lambda[  15] =   0.03701858765327
==subpsace eigenproblem: bcast eigvals took 0.075 ms
Total time for solving subspace eigenvalue problem: 0.255 ms
rank =  0, subspace rotation using ScaLAPACK took 3.517 ms
rank =  0, Distributing orbital back into band + domain format took 12.032 ms
rank = 0, Subspace_Rotation used 15.562 ms

Total time for subspace rotation: 15.567 ms
rank = 0, Efermi =  -0.167353110767 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 3.019 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.296 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.151 ms
rank = 0, Calculating density took 1230.839 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
rank = 0, D2D took 0.785 ms
rank = 0, Transfering density took 0.789 ms
Etot    =   -34.445362859931
Eband   =    -9.484003489795
E1      =    20.233261060642
E2      =    -8.915725348839
E3      =   -11.280213050384
Exc     =   -10.325539418942
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 7.776e-06, dEband = 4.746e-04
rank = 0, Calculating/Estimating energy took 1.088 ms, Etot = -34.445362860, dEtot = 7.776e-06, dEband = 4.746e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0491525418598, which took 0.050 ms

iter_count = 102, r_2norm = 1.930e-06, tol*||rhs|| = 1.966e-06

Anderson update took 55.111 ms, out of which F'*F took 25.941 ms; b-Ax took 173.810 ms, out of which Lap took 155.356 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.929 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451185, int_b + int_rho = -9.823e-13, checking this took 0.108 ms
2-norm of RHS = 491.7340746869996, which took 0.132 ms

iter_count = 108, r_2norm = 4.202e-04, tol*||rhs|| = 4.917e-04

Anderson update took 58.305 ms, out of which F'*F took 27.217 ms; b-Ax took 184.495 ms, out of which Lap took 165.658 ms
Solving Poisson took 391.961 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.094671 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.086225 
Total time for convolution: 	 convolve: 5.100321 
Total time for convolution: 	 convolve: 5.101595 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.845 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.940 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.350 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.312 ms

This SCF took 26378.170 ms, scf error = 1.914e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.137019, lowerbound = -1.084351, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1161.640 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 12.805 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.330 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 16.155 ms
rank =  0, finding HY took 19.347 ms
rank =  0, distributing HY into block cyclic form took 12.180 ms
rank =  0, finding Y'*HY took 4.356 ms
Rank 0, Project_Hamiltonian used 52.069 ms
Total time for projection: 52.099 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -1.084298298534083
    last  calculated eigval = 0.037129263338592
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08429829853408
lambda[   2] =  -0.75354961786515
lambda[   3] =  -0.63706889326176
lambda[   4] =  -0.50210649697974
lambda[   5] =  -0.45676436319011
lambda[   6] =  -0.45676422953938
lambda[   7] =  -0.29648013197967
lambda[   8] =  -0.29648003543745
lambda[   9] =  -0.25811905230098
lambda[  10] =  -0.13624501202015
lambda[  11] =  -0.13624496432309
lambda[  12] =  -0.02007166412917
lambda[  13] =   0.02022127630350
lambda[  14] =   0.03352947382354
lambda[  15] =   0.03712926333859
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 3.529 ms
rank =  0, Distributing orbital back into band + domain format took 11.973 ms
rank = 0, Subspace_Rotation used 15.519 ms

Total time for subspace rotation: 15.524 ms
rank = 0, Efermi =  -0.167314620307 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 3.000 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.320 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.158 ms
rank = 0, Calculating density took 1236.032 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
rank = 0, D2D took 0.898 ms
rank = 0, Transfering density took 0.907 ms
Etot    =   -34.445361943315
Eband   =    -9.483262238791
E1      =    20.232864771411
E2      =    -8.915352420137
E3      =   -11.280331816265
Exc     =   -10.325629301277
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 2.292e-07, dEband = 1.853e-04
rank = 0, Calculating/Estimating energy took 1.441 ms, Etot = -34.445361943, dEtot = 2.292e-07, dEband = 1.853e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0378765620836, which took 0.081 ms

iter_count = 108, r_2norm = 1.115e-06, tol*||rhs|| = 1.515e-06

Anderson update took 57.982 ms, out of which F'*F took 26.909 ms; b-Ax took 183.163 ms, out of which Lap took 163.480 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.302 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451184, int_b + int_rho = -9.895e-13, checking this took 0.102 ms
2-norm of RHS = 491.7341219554104, which took 0.120 ms

iter_count = 132, r_2norm = 4.883e-04, tol*||rhs|| = 4.917e-04

Anderson update took 70.885 ms, out of which F'*F took 33.153 ms; b-Ax took 223.982 ms, out of which Lap took 200.651 ms
Solving Poisson took 476.614 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.113442 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.096314 
Total time for convolution: 	 convolve: 5.092957 
Total time for convolution: 	 convolve: 5.092058 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.857 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.127 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.954 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.350 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.325 ms

This SCF took 26489.382 ms, scf error = 1.676e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.137129, lowerbound = -1.084298, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1143.009 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.648 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.307 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 23.972 ms
rank =  0, finding HY took 19.353 ms
rank =  0, distributing HY into block cyclic form took 11.878 ms
rank =  0, finding Y'*HY took 4.386 ms
Rank 0, Project_Hamiltonian used 59.618 ms
Total time for projection: 59.634 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -1.084173420577998
    last  calculated eigval = 0.037678792522720
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08417342057800
lambda[   2] =  -0.75344901830898
lambda[   3] =  -0.63697103241819
lambda[   4] =  -0.50198744407039
lambda[   5] =  -0.45665498324168
lambda[   6] =  -0.45665492625880
lambda[   7] =  -0.29638795289145
lambda[   8] =  -0.29638790852103
lambda[   9] =  -0.25802743352165
lambda[  10] =  -0.13614994175906
lambda[  11] =  -0.13614991760934
lambda[  12] =  -0.01980364240625
lambda[  13] =   0.02024376984239
lambda[  14] =   0.03358411528897
lambda[  15] =   0.03767879252272
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.172 ms
rank =  0, subspace rotation using ScaLAPACK took 3.534 ms
rank =  0, Distributing orbital back into band + domain format took 11.970 ms
rank = 0, Subspace_Rotation used 15.515 ms

Total time for subspace rotation: 15.519 ms
rank = 0, Efermi =  -0.167219561830 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.995 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.308 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.212 ms
rank = 0, Calculating density took 1224.956 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.641 ms
rank = 0, D2D took 1.744 ms
rank = 0, Transfering density took 1.750 ms
Etot    =   -34.445379278241
Eband   =    -9.481388240235
E1      =    20.231833350098
E2      =    -8.914447394681
E3      =   -11.280538099557
Exc     =   -10.325790471283
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 4.334e-06, dEband = 4.685e-04
rank = 0, Calculating/Estimating energy took 0.903 ms, Etot = -34.445379278, dEtot = 4.334e-06, dEband = 4.685e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0320639646706, which took 0.055 ms

iter_count = 108, r_2norm = 8.698e-07, tol*||rhs|| = 1.283e-06

Anderson update took 57.716 ms, out of which F'*F took 26.927 ms; b-Ax took 183.151 ms, out of which Lap took 163.472 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.714 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451185, int_b + int_rho = -9.750e-13, checking this took 0.103 ms
2-norm of RHS = 491.7305370618684, which took 0.149 ms

iter_count = 156, r_2norm = 4.268e-04, tol*||rhs|| = 4.917e-04

Anderson update took 83.561 ms, out of which F'*F took 39.207 ms; b-Ax took 265.711 ms, out of which Lap took 238.253 ms
Solving Poisson took 562.387 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.079360 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.216 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 6.301189 
Total time for convolution: 	 convolve: 5.077921 
Total time for convolution: 	 convolve: 5.079546 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.831 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.388 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.935 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.345 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.300 ms

This SCF took 27724.690 ms, scf error = 1.314e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.137679, lowerbound = -1.084173, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1180.368 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.957 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.348 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.039 ms
rank =  0, Distribute data + matrix mult took 20.357 ms
rank =  0, finding HY took 19.338 ms
rank =  0, distributing HY into block cyclic form took 11.903 ms
rank =  0, finding Y'*HY took 4.350 ms
Rank 0, Project_Hamiltonian used 55.977 ms
Total time for projection: 55.998 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -1.084146359888782
    last  calculated eigval = 0.038247467256953
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08414635988878
lambda[   2] =  -0.75340981985280
lambda[   3] =  -0.63692462227210
lambda[   4] =  -0.50196293495648
lambda[   5] =  -0.45662192253169
lambda[   6] =  -0.45662185316570
lambda[   7] =  -0.29634843930481
lambda[   8] =  -0.29634830398634
lambda[   9] =  -0.25800344163763
lambda[  10] =  -0.13611648303400
lambda[  11] =  -0.13611643065976
lambda[  12] =  -0.01986309801454
lambda[  13] =   0.02032593525773
lambda[  14] =   0.03323577869590
lambda[  15] =   0.03824746725695
==subpsace eigenproblem: bcast eigvals took 0.039 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 3.543 ms
rank =  0, Distributing orbital back into band + domain format took 11.977 ms
rank = 0, Subspace_Rotation used 15.533 ms

Total time for subspace rotation: 15.538 ms
rank = 0, Efermi =  -0.167186089098 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 3.426 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.401 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.153 ms
rank = 0, Calculating density took 1258.794 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.618 ms
rank = 0, D2D took 0.836 ms
rank = 0, Transfering density took 0.844 ms
Etot    =   -34.445396180774
Eband   =    -9.480775395807
E1      =    20.231480895133
E2      =    -8.914215991671
E3      =   -11.280406769856
Exc     =   -10.325705030567
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 4.226e-06, dEband = 1.532e-04
rank = 0, Calculating/Estimating energy took 0.942 ms, Etot = -34.445396181, dEtot = 4.226e-06, dEband = 1.532e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0223812138597, which took 0.132 ms

iter_count = 108, r_2norm = 8.386e-07, tol*||rhs|| = 8.952e-07

Anderson update took 57.789 ms, out of which F'*F took 27.085 ms; b-Ax took 183.388 ms, out of which Lap took 163.632 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.159 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451183, int_b + int_rho = -9.968e-13, checking this took 0.107 ms
2-norm of RHS = 491.7316019374767, which took 0.164 ms

iter_count = 114, r_2norm = 4.861e-04, tol*||rhs|| = 4.917e-04

Anderson update took 61.077 ms, out of which F'*F took 28.790 ms; b-Ax took 194.067 ms, out of which Lap took 173.841 ms
Solving Poisson took 412.214 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.078974 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.925 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.077985 
Total time for convolution: 	 convolve: 5.085927 
Total time for convolution: 	 convolve: 5.073624 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.183 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 0.954 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.343 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.319 ms

This SCF took 26429.301 ms, scf error = 1.238e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.138247, lowerbound = -1.084146, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1137.365 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 21.347 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.368 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 24.734 ms
rank =  0, finding HY took 19.372 ms
rank =  0, distributing HY into block cyclic form took 12.037 ms
rank =  0, finding Y'*HY took 4.185 ms
Rank 0, Project_Hamiltonian used 60.355 ms
Total time for projection: 60.377 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.164 ms
    first calculated eigval = -1.084079984239140
    last  calculated eigval = 0.038045857584381
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08407998423914
lambda[   2] =  -0.75336486851589
lambda[   3] =  -0.63688558642388
lambda[   4] =  -0.50189866906356
lambda[   5] =  -0.45656361371858
lambda[   6] =  -0.45656360961384
lambda[   7] =  -0.29630644288746
lambda[   8] =  -0.29630637022739
lambda[   9] =  -0.25796026509523
lambda[  10] =  -0.13606999290942
lambda[  11] =  -0.13606995905772
lambda[  12] =  -0.01991351690412
lambda[  13] =   0.02059677643060
lambda[  14] =   0.03302336492204
lambda[  15] =   0.03804585758438
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.179 ms
rank =  0, subspace rotation using ScaLAPACK took 3.473 ms
rank =  0, Distributing orbital back into band + domain format took 11.676 ms
rank = 0, Subspace_Rotation used 15.165 ms

Total time for subspace rotation: 15.174 ms
rank = 0, Efermi =  -0.167139608045 calculate fermi energy took 0.077 ms
rank = 0, --- Calculate rho: sum over local bands took 3.091 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.143 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.177 ms
rank = 0, Calculating density took 1220.736 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.495 ms
rank = 0, D2D took 0.597 ms
rank = 0, Transfering density took 0.602 ms
Etot    =   -34.445401649133
Eband   =    -9.479858820184
E1      =    20.231022970745
E2      =    -8.913731097909
E3      =   -11.280486231475
Exc     =   -10.325763718018
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 1.367e-06, dEband = 2.291e-04
rank = 0, Calculating/Estimating energy took 0.903 ms, Etot = -34.445401649, dEtot = 1.367e-06, dEband = 2.291e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0148997579682, which took 0.055 ms

iter_count = 114, r_2norm = 4.179e-07, tol*||rhs|| = 5.960e-07

Anderson update took 61.461 ms, out of which F'*F took 28.483 ms; b-Ax took 193.594 ms, out of which Lap took 172.803 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.588 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451184, int_b + int_rho = -9.932e-13, checking this took 0.114 ms
2-norm of RHS = 491.7382158332180, which took 0.135 ms

iter_count = 144, r_2norm = 4.526e-04, tol*||rhs|| = 4.917e-04

Anderson update took 77.127 ms, out of which F'*F took 36.256 ms; b-Ax took 244.848 ms, out of which Lap took 219.326 ms
Solving Poisson took 519.813 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.119906 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.099726 
Total time for convolution: 	 convolve: 5.082448 
Total time for convolution: 	 convolve: 5.085744 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.013 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.221 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 0.960 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.342 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.325 ms

This SCF took 26614.460 ms, scf error = 1.004e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.138046, lowerbound = -1.084080, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1162.369 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.330 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.380 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 18.725 ms
rank =  0, finding HY took 19.335 ms
rank =  0, distributing HY into block cyclic form took 11.936 ms
rank =  0, finding Y'*HY took 4.325 ms
Rank 0, Project_Hamiltonian used 54.347 ms
Total time for projection: 54.362 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -1.084198094950358
    last  calculated eigval = 0.037450785941464
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08419809495036
lambda[   2] =  -0.75343541045135
lambda[   3] =  -0.63695535749564
lambda[   4] =  -0.50199596681602
lambda[   5] =  -0.45665013774827
lambda[   6] =  -0.45665010662451
lambda[   7] =  -0.29635889823074
lambda[   8] =  -0.29635881989206
lambda[   9] =  -0.25797234888190
lambda[  10] =  -0.13611993317672
lambda[  11] =  -0.13611991672402
lambda[  12] =  -0.01968872929508
lambda[  13] =   0.02145703333885
lambda[  14] =   0.03351199242289
lambda[  15] =   0.03745078594146
==subpsace eigenproblem: bcast eigvals took 0.038 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 4.018 ms
rank =  0, Distributing orbital back into band + domain format took 11.621 ms
rank = 0, Subspace_Rotation used 15.656 ms

Total time for subspace rotation: 15.663 ms
rank = 0, Efermi =  -0.167189557164 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 3.092 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.081 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.248 ms
rank = 0, Calculating density took 1239.640 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
rank = 0, D2D took 0.678 ms
rank = 0, Transfering density took 0.683 ms
Etot    =   -34.445403952858
Eband   =    -9.481150282796
E1      =    20.232127732057
E2      =    -8.914009232641
E3      =   -11.280063888707
Exc     =   -10.325435112407
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 5.759e-07, dEband = 3.229e-04
rank = 0, Calculating/Estimating energy took 0.878 ms, Etot = -34.445403953, dEtot = 5.759e-07, dEband = 3.229e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0173179954471, which took 0.145 ms

iter_count = 108, r_2norm = 6.225e-07, tol*||rhs|| = 6.927e-07

Anderson update took 57.891 ms, out of which F'*F took 27.069 ms; b-Ax took 183.481 ms, out of which Lap took 163.864 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.184 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451179, int_b + int_rho = -1.037e-12, checking this took 0.124 ms
2-norm of RHS = 491.7308030096362, which took 0.139 ms

iter_count = 156, r_2norm = 4.160e-04, tol*||rhs|| = 4.917e-04

Anderson update took 83.738 ms, out of which F'*F took 39.291 ms; b-Ax took 268.541 ms, out of which Lap took 241.129 ms
Solving Poisson took 565.448 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.132538 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.087227 
Total time for convolution: 	 convolve: 5.102959 
Total time for convolution: 	 convolve: 5.081788 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.082 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.955 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.355 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.333 ms

This SCF took 26594.898 ms, scf error = 2.016e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.137451, lowerbound = -1.084198, upperbound = 267.584915

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1170.974 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.281 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.313 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.094 ms
rank =  0, Distribute data + matrix mult took 15.698 ms
rank =  0, finding HY took 19.348 ms
rank =  0, distributing HY into block cyclic form took 11.915 ms
rank =  0, finding Y'*HY took 4.297 ms
Rank 0, Project_Hamiltonian used 51.282 ms
Total time for projection: 51.297 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.855 ms
    first calculated eigval = -1.084069919713563
    last  calculated eigval = 0.036609320913310
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08406991971356
lambda[   2] =  -0.75335924379667
lambda[   3] =  -0.63688365188727
lambda[   4] =  -0.50189382597277
lambda[   5] =  -0.45655173273276
lambda[   6] =  -0.45655172710313
lambda[   7] =  -0.29630285731940
lambda[   8] =  -0.29630276012465
lambda[   9] =  -0.25798896438981
lambda[  10] =  -0.13607178564389
lambda[  11] =  -0.13607174350351
lambda[  12] =  -0.02053414552528
lambda[  13] =   0.02048341037192
lambda[  14] =   0.03232670341197
lambda[  15] =   0.03660932091331
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.902 ms
rank =  0, subspace rotation using ScaLAPACK took 3.541 ms
rank =  0, Distributing orbital back into band + domain format took 11.775 ms
rank = 0, Subspace_Rotation used 15.334 ms

Total time for subspace rotation: 15.342 ms
rank = 0, Efermi =  -0.167141396670 calculate fermi energy took 0.079 ms
rank = 0, --- Calculate rho: sum over local bands took 3.103 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.118 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.163 ms
rank = 0, Calculating density took 1245.635 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.613 ms
rank = 0, D2D took 0.789 ms
rank = 0, Transfering density took 0.796 ms
Etot    =   -34.445409332420
Eband   =    -9.479809366694
E1      =    20.230970834868
E2      =    -8.913739472423
E3      =   -11.280419170308
Exc     =   -10.325710032265
Esc     =   -55.065019410916
Entropy =    -0.000000000144
dE = 1.345e-06, dEband = 3.352e-04
rank = 0, Calculating/Estimating energy took 0.962 ms, Etot = -34.445409332, dEtot = 1.345e-06, dEband = 3.352e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0130130416458, which took 0.138 ms

iter_count = 114, r_2norm = 3.471e-07, tol*||rhs|| = 5.205e-07

Anderson update took 60.553 ms, out of which F'*F took 29.417 ms; b-Ax took 194.446 ms, out of which Lap took 173.535 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.679 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000451283, int_rho =  18.00000000451181, int_b + int_rho = -1.022e-12, checking this took 0.104 ms
2-norm of RHS = 491.7337471745687, which took 0.140 ms

iter_count = 102, r_2norm = 4.368e-04, tol*||rhs|| = 4.917e-04

Anderson update took 54.695 ms, out of which F'*F took 25.759 ms; b-Ax took 173.180 ms, out of which Lap took 155.236 ms
Solving Poisson took 368.958 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.085926 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.508 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.085012 
Total time for convolution: 	 convolve: 5.079496 
Total time for convolution: 	 convolve: 5.084343 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.974 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.331 ms

This SCF took 26392.817 ms, scf error = 8.914e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -1.08406991971356, occ[   1] =   2.00000000000000
lambda[   2] =  -0.75335924379667, occ[   2] =   2.00000000000000
lambda[   3] =  -0.63688365188727, occ[   3] =   2.00000000000000
lambda[   4] =  -0.50189382597277, occ[   4] =   2.00000000000000
lambda[   5] =  -0.45655173273276, occ[   5] =   2.00000000000000
lambda[   6] =  -0.45655172710313, occ[   6] =   2.00000000000000
lambda[   7] =  -0.29630285731940, occ[   7] =   2.00000000000000
lambda[   8] =  -0.29630276012465, occ[   8] =   2.00000000000000
lambda[   9] =  -0.25798896438981, occ[   9] =   2.00000000000000
lambda[  10] =  -0.13607178564389, occ[  10] =   0.00000000225597
lambda[  11] =  -0.13607174350351, occ[  11] =   0.00000000225585
lambda[  12] =  -0.02053414552528, occ[  12] =   0.00000000000000
lambda[  13] =   0.02048341037192, occ[  13] =   0.00000000000000
lambda[  14] =   0.03232670341197, occ[  14] =   0.00000000000000
lambda[  15] =   0.03660932091331, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.628 ms, time for Allreduce/Reduce: 5.810 ms 
Time for calculating local force components: 15.386 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000012138487  -0.00000033854596  -1.40059792748371
  0.00000031047980   0.00000099977245   0.55798195671282
 -0.00000004694779  -0.00000001275964   0.25476212984121
  0.00000008656071   0.00000048817459   0.15656753014657
force_loc = 
 -0.00000099521572   0.00000237787219   1.37557347636431
  0.00000291658567   0.00000065598745  -0.54730928277489
 -0.00000018355466  -0.00000154301401  -0.24177235553675
  0.00000002903503  -0.00000014217015  -0.16967580267351
Time for calculating nonlocal force components: 26.816 ms
[32mforces_xc: 
[0m[32m -0.00000004823650   0.00000011247123   0.03131044033082
[0m[32m  0.00000015659367   0.00000005296633  -0.00882969020120
[0m[32m -0.00000003951835  -0.00000011259874  -0.01238976067685
[0m[32m  0.00000001341743  -0.00000002437132   0.00440933075323
[0mTime for calculating XC forces components: 19.087 ms
 Cartesian force = 
 -0.00000168429070   0.00000152335135   0.00627847801091
  0.00000286420553   0.00000108028013   0.00183547253621
 -0.00000078947440  -0.00000229681850   0.00059250242710
 -0.00000039044044  -0.00000030681297  -0.00870645297422
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Time for printing density: 389.597 ms
The program took 570.793 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:21
Job ID:        2266467
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:56:48,vmem=8468K,walltime=00:09:44,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-14-1
---------------------------------------
