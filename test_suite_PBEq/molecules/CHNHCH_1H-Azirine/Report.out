---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:23
Job ID:    2266664
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:29
Job ID:    2266664
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.068 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.018 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 22.852 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 6.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 0.914 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 82.785 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.040 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.104 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.001606	   12.004686	   10.000000	
    8.998394	    7.995314	   13.069142	
    8.998394	    7.995314	    6.930858	
    9.159705	    8.791656	   11.212751	
    9.159705	    8.791656	    8.787249	
    9.159705	   11.409190	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.190 ms
Set up communicators.

--set up spincomm took 2.284 ms

--set up kptcomm took 0.350 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.006 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.113 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.107 ms

Calculate_SplineDerivRadFun took 0.197 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.323 ms.
time spent on vectorized spline interp: 2.460 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.999 ms.
time spent on vectorized spline interp: 1.859 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.549 ms.
time spent on vectorized spline interp: 1.783 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.539 ms.

Calculating rb for all atom types took 16.293 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.936 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000214010, sum_int_rho = 15.6924642588315
PosCharge = 16.000000021401, NegCharge = -15.692464258831, scal_fac = 1.019597671691
After scaling, int_rho = 16.0000000214010, PosCharge + NegCharge - NetCharge = 5.329e-14
--Calculate Vref took 0.408 ms
--Calculate rho_guess took 2.601 ms

 integral of b = -16.0000000214010,
 int{b} + Nelectron + NetCharge = -2.140e-08,
 Esc = -41.6320520762604,
 MPI_Reduce took 4.393 ms

Calculating b & b_ref took 13.510 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.015 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.021 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.004 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.040 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.006 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.007 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.013 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 27.144 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140103, int_b + int_rho = 5.093e-14, checking this took 0.087 ms
2-norm of RHS = 585.6049802082765, which took 0.454 ms

iter_count = 420, r_2norm = 5.547e-04, tol*||rhs|| = 5.856e-04

Anderson update took 263.041 ms, out of which F'*F took 118.959 ms; b-Ax took 816.889 ms, out of which Lap took 726.376 ms
Solving Poisson took 1794.926 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.398 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.835 ms
Total time for convolution: 	 convolve: 5.109280 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 29.295 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.788 ms
Total time for convolution: 	 convolve: 5.103891 
Total time for convolution: 	 convolve: 5.103958 
Total time for convolution: 	 convolve: 5.102453 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.717 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.383 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
rank = 0, XC calculation took 24304.784 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 1.118 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.774 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 3.005 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.136 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.893 ms
    Lanczos iter 54, eigmin  = -0.986717936, eigmax = 264.931241730, err_eigmin = 6.022e-04, err_eigmax = 9.614e-03
rank =   0, Lanczos took 136.088 ms, eigmin = -0.986717935708, eigmax = 267.580554147115

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.246918, lowerbound = -1.086718, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1444.547 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 16.454 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.680 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.281 ms
rank =  0, Distribute data + matrix mult took 19.438 ms
rank =  0, finding HY took 21.515 ms
rank =  0, distributing HY into block cyclic form took 16.073 ms
rank =  0, finding Y'*HY took 2.218 ms
Rank 0, Project_Hamiltonian used 59.278 ms
Total time for projection: 59.293 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.712 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.597 ms
rank = 0, Solve_Generalized_EigenProblem used 1.731 ms
    first calculated eigval = 2.801679038912021
    last  calculated eigval = 3.179261436155064
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.80167903891202
lambda[   2] =   2.83800968463091
lambda[   3] =   2.85785205999148
lambda[   4] =   2.90165160244806
lambda[   5] =   2.95736024390924
lambda[   6] =   2.98843454143565
lambda[   7] =   3.00615762541648
lambda[   8] =   3.03380157923297
lambda[   9] =   3.07201323803664
lambda[  10] =   3.07740289450140
lambda[  11] =   3.11161885286744
lambda[  12] =   3.13079620521569
lambda[  13] =   3.15178708855399
lambda[  14] =   3.17926143615506
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.747 ms
rank =  0, subspace rotation using ScaLAPACK took 3.854 ms
rank =  0, Distributing orbital back into band + domain format took 14.371 ms
rank = 0, Subspace_Rotation used 18.238 ms

Total time for subspace rotation: 18.242 ms
rank = 0, Efermi =   3.052900681421 calculate fermi energy took 0.125 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.279261, lowerbound = -1.086718, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1391.742 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.856 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.593 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 16.487 ms
rank =  0, finding HY took 20.704 ms
rank =  0, distributing HY into block cyclic form took 15.142 ms
rank =  0, finding Y'*HY took 2.235 ms
Rank 0, Project_Hamiltonian used 54.603 ms
Total time for projection: 54.618 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.168 ms
    first calculated eigval = -0.775566323001274
    last  calculated eigval = 0.436656904823734
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.77556632300127
lambda[   2] =  -0.44006902729518
lambda[   3] =  -0.34270724156404
lambda[   4] =  -0.11111176065090
lambda[   5] =  -0.05243619317039
lambda[   6] =   0.17473822659051
lambda[   7] =   0.20858310768873
lambda[   8] =   0.27485776739800
lambda[   9] =   0.31067683328336
lambda[  10] =   0.33671657168281
lambda[  11] =   0.38952862406249
lambda[  12] =   0.39995952032647
lambda[  13] =   0.41668203638345
lambda[  14] =   0.43665690482373
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 3.813 ms
rank =  0, Distributing orbital back into band + domain format took 14.519 ms
rank = 0, Subspace_Rotation used 18.347 ms

Total time for subspace rotation: 18.351 ms
rank = 0, Efermi =   0.292767326758 calculate fermi energy took 0.087 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.536657, lowerbound = -1.086718, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1388.149 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 15.038 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.570 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 16.644 ms
rank =  0, finding HY took 20.681 ms
rank =  0, distributing HY into block cyclic form took 15.023 ms
rank =  0, finding Y'*HY took 2.280 ms
Rank 0, Project_Hamiltonian used 54.689 ms
Total time for projection: 54.695 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -0.989804933856451
    last  calculated eigval = 0.147182203145225
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.98980493385645
lambda[   2] =  -0.72106642932608
lambda[   3] =  -0.61577575262225
lambda[   4] =  -0.56063181982028
lambda[   5] =  -0.47921739519541
lambda[   6] =  -0.39760519205754
lambda[   7] =  -0.34386296684070
lambda[   8] =  -0.21556328850031
lambda[   9] =  -0.02616229728250
lambda[  10] =   0.04167081394928
lambda[  11] =   0.06218687652230
lambda[  12] =   0.09061889333350
lambda[  13] =   0.09583570295425
lambda[  14] =   0.14718220314523
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.188 ms
rank =  0, subspace rotation using ScaLAPACK took 2.986 ms
rank =  0, Distributing orbital back into band + domain format took 14.802 ms
rank = 0, Subspace_Rotation used 17.807 ms

Total time for subspace rotation: 17.811 ms
rank = 0, Efermi =  -0.055267715421 calculate fermi energy took 0.036 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.247182, lowerbound = -1.086718, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1375.921 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.017 ms
rank =  0, Distribute orbital to block cyclic format took 15.198 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.585 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 16.824 ms
rank =  0, finding HY took 20.547 ms
rank =  0, distributing HY into block cyclic form took 15.149 ms
rank =  0, finding Y'*HY took 2.264 ms
Rank 0, Project_Hamiltonian used 54.830 ms
Total time for projection: 54.837 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -0.990008461472001
    last  calculated eigval = 0.073042989371871
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.99000846147200
lambda[   2] =  -0.72268747332889
lambda[   3] =  -0.61744374329331
lambda[   4] =  -0.57264586091178
lambda[   5] =  -0.48991293559274
lambda[   6] =  -0.40817632341693
lambda[   7] =  -0.38523281503245
lambda[   8] =  -0.28344463696619
lambda[   9] =  -0.10288959903254
lambda[  10] =  -0.01235831846977
lambda[  11] =   0.00019621784032
lambda[  12] =   0.04277008218960
lambda[  13] =   0.05674731111716
lambda[  14] =   0.07304298937187
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 3.860 ms
rank =  0, Distributing orbital back into band + domain format took 14.480 ms
rank = 0, Subspace_Rotation used 18.353 ms

Total time for subspace rotation: 18.357 ms
rank = 0, Efermi =  -0.131995017110 calculate fermi energy took 0.021 ms
rank = 0, --- Calculate rho: sum over local bands took 2.485 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.664 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.101 ms
rank = 0, Calculating density took 6040.908 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
rank = 0, D2D took 0.868 ms
rank = 0, Transfering density took 0.880 ms
Etot    =   -24.141142676708
Eband   =    -8.939104502231
E1      =    18.501285003833
E2      =    -7.035995651366
E3      =    -8.851964873101
Exc     =    -7.959231625874
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 4.024e+00, dEband = 1.490e+00
rank = 0, Calculating/Estimating energy took 1.688 ms, Etot = -24.141142677, dEtot = 4.024e+00, dEband = 1.490e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 42.1419890104822, which took 0.054 ms

iter_count = 96, r_2norm = 1.367e-03, tol*||rhs|| = 1.686e-03

Anderson update took 57.383 ms, out of which F'*F took 26.949 ms; b-Ax took 182.501 ms, out of which Lap took 162.652 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 410.175 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140096, int_b + int_rho = -2.183e-14, checking this took 0.108 ms
2-norm of RHS = 582.3273448733750, which took 0.153 ms

iter_count = 288, r_2norm = 4.846e-04, tol*||rhs|| = 5.823e-04

Anderson update took 176.646 ms, out of which F'*F took 81.887 ms; b-Ax took 566.294 ms, out of which Lap took 507.027 ms
Solving Poisson took 1246.998 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.248 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.083596 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.351 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.383 ms
Total time for convolution: 	 convolve: 5.087728 
Total time for convolution: 	 convolve: 5.093153 
Total time for convolution: 	 convolve: 5.095451 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.388 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.270 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.565 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.207 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 0.700 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.024 ms

This SCF took 32066.635 ms, scf error = 1.880e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.173043, lowerbound = -0.990008, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1315.347 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 15.221 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.565 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 16.828 ms
rank =  0, finding HY took 20.483 ms
rank =  0, distributing HY into block cyclic form took 15.059 ms
rank =  0, finding Y'*HY took 2.243 ms
Rank 0, Project_Hamiltonian used 54.645 ms
Total time for projection: 54.663 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -0.953918994336791
    last  calculated eigval = 0.047563411126540
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95391899433679
lambda[   2] =  -0.68716491384569
lambda[   3] =  -0.59685407322649
lambda[   4] =  -0.54718775022021
lambda[   5] =  -0.45868894220062
lambda[   6] =  -0.37676113417592
lambda[   7] =  -0.35697314976488
lambda[   8] =  -0.25393157633272
lambda[   9] =  -0.09916443968240
lambda[  10] =  -0.02049628349721
lambda[  11] =  -0.00037973245721
lambda[  12] =   0.00955595599265
lambda[  13] =   0.03496438568232
lambda[  14] =   0.04756341112654
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 3.867 ms
rank =  0, Distributing orbital back into band + domain format took 14.555 ms
rank = 0, Subspace_Rotation used 18.436 ms

Total time for subspace rotation: 18.440 ms
rank = 0, Efermi =  -0.128269857806 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.400 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.775 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.818 ms
rank = 0, Calculating density took 1393.311 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.374 ms
rank = 0, D2D took 0.489 ms
rank = 0, Transfering density took 0.491 ms
Etot    =   -24.105306947180
Eband   =    -8.462961070329
E1      =    18.091708401180
E2      =    -6.983075386210
E3      =    -8.969867354971
Exc     =    -8.054944942310
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 5.973e-03, dEband = 7.936e-02
rank = 0, Calculating/Estimating energy took 0.980 ms, Etot = -24.105306947, dEtot = 5.973e-03, dEband = 7.936e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 14.8371999415152, which took 0.076 ms

iter_count = 102, r_2norm = 5.007e-04, tol*||rhs|| = 5.935e-04

Anderson update took 60.940 ms, out of which F'*F took 28.208 ms; b-Ax took 193.400 ms, out of which Lap took 172.458 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.106 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140097, int_b + int_rho = -1.273e-14, checking this took 0.102 ms
2-norm of RHS = 578.1828767066029, which took 0.125 ms

iter_count = 300, r_2norm = 5.616e-04, tol*||rhs|| = 5.782e-04

Anderson update took 177.768 ms, out of which F'*F took 82.730 ms; b-Ax took 565.471 ms, out of which Lap took 502.232 ms
Solving Poisson took 1238.968 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.011 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.516 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.090617 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.083053 
Total time for convolution: 	 convolve: 5.086565 
Total time for convolution: 	 convolve: 5.086016 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.389 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.094 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.376 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.689 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.014 ms

This SCF took 27572.788 ms, scf error = 1.289e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.147563, lowerbound = -0.953919, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1385.629 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.113 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.682 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.828 ms
rank =  0, finding HY took 22.160 ms
rank =  0, distributing HY into block cyclic form took 15.040 ms
rank =  0, finding Y'*HY took 2.278 ms
Rank 0, Project_Hamiltonian used 56.337 ms
Total time for projection: 56.355 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -0.895753600640287
    last  calculated eigval = 0.043810335590859
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.89575360064029
lambda[   2] =  -0.62859146160149
lambda[   3] =  -0.55598887928968
lambda[   4] =  -0.49865404243671
lambda[   5] =  -0.40563173262868
lambda[   6] =  -0.32406499593269
lambda[   7] =  -0.31236628011144
lambda[   8] =  -0.20184897461945
lambda[   9] =  -0.06697988144955
lambda[  10] =  -0.02675195212544
lambda[  11] =  -0.00743266699669
lambda[  12] =   0.01756761128214
lambda[  13] =   0.03551036497778
lambda[  14] =   0.04381033559086
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 3.822 ms
rank =  0, Distributing orbital back into band + domain format took 14.495 ms
rank = 0, Subspace_Rotation used 19.297 ms

Total time for subspace rotation: 19.302 ms
rank = 0, Efermi =  -0.096085299545 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 2.437 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.901 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.111 ms
rank = 0, Calculating density took 1465.618 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.514 ms
rank = 0, D2D took 0.839 ms
rank = 0, Transfering density took 0.849 ms
Etot    =   -24.070400981220
Eband   =    -7.645799935954
E1      =    17.425846321773
E2      =    -6.823018627480
E3      =    -9.196378448185
Exc     =    -8.237792365801
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 5.818e-03, dEband = 1.362e-01
rank = 0, Calculating/Estimating energy took 1.140 ms, Etot = -24.070400981, dEtot = 5.818e-03, dEband = 1.362e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.5946530739392, which took 0.068 ms

iter_count = 102, r_2norm = 2.168e-04, tol*||rhs|| = 2.238e-04

Anderson update took 60.745 ms, out of which F'*F took 27.735 ms; b-Ax took 191.081 ms, out of which Lap took 169.006 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.678 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140099, int_b + int_rho = 1.273e-14, checking this took 0.120 ms
2-norm of RHS = 578.4972530466503, which took 0.165 ms

iter_count = 270, r_2norm = 5.604e-04, tol*||rhs|| = 5.785e-04

Anderson update took 162.527 ms, out of which F'*F took 73.653 ms; b-Ax took 507.747 ms, out of which Lap took 449.640 ms
Solving Poisson took 1125.288 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
Total time for convolution: 	 convolve: 5.092364 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.892 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.079632 
Total time for convolution: 	 convolve: 6.394308 
Total time for convolution: 	 convolve: 5.236460 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 1.221 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 0.694 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.026 ms

This SCF took 28841.073 ms, scf error = 4.056e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.143810, lowerbound = -0.895754, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1346.612 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.838 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.599 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 16.483 ms
rank =  0, finding HY took 21.244 ms
rank =  0, distributing HY into block cyclic form took 14.930 ms
rank =  0, finding Y'*HY took 2.374 ms
Rank 0, Project_Hamiltonian used 55.068 ms
Total time for projection: 55.084 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.887340020622296
    last  calculated eigval = 0.037534827144448
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88734002062230
lambda[   2] =  -0.61811097840108
lambda[   3] =  -0.54525862522076
lambda[   4] =  -0.48757358021675
lambda[   5] =  -0.39614542570137
lambda[   6] =  -0.31483434118076
lambda[   7] =  -0.30578725297499
lambda[   8] =  -0.19368685468065
lambda[   9] =  -0.05996183498156
lambda[  10] =  -0.02974890418351
lambda[  11] =  -0.00911426871585
lambda[  12] =   0.01265088162579
lambda[  13] =   0.03118927130863
lambda[  14] =   0.03753482714445
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 4.599 ms
rank =  0, Distributing orbital back into band + domain format took 13.358 ms
rank = 0, Subspace_Rotation used 17.978 ms

Total time for subspace rotation: 17.987 ms
rank = 0, Efermi =  -0.089067253103 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.478 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.198 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.104 ms
rank = 0, Calculating density took 1424.359 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.669 ms
rank = 0, D2D took 0.956 ms
rank = 0, Transfering density took 0.962 ms
Etot    =   -24.067514179046
Eband   =    -7.497474159281
E1      =    17.339122996380
E2      =    -6.753680516440
E3      =    -9.240740403185
Exc     =    -8.271531858868
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 4.811e-04, dEband = 2.472e-02
rank = 0, Calculating/Estimating energy took 1.055 ms, Etot = -24.067514179, dEtot = 4.811e-04, dEband = 2.472e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.7564415949217, which took 0.055 ms

iter_count = 114, r_2norm = 4.433e-05, tol*||rhs|| = 7.026e-05

Anderson update took 68.186 ms, out of which F'*F took 31.620 ms; b-Ax took 216.080 ms, out of which Lap took 191.683 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.321 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140095, int_b + int_rho = -2.728e-14, checking this took 0.107 ms
2-norm of RHS = 579.0679279038683, which took 0.137 ms

iter_count = 264, r_2norm = 5.322e-04, tol*||rhs|| = 5.791e-04

Anderson update took 156.887 ms, out of which F'*F took 74.655 ms; b-Ax took 510.225 ms, out of which Lap took 453.056 ms
Solving Poisson took 1119.993 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.088667 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 81.489 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.083920 
Total time for convolution: 	 convolve: 5.085373 
Total time for convolution: 	 convolve: 5.082010 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.389 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
---Transfer Veff_loc: D2D took 0.703 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.038 ms

This SCF took 27441.974 ms, scf error = 1.887e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.137535, lowerbound = -0.887340, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1341.785 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 14.937 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.583 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.560 ms
rank =  0, finding HY took 21.255 ms
rank =  0, distributing HY into block cyclic form took 14.829 ms
rank =  0, finding Y'*HY took 2.554 ms
Rank 0, Project_Hamiltonian used 55.235 ms
Total time for projection: 55.253 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -0.882631840484798
    last  calculated eigval = 0.031891977605337
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88263184048480
lambda[   2] =  -0.61220213305596
lambda[   3] =  -0.53929908861114
lambda[   4] =  -0.48152831454214
lambda[   5] =  -0.39089331362472
lambda[   6] =  -0.30988670273402
lambda[   7] =  -0.30104782846857
lambda[   8] =  -0.18874174954711
lambda[   9] =  -0.05638083975151
lambda[  10] =  -0.03042394104170
lambda[  11] =  -0.00922958861245
lambda[  12] =   0.00874977711088
lambda[  13] =   0.02713788974258
lambda[  14] =   0.03189197760534
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.176 ms
rank =  0, subspace rotation using ScaLAPACK took 4.621 ms
rank =  0, Distributing orbital back into band + domain format took 13.434 ms
rank = 0, Subspace_Rotation used 18.074 ms

Total time for subspace rotation: 18.083 ms
rank = 0, Efermi =  -0.085486257861 calculate fermi energy took 0.151 ms
rank = 0, --- Calculate rho: sum over local bands took 2.465 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.710 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1419.275 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.557 ms
rank = 0, D2D took 0.957 ms
rank = 0, Transfering density took 0.969 ms
Etot    =   -24.066372370361
Eband   =    -7.412461943344
E1      =    17.305416154634
E2      =    -6.696632181487
E3      =    -9.263835952957
Exc     =    -8.287742639193
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 1.903e-04, dEband = 1.417e-02
rank = 0, Calculating/Estimating energy took 1.108 ms, Etot = -24.066372370, dEtot = 1.903e-04, dEband = 1.417e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7091036600162, which took 0.059 ms

iter_count = 114, r_2norm = 1.868e-05, tol*||rhs|| = 2.836e-05

Anderson update took 67.894 ms, out of which F'*F took 32.092 ms; b-Ax took 218.257 ms, out of which Lap took 195.486 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.583 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140099, int_b + int_rho = 5.457e-15, checking this took 0.115 ms
2-norm of RHS = 579.3673378031206, which took 0.153 ms

iter_count = 252, r_2norm = 4.885e-04, tol*||rhs|| = 5.794e-04

Anderson update took 152.304 ms, out of which F'*F took 71.539 ms; b-Ax took 478.424 ms, out of which Lap took 430.596 ms
Solving Poisson took 1050.416 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.084159 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.646 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.083631 
Total time for convolution: 	 convolve: 5.076142 
Total time for convolution: 	 convolve: 5.076812 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.121 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.660 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.677 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.007 ms

This SCF took 27303.307 ms, scf error = 7.836e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.131892, lowerbound = -0.882632, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1398.898 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.884 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.565 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 16.499 ms
rank =  0, finding HY took 21.256 ms
rank =  0, distributing HY into block cyclic form took 14.830 ms
rank =  0, finding Y'*HY took 2.431 ms
Rank 0, Project_Hamiltonian used 55.048 ms
Total time for projection: 55.062 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.640 ms
rank = 0, Solve_Generalized_EigenProblem used 1.124 ms
    first calculated eigval = -0.878513223988035
    last  calculated eigval = 0.029869082843282
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87851322398804
lambda[   2] =  -0.60826637227565
lambda[   3] =  -0.53635017902895
lambda[   4] =  -0.47833245503481
lambda[   5] =  -0.38718195189503
lambda[   6] =  -0.30639980881564
lambda[   7] =  -0.29662836380552
lambda[   8] =  -0.18467363660435
lambda[   9] =  -0.05434382141276
lambda[  10] =  -0.03043504505605
lambda[  11] =  -0.00889483430578
lambda[  12] =   0.00577280450527
lambda[  13] =   0.02359437743163
lambda[  14] =   0.02986908284328
==subpsace eigenproblem: bcast eigvals took 0.113 ms
Total time for solving subspace eigenvalue problem: 1.246 ms
rank =  0, subspace rotation using ScaLAPACK took 4.020 ms
rank =  0, Distributing orbital back into band + domain format took 14.348 ms
rank = 0, Subspace_Rotation used 18.384 ms

Total time for subspace rotation: 18.389 ms
rank = 0, Efermi =  -0.083449239500 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 2.577 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.747 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1477.168 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.604 ms
rank = 0, D2D took 0.934 ms
rank = 0, Transfering density took 0.945 ms
Etot    =   -24.065960496316
Eband   =    -7.352691984059
E1      =    17.281187522184
E2      =    -6.657680413045
E3      =    -9.275299504010
Exc     =    -8.295383874593
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 6.865e-05, dEband = 9.962e-03
rank = 0, Calculating/Estimating energy took 1.099 ms, Etot = -24.065960496, dEtot = 6.865e-05, dEband = 9.962e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4067820090607, which took 0.056 ms

iter_count = 114, r_2norm = 1.017e-05, tol*||rhs|| = 1.627e-05

Anderson update took 68.880 ms, out of which F'*F took 32.323 ms; b-Ax took 215.816 ms, out of which Lap took 193.750 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.584 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140091, int_b + int_rho = -6.366e-14, checking this took 0.121 ms
2-norm of RHS = 579.5814248371584, which took 0.112 ms

iter_count = 252, r_2norm = 4.999e-04, tol*||rhs|| = 5.796e-04

Anderson update took 146.957 ms, out of which F'*F took 69.111 ms; b-Ax took 476.792 ms, out of which Lap took 423.720 ms
Solving Poisson took 1048.747 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.100343 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.172 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.086677 
Total time for convolution: 	 convolve: 5.095268 
Total time for convolution: 	 convolve: 5.079422 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.849 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.589 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.664 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.985 ms

This SCF took 27398.182 ms, scf error = 4.314e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.129869, lowerbound = -0.878513, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1364.244 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.847 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.532 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 16.419 ms
rank =  0, finding HY took 21.073 ms
rank =  0, distributing HY into block cyclic form took 15.023 ms
rank =  0, finding Y'*HY took 2.221 ms
Rank 0, Project_Hamiltonian used 54.801 ms
Total time for projection: 54.821 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.874009648770400
    last  calculated eigval = 0.029815727320936
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87400964877040
lambda[   2] =  -0.60431477674694
lambda[   3] =  -0.53287849723261
lambda[   4] =  -0.47489970342421
lambda[   5] =  -0.38299990120819
lambda[   6] =  -0.30223489970996
lambda[   7] =  -0.29248206568792
lambda[   8] =  -0.18054784316630
lambda[   9] =  -0.05101827899773
lambda[  10] =  -0.02952078314785
lambda[  11] =  -0.00760653974605
lambda[  12] =   0.00505894007825
lambda[  13] =   0.02325234787424
lambda[  14] =   0.02981572732094
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 3.997 ms
rank =  0, Distributing orbital back into band + domain format took 14.232 ms
rank = 0, Subspace_Rotation used 18.241 ms

Total time for subspace rotation: 18.245 ms
rank = 0, Efermi =  -0.080123697050 calculate fermi energy took 0.036 ms
rank = 0, --- Calculate rho: sum over local bands took 2.637 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.682 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.111 ms
rank = 0, Calculating density took 1441.060 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.617 ms
rank = 0, D2D took 0.948 ms
rank = 0, Transfering density took 0.957 ms
Etot    =   -24.065830420525
Eband   =    -7.288734672985
E1      =    17.253238322150
E2      =    -6.619171858405
E3      =    -9.283038804710
Exc     =    -8.300492655903
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 2.168e-05, dEband = 1.066e-02
rank = 0, Calculating/Estimating energy took 1.130 ms, Etot = -24.065830421, dEtot = 2.168e-05, dEband = 1.066e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2746631299516, which took 0.115 ms

iter_count = 114, r_2norm = 7.115e-06, tol*||rhs|| = 1.099e-05

Anderson update took 67.638 ms, out of which F'*F took 32.029 ms; b-Ax took 216.219 ms, out of which Lap took 192.764 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.425 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140093, int_b + int_rho = -4.729e-14, checking this took 0.104 ms
2-norm of RHS = 579.5601786564035, which took 0.116 ms

iter_count = 234, r_2norm = 4.584e-04, tol*||rhs|| = 5.796e-04

Anderson update took 136.990 ms, out of which F'*F took 64.267 ms; b-Ax took 437.232 ms, out of which Lap took 387.501 ms
Solving Poisson took 966.063 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.077175 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.626 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.095542 
Total time for convolution: 	 convolve: 5.120758 
Total time for convolution: 	 convolve: 5.085410 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.653 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.982 ms

This SCF took 27285.341 ms, scf error = 2.299e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.129816, lowerbound = -0.874010, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1359.601 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.531 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.391 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 15.970 ms
rank =  0, finding HY took 21.617 ms
rank =  0, distributing HY into block cyclic form took 14.921 ms
rank =  0, finding Y'*HY took 2.297 ms
Rank 0, Project_Hamiltonian used 55.469 ms
Total time for projection: 55.488 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.871106811110147
    last  calculated eigval = 0.029582101464562
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87110681111015
lambda[   2] =  -0.60159955436849
lambda[   3] =  -0.53076360595231
lambda[   4] =  -0.47263489528180
lambda[   5] =  -0.38029564304167
lambda[   6] =  -0.29953876795612
lambda[   7] =  -0.28983544823498
lambda[   8] =  -0.17778570122350
lambda[   9] =  -0.04885194478244
lambda[  10] =  -0.02836327972236
lambda[  11] =  -0.00592919859386
lambda[  12] =   0.00611203574801
lambda[  13] =   0.02361162867415
lambda[  14] =   0.02958210146456
==subpsace eigenproblem: bcast eigvals took 0.052 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 3.993 ms
rank =  0, Distributing orbital back into band + domain format took 14.298 ms
rank = 0, Subspace_Rotation used 18.304 ms

Total time for subspace rotation: 18.308 ms
rank = 0, Efermi =  -0.077957362867 calculate fermi energy took 0.036 ms
rank = 0, --- Calculate rho: sum over local bands took 2.558 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.832 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1437.216 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.628 ms
rank = 0, D2D took 0.978 ms
rank = 0, Transfering density took 0.991 ms
Etot    =   -24.065839682769
Eband   =    -7.247120855384
E1      =    17.229898776503
E2      =    -6.599396414948
E3      =    -9.289151493880
Exc     =    -8.305113435814
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 1.544e-06, dEband = 6.936e-03
rank = 0, Calculating/Estimating energy took 1.109 ms, Etot = -24.065839683, dEtot = 1.544e-06, dEband = 6.936e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1510677977588, which took 0.057 ms

iter_count = 114, r_2norm = 4.075e-06, tol*||rhs|| = 6.043e-06

Anderson update took 67.716 ms, out of which F'*F took 31.877 ms; b-Ax took 214.625 ms, out of which Lap took 191.824 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.738 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140098, int_b + int_rho = 1.819e-15, checking this took 0.115 ms
2-norm of RHS = 579.5518340518298, which took 0.118 ms

iter_count = 228, r_2norm = 4.790e-04, tol*||rhs|| = 5.796e-04

Anderson update took 134.402 ms, out of which F'*F took 62.270 ms; b-Ax took 424.101 ms, out of which Lap took 376.712 ms
Solving Poisson took 942.249 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.068 ms
Total time for convolution: 	 convolve: 5.077666 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.081288 
Total time for convolution: 	 convolve: 5.083320 
Total time for convolution: 	 convolve: 5.090123 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.688 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.015 ms

This SCF took 27241.206 ms, scf error = 1.614e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.129582, lowerbound = -0.871107, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1371.062 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.913 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.566 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 16.521 ms
rank =  0, finding HY took 21.035 ms
rank =  0, distributing HY into block cyclic form took 14.985 ms
rank =  0, finding Y'*HY took 2.262 ms
Rank 0, Project_Hamiltonian used 54.834 ms
Total time for projection: 54.850 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.870087128455433
    last  calculated eigval = 0.030102145843616
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87008712845543
lambda[   2] =  -0.60036951021901
lambda[   3] =  -0.52953967008711
lambda[   4] =  -0.47144155863891
lambda[   5] =  -0.37912789303588
lambda[   6] =  -0.29834623839837
lambda[   7] =  -0.28871029884832
lambda[   8] =  -0.17658646322078
lambda[   9] =  -0.04731004153521
lambda[  10] =  -0.02544596493983
lambda[  11] =  -0.00229416693175
lambda[  12] =   0.00991528907646
lambda[  13] =   0.02535563160596
lambda[  14] =   0.03010214584362
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 3.965 ms
rank =  0, Distributing orbital back into band + domain format took 14.289 ms
rank = 0, Subspace_Rotation used 18.266 ms

Total time for subspace rotation: 18.270 ms
rank = 0, Efermi =  -0.076415459640 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.566 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.822 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1447.958 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.612 ms
rank = 0, D2D took 0.877 ms
rank = 0, Transfering density took 0.881 ms
Etot    =   -24.065919863748
Eband   =    -7.228417522820
E1      =    17.222664648882
E2      =    -6.587911573543
E3      =    -9.289125177281
Exc     =    -8.305151663732
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 1.336e-05, dEband = 3.117e-03
rank = 0, Calculating/Estimating energy took 1.147 ms, Etot = -24.065919864, dEtot = 1.336e-05, dEband = 3.117e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0923559407128, which took 0.078 ms

iter_count = 114, r_2norm = 3.088e-06, tol*||rhs|| = 3.694e-06

Anderson update took 67.825 ms, out of which F'*F took 31.665 ms; b-Ax took 229.087 ms, out of which Lap took 206.159 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 495.950 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140089, int_b + int_rho = -8.731e-14, checking this took 0.115 ms
2-norm of RHS = 579.5405517060649, which took 0.120 ms

iter_count = 198, r_2norm = 4.709e-04, tol*||rhs|| = 5.795e-04

Anderson update took 117.274 ms, out of which F'*F took 54.360 ms; b-Ax took 368.845 ms, out of which Lap took 327.052 ms
Solving Poisson took 819.917 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.076982 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 43.138 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.373 ms
Total time for convolution: 	 convolve: 5.077148 
Total time for convolution: 	 convolve: 5.083413 
Total time for convolution: 	 convolve: 5.081583 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.749 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.696 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.777 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.848 ms

This SCF took 27135.753 ms, scf error = 9.627e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.130102, lowerbound = -0.870087, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1379.425 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.882 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.538 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 16.454 ms
rank =  0, finding HY took 20.988 ms
rank =  0, distributing HY into block cyclic form took 14.981 ms
rank =  0, finding Y'*HY took 2.257 ms
Rank 0, Project_Hamiltonian used 54.711 ms
Total time for projection: 54.731 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.869099934303982
    last  calculated eigval = 0.030522639321698
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.86909993430398
lambda[   2] =  -0.59945317137909
lambda[   3] =  -0.52873220430607
lambda[   4] =  -0.47060350532631
lambda[   5] =  -0.37821344524028
lambda[   6] =  -0.29745173582967
lambda[   7] =  -0.28779565513348
lambda[   8] =  -0.17568376231178
lambda[   9] =  -0.04643693187826
lambda[  10] =  -0.02382908137781
lambda[  11] =  -0.00044253173967
lambda[  12] =   0.01199028741945
lambda[  13] =   0.02612188140937
lambda[  14] =   0.03052263932170
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 4.045 ms
rank =  0, Distributing orbital back into band + domain format took 14.315 ms
rank = 0, Subspace_Rotation used 18.372 ms

Total time for subspace rotation: 18.376 ms
rank = 0, Efermi =  -0.075542350042 calculate fermi energy took 0.146 ms
rank = 0, --- Calculate rho: sum over local bands took 2.578 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.702 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1456.284 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.595 ms
rank = 0, D2D took 0.967 ms
rank = 0, Transfering density took 0.971 ms
Etot    =   -24.065957517861
Eband   =    -7.214066828655
E1      =    17.214694609677
E2      =    -6.581130323046
E3      =    -9.290937110117
Exc     =    -8.306600655143
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 6.276e-06, dEband = 2.392e-03
rank = 0, Calculating/Estimating energy took 1.115 ms, Etot = -24.065957518, dEtot = 6.276e-06, dEband = 2.392e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0895198594402, which took 0.087 ms

iter_count = 108, r_2norm = 2.966e-06, tol*||rhs|| = 3.581e-06

Anderson update took 64.322 ms, out of which F'*F took 30.041 ms; b-Ax took 202.742 ms, out of which Lap took 181.231 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.513 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140098, int_b + int_rho = -5.457e-15, checking this took 0.113 ms
2-norm of RHS = 579.5452394149456, which took 0.067 ms

iter_count = 204, r_2norm = 4.791e-04, tol*||rhs|| = 5.795e-04

Anderson update took 121.488 ms, out of which F'*F took 55.862 ms; b-Ax took 379.576 ms, out of which Lap took 337.163 ms
Solving Poisson took 843.879 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.081491 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 44.744 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.075399 
Total time for convolution: 	 convolve: 5.076353 
Total time for convolution: 	 convolve: 5.079530 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.209 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.660 ms
---Transfer Veff_loc: D2D took 1.108 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.294 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.756 ms

This SCF took 27127.644 ms, scf error = 6.838e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.130523, lowerbound = -0.869100, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1374.449 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.924 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.552 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.509 ms
rank =  0, finding HY took 20.968 ms
rank =  0, distributing HY into block cyclic form took 14.841 ms
rank =  0, finding Y'*HY took 2.395 ms
Rank 0, Project_Hamiltonian used 54.743 ms
Total time for projection: 54.762 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.867823314789903
    last  calculated eigval = 0.033005736224602
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.86782331478990
lambda[   2] =  -0.59831008261608
lambda[   3] =  -0.52763668936448
lambda[   4] =  -0.46950768529223
lambda[   5] =  -0.37704040505846
lambda[   6] =  -0.29631258008934
lambda[   7] =  -0.28660056107209
lambda[   8] =  -0.17455895042043
lambda[   9] =  -0.04526772862846
lambda[  10] =  -0.02038751313417
lambda[  11] =   0.00278655925843
lambda[  12] =   0.01520362156667
lambda[  13] =   0.02853035809070
lambda[  14] =   0.03300573622460
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.211 ms
rank =  0, subspace rotation using ScaLAPACK took 3.901 ms
rank =  0, Distributing orbital back into band + domain format took 14.326 ms
rank = 0, Subspace_Rotation used 18.240 ms

Total time for subspace rotation: 18.244 ms
rank = 0, Efermi =  -0.074373146727 calculate fermi energy took 0.037 ms
rank = 0, --- Calculate rho: sum over local bands took 2.571 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.752 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1451.209 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
rank = 0, D2D took 0.921 ms
rank = 0, Transfering density took 0.932 ms
Etot    =   -24.066039021859
Eband   =    -7.195580538375
E1      =    17.205074988126
E2      =    -6.571832439087
E3      =    -9.292780002880
Exc     =    -8.308093836675
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 1.358e-05, dEband = 3.081e-03
rank = 0, Calculating/Estimating energy took 1.176 ms, Etot = -24.066039022, dEtot = 1.358e-05, dEband = 3.081e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0497196514510, which took 0.059 ms

iter_count = 114, r_2norm = 1.321e-06, tol*||rhs|| = 1.989e-06

Anderson update took 73.160 ms, out of which F'*F took 32.599 ms; b-Ax took 211.942 ms, out of which Lap took 191.068 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.640 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140101, int_b + int_rho = 3.092e-14, checking this took 0.149 ms
2-norm of RHS = 579.5532605778924, which took 0.149 ms

iter_count = 168, r_2norm = 5.339e-04, tol*||rhs|| = 5.796e-04

Anderson update took 100.126 ms, out of which F'*F took 46.404 ms; b-Ax took 312.994 ms, out of which Lap took 277.721 ms
Solving Poisson took 696.409 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.076060 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 43.211 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.122802 
Total time for convolution: 	 convolve: 5.084830 
Total time for convolution: 	 convolve: 5.080408 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.737 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.419 ms
---Transfer Veff_loc: D2D took 0.686 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.315 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.024 ms

This SCF took 27058.563 ms, scf error = 4.072e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.133006, lowerbound = -0.867823, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1323.648 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.799 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.556 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.165 ms
rank =  0, Distribute data + matrix mult took 16.536 ms
rank =  0, finding HY took 20.995 ms
rank =  0, distributing HY into block cyclic form took 14.912 ms
rank =  0, finding Y'*HY took 2.265 ms
Rank 0, Project_Hamiltonian used 54.736 ms
Total time for projection: 54.751 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -0.867593591598450
    last  calculated eigval = 0.034222681398024
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.86759359159845
lambda[   2] =  -0.59805969227152
lambda[   3] =  -0.52735028226832
lambda[   4] =  -0.46923850965419
lambda[   5] =  -0.37679316779053
lambda[   6] =  -0.29606711351880
lambda[   7] =  -0.28637042185156
lambda[   8] =  -0.17433258714025
lambda[   9] =  -0.04501974584488
lambda[  10] =  -0.01892651096386
lambda[  11] =   0.00372524471819
lambda[  12] =   0.01630688599735
lambda[  13] =   0.02945009643470
lambda[  14] =   0.03422268139802
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 3.978 ms
rank =  0, Distributing orbital back into band + domain format took 14.222 ms
rank = 0, Subspace_Rotation used 18.212 ms

Total time for subspace rotation: 18.216 ms
rank = 0, Efermi =  -0.074125163997 calculate fermi energy took 0.089 ms
rank = 0, --- Calculate rho: sum over local bands took 2.612 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.710 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1400.334 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.601 ms
rank = 0, D2D took 1.005 ms
rank = 0, Transfering density took 1.008 ms
Etot    =   -24.066088133224
Eband   =    -7.191610733151
E1      =    17.203383348632
E2      =    -6.569494248802
E3      =    -9.292929674227
Exc     =    -8.308232594832
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 8.185e-06, dEband = 6.616e-04
rank = 0, Calculating/Estimating energy took 1.570 ms, Etot = -24.066088133, dEtot = 8.185e-06, dEband = 6.616e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0444538068616, which took 0.053 ms

iter_count = 114, r_2norm = 1.144e-06, tol*||rhs|| = 1.778e-06

Anderson update took 67.482 ms, out of which F'*F took 33.034 ms; b-Ax took 215.270 ms, out of which Lap took 192.407 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.015 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140101, int_b + int_rho = 2.910e-14, checking this took 0.119 ms
2-norm of RHS = 579.5600083685702, which took 0.116 ms

iter_count = 156, r_2norm = 5.776e-04, tol*||rhs|| = 5.796e-04

Anderson update took 92.926 ms, out of which F'*F took 44.447 ms; b-Ax took 292.909 ms, out of which Lap took 260.389 ms
Solving Poisson took 649.126 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.075099 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.391 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.075967 
Total time for convolution: 	 convolve: 5.076063 
Total time for convolution: 	 convolve: 5.075308 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.180 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.294 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.989 ms

This SCF took 26881.302 ms, scf error = 3.111e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134223, lowerbound = -0.867594, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1373.381 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.853 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.548 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.435 ms
rank =  0, finding HY took 21.044 ms
rank =  0, distributing HY into block cyclic form took 14.865 ms
rank =  0, finding Y'*HY took 2.283 ms
Rank 0, Project_Hamiltonian used 54.658 ms
Total time for projection: 54.677 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.867341294995471
    last  calculated eigval = 0.035489908620561
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.86734129499547
lambda[   2] =  -0.59779464021609
lambda[   3] =  -0.52708767648451
lambda[   4] =  -0.46898030447388
lambda[   5] =  -0.37653464084635
lambda[   6] =  -0.29580813602504
lambda[   7] =  -0.28612617311503
lambda[   8] =  -0.17408622731782
lambda[   9] =  -0.04482545907503
lambda[  10] =  -0.01765436840353
lambda[  11] =   0.00422729290130
lambda[  12] =   0.01702540216593
lambda[  13] =   0.03018474800076
lambda[  14] =   0.03548990862056
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 3.995 ms
rank =  0, Distributing orbital back into band + domain format took 14.300 ms
rank = 0, Subspace_Rotation used 18.309 ms

Total time for subspace rotation: 18.313 ms
rank = 0, Efermi =  -0.073930877211 calculate fermi energy took 0.038 ms
rank = 0, --- Calculate rho: sum over local bands took 2.612 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.748 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1450.166 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.838 ms
rank = 0, D2D took 1.938 ms
rank = 0, Transfering density took 1.946 ms
Etot    =   -24.066132138118
Eband   =    -7.187518187908
E1      =    17.201425879873
E2      =    -6.567246433937
E3      =    -9.293267242503
Exc     =    -8.308501429621
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 7.334e-06, dEband = 6.821e-04
rank = 0, Calculating/Estimating energy took 0.968 ms, Etot = -24.066132138, dEtot = 7.334e-06, dEband = 6.821e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0353616118855, which took 0.065 ms

iter_count = 108, r_2norm = 1.122e-06, tol*||rhs|| = 1.414e-06

Anderson update took 64.062 ms, out of which F'*F took 30.051 ms; b-Ax took 203.186 ms, out of which Lap took 181.319 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.550 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140096, int_b + int_rho = -1.819e-14, checking this took 0.115 ms
2-norm of RHS = 579.5699000296314, which took 0.139 ms

iter_count = 168, r_2norm = 5.152e-04, tol*||rhs|| = 5.796e-04

Anderson update took 104.734 ms, out of which F'*F took 57.602 ms; b-Ax took 331.957 ms, out of which Lap took 297.154 ms
Solving Poisson took 718.448 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.074904 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.339 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.074298 
Total time for convolution: 	 convolve: 5.083233 
Total time for convolution: 	 convolve: 5.078094 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.191 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.390 ms
---Transfer Veff_loc: D2D took 0.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.988 ms

This SCF took 26950.553 ms, scf error = 2.484e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135490, lowerbound = -0.867341, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1370.732 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.892 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.564 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 16.497 ms
rank =  0, finding HY took 21.019 ms
rank =  0, distributing HY into block cyclic form took 14.933 ms
rank =  0, finding Y'*HY took 2.318 ms
Rank 0, Project_Hamiltonian used 54.798 ms
Total time for projection: 54.816 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -0.867365184653897
    last  calculated eigval = 0.037394230135621
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.86736518465390
lambda[   2] =  -0.59774576860570
lambda[   3] =  -0.52701674172491
lambda[   4] =  -0.46892452034512
lambda[   5] =  -0.37650263883619
lambda[   6] =  -0.29576509559450
lambda[   7] =  -0.28609552890200
lambda[   8] =  -0.17404020008276
lambda[   9] =  -0.04486417691019
lambda[  10] =  -0.01610841765445
lambda[  11] =   0.00428158776328
lambda[  12] =   0.01692617775585
lambda[  13] =   0.03117320098754
lambda[  14] =   0.03739423013562
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.191 ms
rank =  0, subspace rotation using ScaLAPACK took 3.956 ms
rank =  0, Distributing orbital back into band + domain format took 14.380 ms
rank = 0, Subspace_Rotation used 18.348 ms

Total time for subspace rotation: 18.352 ms
rank = 0, Efermi =  -0.073969594994 calculate fermi energy took 0.038 ms
rank = 0, --- Calculate rho: sum over local bands took 2.574 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.796 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1448.230 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.456 ms
rank = 0, D2D took 0.559 ms
rank = 0, Transfering density took 0.564 ms
Etot    =   -24.066185675287
Eband   =    -7.186911358450
E1      =    17.201803453141
E2      =    -6.566327366529
E3      =    -9.292750236840
Exc     =    -8.308103296445
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 8.923e-06, dEband = 1.011e-04
rank = 0, Calculating/Estimating energy took 0.956 ms, Etot = -24.066185675, dEtot = 8.923e-06, dEband = 1.011e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0379033110166, which took 0.074 ms

iter_count = 108, r_2norm = 1.164e-06, tol*||rhs|| = 1.516e-06

Anderson update took 64.251 ms, out of which F'*F took 30.159 ms; b-Ax took 202.992 ms, out of which Lap took 181.201 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.509 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140096, int_b + int_rho = -2.001e-14, checking this took 0.105 ms
2-norm of RHS = 579.5708467653491, which took 0.103 ms

iter_count = 108, r_2norm = 5.305e-04, tol*||rhs|| = 5.796e-04

Anderson update took 64.072 ms, out of which F'*F took 29.573 ms; b-Ax took 200.788 ms, out of which Lap took 178.430 ms
Solving Poisson took 453.756 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.079152 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.961 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.378 ms
Total time for convolution: 	 convolve: 5.075172 
Total time for convolution: 	 convolve: 6.142447 
Total time for convolution: 	 convolve: 5.243962 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.098 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.677 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.999 ms

This SCF took 27918.027 ms, scf error = 2.790e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.137394, lowerbound = -0.867365, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1371.501 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.879 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.522 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 16.435 ms
rank =  0, finding HY took 20.931 ms
rank =  0, distributing HY into block cyclic form took 14.992 ms
rank =  0, finding Y'*HY took 2.240 ms
Rank 0, Project_Hamiltonian used 54.628 ms
Total time for projection: 54.647 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -0.867237248260513
    last  calculated eigval = 0.037367531371838
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.86723724826051
lambda[   2] =  -0.59764143419570
lambda[   3] =  -0.52692848540148
lambda[   4] =  -0.46883207533914
lambda[   5] =  -0.37639314955155
lambda[   6] =  -0.29565877048350
lambda[   7] =  -0.28598581278363
lambda[   8] =  -0.17393512467748
lambda[   9] =  -0.04476659787716
lambda[  10] =  -0.01595707398682
lambda[  11] =   0.00437800416349
lambda[  12] =   0.01714687033228
lambda[  13] =   0.03094630119157
lambda[  14] =   0.03736753137184
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 3.973 ms
rank =  0, Distributing orbital back into band + domain format took 14.340 ms
rank = 0, Subspace_Rotation used 18.327 ms

Total time for subspace rotation: 18.729 ms
rank = 0, Efermi =  -0.073872015947 calculate fermi energy took 0.596 ms
rank = 0, --- Calculate rho: sum over local bands took 2.594 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.793 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1449.170 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.663 ms
rank = 0, D2D took 0.919 ms
rank = 0, Transfering density took 0.932 ms
Etot    =   -24.066180639858
Eband   =    -7.185224202344
E1      =    17.200838954809
E2      =    -6.565531341102
E3      =    -9.293067253181
Exc     =    -8.308341909703
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 8.392e-07, dEband = 2.812e-04
rank = 0, Calculating/Estimating energy took 1.104 ms, Etot = -24.066180640, dEtot = 8.392e-07, dEband = 2.812e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0381854009907, which took 0.048 ms

iter_count = 108, r_2norm = 1.198e-06, tol*||rhs|| = 1.527e-06

Anderson update took 63.901 ms, out of which F'*F took 30.012 ms; b-Ax took 202.641 ms, out of which Lap took 180.887 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.764 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140094, int_b + int_rho = -4.002e-14, checking this took 0.114 ms
2-norm of RHS = 579.5707334900248, which took 0.126 ms

iter_count = 24, r_2norm = 5.361e-04, tol*||rhs|| = 5.796e-04

Anderson update took 14.061 ms, out of which F'*F took 6.596 ms; b-Ax took 44.532 ms, out of which Lap took 39.527 ms
Solving Poisson took 102.449 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.081924 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.646 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.077706 
Total time for convolution: 	 convolve: 5.074603 
Total time for convolution: 	 convolve: 5.073385 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.350 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.654 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.985 ms

This SCF took 26314.817 ms, scf error = 2.294e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.137368, lowerbound = -0.867237, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1373.857 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.842 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.534 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.047 ms
rank =  0, Distribute data + matrix mult took 16.436 ms
rank =  0, finding HY took 20.995 ms
rank =  0, distributing HY into block cyclic form took 14.873 ms
rank =  0, finding Y'*HY took 2.363 ms
Rank 0, Project_Hamiltonian used 54.700 ms
Total time for projection: 54.717 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.197 ms
    first calculated eigval = -0.867242419260042
    last  calculated eigval = 0.037206033141642
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.86724241926004
lambda[   2] =  -0.59764511655815
lambda[   3] =  -0.52693220179542
lambda[   4] =  -0.46883590360455
lambda[   5] =  -0.37639675597352
lambda[   6] =  -0.29566211146129
lambda[   7] =  -0.28598977686198
lambda[   8] =  -0.17393774782654
lambda[   9] =  -0.04476844916646
lambda[  10] =  -0.01598345641435
lambda[  11] =   0.00430652061309
lambda[  12] =   0.01713014633877
lambda[  13] =   0.03063827019040
lambda[  14] =   0.03720603314164
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 4.377 ms
rank =  0, Distributing orbital back into band + domain format took 12.721 ms
rank = 0, Subspace_Rotation used 17.116 ms

Total time for subspace rotation: 17.128 ms
rank = 0, Efermi =  -0.073873867292 calculate fermi energy took 0.104 ms
rank = 0, --- Calculate rho: sum over local bands took 2.550 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.716 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1451.051 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.579 ms
rank = 0, D2D took 0.983 ms
rank = 0, Transfering density took 0.995 ms
Etot    =   -24.066188499762
Eband   =    -7.185284067641
E1      =    17.200875930167
E2      =    -6.565557409554
E3      =    -9.293023954746
Exc     =    -8.308309649685
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 1.310e-06, dEband = 9.978e-06
rank = 0, Calculating/Estimating energy took 1.093 ms, Etot = -24.066188500, dEtot = 1.310e-06, dEband = 9.978e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0345511026930, which took 0.057 ms

iter_count = 108, r_2norm = 1.132e-06, tol*||rhs|| = 1.382e-06

Anderson update took 63.835 ms, out of which F'*F took 29.752 ms; b-Ax took 201.793 ms, out of which Lap took 179.756 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.603 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140092, int_b + int_rho = -6.003e-14, checking this took 0.115 ms
2-norm of RHS = 579.5683247996884, which took 0.098 ms

iter_count = 120, r_2norm = 5.331e-04, tol*||rhs|| = 5.796e-04

Anderson update took 71.395 ms, out of which F'*F took 32.662 ms; b-Ax took 222.767 ms, out of which Lap took 197.835 ms
Solving Poisson took 497.254 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.075591 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 39.970 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.078268 
Total time for convolution: 	 convolve: 5.076170 
Total time for convolution: 	 convolve: 5.077896 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.705 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.685 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.007 ms

This SCF took 26750.164 ms, scf error = 2.315e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.137206, lowerbound = -0.867242, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1327.131 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.817 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.548 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 16.413 ms
rank =  0, finding HY took 21.023 ms
rank =  0, distributing HY into block cyclic form took 14.931 ms
rank =  0, finding Y'*HY took 2.280 ms
Rank 0, Project_Hamiltonian used 54.678 ms
Total time for projection: 54.693 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.193 ms
    first calculated eigval = -0.867089315633548
    last  calculated eigval = 0.036891043275148
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.86708931563355
lambda[   2] =  -0.59752876761827
lambda[   3] =  -0.52684216556455
lambda[   4] =  -0.46873558158773
lambda[   5] =  -0.37627991330120
lambda[   6] =  -0.29555098389239
lambda[   7] =  -0.28586596120841
lambda[   8] =  -0.17383318237673
lambda[   9] =  -0.04472976776143
lambda[  10] =  -0.01629722702827
lambda[  11] =   0.00394466098191
lambda[  12] =   0.01658883612877
lambda[  13] =   0.02990898356734
lambda[  14] =   0.03689104327515
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 3.909 ms
rank =  0, Distributing orbital back into band + domain format took 12.906 ms
rank = 0, Subspace_Rotation used 16.829 ms

Total time for subspace rotation: 16.840 ms
rank = 0, Efermi =  -0.073835185833 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.560 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.734 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.091 ms
rank = 0, Calculating density took 1404.341 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.611 ms
rank = 0, D2D took 0.954 ms
rank = 0, Transfering density took 0.964 ms
Etot    =   -24.066189994861
Eband   =    -7.183451743323
E1      =    17.199644345562
E2      =    -6.564864028476
E3      =    -9.293405375561
Exc     =    -8.308599924235
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 2.492e-07, dEband = 3.054e-04
rank = 0, Calculating/Estimating energy took 1.086 ms, Etot = -24.066189995, dEtot = 2.492e-07, dEband = 3.054e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0252555563824, which took 0.053 ms

iter_count = 108, r_2norm = 7.156e-07, tol*||rhs|| = 1.010e-06

Anderson update took 64.056 ms, out of which F'*F took 30.239 ms; b-Ax took 203.111 ms, out of which Lap took 181.339 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.266 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140102, int_b + int_rho = 4.547e-14, checking this took 0.127 ms
2-norm of RHS = 579.5683015845020, which took 0.137 ms

iter_count = 150, r_2norm = 4.871e-04, tol*||rhs|| = 5.796e-04

Anderson update took 88.054 ms, out of which F'*F took 41.291 ms; b-Ax took 278.749 ms, out of which Lap took 247.058 ms
Solving Poisson took 620.987 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.124590 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.083885 
Total time for convolution: 	 convolve: 5.077110 
Total time for convolution: 	 convolve: 5.074848 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.744 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.315 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.006 ms

This SCF took 26839.543 ms, scf error = 1.503e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.136891, lowerbound = -0.867089, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1371.887 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.830 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.531 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.394 ms
rank =  0, finding HY took 20.989 ms
rank =  0, distributing HY into block cyclic form took 14.910 ms
rank =  0, finding Y'*HY took 2.280 ms
Rank 0, Project_Hamiltonian used 54.605 ms
Total time for projection: 54.622 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 1.067 ms
    first calculated eigval = -0.866953067373204
    last  calculated eigval = 0.037165466628774
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.86695306737320
lambda[   2] =  -0.59740905970848
lambda[   3] =  -0.52671991392634
lambda[   4] =  -0.46861321174208
lambda[   5] =  -0.37616397745400
lambda[   6] =  -0.29543748875952
lambda[   7] =  -0.28575053286313
lambda[   8] =  -0.17373966383131
lambda[   9] =  -0.04470136111310
lambda[  10] =  -0.01616138216634
lambda[  11] =   0.00350768940132
lambda[  12] =   0.01591371480563
lambda[  13] =   0.02946892718976
lambda[  14] =   0.03716546662877
==subpsace eigenproblem: bcast eigvals took 0.554 ms
Total time for solving subspace eigenvalue problem: 1.629 ms
rank =  0, subspace rotation using ScaLAPACK took 4.034 ms
rank =  0, Distributing orbital back into band + domain format took 14.287 ms
rank = 0, Subspace_Rotation used 18.335 ms

Total time for subspace rotation: 18.341 ms
rank = 0, Efermi =  -0.073806779236 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.619 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.726 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1450.073 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.628 ms
rank = 0, D2D took 0.935 ms
rank = 0, Transfering density took 0.948 ms
Etot    =   -24.066213409972
Eband   =    -7.181573832273
E1      =    17.198629674919
E2      =    -6.563940080963
E3      =    -9.293548475140
Exc     =    -8.308705731819
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 3.903e-06, dEband = 3.130e-04
rank = 0, Calculating/Estimating energy took 1.112 ms, Etot = -24.066213410, dEtot = 3.903e-06, dEband = 3.130e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0173545663786, which took 0.093 ms

iter_count = 108, r_2norm = 6.476e-07, tol*||rhs|| = 6.942e-07

Anderson update took 64.207 ms, out of which F'*F took 29.869 ms; b-Ax took 202.855 ms, out of which Lap took 181.166 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.133 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140099, int_b + int_rho = 7.276e-15, checking this took 0.114 ms
2-norm of RHS = 579.5682960425468, which took 0.149 ms

iter_count = 126, r_2norm = 5.236e-04, tol*||rhs|| = 5.796e-04

Anderson update took 74.143 ms, out of which F'*F took 34.290 ms; b-Ax took 235.109 ms, out of which Lap took 208.919 ms
Solving Poisson took 521.814 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.078675 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.260 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.089744 
Total time for convolution: 	 convolve: 5.116776 
Total time for convolution: 	 convolve: 5.089917 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.666 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.315 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.010 ms

This SCF took 26835.223 ms, scf error = 1.038e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.137165, lowerbound = -0.866953, upperbound = 267.580554

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1371.955 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.820 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.539 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 16.402 ms
rank =  0, finding HY took 21.086 ms
rank =  0, distributing HY into block cyclic form took 14.852 ms
rank =  0, finding Y'*HY took 2.309 ms
Rank 0, Project_Hamiltonian used 55.769 ms
Total time for projection: 55.787 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -0.866947701142485
    last  calculated eigval = 0.035702107216879
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.86694770114249
lambda[   2] =  -0.59739493829159
lambda[   3] =  -0.52669336041289
lambda[   4] =  -0.46859081233725
lambda[   5] =  -0.37615368381949
lambda[   6] =  -0.29542497805367
lambda[   7] =  -0.28574419634654
lambda[   8] =  -0.17373688315325
lambda[   9] =  -0.04473085790088
lambda[  10] =  -0.01712588383431
lambda[  11] =   0.00270729324903
lambda[  12] =   0.01490097651755
lambda[  13] =   0.02823472715425
lambda[  14] =   0.03570210721688
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 3.978 ms
rank =  0, Distributing orbital back into band + domain format took 14.393 ms
rank = 0, Subspace_Rotation used 18.384 ms

Total time for subspace rotation: 18.389 ms
rank = 0, Efermi =  -0.073836276050 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.646 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.718 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1449.909 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.591 ms
rank = 0, D2D took 0.955 ms
rank = 0, Transfering density took 0.969 ms
Etot    =   -24.066220394079
Eband   =    -7.181373108072
E1      =    17.198596581300
E2      =    -6.563778906154
E3      =    -9.293476114358
Exc     =    -8.308646810917
Esc     =   -41.632052076260
Entropy =    -0.000000000642
dE = 1.164e-06, dEband = 3.345e-05
rank = 0, Calculating/Estimating energy took 1.117 ms, Etot = -24.066220394, dEtot = 1.164e-06, dEband = 3.345e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0073412083220, which took 0.092 ms

iter_count = 120, r_2norm = 1.737e-07, tol*||rhs|| = 2.936e-07

Anderson update took 71.114 ms, out of which F'*F took 33.424 ms; b-Ax took 225.540 ms, out of which Lap took 201.410 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 506.804 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000002140098, int_rho =  16.00000002140092, int_b + int_rho = -6.185e-14, checking this took 0.117 ms
2-norm of RHS = 579.5661843234492, which took 0.114 ms

iter_count = 114, r_2norm = 5.474e-04, tol*||rhs|| = 5.796e-04

Anderson update took 67.017 ms, out of which F'*F took 31.378 ms; b-Ax took 212.411 ms, out of which Lap took 188.354 ms
Solving Poisson took 473.000 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.079438 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.666 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.852 ms
Total time for convolution: 	 convolve: 5.097608 
Total time for convolution: 	 convolve: 5.079986 
Total time for convolution: 	 convolve: 5.076357 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.680 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.015 ms

This SCF took 26787.951 ms, scf error = 9.183e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -0.86694770114249, occ[   1] =   2.00000000000000
lambda[   2] =  -0.59739493829159, occ[   2] =   2.00000000000000
lambda[   3] =  -0.52669336041289, occ[   3] =   2.00000000000000
lambda[   4] =  -0.46859081233725, occ[   4] =   2.00000000000000
lambda[   5] =  -0.37615368381949, occ[   5] =   2.00000000000000
lambda[   6] =  -0.29542497805367, occ[   6] =   2.00000000000000
lambda[   7] =  -0.28574419634654, occ[   7] =   2.00000000000000
lambda[   8] =  -0.17373688315325, occ[   8] =   2.00000000000000
lambda[   9] =  -0.04473085790088, occ[   9] =   0.00000002140095
lambda[  10] =  -0.01712588383431, occ[  10] =   0.00000000000000
lambda[  11] =   0.00270729324903, occ[  11] =   0.00000000000000
lambda[  12] =   0.01490097651755, occ[  12] =   0.00000000000000
lambda[  13] =   0.02823472715425, occ[  13] =   0.00000000000000
lambda[  14] =   0.03570210721688, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.659 ms, time for Allreduce/Reduce: 6.257 ms 
Time for calculating local force components: 16.104 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.05843318810366  -0.02168737309900  -0.00000001482064
  0.00433706949983   0.02119044274647  -0.04921556744394
  0.00433707363277   0.02119042971605   0.04921549083132
  0.00652064746432   0.16775401575174  -0.08434391320850
  0.00651962433678   0.16775308956388   0.08434374603697
  0.66240436288921  -0.72193244096204   0.00000086423554
force_loc = 
  0.06240812924541   0.02503732624223   0.00000018042214
 -0.00464341224808  -0.02278078468904   0.05275747912811
 -0.00464305483411  -0.02278061900118  -0.05275770697988
 -0.00640311136011  -0.16129861147434   0.08287218860998
 -0.00640223685250  -0.16129733724059  -0.08286901536212
 -0.64616824329694   0.69854314892904  -0.00000034187319
Time for calculating nonlocal force components: 28.048 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00057034114856  -0.00650916307052  -0.00625319440387
[0m[32m -0.00057026273089  -0.00650906613134   0.00625325658445
[0m[32m -0.01866645371861   0.02335880954412  -0.00000005044074
[0mTime for calculating XC forces components: 20.859 ms
 Cartesian force = 
  0.00397050734594   0.00334464200564  -0.00000040128444
 -0.00031077654406  -0.00159565308015   0.00354134479823
 -0.00031041499715  -0.00159550042271  -0.00354278303450
 -0.00045723884016  -0.00005906993069  -0.00772548588832
 -0.00045730904242  -0.00005862494563   0.00772742037336
 -0.00243476792216  -0.00003579362646  -0.00000009496432
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.362 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.963 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Time for printing density: 397.386 ms
The program took 549.665 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:40
Job ID:        2266664
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:53:00,vmem=8344K,walltime=00:09:25,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-16-1
---------------------------------------
