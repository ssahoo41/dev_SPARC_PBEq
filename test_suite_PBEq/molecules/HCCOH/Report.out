---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:55
Job ID:    2266797
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:22:01
Job ID:    2266797
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.093 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 16.559 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 14.145 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 84.189 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.973 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.167 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    9.186494	    7.040819	   10.000000	
    9.934355	   13.777423	   10.000000	
   10.813506	    6.222577	   10.000000	
    9.545094	    9.508197	   10.000000	
    9.746951	   11.781118	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.242 ms
Set up communicators.

--set up spincomm took 3.803 ms

--set up kptcomm took 0.347 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.093 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.463 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 9.132 ms

Calculate_SplineDerivRadFun took 0.213 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.279 ms.
time spent on vectorized spline interp: 2.861 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.007 ms.
time spent on vectorized spline interp: 1.404 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.299 ms.
time spent on vectorized spline interp: 1.859 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.955 ms.

Calculating rb for all atom types took 15.691 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.821 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000129648, sum_int_rho = 15.7910709946716
PosCharge = 16.000000012965, NegCharge = -15.791070994672, scal_fac = 1.013230832688
After scaling, int_rho = 16.0000000129648, PosCharge + NegCharge - NetCharge = 3.908e-14
--Calculate Vref took 0.391 ms
--Calculate rho_guess took 2.084 ms

 integral of b = -16.0000000129648,
 int{b} + Nelectron + NetCharge = -1.296e-08,
 Esc = -47.6240392062252,
 MPI_Reduce took 4.596 ms

Calculating b & b_ref took 12.711 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.010 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.017 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 26.974 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296483, int_b + int_rho = 5.457e-15, checking this took 0.090 ms
2-norm of RHS = 544.5830537401621, which took 0.435 ms

iter_count = 420, r_2norm = 5.206e-04, tol*||rhs|| = 5.446e-04

Anderson update took 236.472 ms, out of which F'*F took 106.401 ms; b-Ax took 729.324 ms, out of which Lap took 655.658 ms
Solving Poisson took 1537.134 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.434 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.823 ms
Total time for convolution: 	 convolve: 5.139627 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
Total time for convolution: 	 convolve: 5.144300 
Total time for convolution: 	 convolve: 5.106670 
Total time for convolution: 	 convolve: 5.126229 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.738 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.383 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
rank = 0, XC calculation took 24383.972 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.107 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.778 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 2.995 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.136 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.668 ms
    Lanczos iter 53, eigmin  = -1.053404478, eigmax = 264.926043802, err_eigmin = 1.890e-03, err_eigmax = 9.669e-03
rank =   0, Lanczos took 120.541 ms, eigmin = -1.053404478077, eigmax = 267.575304240402

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.210950, lowerbound = -1.153404, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1181.208 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 13.249 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.735 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.069 ms
rank =  0, Distribute data + matrix mult took 17.071 ms
rank =  0, finding HY took 19.112 ms
rank =  0, distributing HY into block cyclic form took 13.746 ms
rank =  0, finding Y'*HY took 2.036 ms
Rank 0, Project_Hamiltonian used 51.992 ms
Total time for projection: 52.003 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.443 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.521 ms
    first calculated eigval = 2.781856682282301
    last  calculated eigval = 3.194537612210784
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.78185668228230
lambda[   2] =   2.83931015349907
lambda[   3] =   2.86520538235513
lambda[   4] =   2.91122657107138
lambda[   5] =   2.95783282688651
lambda[   6] =   2.98944961334577
lambda[   7] =   3.01792216216100
lambda[   8] =   3.02626191442988
lambda[   9] =   3.06720456252599
lambda[  10] =   3.07746289270688
lambda[  11] =   3.10205155510254
lambda[  12] =   3.13551075071525
lambda[  13] =   3.14801761393534
lambda[  14] =   3.19453761221078
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.537 ms
rank =  0, subspace rotation using ScaLAPACK took 2.754 ms
rank =  0, Distributing orbital back into band + domain format took 12.232 ms
rank = 0, Subspace_Rotation used 15.001 ms

Total time for subspace rotation: 15.005 ms
rank = 0, Efermi =   3.046733537274 calculate fermi energy took 0.063 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.294538, lowerbound = -1.153404, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1180.581 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.659 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.458 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.083 ms
rank =  0, Distribute data + matrix mult took 14.212 ms
rank =  0, finding HY took 18.345 ms
rank =  0, distributing HY into block cyclic form took 12.783 ms
rank =  0, finding Y'*HY took 2.152 ms
Rank 0, Project_Hamiltonian used 47.523 ms
Total time for projection: 47.536 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -0.832422546728287
    last  calculated eigval = 0.432621951091162
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.83242254672829
lambda[   2] =  -0.66526556064558
lambda[   3] =  -0.33975755282159
lambda[   4] =  -0.18658538504108
lambda[   5] =   0.00235986985804
lambda[   6] =   0.21231144284547
lambda[   7] =   0.23253569178179
lambda[   8] =   0.28059337736281
lambda[   9] =   0.28922371303186
lambda[  10] =   0.34098642043400
lambda[  11] =   0.36784786974321
lambda[  12] =   0.39357118111003
lambda[  13] =   0.40850791037042
lambda[  14] =   0.43262195109116
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 3.266 ms
rank =  0, Distributing orbital back into band + domain format took 12.202 ms
rank = 0, Subspace_Rotation used 15.480 ms

Total time for subspace rotation: 15.485 ms
rank = 0, Efermi =   0.284908545257 calculate fermi energy took 0.018 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.532622, lowerbound = -1.153404, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1151.989 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 15.156 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.454 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.103 ms
rank =  0, Distribute data + matrix mult took 16.726 ms
rank =  0, finding HY took 18.479 ms
rank =  0, distributing HY into block cyclic form took 12.767 ms
rank =  0, finding Y'*HY took 2.469 ms
Rank 0, Project_Hamiltonian used 50.495 ms
Total time for projection: 50.500 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -1.072910932854998
    last  calculated eigval = 0.139074101517518
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.07291093285500
lambda[   2] =  -0.85902801848076
lambda[   3] =  -0.63065157769817
lambda[   4] =  -0.59580600725276
lambda[   5] =  -0.47101476665113
lambda[   6] =  -0.44307322991311
lambda[   7] =  -0.32564570748831
lambda[   8] =  -0.29811233986864
lambda[   9] =  -0.01154998571254
lambda[  10] =   0.02820066008421
lambda[  11] =   0.08235508287982
lambda[  12] =   0.09287694568042
lambda[  13] =   0.11079678853088
lambda[  14] =   0.13907410151752
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 3.272 ms
rank =  0, Distributing orbital back into band + domain format took 12.168 ms
rank = 0, Subspace_Rotation used 15.452 ms

Total time for subspace rotation: 15.455 ms
rank = 0, Efermi =  -0.041103662656 calculate fermi energy took 0.018 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.239074, lowerbound = -1.153404, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1180.271 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.536 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.441 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.049 ms
rank =  0, Distribute data + matrix mult took 14.038 ms
rank =  0, finding HY took 18.409 ms
rank =  0, distributing HY into block cyclic form took 12.785 ms
rank =  0, finding Y'*HY took 2.197 ms
Rank 0, Project_Hamiltonian used 47.454 ms
Total time for projection: 47.458 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -1.073217190510487
    last  calculated eigval = 0.084340566141739
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.07321719051049
lambda[   2] =  -0.85945215851206
lambda[   3] =  -0.63335914104015
lambda[   4] =  -0.59766034214980
lambda[   5] =  -0.48921873267494
lambda[   6] =  -0.44878531046089
lambda[   7] =  -0.36206345877688
lambda[   8] =  -0.33595457819619
lambda[   9] =  -0.04993574160407
lambda[  10] =  -0.04014754287960
lambda[  11] =  -0.02499812057482
lambda[  12] =   0.04716076082387
lambda[  13] =   0.05648369371304
lambda[  14] =   0.08434056614174
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.287 ms
rank =  0, Distributing orbital back into band + domain format took 12.180 ms
rank = 0, Subspace_Rotation used 15.480 ms

Total time for subspace rotation: 15.484 ms
rank = 0, Efermi =  -0.079489421205 calculate fermi energy took 0.020 ms
rank = 0, --- Calculate rho: sum over local bands took 2.174 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.698 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.094 ms
rank = 0, Calculating density took 5079.951 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.469 ms
rank = 0, D2D took 0.704 ms
rank = 0, Transfering density took 0.712 ms
Etot    =   -29.787961351052
Eband   =    -9.599421825290
E1      =    18.596691569020
E2      =    -7.897646380902
E3      =    -9.705267806814
Exc     =    -8.764106075879
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 5.958e+00, dEband = 1.920e+00
rank = 0, Calculating/Estimating energy took 1.631 ms, Etot = -29.787961351, dEtot = 5.958e+00, dEband = 1.920e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 49.4762897350081, which took 0.046 ms

iter_count = 96, r_2norm = 1.497e-03, tol*||rhs|| = 1.979e-03

Anderson update took 51.836 ms, out of which F'*F took 24.379 ms; b-Ax took 163.648 ms, out of which Lap took 146.623 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 353.338 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296481, int_b + int_rho = -1.091e-14, checking this took 0.126 ms
2-norm of RHS = 541.4133393857419, which took 0.152 ms

iter_count = 294, r_2norm = 4.412e-04, tol*||rhs|| = 5.414e-04

Anderson update took 158.775 ms, out of which F'*F took 74.807 ms; b-Ax took 500.625 ms, out of which Lap took 450.078 ms
Solving Poisson took 1062.681 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.830 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.099731 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.143 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.088405 
Total time for convolution: 	 convolve: 5.095568 
Total time for convolution: 	 convolve: 5.135726 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.347 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.313 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.664 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 30941.715 ms, scf error = 1.676e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.184341, lowerbound = -1.073217, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1156.416 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.672 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.441 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 14.156 ms
rank =  0, finding HY took 18.224 ms
rank =  0, distributing HY into block cyclic form took 12.738 ms
rank =  0, finding Y'*HY took 2.183 ms
Rank 0, Project_Hamiltonian used 47.332 ms
Total time for projection: 47.346 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.147 ms
rank = 0, Solve_Generalized_EigenProblem used 0.236 ms
    first calculated eigval = -1.058049319946154
    last  calculated eigval = 0.057700294951789
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05804931994615
lambda[   2] =  -0.79890671577640
lambda[   3] =  -0.61646257529229
lambda[   4] =  -0.55675379683111
lambda[   5] =  -0.46820181791976
lambda[   6] =  -0.42700543242192
lambda[   7] =  -0.32471841853590
lambda[   8] =  -0.29929757658689
lambda[   9] =  -0.04602747568485
lambda[  10] =  -0.03965217242343
lambda[  11] =  -0.02976604271678
lambda[  12] =   0.02152938149489
lambda[  13] =   0.02926743094019
lambda[  14] =   0.05770029495179
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.252 ms
rank =  0, subspace rotation using ScaLAPACK took 3.251 ms
rank =  0, Distributing orbital back into band + domain format took 12.236 ms
rank = 0, Subspace_Rotation used 15.502 ms

Total time for subspace rotation: 15.506 ms
rank = 0, Efermi =  -0.075581477038 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.163 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.690 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.101 ms
rank = 0, Calculating density took 1222.596 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.425 ms
rank = 0, D2D took 0.623 ms
rank = 0, Transfering density took 0.629 ms
Etot    =   -29.724289006455
Eband   =    -9.098791307218
E1      =    18.184153756792
E2      =    -7.849310971882
E3      =    -9.828629725364
Exc     =    -8.863552946656
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 1.273e-02, dEband = 1.001e-01
rank = 0, Calculating/Estimating energy took 2.035 ms, Etot = -29.724289006, dEtot = 1.273e-02, dEband = 1.001e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 18.1500826618649, which took 0.073 ms

iter_count = 102, r_2norm = 5.810e-04, tol*||rhs|| = 7.260e-04

Anderson update took 54.171 ms, out of which F'*F took 25.401 ms; b-Ax took 173.420 ms, out of which Lap took 154.939 ms
rank = 0, Mixing (+ precond) took 376.312 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296479, int_b + int_rho = -3.638e-14, checking this took 0.097 ms
2-norm of RHS = 538.2081535470890, which took 0.109 ms

iter_count = 306, r_2norm = 4.506e-04, tol*||rhs|| = 5.382e-04

Anderson update took 168.038 ms, out of which F'*F took 77.466 ms; b-Ax took 523.504 ms, out of which Lap took 469.249 ms
Solving Poisson took 1108.443 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.420 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.119262 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.102695 
Total time for convolution: 	 convolve: 5.073228 
Total time for convolution: 	 convolve: 5.100601 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.470 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.679 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.292 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.989 ms

This SCF took 27129.490 ms, scf error = 1.083e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.157700, lowerbound = -1.058049, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1165.793 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.584 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.686 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.075 ms
rank =  0, Distribute data + matrix mult took 14.357 ms
rank =  0, finding HY took 19.428 ms
rank =  0, distributing HY into block cyclic form took 12.714 ms
rank =  0, finding Y'*HY took 2.156 ms
Rank 0, Project_Hamiltonian used 48.679 ms
Total time for projection: 48.692 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -1.034532547548601
    last  calculated eigval = 0.042301405284047
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.03453254754860
lambda[   2] =  -0.71281402049353
lambda[   3] =  -0.58911854207538
lambda[   4] =  -0.49819023217193
lambda[   5] =  -0.43605545884697
lambda[   6] =  -0.39477053866360
lambda[   7] =  -0.27084351270221
lambda[   8] =  -0.24738075423502
lambda[   9] =  -0.04888907664154
lambda[  10] =  -0.00815188036344
lambda[  11] =   0.00449723888158
lambda[  12] =   0.01264638718508
lambda[  13] =   0.02061346075344
lambda[  14] =   0.04230140528405
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 3.290 ms
rank =  0, Distributing orbital back into band + domain format took 12.402 ms
rank = 0, Subspace_Rotation used 15.726 ms

Total time for subspace rotation: 15.730 ms
rank = 0, Efermi =  -0.078442753695 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.931 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.567 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1233.106 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.391 ms
rank = 0, D2D took 1.112 ms
rank = 0, Transfering density took 1.121 ms
Etot    =   -29.681936716192
Eband   =    -8.367411214108
E1      =    17.599452024802
E2      =    -7.705763530809
E3      =   -10.024593549246
Exc     =    -9.020295400322
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 8.470e-03, dEband = 1.463e-01
rank = 0, Calculating/Estimating energy took 1.158 ms, Etot = -29.681936716, dEtot = 8.470e-03, dEband = 1.463e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.7752454057712, which took 0.053 ms

iter_count = 102, r_2norm = 2.252e-04, tol*||rhs|| = 2.310e-04

Anderson update took 54.595 ms, out of which F'*F took 25.581 ms; b-Ax took 173.069 ms, out of which Lap took 155.028 ms
rank = 0, Mixing (+ precond) took 376.991 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296480, int_b + int_rho = -1.819e-14, checking this took 0.102 ms
2-norm of RHS = 538.7341876968667, which took 0.118 ms

iter_count = 282, r_2norm = 4.799e-04, tol*||rhs|| = 5.387e-04

Anderson update took 150.622 ms, out of which F'*F took 71.089 ms; b-Ax took 479.146 ms, out of which Lap took 430.707 ms
Solving Poisson took 1017.460 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Total time for convolution: 	 convolve: 5.078681 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 58.855 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.078095 
Total time for convolution: 	 convolve: 5.074336 
Total time for convolution: 	 convolve: 5.076016 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.358 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.689 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.004 ms

This SCF took 27035.329 ms, scf error = 3.968e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.142301, lowerbound = -1.034533, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1143.312 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.592 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.427 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.165 ms
rank =  0, Distribute data + matrix mult took 14.194 ms
rank =  0, finding HY took 18.382 ms
rank =  0, distributing HY into block cyclic form took 12.507 ms
rank =  0, finding Y'*HY took 2.298 ms
Rank 0, Project_Hamiltonian used 47.410 ms
Total time for projection: 47.424 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -1.025325927954792
    last  calculated eigval = 0.034659770555522
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02532592795479
lambda[   2] =  -0.68954144700034
lambda[   3] =  -0.57864151326844
lambda[   4] =  -0.48216249469272
lambda[   5] =  -0.42521892749539
lambda[   6] =  -0.38308082987732
lambda[   7] =  -0.25528223693299
lambda[   8] =  -0.23364913718619
lambda[   9] =  -0.04903130188458
lambda[  10] =   0.00133456207808
lambda[  11] =   0.00729919915489
lambda[  12] =   0.01378459953609
lambda[  13] =   0.01473007421964
lambda[  14] =   0.03465977055552
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 3.217 ms
rank =  0, Distributing orbital back into band + domain format took 12.007 ms
rank = 0, Subspace_Rotation used 15.242 ms

Total time for subspace rotation: 15.247 ms
rank = 0, Efermi =  -0.078584978930 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.999 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.036 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.107 ms
rank = 0, Calculating density took 1209.415 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.419 ms
rank = 0, D2D took 0.706 ms
rank = 0, Transfering density took 0.714 ms
Etot    =   -29.677861341569
Eband   =    -8.145805029452
E1      =    17.463912725480
E2      =    -7.610123911559
E3      =   -10.080831269356
Exc     =    -9.062885011892
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 8.151e-04, dEband = 4.432e-02
rank = 0, Calculating/Estimating energy took 1.048 ms, Etot = -29.677861342, dEtot = 8.151e-04, dEband = 4.432e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.3722694675868, which took 0.098 ms

iter_count = 108, r_2norm = 1.003e-04, tol*||rhs|| = 1.349e-04

Anderson update took 57.512 ms, out of which F'*F took 26.823 ms; b-Ax took 182.740 ms, out of which Lap took 162.773 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.856 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296479, int_b + int_rho = -3.092e-14, checking this took 0.098 ms
2-norm of RHS = 539.1411715875911, which took 0.117 ms

iter_count = 258, r_2norm = 5.300e-04, tol*||rhs|| = 5.391e-04

Anderson update took 137.718 ms, out of which F'*F took 65.419 ms; b-Ax took 439.016 ms, out of which Lap took 394.505 ms
Solving Poisson took 932.541 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.357 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.085510 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.097668 
Total time for convolution: 	 convolve: 5.100536 
Total time for convolution: 	 convolve: 5.221582 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.369 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.165 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.681 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.006 ms

This SCF took 27053.732 ms, scf error = 1.554e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.134660, lowerbound = -1.025326, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1167.605 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.655 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.436 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.140 ms
rank =  0, Distribute data + matrix mult took 14.242 ms
rank =  0, finding HY took 18.161 ms
rank =  0, distributing HY into block cyclic form took 12.602 ms
rank =  0, finding Y'*HY took 2.430 ms
Rank 0, Project_Hamiltonian used 47.465 ms
Total time for projection: 47.481 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.038 ms
rank = 0, Solve_Generalized_EigenProblem used 0.132 ms
    first calculated eigval = -1.023588704008437
    last  calculated eigval = 0.031146280492428
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02358870400844
lambda[   2] =  -0.68429983306818
lambda[   3] =  -0.57627614991161
lambda[   4] =  -0.47502473596096
lambda[   5] =  -0.42283229980781
lambda[   6] =  -0.38079248384617
lambda[   7] =  -0.25085326840111
lambda[   8] =  -0.22903943807248
lambda[   9] =  -0.04935707255439
lambda[  10] =   0.00121369657251
lambda[  11] =   0.00416620204828
lambda[  12] =   0.01216735164336
lambda[  13] =   0.01590431995276
lambda[  14] =   0.03114628049243
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 3.244 ms
rank =  0, Distributing orbital back into band + domain format took 11.983 ms
rank = 0, Subspace_Rotation used 15.239 ms

Total time for subspace rotation: 15.243 ms
rank = 0, Efermi =  -0.078910749544 calculate fermi energy took 0.374 ms
rank = 0, --- Calculate rho: sum over local bands took 2.141 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.810 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.100 ms
rank = 0, Calculating density took 1233.982 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.509 ms
rank = 0, D2D took 0.704 ms
rank = 0, Transfering density took 0.707 ms
Etot    =   -29.677060968844
Eband   =    -8.085413826793
E1      =    17.437667127656
E2      =    -7.572254084219
E3      =   -10.096019686395
Exc     =    -9.073548833702
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 1.601e-04, dEband = 1.208e-02
rank = 0, Calculating/Estimating energy took 0.994 ms, Etot = -29.677060969, dEtot = 1.601e-04, dEband = 1.208e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9281039011665, which took 0.096 ms

iter_count = 114, r_2norm = 2.473e-05, tol*||rhs|| = 3.712e-05

Anderson update took 60.866 ms, out of which F'*F took 28.778 ms; b-Ax took 193.479 ms, out of which Lap took 173.873 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.509 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296485, int_b + int_rho = 2.547e-14, checking this took 0.118 ms
2-norm of RHS = 539.7621558541879, which took 0.108 ms

iter_count = 264, r_2norm = 4.763e-04, tol*||rhs|| = 5.398e-04

Anderson update took 142.536 ms, out of which F'*F took 66.415 ms; b-Ax took 447.952 ms, out of which Lap took 399.971 ms
Solving Poisson took 952.373 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.465 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.074778 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.644 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.068934 
Total time for convolution: 	 convolve: 5.071972 
Total time for convolution: 	 convolve: 5.072596 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.601 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.125 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.678 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.000 ms

This SCF took 26917.768 ms, scf error = 9.399e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.131146, lowerbound = -1.023589, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1166.296 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.621 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.432 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.198 ms
rank =  0, Distribute data + matrix mult took 14.262 ms
rank =  0, finding HY took 18.161 ms
rank =  0, distributing HY into block cyclic form took 12.738 ms
rank =  0, finding Y'*HY took 2.142 ms
Rank 0, Project_Hamiltonian used 47.330 ms
Total time for projection: 47.345 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -1.021132000565031
    last  calculated eigval = 0.030572418910905
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02113200056503
lambda[   2] =  -0.68054946710329
lambda[   3] =  -0.57371465787237
lambda[   4] =  -0.46946468102003
lambda[   5] =  -0.42021585900385
lambda[   6] =  -0.37799253163510
lambda[   7] =  -0.24708354503691
lambda[   8] =  -0.22526138695221
lambda[   9] =  -0.04923331378297
lambda[  10] =  -0.00088274650296
lambda[  11] =   0.00643283706762
lambda[  12] =   0.01235295877114
lambda[  13] =   0.01823671215687
lambda[  14] =   0.03057241891091
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 3.033 ms
rank =  0, Distributing orbital back into band + domain format took 12.026 ms
rank = 0, Subspace_Rotation used 15.078 ms

Total time for subspace rotation: 15.082 ms
rank = 0, Efermi =  -0.078786990791 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.062 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.745 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.090 ms
rank = 0, Calculating density took 1231.941 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.437 ms
rank = 0, D2D took 1.080 ms
rank = 0, Transfering density took 1.088 ms
Etot    =   -29.676458273566
Eband   =    -8.030828259016
E1      =    17.424960082454
E2      =    -7.526869983713
E3      =   -10.106683082955
Exc     =    -9.080103957053
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 1.205e-04, dEband = 1.092e-02
rank = 0, Calculating/Estimating energy took 0.906 ms, Etot = -29.676458274, dEtot = 1.205e-04, dEband = 1.092e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4689962923397, which took 0.050 ms

iter_count = 114, r_2norm = 1.272e-05, tol*||rhs|| = 1.876e-05

Anderson update took 61.385 ms, out of which F'*F took 28.566 ms; b-Ax took 193.507 ms, out of which Lap took 173.651 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.159 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296480, int_b + int_rho = -2.183e-14, checking this took 0.091 ms
2-norm of RHS = 539.7954629567963, which took 0.124 ms

iter_count = 246, r_2norm = 4.880e-04, tol*||rhs|| = 5.398e-04

Anderson update took 131.531 ms, out of which F'*F took 62.158 ms; b-Ax took 423.378 ms, out of which Lap took 379.659 ms
Solving Poisson took 888.458 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.095751 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.089852 
Total time for convolution: 	 convolve: 5.160065 
Total time for convolution: 	 convolve: 5.080794 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.582 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.991 ms

This SCF took 26975.069 ms, scf error = 3.881e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.130572, lowerbound = -1.021132, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1116.071 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.505 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.416 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.117 ms
rank =  0, Distribute data + matrix mult took 14.049 ms
rank =  0, finding HY took 18.506 ms
rank =  0, distributing HY into block cyclic form took 12.705 ms
rank =  0, finding Y'*HY took 2.154 ms
Rank 0, Project_Hamiltonian used 47.459 ms
Total time for projection: 47.478 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -1.018518137102821
    last  calculated eigval = 0.031839293193184
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01851813710282
lambda[   2] =  -0.67645176354298
lambda[   3] =  -0.57118635355600
lambda[   4] =  -0.46612541316914
lambda[   5] =  -0.41742130222996
lambda[   6] =  -0.37507587228862
lambda[   7] =  -0.24333009846917
lambda[   8] =  -0.22158554731339
lambda[   9] =  -0.04886492263300
lambda[  10] =  -0.00076374473669
lambda[  11] =   0.00953275472524
lambda[  12] =   0.01352208893123
lambda[  13] =   0.02118813043902
lambda[  14] =   0.03183929319318
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 2.857 ms
rank =  0, Distributing orbital back into band + domain format took 12.144 ms
rank = 0, Subspace_Rotation used 15.019 ms

Total time for subspace rotation: 15.022 ms
rank = 0, Efermi =  -0.078418599566 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.037 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.710 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.095 ms
rank = 0, Calculating density took 1181.707 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.416 ms
rank = 0, D2D took 1.199 ms
rank = 0, Transfering density took 1.207 ms
Etot    =   -29.676122657767
Eband   =    -7.979388975978
E1      =    17.399016010351
E2      =    -7.499448219599
E3      =   -10.114564464012
Exc     =    -9.085723169133
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 6.712e-05, dEband = 1.029e-02
rank = 0, Calculating/Estimating energy took 0.907 ms, Etot = -29.676122658, dEtot = 6.712e-05, dEband = 1.029e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2520407718633, which took 0.047 ms

iter_count = 114, r_2norm = 7.572e-06, tol*||rhs|| = 1.008e-05

Anderson update took 61.202 ms, out of which F'*F took 28.317 ms; b-Ax took 194.023 ms, out of which Lap took 172.695 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.154 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296478, int_b + int_rho = -4.366e-14, checking this took 0.115 ms
2-norm of RHS = 539.8532713055761, which took 0.094 ms

iter_count = 240, r_2norm = 5.274e-04, tol*||rhs|| = 5.399e-04

Anderson update took 128.492 ms, out of which F'*F took 60.190 ms; b-Ax took 408.137 ms, out of which Lap took 365.164 ms
Solving Poisson took 863.556 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.075081 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.551 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.124783 
Total time for convolution: 	 convolve: 5.089343 
Total time for convolution: 	 convolve: 5.100855 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.820 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.410 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.000 ms

This SCF took 26876.862 ms, scf error = 2.237e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.131839, lowerbound = -1.018518, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.268 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.613 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.437 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.308 ms
rank =  0, Distribute data + matrix mult took 14.373 ms
rank =  0, finding HY took 18.744 ms
rank =  0, distributing HY into block cyclic form took 12.736 ms
rank =  0, finding Y'*HY took 2.161 ms
Rank 0, Project_Hamiltonian used 48.044 ms
Total time for projection: 48.062 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -1.017647921996870
    last  calculated eigval = 0.033964401316784
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01764792199687
lambda[   2] =  -0.67420792499993
lambda[   3] =  -0.57017344074049
lambda[   4] =  -0.46397529358485
lambda[   5] =  -0.41631260821982
lambda[   6] =  -0.37382952248659
lambda[   7] =  -0.24106992113062
lambda[   8] =  -0.21942986275638
lambda[   9] =  -0.04830085656335
lambda[  10] =   0.00049820398486
lambda[  11] =   0.01236375346999
lambda[  12] =   0.01526423373701
lambda[  13] =   0.02322947525356
lambda[  14] =   0.03396440131678
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 3.273 ms
rank =  0, Distributing orbital back into band + domain format took 12.229 ms
rank = 0, Subspace_Rotation used 15.512 ms

Total time for subspace rotation: 15.516 ms
rank = 0, Efermi =  -0.077854533450 calculate fermi energy took 0.036 ms
rank = 0, --- Calculate rho: sum over local bands took 2.193 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.730 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.093 ms
rank = 0, Calculating density took 1187.122 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.460 ms
rank = 0, D2D took 0.880 ms
rank = 0, Transfering density took 0.888 ms
Etot    =   -29.675926788198
Eband   =    -7.953292992457
E1      =    17.389076731498
E2      =    -7.482640974795
E3      =   -10.116799857685
Exc     =    -9.087112153099
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 3.917e-05, dEband = 5.219e-03
rank = 0, Calculating/Estimating energy took 0.902 ms, Etot = -29.675926788, dEtot = 3.917e-05, dEband = 5.219e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2196056624028, which took 0.095 ms

iter_count = 114, r_2norm = 5.672e-06, tol*||rhs|| = 8.784e-06

Anderson update took 61.207 ms, out of which F'*F took 28.280 ms; b-Ax took 193.896 ms, out of which Lap took 172.607 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.602 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296475, int_b + int_rho = -6.548e-14, checking this took 0.110 ms
2-norm of RHS = 539.8037618311544, which took 0.113 ms

iter_count = 216, r_2norm = 4.710e-04, tol*||rhs|| = 5.398e-04

Anderson update took 115.750 ms, out of which F'*F took 54.418 ms; b-Ax took 366.863 ms, out of which Lap took 328.357 ms
Solving Poisson took 778.184 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.075998 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.079499 
Total time for convolution: 	 convolve: 5.078573 
Total time for convolution: 	 convolve: 5.083232 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.422 ms
---Transfer Veff_loc: D2D took 0.686 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.318 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.027 ms

This SCF took 26774.977 ms, scf error = 1.450e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.133964, lowerbound = -1.017648, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.548 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.645 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.423 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.211 ms
rank =  0, Distribute data + matrix mult took 14.291 ms
rank =  0, finding HY took 18.606 ms
rank =  0, distributing HY into block cyclic form took 12.706 ms
rank =  0, finding Y'*HY took 2.162 ms
Rank 0, Project_Hamiltonian used 47.790 ms
Total time for projection: 47.803 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -1.017070018496165
    last  calculated eigval = 0.033750091095780
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01707001849616
lambda[   2] =  -0.67270737813184
lambda[   3] =  -0.56949158063215
lambda[   4] =  -0.46280088627392
lambda[   5] =  -0.41558053079815
lambda[   6] =  -0.37307117830087
lambda[   7] =  -0.23985412995872
lambda[   8] =  -0.21828508350850
lambda[   9] =  -0.04772292966168
lambda[  10] =   0.00044680739986
lambda[  11] =   0.01318155770651
lambda[  12] =   0.01622115319882
lambda[  13] =   0.02307776610851
lambda[  14] =   0.03375009109578
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 3.321 ms
rank =  0, Distributing orbital back into band + domain format took 12.096 ms
rank = 0, Subspace_Rotation used 15.429 ms

Total time for subspace rotation: 15.432 ms
rank = 0, Efermi =  -0.077276606485 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.153 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.751 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.088 ms
rank = 0, Calculating density took 1187.093 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.515 ms
rank = 0, D2D took 0.797 ms
rank = 0, Transfering density took 0.801 ms
Etot    =   -29.675992864462
Eband   =    -7.937721572819
E1      =    17.379358569644
E2      =    -7.476279758139
E3      =   -10.119063769558
Exc     =    -9.088934182364
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 1.322e-05, dEband = 3.114e-03
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -29.675992864, dEtot = 1.322e-05, dEband = 3.114e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1143682124827, which took 0.052 ms

iter_count = 114, r_2norm = 2.897e-06, tol*||rhs|| = 4.575e-06

Anderson update took 61.160 ms, out of which F'*F took 28.462 ms; b-Ax took 194.074 ms, out of which Lap took 172.760 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.516 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296485, int_b + int_rho = 3.092e-14, checking this took 0.098 ms
2-norm of RHS = 539.7850875292061, which took 0.098 ms

iter_count = 222, r_2norm = 5.282e-04, tol*||rhs|| = 5.398e-04

Anderson update took 119.160 ms, out of which F'*F took 55.773 ms; b-Ax took 376.637 ms, out of which Lap took 337.222 ms
Solving Poisson took 799.462 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.982 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.073086 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.074235 
Total time for convolution: 	 convolve: 5.089236 
Total time for convolution: 	 convolve: 5.099950 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.412 ms
---Transfer Veff_loc: D2D took 0.663 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.029 ms

This SCF took 26799.968 ms, scf error = 1.096e-03
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.133750, lowerbound = -1.017070, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1119.887 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.605 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.425 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.165 ms
rank =  0, Distribute data + matrix mult took 14.207 ms
rank =  0, finding HY took 18.559 ms
rank =  0, distributing HY into block cyclic form took 12.721 ms
rank =  0, finding Y'*HY took 2.128 ms
Rank 0, Project_Hamiltonian used 47.643 ms
Total time for projection: 47.657 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -1.016454829760397
    last  calculated eigval = 0.033819720540959
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01645482976040
lambda[   2] =  -0.67207032660667
lambda[   3] =  -0.56891869695970
lambda[   4] =  -0.46180388926825
lambda[   5] =  -0.41497567357288
lambda[   6] =  -0.37240226612495
lambda[   7] =  -0.23907180604431
lambda[   8] =  -0.21750123044614
lambda[   9] =  -0.04449394840454
lambda[  10] =   0.00217704527803
lambda[  11] =   0.01409157734036
lambda[  12] =   0.01963205218913
lambda[  13] =   0.02369428728218
lambda[  14] =   0.03381972054096
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.327 ms
rank =  0, Distributing orbital back into band + domain format took 12.130 ms
rank = 0, Subspace_Rotation used 15.470 ms

Total time for subspace rotation: 15.475 ms
rank = 0, Efermi =  -0.074047625549 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.188 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.765 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1186.349 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.523 ms
rank = 0, D2D took 0.782 ms
rank = 0, Transfering density took 0.784 ms
Etot    =   -29.676136712396
Eband   =    -7.926397438143
E1      =    17.374890933094
E2      =    -7.469403773721
E3      =   -10.118860291765
Exc     =    -9.088855066213
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 2.877e-05, dEband = 2.265e-03
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -29.676136712, dEtot = 2.877e-05, dEband = 2.265e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0736588964474, which took 0.103 ms

iter_count = 114, r_2norm = 2.125e-06, tol*||rhs|| = 2.946e-06

Anderson update took 61.203 ms, out of which F'*F took 28.393 ms; b-Ax took 193.943 ms, out of which Lap took 172.663 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.505 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296484, int_b + int_rho = 2.001e-14, checking this took 0.122 ms
2-norm of RHS = 539.8013342955635, which took 0.784 ms

iter_count = 204, r_2norm = 4.404e-04, tol*||rhs|| = 5.398e-04

Anderson update took 109.369 ms, out of which F'*F took 51.288 ms; b-Ax took 346.471 ms, out of which Lap took 310.163 ms
Solving Poisson took 735.643 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.073106 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.631 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.083591 
Total time for convolution: 	 convolve: 5.084036 
Total time for convolution: 	 convolve: 5.155250 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.437 ms
---Transfer Veff_loc: D2D took 0.737 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.441 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.198 ms

This SCF took 26778.531 ms, scf error = 6.513e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.133820, lowerbound = -1.016455, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1134.732 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.571 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.426 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.277 ms
rank =  0, Distribute data + matrix mult took 14.285 ms
rank =  0, finding HY took 18.775 ms
rank =  0, distributing HY into block cyclic form took 12.665 ms
rank =  0, finding Y'*HY took 2.235 ms
Rank 0, Project_Hamiltonian used 47.988 ms
Total time for projection: 48.003 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -1.015677979154497
    last  calculated eigval = 0.034493413827289
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01567797915450
lambda[   2] =  -0.67115492011954
lambda[   3] =  -0.56816906399169
lambda[   4] =  -0.46095685165865
lambda[   5] =  -0.41424466997492
lambda[   6] =  -0.37163554728239
lambda[   7] =  -0.23822334626230
lambda[   8] =  -0.21668211808704
lambda[   9] =  -0.04205247984791
lambda[  10] =   0.00187939391478
lambda[  11] =   0.01417281055455
lambda[  12] =   0.02170912390987
lambda[  13] =   0.02344522687973
lambda[  14] =   0.03449341382729
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 3.327 ms
rank =  0, Distributing orbital back into band + domain format took 12.159 ms
rank = 0, Subspace_Rotation used 15.497 ms

Total time for subspace rotation: 15.501 ms
rank = 0, Efermi =  -0.071606156793 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.160 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.813 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.090 ms
rank = 0, Calculating density took 1201.553 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.523 ms
rank = 0, D2D took 0.737 ms
rank = 0, Transfering density took 0.740 ms
Etot    =   -29.676232663542
Eband   =    -7.913488993607
E1      =    17.367981494738
E2      =    -7.462955450529
E3      =   -10.120515467132
Exc     =    -9.090156875714
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 1.919e-05, dEband = 2.582e-03
rank = 0, Calculating/Estimating energy took 0.974 ms, Etot = -29.676232664, dEtot = 1.919e-05, dEband = 2.582e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0621110195901, which took 0.086 ms

iter_count = 114, r_2norm = 1.531e-06, tol*||rhs|| = 2.484e-06

Anderson update took 61.291 ms, out of which F'*F took 28.273 ms; b-Ax took 193.911 ms, out of which Lap took 172.681 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.278 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296485, int_b + int_rho = 2.547e-14, checking this took 0.102 ms
2-norm of RHS = 539.8088709457570, which took 0.089 ms

iter_count = 186, r_2norm = 5.141e-04, tol*||rhs|| = 5.398e-04

Anderson update took 99.922 ms, out of which F'*F took 46.704 ms; b-Ax took 315.666 ms, out of which Lap took 282.662 ms
Solving Poisson took 670.753 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.071258 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.650 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.226276 
Total time for convolution: 	 convolve: 5.083414 
Total time for convolution: 	 convolve: 5.085630 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.415 ms
---Transfer Veff_loc: D2D took 0.675 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.995 ms

This SCF took 26765.068 ms, scf error = 4.245e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.134493, lowerbound = -1.015678, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1118.604 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.587 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.423 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.226 ms
rank =  0, Distribute data + matrix mult took 14.248 ms
rank =  0, finding HY took 18.473 ms
rank =  0, distributing HY into block cyclic form took 12.738 ms
rank =  0, finding Y'*HY took 2.135 ms
Rank 0, Project_Hamiltonian used 47.621 ms
Total time for projection: 47.635 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -1.015298436972074
    last  calculated eigval = 0.035825296195754
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01529843697207
lambda[   2] =  -0.67081916421206
lambda[   3] =  -0.56781031351553
lambda[   4] =  -0.46057401437926
lambda[   5] =  -0.41390016315086
lambda[   6] =  -0.37128013882062
lambda[   7] =  -0.23786232715568
lambda[   8] =  -0.21631908867597
lambda[   9] =  -0.03904647115020
lambda[  10] =   0.00202739732633
lambda[  11] =   0.01427651764251
lambda[  12] =   0.02384020343022
lambda[  13] =   0.02511450466782
lambda[  14] =   0.03582529619575
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 3.299 ms
rank =  0, Distributing orbital back into band + domain format took 12.095 ms
rank = 0, Subspace_Rotation used 15.407 ms

Total time for subspace rotation: 15.410 ms
rank = 0, Efermi =  -0.068600148146 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.173 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.749 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1184.906 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.473 ms
rank = 0, D2D took 0.841 ms
rank = 0, Transfering density took 0.845 ms
Etot    =   -29.676279793956
Eband   =    -7.907727294270
E1      =    17.365151416445
E2      =    -7.459919392154
E3      =   -10.120917717006
Exc     =    -9.090501818669
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 9.426e-06, dEband = 1.152e-03
rank = 0, Calculating/Estimating energy took 0.934 ms, Etot = -29.676279794, dEtot = 9.426e-06, dEband = 1.152e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0494096971573, which took 0.082 ms

iter_count = 114, r_2norm = 1.262e-06, tol*||rhs|| = 1.976e-06

Anderson update took 61.156 ms, out of which F'*F took 28.325 ms; b-Ax took 194.064 ms, out of which Lap took 172.585 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.585 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296480, int_b + int_rho = -1.637e-14, checking this took 0.095 ms
2-norm of RHS = 539.8113769695954, which took 0.125 ms

iter_count = 156, r_2norm = 4.668e-04, tol*||rhs|| = 5.398e-04

Anderson update took 83.626 ms, out of which F'*F took 39.393 ms; b-Ax took 264.877 ms, out of which Lap took 237.127 ms
Solving Poisson took 562.970 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.086816 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.245 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.071626 
Total time for convolution: 	 convolve: 5.101859 
Total time for convolution: 	 convolve: 5.082922 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.844 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.398 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.990 ms

This SCF took 26528.839 ms, scf error = 2.974e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.135825, lowerbound = -1.015298, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1118.408 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.660 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.430 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.148 ms
rank =  0, Distribute data + matrix mult took 14.249 ms
rank =  0, finding HY took 18.557 ms
rank =  0, distributing HY into block cyclic form took 12.778 ms
rank =  0, finding Y'*HY took 2.086 ms
Rank 0, Project_Hamiltonian used 47.695 ms
Total time for projection: 47.708 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -1.015065282869709
    last  calculated eigval = 0.035768084557066
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01506528286971
lambda[   2] =  -0.67060161242409
lambda[   3] =  -0.56759001533494
lambda[   4] =  -0.46037835891477
lambda[   5] =  -0.41367628947313
lambda[   6] =  -0.37105836052366
lambda[   7] =  -0.23765931533261
lambda[   8] =  -0.21611371683658
lambda[   9] =  -0.03843802617729
lambda[  10] =   0.00144587200495
lambda[  11] =   0.01416159528823
lambda[  12] =   0.02366239023286
lambda[  13] =   0.02588511141435
lambda[  14] =   0.03576808455707
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.302 ms
rank =  0, Distributing orbital back into band + domain format took 12.132 ms
rank = 0, Subspace_Rotation used 15.446 ms

Total time for subspace rotation: 15.450 ms
rank = 0, Efermi =  -0.067991703273 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.174 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.753 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.089 ms
rank = 0, Calculating density took 1184.861 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
rank = 0, D2D took 0.754 ms
rank = 0, Transfering density took 0.757 ms
Etot    =   -29.676318111138
Eband   =    -7.904285903917
E1      =    17.363373848589
E2      =    -7.458135755770
E3      =   -10.121278241695
Exc     =    -9.090780846654
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 7.663e-06, dEband = 6.883e-04
rank = 0, Calculating/Estimating energy took 1.694 ms, Etot = -29.676318111, dEtot = 7.663e-06, dEband = 6.883e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0328807329230, which took 0.047 ms

iter_count = 108, r_2norm = 1.202e-06, tol*||rhs|| = 1.315e-06

Anderson update took 57.998 ms, out of which F'*F took 26.823 ms; b-Ax took 183.773 ms, out of which Lap took 163.588 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.752 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296478, int_b + int_rho = -3.820e-14, checking this took 0.105 ms
2-norm of RHS = 539.8261142268211, which took 0.104 ms

iter_count = 180, r_2norm = 4.923e-04, tol*||rhs|| = 5.398e-04

Anderson update took 96.606 ms, out of which F'*F took 45.129 ms; b-Ax took 305.529 ms, out of which Lap took 273.225 ms
Solving Poisson took 648.857 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.072859 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 29.269 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.080821 
Total time for convolution: 	 convolve: 5.079252 
Total time for convolution: 	 convolve: 5.094508 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.396 ms
---Transfer Veff_loc: D2D took 0.662 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.310 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.992 ms

This SCF took 26594.426 ms, scf error = 2.400e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135768, lowerbound = -1.015065, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1117.718 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.659 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.412 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.162 ms
rank =  0, Distribute data + matrix mult took 14.246 ms
rank =  0, finding HY took 18.559 ms
rank =  0, distributing HY into block cyclic form took 12.732 ms
rank =  0, finding Y'*HY took 2.119 ms
Rank 0, Project_Hamiltonian used 47.683 ms
Total time for projection: 47.696 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.095 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -1.014922982090865
    last  calculated eigval = 0.037101491438964
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01492298209086
lambda[   2] =  -0.67048210496098
lambda[   3] =  -0.56743266909512
lambda[   4] =  -0.46022772814576
lambda[   5] =  -0.41351494571685
lambda[   6] =  -0.37090549191215
lambda[   7] =  -0.23752435076582
lambda[   8] =  -0.21597932744617
lambda[   9] =  -0.03873530204831
lambda[  10] =   0.00120552834308
lambda[  11] =   0.01447677533533
lambda[  12] =   0.02411647830443
lambda[  13] =   0.02636924614954
lambda[  14] =   0.03710149143896
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 3.310 ms
rank =  0, Distributing orbital back into band + domain format took 12.124 ms
rank = 0, Subspace_Rotation used 15.446 ms

Total time for subspace rotation: 15.450 ms
rank = 0, Efermi =  -0.068288979123 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.165 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.739 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.100 ms
rank = 0, Calculating density took 1184.129 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 1.144 ms
rank = 0, D2D took 108.613 ms
rank = 0, Transfering density took 108.621 ms
Etot    =   -29.676377437974
Eband   =    -7.901979200770
E1      =    17.362932683251
E2      =    -7.456259755853
E3      =   -10.121003089498
Exc     =    -9.090554559185
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 1.187e-05, dEband = 4.613e-04
rank = 0, Calculating/Estimating energy took 0.873 ms, Etot = -29.676377438, dEtot = 1.187e-05, dEband = 4.613e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0317909893452, which took 0.054 ms

iter_count = 108, r_2norm = 1.201e-06, tol*||rhs|| = 1.272e-06

Anderson update took 58.018 ms, out of which F'*F took 26.865 ms; b-Ax took 183.877 ms, out of which Lap took 163.795 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.001 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296476, int_b + int_rho = -6.185e-14, checking this took 0.107 ms
2-norm of RHS = 539.8255365652815, which took 0.116 ms

iter_count = 96, r_2norm = 4.937e-04, tol*||rhs|| = 5.398e-04

Anderson update took 51.529 ms, out of which F'*F took 24.190 ms; b-Ax took 162.934 ms, out of which Lap took 145.765 ms
Solving Poisson took 347.683 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.072728 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 49.285 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.070890 
Total time for convolution: 	 convolve: 5.141227 
Total time for convolution: 	 convolve: 5.101584 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.576 ms
======D2D: initiated sending and receiving took 1.362 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.662 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 26553.497 ms, scf error = 2.560e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.137101, lowerbound = -1.014923, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1119.219 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.577 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.414 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.195 ms
rank =  0, Distribute data + matrix mult took 14.202 ms
rank =  0, finding HY took 18.543 ms
rank =  0, distributing HY into block cyclic form took 12.720 ms
rank =  0, finding Y'*HY took 2.142 ms
Rank 0, Project_Hamiltonian used 47.634 ms
Total time for projection: 47.647 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -1.014902410992780
    last  calculated eigval = 0.037066450804923
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01490241099278
lambda[   2] =  -0.67045772482055
lambda[   3] =  -0.56741278635425
lambda[   4] =  -0.46020680404403
lambda[   5] =  -0.41349284324690
lambda[   6] =  -0.37088380689618
lambda[   7] =  -0.23750217655236
lambda[   8] =  -0.21595714987561
lambda[   9] =  -0.03854953090117
lambda[  10] =   0.00123360227009
lambda[  11] =   0.01450425068472
lambda[  12] =   0.02413464223082
lambda[  13] =   0.02659610306940
lambda[  14] =   0.03706645080492
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 3.300 ms
rank =  0, Distributing orbital back into band + domain format took 12.117 ms
rank = 0, Subspace_Rotation used 15.428 ms

Total time for subspace rotation: 15.432 ms
rank = 0, Efermi =  -0.068103208009 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.198 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.680 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.131 ms
rank = 0, Calculating density took 1186.361 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.402 ms
rank = 0, D2D took 0.532 ms
rank = 0, Transfering density took 0.537 ms
Etot    =   -29.676379244483
Eband   =    -7.901631406065
E1      =    17.362736409279
E2      =    -7.456103017479
E3      =   -10.121034841101
Exc     =    -9.090582899658
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 3.613e-07, dEband = 6.956e-05
rank = 0, Calculating/Estimating energy took 0.892 ms, Etot = -29.676379244, dEtot = 3.613e-07, dEband = 6.956e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0333053488684, which took 0.097 ms

iter_count = 108, r_2norm = 1.223e-06, tol*||rhs|| = 1.332e-06

Anderson update took 57.964 ms, out of which F'*F took 26.779 ms; b-Ax took 183.887 ms, out of which Lap took 163.593 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.030 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296479, int_b + int_rho = -3.274e-14, checking this took 0.100 ms
2-norm of RHS = 539.8247339578256, which took 0.110 ms

iter_count = 102, r_2norm = 4.878e-04, tol*||rhs|| = 5.398e-04

Anderson update took 54.629 ms, out of which F'*F took 25.594 ms; b-Ax took 173.240 ms, out of which Lap took 155.105 ms
Solving Poisson took 369.140 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.077139 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.280 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.082301 
Total time for convolution: 	 convolve: 5.083178 
Total time for convolution: 	 convolve: 5.112406 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.654 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.308 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.983 ms

This SCF took 26381.146 ms, scf error = 2.414e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.137066, lowerbound = -1.014902, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1121.207 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.648 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.416 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.177 ms
rank =  0, Distribute data + matrix mult took 14.252 ms
rank =  0, finding HY took 18.589 ms
rank =  0, distributing HY into block cyclic form took 12.884 ms
rank =  0, finding Y'*HY took 2.080 ms
Rank 0, Project_Hamiltonian used 47.835 ms
Total time for projection: 47.848 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -1.014845059900485
    last  calculated eigval = 0.037149920226127
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01484505990048
lambda[   2] =  -0.67040480623198
lambda[   3] =  -0.56736145015959
lambda[   4] =  -0.46016084101074
lambda[   5] =  -0.41343797141567
lambda[   6] =  -0.37082763924972
lambda[   7] =  -0.23745132428429
lambda[   8] =  -0.21590584389816
lambda[   9] =  -0.03830342023455
lambda[  10] =   0.00134071248864
lambda[  11] =   0.01457898819938
lambda[  12] =   0.02421653387084
lambda[  13] =   0.02687551527700
lambda[  14] =   0.03714992022613
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.163 ms
rank =  0, subspace rotation using ScaLAPACK took 3.234 ms
rank =  0, Distributing orbital back into band + domain format took 11.982 ms
rank = 0, Subspace_Rotation used 15.233 ms

Total time for subspace rotation: 15.237 ms
rank = 0, Efermi =  -0.067857097178 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.115 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.776 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.088 ms
rank = 0, Calculating density took 1187.605 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.473 ms
rank = 0, D2D took 0.840 ms
rank = 0, Transfering density took 0.849 ms
Etot    =   -29.676382132759
Eband   =    -7.900789872798
E1      =    17.362288518077
E2      =    -7.455689907179
E3      =   -10.121115392567
Exc     =    -9.090646871165
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 5.777e-07, dEband = 1.683e-04
rank = 0, Calculating/Estimating energy took 0.944 ms, Etot = -29.676382133, dEtot = 5.777e-07, dEband = 1.683e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0338227693751, which took 0.081 ms

iter_count = 108, r_2norm = 1.207e-06, tol*||rhs|| = 1.353e-06

Anderson update took 58.320 ms, out of which F'*F took 26.834 ms; b-Ax took 183.583 ms, out of which Lap took 163.584 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.251 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296480, int_b + int_rho = -1.819e-14, checking this took 0.108 ms
2-norm of RHS = 539.8248212160603, which took 0.100 ms

iter_count = 84, r_2norm = 5.298e-04, tol*||rhs|| = 5.398e-04

Anderson update took 45.028 ms, out of which F'*F took 21.175 ms; b-Ax took 142.550 ms, out of which Lap took 127.631 ms
Solving Poisson took 304.593 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.085745 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.738 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.081189 
Total time for convolution: 	 convolve: 5.073810 
Total time for convolution: 	 convolve: 5.070680 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.668 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.994 ms

This SCF took 26280.279 ms, scf error = 2.215e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.137150, lowerbound = -1.014845, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1119.624 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.606 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.416 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.237 ms
rank =  0, Distribute data + matrix mult took 14.270 ms
rank =  0, finding HY took 18.615 ms
rank =  0, distributing HY into block cyclic form took 12.707 ms
rank =  0, finding Y'*HY took 2.168 ms
Rank 0, Project_Hamiltonian used 47.786 ms
Total time for projection: 47.801 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -1.014826981834646
    last  calculated eigval = 0.037037884675333
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01482698183465
lambda[   2] =  -0.67039273794352
lambda[   3] =  -0.56734477658185
lambda[   4] =  -0.46014847387559
lambda[   5] =  -0.41342259821793
lambda[   6] =  -0.37081198610454
lambda[   7] =  -0.23743793673545
lambda[   8] =  -0.21589182418041
lambda[   9] =  -0.03830157603720
lambda[  10] =   0.00133946914932
lambda[  11] =   0.01459565240687
lambda[  12] =   0.02418741887315
lambda[  13] =   0.02687415617995
lambda[  14] =   0.03703788467533
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.281 ms
rank =  0, Distributing orbital back into band + domain format took 12.006 ms
rank = 0, Subspace_Rotation used 15.305 ms

Total time for subspace rotation: 15.310 ms
rank = 0, Efermi =  -0.067855253102 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.136 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.772 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.089 ms
rank = 0, Calculating density took 1186.017 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.468 ms
rank = 0, D2D took 0.716 ms
rank = 0, Transfering density took 0.725 ms
Etot    =   -29.676381560218
Eband   =    -7.900554631444
E1      =    17.362169977040
E2      =    -7.455570195906
E3      =   -10.121132689282
Exc     =    -9.090660584382
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 1.145e-07, dEband = 4.705e-05
rank = 0, Calculating/Estimating energy took 1.000 ms, Etot = -29.676381560, dEtot = 1.145e-07, dEband = 4.705e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0376108009696, which took 0.050 ms

iter_count = 108, r_2norm = 1.117e-06, tol*||rhs|| = 1.504e-06

Anderson update took 57.982 ms, out of which F'*F took 26.842 ms; b-Ax took 183.692 ms, out of which Lap took 163.518 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.791 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296484, int_b + int_rho = 1.455e-14, checking this took 0.116 ms
2-norm of RHS = 539.8244503524269, which took 0.111 ms

iter_count = 138, r_2norm = 5.298e-04, tol*||rhs|| = 5.398e-04

Anderson update took 73.988 ms, out of which F'*F took 34.684 ms; b-Ax took 234.285 ms, out of which Lap took 209.717 ms
Solving Poisson took 498.109 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.152230 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.088114 
Total time for convolution: 	 convolve: 5.081855 
Total time for convolution: 	 convolve: 5.094689 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.819 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.656 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.985 ms

This SCF took 26504.386 ms, scf error = 2.172e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.137038, lowerbound = -1.014827, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1122.203 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.675 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.408 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.170 ms
rank =  0, Distribute data + matrix mult took 14.268 ms
rank =  0, finding HY took 18.565 ms
rank =  0, distributing HY into block cyclic form took 12.724 ms
rank =  0, finding Y'*HY took 2.095 ms
Rank 0, Project_Hamiltonian used 47.679 ms
Total time for projection: 47.693 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -1.014657432080674
    last  calculated eigval = 0.036769988879663
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01465743208067
lambda[   2] =  -0.67022619364500
lambda[   3] =  -0.56718427075480
lambda[   4] =  -0.46001461794306
lambda[   5] =  -0.41326867352635
lambda[   6] =  -0.37065577545639
lambda[   7] =  -0.23728697256398
lambda[   8] =  -0.21573978923799
lambda[   9] =  -0.03895054130390
lambda[  10] =   0.00126035845918
lambda[  11] =   0.01466928450751
lambda[  12] =   0.02392841815779
lambda[  13] =   0.02611889934074
lambda[  14] =   0.03676998887966
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 3.378 ms
rank =  0, Distributing orbital back into band + domain format took 11.909 ms
rank = 0, Subspace_Rotation used 15.308 ms

Total time for subspace rotation: 15.311 ms
rank = 0, Efermi =  -0.068504218243 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.194 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.769 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.086 ms
rank = 0, Calculating density took 1188.568 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.557 ms
rank = 0, D2D took 0.763 ms
rank = 0, Transfering density took 0.771 ms
Etot    =   -29.676392528090
Eband   =    -7.898067450921
E1      =    17.360752221433
E2      =    -7.454405887040
E3      =   -10.121463251207
Exc     =    -9.090907230228
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 2.194e-06, dEband = 4.974e-04
rank = 0, Calculating/Estimating energy took 0.948 ms, Etot = -29.676392528, dEtot = 2.194e-06, dEband = 4.974e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0412950904217, which took 0.055 ms

iter_count = 102, r_2norm = 1.523e-06, tol*||rhs|| = 1.652e-06

Anderson update took 54.975 ms, out of which F'*F took 25.330 ms; b-Ax took 173.448 ms, out of which Lap took 154.361 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 377.261 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296483, int_b + int_rho = 7.276e-15, checking this took 0.110 ms
2-norm of RHS = 539.8285123651294, which took 0.108 ms

iter_count = 144, r_2norm = 4.705e-04, tol*||rhs|| = 5.398e-04

Anderson update took 77.364 ms, out of which F'*F took 36.262 ms; b-Ax took 244.302 ms, out of which Lap took 218.741 ms
Solving Poisson took 519.796 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.069270 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 50.247 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.074560 
Total time for convolution: 	 convolve: 5.092357 
Total time for convolution: 	 convolve: 5.078441 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 0.682 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.301 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.003 ms

This SCF took 26454.877 ms, scf error = 1.673e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.136770, lowerbound = -1.014657, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1122.281 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.605 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.427 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.196 ms
rank =  0, Distribute data + matrix mult took 14.240 ms
rank =  0, finding HY took 18.565 ms
rank =  0, distributing HY into block cyclic form took 12.694 ms
rank =  0, finding Y'*HY took 2.127 ms
Rank 0, Project_Hamiltonian used 47.653 ms
Total time for projection: 47.683 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -1.014500243536367
    last  calculated eigval = 0.038102202527040
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01450024353637
lambda[   2] =  -0.67006223150713
lambda[   3] =  -0.56702658096158
lambda[   4] =  -0.45984276054560
lambda[   5] =  -0.41311803650508
lambda[   6] =  -0.37049871556605
lambda[   7] =  -0.23712254892512
lambda[   8] =  -0.21557833892982
lambda[   9] =  -0.03837380203248
lambda[  10] =   0.00187661119358
lambda[  11] =   0.01513102193000
lambda[  12] =   0.02432287429374
lambda[  13] =   0.02711904580652
lambda[  14] =   0.03810220252704
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 3.048 ms
rank =  0, Distributing orbital back into band + domain format took 12.192 ms
rank = 0, Subspace_Rotation used 15.257 ms

Total time for subspace rotation: 15.261 ms
rank = 0, Efermi =  -0.067927479016 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.145 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.762 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1188.509 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.474 ms
rank = 0, D2D took 0.681 ms
rank = 0, Transfering density took 0.689 ms
Etot    =   -29.676399923592
Eband   =    -7.895498913451
E1      =    17.359601162618
E2      =    -7.452934175134
E3      =   -10.121647168437
Exc     =    -9.091044309710
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 1.479e-06, dEband = 5.137e-04
rank = 0, Calculating/Estimating energy took 1.046 ms, Etot = -29.676399924, dEtot = 1.479e-06, dEband = 5.137e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0289439729264, which took 0.062 ms

iter_count = 108, r_2norm = 8.873e-07, tol*||rhs|| = 1.158e-06

Anderson update took 58.033 ms, out of which F'*F took 26.845 ms; b-Ax took 183.723 ms, out of which Lap took 163.478 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.741 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296478, int_b + int_rho = -3.820e-14, checking this took 0.104 ms
2-norm of RHS = 539.8280933592350, which took 0.093 ms

iter_count = 96, r_2norm = 4.739e-04, tol*||rhs|| = 5.398e-04

Anderson update took 51.709 ms, out of which F'*F took 24.091 ms; b-Ax took 162.826 ms, out of which Lap took 145.818 ms
Solving Poisson took 347.791 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.084555 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.483 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.074411 
Total time for convolution: 	 convolve: 5.081730 
Total time for convolution: 	 convolve: 5.076865 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.672 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.998 ms

This SCF took 26291.044 ms, scf error = 1.826e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.138102, lowerbound = -1.014500, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.693 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.615 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.420 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.147 ms
rank =  0, Distribute data + matrix mult took 14.215 ms
rank =  0, finding HY took 18.327 ms
rank =  0, distributing HY into block cyclic form took 16.489 ms
rank =  0, finding Y'*HY took 2.156 ms
Rank 0, Project_Hamiltonian used 51.218 ms
Total time for projection: 51.235 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -1.014434852999905
    last  calculated eigval = 0.038577998201589
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01443485299990
lambda[   2] =  -0.66999149535300
lambda[   3] =  -0.56696331395180
lambda[   4] =  -0.45977771860210
lambda[   5] =  -0.41305465824504
lambda[   6] =  -0.37043453413047
lambda[   7] =  -0.23705645724160
lambda[   8] =  -0.21551211360069
lambda[   9] =  -0.03807691102845
lambda[  10] =   0.00217176028654
lambda[  11] =   0.01531757848813
lambda[  12] =   0.02446755165846
lambda[  13] =   0.02760590924840
lambda[  14] =   0.03857799820159
==subpsace eigenproblem: bcast eigvals took 0.045 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 3.297 ms
rank =  0, Distributing orbital back into band + domain format took 12.181 ms
rank = 0, Subspace_Rotation used 15.489 ms

Total time for subspace rotation: 15.493 ms
rank = 0, Efermi =  -0.067630588059 calculate fermi energy took 0.037 ms
rank = 0, --- Calculate rho: sum over local bands took 2.164 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.804 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.088 ms
rank = 0, Calculating density took 1190.772 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
rank = 0, D2D took 0.798 ms
rank = 0, Transfering density took 0.805 ms
Etot    =   -29.676404121729
Eband   =    -7.894450288743
E1      =    17.359027307160
E2      =    -7.452430145860
E3      =   -10.121767717327
Exc     =    -9.091139796714
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 8.396e-07, dEband = 2.097e-04
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -29.676404122, dEtot = 8.396e-07, dEband = 2.097e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0311775448400, which took 0.106 ms

iter_count = 108, r_2norm = 8.448e-07, tol*||rhs|| = 1.247e-06

Anderson update took 57.970 ms, out of which F'*F took 26.888 ms; b-Ax took 183.729 ms, out of which Lap took 163.647 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.950 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296480, int_b + int_rho = -2.365e-14, checking this took 0.106 ms
2-norm of RHS = 539.8265257666827, which took 0.099 ms

iter_count = 132, r_2norm = 5.313e-04, tol*||rhs|| = 5.398e-04

Anderson update took 70.859 ms, out of which F'*F took 33.263 ms; b-Ax took 224.219 ms, out of which Lap took 200.638 ms
Solving Poisson took 476.871 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.071270 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 38.293 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.073317 
Total time for convolution: 	 convolve: 5.077152 
Total time for convolution: 	 convolve: 5.083901 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.308 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 26414.778 ms, scf error = 1.646e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.138578, lowerbound = -1.014435, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1121.996 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.649 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.410 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.180 ms
rank =  0, Distribute data + matrix mult took 14.258 ms
rank =  0, finding HY took 18.551 ms
rank =  0, distributing HY into block cyclic form took 12.650 ms
rank =  0, finding Y'*HY took 2.193 ms
Rank 0, Project_Hamiltonian used 47.680 ms
Total time for projection: 47.694 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -1.014293494092924
    last  calculated eigval = 0.039317766221293
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01429349409292
lambda[   2] =  -0.66984883225141
lambda[   3] =  -0.56682569626984
lambda[   4] =  -0.45965699396358
lambda[   5] =  -0.41291817917750
lambda[   6] =  -0.37030077684620
lambda[   7] =  -0.23692846243257
lambda[   8] =  -0.21538194298529
lambda[   9] =  -0.03854840081686
lambda[  10] =   0.00279407758591
lambda[  11] =   0.01569887520503
lambda[  12] =   0.02438931839946
lambda[  13] =   0.02724131913959
lambda[  14] =   0.03931776622129
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 3.302 ms
rank =  0, Distributing orbital back into band + domain format took 12.197 ms
rank = 0, Subspace_Rotation used 15.509 ms

Total time for subspace rotation: 15.514 ms
rank = 0, Efermi =  -0.068102077945 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.172 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.756 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1188.531 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.505 ms
rank = 0, D2D took 0.822 ms
rank = 0, Transfering density took 0.824 ms
Etot    =   -29.676406624081
Eband   =    -7.892308756538
E1      =    17.357806353212
E2      =    -7.451442799720
E3      =   -10.122053545620
Exc     =    -9.091361359475
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 5.005e-07, dEband = 4.283e-04
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -29.676406624, dEtot = 5.005e-07, dEband = 4.283e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0310580330258, which took 0.086 ms

iter_count = 102, r_2norm = 1.241e-06, tol*||rhs|| = 1.242e-06

Anderson update took 54.839 ms, out of which F'*F took 25.247 ms; b-Ax took 173.307 ms, out of which Lap took 154.259 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 377.286 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296481, int_b + int_rho = -1.273e-14, checking this took 0.146 ms
2-norm of RHS = 539.8263539213507, which took 0.122 ms

iter_count = 120, r_2norm = 5.199e-04, tol*||rhs|| = 5.398e-04

Anderson update took 64.411 ms, out of which F'*F took 30.238 ms; b-Ax took 203.868 ms, out of which Lap took 182.452 ms
Solving Poisson took 433.844 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.969 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.082684 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 168.381 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.087061 
Total time for convolution: 	 convolve: 5.087281 
Total time for convolution: 	 convolve: 5.074668 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.837 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.679 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.015 ms

This SCF took 26523.280 ms, scf error = 1.204e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.139318, lowerbound = -1.014293, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1119.559 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.583 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.431 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.171 ms
rank =  0, Distribute data + matrix mult took 14.199 ms
rank =  0, finding HY took 18.612 ms
rank =  0, distributing HY into block cyclic form took 12.754 ms
rank =  0, finding Y'*HY took 2.120 ms
Rank 0, Project_Hamiltonian used 47.712 ms
Total time for projection: 47.725 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -1.014306051414150
    last  calculated eigval = 0.039675522407422
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01430605141415
lambda[   2] =  -0.66986350724286
lambda[   3] =  -0.56683420427112
lambda[   4] =  -0.45967156780696
lambda[   5] =  -0.41292536125584
lambda[   6] =  -0.37030921812877
lambda[   7] =  -0.23694086838003
lambda[   8] =  -0.21539487123071
lambda[   9] =  -0.03920304202902
lambda[  10] =   0.00339111602065
lambda[  11] =   0.01596594595848
lambda[  12] =   0.02432283200487
lambda[  13] =   0.02689869889222
lambda[  14] =   0.03967552240742
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 3.311 ms
rank =  0, Distributing orbital back into band + domain format took 12.131 ms
rank = 0, Subspace_Rotation used 15.454 ms

Total time for subspace rotation: 15.458 ms
rank = 0, Efermi =  -0.068756719068 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.161 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.762 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1186.012 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.505 ms
rank = 0, D2D took 0.829 ms
rank = 0, Transfering density took 0.833 ms
Etot    =   -29.676408204071
Eband   =    -7.892491299969
E1      =    17.357982832457
E2      =    -7.451473586296
E3      =   -10.121940026514
Exc     =    -9.091274142750
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 3.160e-07, dEband = 3.651e-05
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -29.676408204, dEtot = 3.160e-07, dEband = 3.651e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0320654891157, which took 0.053 ms

iter_count = 102, r_2norm = 1.194e-06, tol*||rhs|| = 1.283e-06

Anderson update took 54.908 ms, out of which F'*F took 25.399 ms; b-Ax took 173.554 ms, out of which Lap took 154.476 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 377.327 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296481, int_b + int_rho = -1.273e-14, checking this took 0.122 ms
2-norm of RHS = 539.8257219724031, which took 0.110 ms

iter_count = 66, r_2norm = 5.365e-04, tol*||rhs|| = 5.398e-04

Anderson update took 35.775 ms, out of which F'*F took 16.626 ms; b-Ax took 112.568 ms, out of which Lap took 101.170 ms
Solving Poisson took 239.921 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.140410 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.078160 
Total time for convolution: 	 convolve: 5.148906 
Total time for convolution: 	 convolve: 5.085994 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.721 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.055 ms

This SCF took 26295.544 ms, scf error = 1.301e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.139676, lowerbound = -1.014306, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1123.579 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.627 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.415 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.186 ms
rank =  0, Distribute data + matrix mult took 14.241 ms
rank =  0, finding HY took 18.528 ms
rank =  0, distributing HY into block cyclic form took 12.729 ms
rank =  0, finding Y'*HY took 2.148 ms
Rank 0, Project_Hamiltonian used 47.676 ms
Total time for projection: 47.689 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -1.014299729129220
    last  calculated eigval = 0.039320486979771
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01429972912922
lambda[   2] =  -0.66985206512432
lambda[   3] =  -0.56682742206093
lambda[   4] =  -0.45966245716021
lambda[   5] =  -0.41291942193154
lambda[   6] =  -0.37030308665409
lambda[   7] =  -0.23693137460595
lambda[   8] =  -0.21538559018234
lambda[   9] =  -0.03940377787216
lambda[  10] =   0.00339711233808
lambda[  11] =   0.01595145347999
lambda[  12] =   0.02422051720450
lambda[  13] =   0.02665338776523
lambda[  14] =   0.03932048697977
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 3.363 ms
rank =  0, Distributing orbital back into band + domain format took 12.044 ms
rank = 0, Subspace_Rotation used 15.422 ms

Total time for subspace rotation: 15.426 ms
rank = 0, Efermi =  -0.068957454960 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.150 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.807 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.086 ms
rank = 0, Calculating density took 1190.003 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.510 ms
rank = 0, D2D took 0.815 ms
rank = 0, Transfering density took 0.818 ms
Etot    =   -29.676411064002
Eband   =    -7.892362294208
E1      =    17.357886763392
E2      =    -7.451435186445
E3      =   -10.121953148167
Exc     =    -9.091284661178
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 5.720e-07, dEband = 2.580e-05
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -29.676411064, dEtot = 5.720e-07, dEband = 2.580e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0296514040291, which took 0.047 ms

iter_count = 102, r_2norm = 1.180e-06, tol*||rhs|| = 1.186e-06

Anderson update took 54.824 ms, out of which F'*F took 25.272 ms; b-Ax took 173.433 ms, out of which Lap took 154.340 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 377.798 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296484, int_b + int_rho = 1.819e-14, checking this took 0.560 ms
2-norm of RHS = 539.8235552174116, which took 0.099 ms

iter_count = 96, r_2norm = 5.108e-04, tol*||rhs|| = 5.398e-04

Anderson update took 51.495 ms, out of which F'*F took 24.137 ms; b-Ax took 163.135 ms, out of which Lap took 146.002 ms
Solving Poisson took 347.811 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.076101 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.325 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.114357 
Total time for convolution: 	 convolve: 5.116972 
Total time for convolution: 	 convolve: 5.082633 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.312 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.007 ms

This SCF took 26355.561 ms, scf error = 1.227e-04
-------------
SCF iter 24  
-------------

 Chebfilt 27, in Chebyshev filtering, lambda_cutoff = 0.139320, lowerbound = -1.014300, upperbound = 267.575304

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1117.585 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.644 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.410 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.210 ms
rank =  0, Distribute data + matrix mult took 14.277 ms
rank =  0, finding HY took 18.811 ms
rank =  0, distributing HY into block cyclic form took 12.714 ms
rank =  0, finding Y'*HY took 2.187 ms
Rank 0, Project_Hamiltonian used 48.023 ms
Total time for projection: 48.036 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -1.014238791375207
    last  calculated eigval = 0.038816159748768
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01423879137521
lambda[   2] =  -0.66981216979621
lambda[   3] =  -0.56677588267276
lambda[   4] =  -0.45963726525646
lambda[   5] =  -0.41286831765744
lambda[   6] =  -0.37025194495922
lambda[   7] =  -0.23689790244496
lambda[   8] =  -0.21535010436170
lambda[   9] =  -0.03957742849056
lambda[  10] =   0.00343583253433
lambda[  11] =   0.01595891218805
lambda[  12] =   0.02408972374099
lambda[  13] =   0.02636370875490
lambda[  14] =   0.03881615974877
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.316 ms
rank =  0, Distributing orbital back into band + domain format took 12.085 ms
rank = 0, Subspace_Rotation used 15.413 ms

Total time for subspace rotation: 15.416 ms
rank = 0, Efermi =  -0.069131105539 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.204 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.724 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1184.356 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.462 ms
rank = 0, D2D took 0.879 ms
rank = 0, Transfering density took 0.886 ms
Etot    =   -29.676409195850
Eband   =    -7.891664757561
E1      =    17.357396402496
E2      =    -7.451198850787
E3      =   -10.122099286404
Exc     =    -9.091399771356
Esc     =   -47.624039206225
Entropy =    -0.000000000394
dE = 3.736e-07, dEband = 1.395e-04
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -29.676409196, dEtot = 3.736e-07, dEband = 1.395e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0216026718153, which took 0.107 ms

iter_count = 108, r_2norm = 6.323e-07, tol*||rhs|| = 8.641e-07

Anderson update took 57.907 ms, out of which F'*F took 26.940 ms; b-Ax took 183.962 ms, out of which Lap took 163.742 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.163 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001296482, int_rho =  16.00000001296485, int_b + int_rho = 2.365e-14, checking this took 0.118 ms
2-norm of RHS = 539.8212591147998, which took 0.093 ms

iter_count = 108, r_2norm = 5.265e-04, tol*||rhs|| = 5.398e-04

Anderson update took 58.339 ms, out of which F'*F took 27.159 ms; b-Ax took 183.594 ms, out of which Lap took 164.360 ms
Solving Poisson took 391.566 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.145994 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.893 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.112545 
Total time for convolution: 	 convolve: 5.082721 
Total time for convolution: 	 convolve: 5.076962 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.860 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.668 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.990 ms

This SCF took 26445.911 ms, scf error = 8.969e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -1.01423879137521, occ[   1] =   2.00000000000000
lambda[   2] =  -0.66981216979621, occ[   2] =   2.00000000000000
lambda[   3] =  -0.56677588267276, occ[   3] =   2.00000000000000
lambda[   4] =  -0.45963726525646, occ[   4] =   2.00000000000000
lambda[   5] =  -0.41286831765744, occ[   5] =   2.00000000000000
lambda[   6] =  -0.37025194495922, occ[   6] =   2.00000000000000
lambda[   7] =  -0.23689790244496, occ[   7] =   2.00000000000000
lambda[   8] =  -0.21535010436170, occ[   8] =   2.00000000000000
lambda[   9] =  -0.03957742849056, occ[   9] =   0.00000001296480
lambda[  10] =   0.00343583253433, occ[  10] =   0.00000000000000
lambda[  11] =   0.01595891218805, occ[  11] =   0.00000000000000
lambda[  12] =   0.02408972374099, occ[  12] =   0.00000000000000
lambda[  13] =   0.02636370875490, occ[  13] =   0.00000000000000
lambda[  14] =   0.03881615974877, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.478 ms, time for Allreduce/Reduce: 6.057 ms 
Time for calculating local force components: 14.751 ms
Start Calculating nonlocal forces
force_nloc = 
  0.98069786369815   0.65922468667514   0.00000116200242
 -0.00502719124830  -0.05475342546060  -0.00000000795926
 -0.06599725986161   0.03566125953956   0.00000000927528
 -0.04738218528308  -0.28259127034302   0.00000028552298
  0.00084267883142  -0.07000776263237  -0.00000079839399
force_loc = 
 -0.95353135317016  -0.62894004437865  -0.00000075013699
  0.00528678613693   0.05764206650258  -0.00000013737262
  0.06944619787841  -0.03980169014510  -0.00000019267035
  0.04329910935262   0.25445366552072   0.00000121125499
 -0.00060320311371   0.07800971227468  -0.00000025910253
Time for calculating nonlocal force components: 25.482 ms
[32mforces_xc: 
[0m[32m -0.02894605507351  -0.02103062193842  -0.00000005877342
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00292408002800   0.02154136480049   0.00000011315842
[0m[32m -0.00109111738275  -0.00950077156204  -0.00000004594174
[0mTime for calculating XC forces components: 18.551 ms
 Cartesian force = 
 -0.00176321470400   0.00927258658748   0.00000024691936
  0.00027592473015   0.00290720727138  -0.00000025150452
  0.00346526785832  -0.00412186437613  -0.00000028956770
 -0.00114266606095  -0.00657767379241   0.00000150376376
 -0.00083531182352  -0.00148025569033  -0.00000120961090
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.203 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Time for printing density: 391.319 ms
The program took 671.475 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:33:14
Job ID:        2266797
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:16:24,vmem=8516K,walltime=00:11:22,mem=8168K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-011-4-1
---------------------------------------
